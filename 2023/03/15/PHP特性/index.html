
<!DOCTYPE html>
<html lang="zh-CN">
    <head>
        <meta charset="UTF-8" />
        <title>PHP特性 | 雲流のLowest World</title>
        <meta name="author" content="C1oudfL0w0" />
        <meta name="description" content="" />
        <meta name="keywords" content="" />
        <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
        <link rel="icon" href="/blog/images/croppedImage_cropped.jpg" />
        <script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.min.js"></script>
<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.2.1/css/all.min.css" />
<link rel="stylesheet" href="/blog/css/fonts.min.css" />
<script> const mixins = {}; </script>

<script src="https://polyfill.io/v3/polyfill.min.js?features=default"></script>

<!--改成了prismjs高亮-->

<script src="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/prism.js"></script>
<link href="https://cdn.jsdelivr.net/npm/prismjs@1.25.0/themes/prism.css" rel="stylesheet" />
<script src="/blog/js/lib/prism.js"></script>



<script src="/blog/js/lib/preview.js"></script>









<script src="/blog/js/lib/home.js"></script>

<link rel="stylesheet" href="/blog/css/main.css" />
<!-- 引入jQuery-->
<script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script>
<!-- 引入不蒜子-->
<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>
        <!-- 页面点击小红心与文字 -->
        <script type = "text/javascript" src = "/blog/js/love-click.js"></script>
        <!-- 浏览器标题 -->
        <script type="text/javascript" src="/blog/js/FunnyTitle.js"></script>
        
        <script type="text/javascript" src="/blog/libs/codeBlock/codeBlockFuction.js"></script>
<!-- 代码语言 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeLang.js"></script>
<!-- 代码块复制 -->
<!-- 引入clipboard -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>
<script type="text/javascript" src="/blog/libs/codeBlock/codeCopy.js"></script>
<!-- 代码块收缩 -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeShrink.js"></script> 
<!-- 代码块折行 -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>
    <meta name="generator" content="Hexo 6.3.0"></head>
    <body>
        <!--flag{never_g0nna g1ve_you up}-->

        <!--动态背景-->
        <script type="text/javascript"
        color="0,0,255" opacity='0.7' zIndex="-2" count="99" src="//cdn.bootcss.com/canvas-nest.js/1.0.0/canvas-nest.min.js"></script>

        <!--文章目录-->
        <div id="toc" class="toc-article">
    <div class="toc-title"></div>
    <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#PHP%E7%89%B9%E6%80%A7"><span class="toc-text">PHP特性</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#PHP%E5%BC%B1%E7%B1%BB%E5%9E%8B"><span class="toc-text">PHP弱类型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#preg-match-%E5%87%BD%E6%95%B0"><span class="toc-text">preg_match()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#intval-%E5%87%BD%E6%95%B0"><span class="toc-text">intval()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#strpos%E5%87%BD%E6%95%B0"><span class="toc-text">strpos函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#in-array-%E5%87%BD%E6%95%B0"><span class="toc-text">in_array()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#ereg-%E5%87%BD%E6%95%B0"><span class="toc-text">ereg()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#is-file-%E5%87%BD%E6%95%B0"><span class="toc-text">is_file()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#is-numeric-%E5%87%BD%E6%95%B0"><span class="toc-text">is_numeric()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#trim-%E5%87%BD%E6%95%B0"><span class="toc-text">trim()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SERVER-%E2%80%98argv%E2%80%99"><span class="toc-text">$_SERVER[‘argv’]</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#gettext-%E5%87%BD%E6%95%B0"><span class="toc-text">gettext()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#get-defined-vars-%E5%87%BD%E6%95%B0"><span class="toc-text">get_defined_vars()函数</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E7%BB%95%E8%BF%87"><span class="toc-text">正则绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8D%A2%E8%A1%8C%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E"><span class="toc-text">换行解析漏洞</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%B7%AF%E5%BE%84%E7%BB%95%E8%BF%87"><span class="toc-text">路径绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E5%BD%95%E7%A9%BF%E8%B6%8A"><span class="toc-text">目录穿越</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7"><span class="toc-text">运算符优先级</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E7%B1%BB"><span class="toc-text">内置类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#Exception-%E5%87%BD%E6%95%B0"><span class="toc-text">Exception()函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%8D%E5%B0%84%E7%B1%BBReflectionClass"><span class="toc-text">反射类ReflectionClass</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%BF%AD%E4%BB%A3%E5%99%A8FilesystemIterator"><span class="toc-text">文件系统迭代器FilesystemIterator</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BC%96%E7%A0%81%E7%BB%95%E8%BF%87"><span class="toc-text">编码绕过</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%81%E5%85%AD%E8%BF%9B%E5%88%B6"><span class="toc-text">十六进制</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#url%E7%BC%96%E7%A0%81"><span class="toc-text">url编码</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81"><span class="toc-text">字符编码</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E8%A6%86%E7%9B%96"><span class="toc-text">变量覆盖</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link"><span class="toc-text">$$</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#extract-%E5%87%BD%E6%95%B0"><span class="toc-text">extract()函数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#parse-str-%E5%87%BD%E6%95%B0"><span class="toc-text">parse_str()函数</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%9E%E6%B3%95%E4%BC%A0%E5%8F%82"><span class="toc-text">非法传参</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#md5%E7%AD%89%E6%95%88%E5%80%BC%E7%BB%95%E8%BF%87"><span class="toc-text">md5等效值绕过</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#SHA1"><span class="toc-text">SHA1</span></a></li></ol></li></ol>
</div>
        
        <!--返回顶部-->
        <div id="totop" style="position:fixed;bottom:50px;right:60px;font-size: 48px;cursor: pointer;z-index: 10;">
            <a title="返回顶部">↑</a>
            </div>
        <script src="/blog/js/totop.js"></script>

        <div id="layout">
            <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>第一次加载可能会花费较长时间，请耐心等待</p>
                    <p>要不挂个梯子试试？（x</p>
                    <p>加载过慢请开启缓存&ensp;浏览器默认开启</p>
                    <img src="/blog/images/loading.gif" />
                </div>
            </div>
            </transition>
            <transition name="into">
            <div id="main" v-show="!loading">
                <nav id="menu" ref="menu">
    <div class="desktop-menu">
        <a class="title" href="/blog/">
            <span>雲流のLOWEST WORLD</span>
        </a>
        
        <a href="/blog/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/blog/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/blog/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/blog/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/blog/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
        <a href="/blog/links">
            <i class="fa-solid fa-link fa-fw"></i>
            <span>&ensp;Links</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" v-show="showMenu" @click="showMenu = !showMenu"></div>
        <div class="title" @click="showMenu = !showMenu">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;雲流のLOWEST WORLD</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="showMenu">
            
            <a href="/blog/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/blog/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/blog/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/blog/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/blog/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
            <a href="/blog/links">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-link fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Links</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>PHP特性</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2023/3/15
        </span>
        
        <span class="category">
            <a href="/blog/categories/Web/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                Web
            </a>
        </span>
        
        
        <span class="tags">
            <span class="icon">
                <i class="fa-solid fa-tags fa-fw"></i>
            </span>
            
            <span class="tag">
                
                <a href="/blog/tags/PHP/" style="color: #00bcd4">PHP</a>
            </span>
            
        </span>
        
        <!--文章字数统计-->
        
            
<div style="margin-top:10px;">
    <span class="post-time">
      <span class="post-meta-item-icon">
        <i class="fa fa-keyboard-o"></i>
        <span class="post-meta-item-text">  字数统计: </span>
        <!-- 安装插件npm install hexo-wordcount --save -->
        <span class="post-count">3.5k字</span>
      </span>
    </span>

    <span class="post-time">
      &nbsp; | &nbsp;
      <span class="post-meta-item-icon">
        <i class="fa fa-hourglass-half"></i>
        <span class="post-meta-item-text">  阅读时长: </span>
        <span class="post-count">15分</span>
      </span>
    </span>
    
    <!--不蒜子统计访问数-->
    <span id="busuanzi_container_page_pv">
    &nbsp; | &nbsp;
    总文章阅读量：<span id="busuanzi_value_page_pv"></span>次
    </span>
</div>

          
    </div>
    
    <div class="content" v-pre>
        <h1 id="PHP特性"><a href="#PHP特性" class="headerlink" title="PHP特性"></a>PHP特性</h1><span id="more"></span>

<h2 id="PHP弱类型"><a href="#PHP弱类型" class="headerlink" title="PHP弱类型"></a>PHP弱类型</h2><blockquote>
<p>在 PHP 中，不同类型的变量可以相互转换</p>
</blockquote>
<p>例如将字符串转换为数字或将数字转换为字符串</p>
<ul>
<li><p>科学计数法绕过</p>
<blockquote>
<p> 使用例</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$year</span><span class="token operator">==</span><span class="token number">2022</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$year</span><span class="token operator">+</span><span class="token number">1</span><span class="token operator">!==</span><span class="token number">2023</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span> 
此时传入<span class="token number">202.2e1</span>即可绕过<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>与数字或布尔值比较时，字符串会转为数字或布尔值</p>
<p>例：字符串’&lt;’会被转换为0，因为不是一个有效的数字</p>
</li>
</ul>
<h2 id="preg-match-函数"><a href="#preg-match-函数" class="headerlink" title="preg_match()函数"></a>preg_match()函数</h2><blockquote>
<p>判断输入的值是否存在指定字符</p>
</blockquote>
<ul>
<li>漏洞：<strong>无法处理数组</strong></li>
</ul>
<h2 id="intval-函数"><a href="#intval-函数" class="headerlink" title="intval()函数"></a>intval()函数</h2><blockquote>
<p>将给定变量转换成整型变量，获取变量的整数值</p>
</blockquote>
  <pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword type-declaration">int</span> <span class="token function">intval</span> <span class="token punctuation">(</span> <span class="token keyword">var</span> <span class="token punctuation">,</span> base <span class="token punctuation">)</span>
<span class="token comment">////var指要转换成 integer 的数量值,base指转化所使用的进制 </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li><p><code>var</code> 可以是任何标量类型，变量不能是array和object格式</p>
<p>除非<code>var</code>参数是字符串，否则 <strong>intval()</strong> 的 <code>base </code>参数不会有效果</p>
<p><code>var</code>中存在字母的话遇到字母就停止读取</p>
<p>但是<strong>e</strong>这个字母比较特殊，可以在PHP中不是科学计数法</p>
</li>
<li><p>如果 <code>base </code>是 <strong>0</strong>，通过检测 <code>var </code>的格式来决定使用的进制： </p>
<ul>
<li>如果字符串包括了 “0x” (或 “0X”) 的前缀，使用 16 进制 (hex)；</li>
<li>否则，如果字符串以 “0” 开始，使用 8 进制(octal)；</li>
<li>否则，如果字符串以”0b”开始，使用2进制；</li>
<li>否则，将使用 10 进制 (decimal)。</li>
</ul>
</li>
<li><p><strong>漏洞</strong>：通过使用<strong>指定的进制</strong> <code>base</code> 转换（默认是十进制），返回变量 <code>var</code> 的 integer 数值。 intval() 不能用于 object，否则会产生 E_NOTICE 错误并返回 1。</p>
<p>处理开头是数字的字符串时，返回值为开头的数</p>
</li>
</ul>
<blockquote>
<p>利用方式</p>
</blockquote>
<ul>
<li><p>过滤某个数字时，我们可以利用它的进制转换来绕过</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token number">042</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment">// 34</span>
<span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token number">0x1A</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// 2</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>数组绕过</p>
<blockquote>
<p>返回值<br>成功时返回 var 的 integer 值，失败时返回 0。空的 array 返回 0，非空的 array 返回 1。 </p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">!=</span>b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span>a<span class="token operator">==</span>b<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
    <span class="token comment">//输入a[]=1和b[]=2绕过(此时两个不同但是都返回1)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>小数点绕过</p>
<blockquote>
<p>小数点后的数字会直接舍去</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                      <span class="token comment">// 42</span>
<span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token number">4.2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                     <span class="token comment">// 4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>
</li>
<li><p>单引号字母绕过</p>
<blockquote>
<p>单引号传值的时候，它只识别字母前面的一部分</p>
<p>进行get传参时,默认加单引号</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token number">1e10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token comment">// 1410065408</span>
<span class="token keyword">echo</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'1e10'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                  <span class="token comment">// 1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<ul>
<li>仅在<strong>php5</strong>下可实现1e10&#x3D;1；<strong>php7</strong>下会转换成10的10次方</li>
<li>计算时1e10会自动转换为10的10次方</li>
</ul>
</li>
</ul>
<h2 id="strpos函数"><a href="#strpos函数" class="headerlink" title="strpos函数"></a><a href="#strpos">strpos函数</a></h2><ul>
<li>开头添加<code>+</code>或<code>%0a</code>使返回数改变</li>
</ul>
<h2 id="in-array-函数"><a href="#in-array-函数" class="headerlink" title="in_array()函数"></a>in_array()函数</h2><blockquote>
<p>判断一个值是否在数组中</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">in_array</span><span class="token punctuation">(</span>value<span class="token punctuation">,</span><span class="token keyword type-declaration">array</span><span class="token punctuation">,</span>type<span class="token punctuation">)</span>
<span class="token comment">//value ：要搜索的值</span>
<span class="token comment">//array ：被搜索的数组</span>
<span class="token comment">//type ： 类型，true全等 ，false非全等(默认)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<blockquote>
<p>没有设置第三个参数 就可以形成自动转换(弱类型比较忽略后面的字符串)</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">eg<span class="token punctuation">:</span>n<span class="token operator">=</span><span class="token number">1.</span>php自动转换为<span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<h2 id="ereg-函数"><a href="#ereg-函数" class="headerlink" title="ereg()函数"></a>ereg()函数</h2><blockquote>
<p>用指定的模式搜索一个字符串中指定的字符串,如果匹配成功返回true,否则,则返回false</p>
<p>搜索字母的字符是大小写敏感的</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword type-declaration">int</span> <span class="token function">ereg</span><span class="token punctuation">(</span><span class="token keyword type-declaration">string</span> pattern<span class="token punctuation">,</span> <span class="token keyword type-declaration">string</span> originalstring<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token keyword type-declaration">array</span> regs<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

可选的输入参数regs包含由正则表达式中的括号组成的所有匹配表达式的数组<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<ul>
<li><strong>漏洞</strong>：<ul>
<li>NULL截断：使用**%00**截断前后语句的正则匹配</li>
<li>只能处理字符串，遇到数组做参数返回NULL</li>
</ul>
</li>
</ul>
<h2 id="is-file-函数"><a href="#is-file-函数" class="headerlink" title="is_file()函数"></a>is_file()函数</h2><blockquote>
<p>检查指定的文件是否是常规的文件。</p>
<p>如果文件是常规的文件，该函数返回 TRUE。</p>
</blockquote>
<ul>
<li>可运用伪协议</li>
<li>目录溢出：该函数最多能处理330位字符串（大概？），超出后会认为不是一个文件</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;p
roc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;pro
c&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;
self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;proc&#x2F;se
lf&#x2F;root&#x2F;proc&#x2F;self&#x2F;root&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h2 id="is-numeric-函数"><a href="#is-numeric-函数" class="headerlink" title="is_numeric()函数"></a>is_numeric()函数</h2><blockquote>
<p>检测变量是否为数字或数字字符串</p>
</blockquote>
<blockquote>
<p>PHP 4, PHP 5, PHP 7</p>
</blockquote>
<p>如果指定的变量是数字和数字字符串则返回 TRUE，否则返回 FALSE，注意<strong>浮点型</strong>返回 1，即 TRUE</p>
<ul>
<li><p>在数字前加上空格，也会被is_numeric函数认为是数字</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">\n<span class="token punctuation">,</span>\t<span class="token punctuation">,</span>\f<span class="token punctuation">,</span>\r<span class="token punctuation">,</span>\v<span class="token punctuation">,</span> <span class="token operator">.</span>均可绕过<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<h2 id="trim-函数"><a href="#trim-函数" class="headerlink" title="trim()函数"></a>trim()函数</h2><blockquote>
<p>移除字符串两侧的空白字符或其他预定义字符</p>
</blockquote>
<blockquote>
<p><code>ltrim() </code>移除字符串左侧的空白字符或其他预定义字符。<code>rtrim()</code>移除字符串右侧的空白字符或其他预定义字符。</p>
</blockquote>
<p>执行成功时返回删除了string字符串首部和尾部空格的字符串，发生错误时返回空字符串（””）。如果任何参数的值为NULL,trim() 函数返回NULL</p>
<ul>
<li>trim()函数过滤空格以及<code>\n\r\t\v\0</code>，但不会过滤<code>\f (%0c)</code></li>
</ul>
<h2 id="SERVER-‘argv’"><a href="#SERVER-‘argv’" class="headerlink" title="$_SERVER[‘argv’]"></a>$_SERVER[‘argv’]</h2><blockquote>
<p>传递给该脚本的参数，以数组方式传回里面的内容</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'argv'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">>></span><span class="token operator">></span>url<span class="token operator">/</span><span class="token operator">?</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token number">1</span>b<span class="token operator">=</span><span class="token number">2</span>
<span class="token operator">>></span><span class="token operator">></span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">7</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$a</span></span>=1b=2"</span> <span class="token punctuation">&#125;</span> 

<span class="token operator">>></span><span class="token operator">></span>url<span class="token operator">/</span><span class="token operator">?</span>a<span class="token operator">=</span><span class="token number">1</span><span class="token operator">+</span>b<span class="token operator">=</span><span class="token number">2</span>
<span class="token operator">>></span><span class="token operator">></span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span> <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"a=1"</span> <span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=></span> <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"b=2"</span> <span class="token punctuation">&#125;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>+</code>具有分隔的作用</p>
<p>读取内容为get请求后的<code>?</code></p>
<p>可以利用这个对变量进行赋值</p>
<h2 id="gettext-函数"><a href="#gettext-函数" class="headerlink" title="gettext()函数"></a>gettext()函数</h2><blockquote>
<p>可以直接输出文本</p>
<p>需要php扩展目录下有php_gettext.dll</p>
</blockquote>
<p>拓展函数：</p>
<p><code>_()</code>&#x3D;&#x3D;gettext()</p>
<h2 id="get-defined-vars-函数"><a href="#get-defined-vars-函数" class="headerlink" title="get_defined_vars()函数"></a>get_defined_vars()函数</h2><blockquote>
<p>返回由所有已定义变量所组成的数组</p>
</blockquote>
<p>和<code>phpinfo()</code>一样是无参方法，可以直接被<code>call_user_func</code>调用</p>
<hr>
<h2 id="正则绕过"><a href="#正则绕过" class="headerlink" title="正则绕过"></a>正则绕过</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/.+?ctfshow/is'</span><span class="token punctuation">,</span> <span class="token variable">$f</span><span class="token punctuation">)</span>
<span class="token operator">?</span>作为通配符可以匹配至少一个任意字符，但是如果没有这个字符则不匹配，因此ctfshow可以直接绕过<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>





<h2 id="换行解析漏洞"><a href="#换行解析漏洞" class="headerlink" title="换行解析漏洞"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_46091464/article/details/108278486">换行解析漏洞</a></h2><blockquote>
<p>在<code>apache2.40~2.4.29</code>版本中存在这个漏洞</p>
</blockquote>
<pre class="line-numbers language-php+HTML" data-language="php+HTML"><code class="language-php+HTML">&lt;FilesMatch \.php$&gt;
    SetHandler application&#x2F;x-httpd-php
&lt;&#x2F;FilesMatch&gt;
匹配上面的正则表达式就可以进行绕过<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>正则表达式中<code>$</code></p>
<blockquote>
<p>匹配输入字符串的结尾位置。如果设置了 RegExp 对象的 Multiline 属性，则 $ 也匹配 ‘\n’ 或 ‘\r’。要匹配 $ 字符本身，请使用 $。</p>
</blockquote>
<ul>
<li><code>\n</code>换行符即**%0a**</li>
</ul>
</li>
</ul>
<h2 id="路径绕过"><a href="#路径绕过" class="headerlink" title="路径绕过"></a>路径绕过</h2><blockquote>
<p>原型</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"no no no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'u'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>只匹配<code>flag.php</code>,所以可以加入当前路径</p>
<pre class="line-numbers language-none"><code class="language-none">.&#x2F;flag.php
var&#x2F;www&#x2F;html&#x2F;flag.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>



<h2 id="目录穿越"><a href="#目录穿越" class="headerlink" title="目录穿越"></a>目录穿越</h2><p>读取文件时可以利用以下语句访问</p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>etc/passwd
<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www/html<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>注：若路径中有不存在的文件夹会直接跳过此段路径查看</p>
<pre class="line-numbers language-powershell" data-language="powershell"><code class="language-powershell"><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span>aaa/<span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token punctuation">.</span><span class="token punctuation">.</span><span class="token operator">/</span><span class="token keyword">var</span><span class="token operator">/</span>www/html == 上面那段语句<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>





<h2 id="运算符优先级"><a href="#运算符优先级" class="headerlink" title="运算符优先级"></a>运算符优先级</h2><blockquote>
<p>&amp;&amp; &gt; || &gt; &#x3D; &gt; and &gt; or</p>
</blockquote>
<p>赋值语句中出现<code>=</code>和多个<code>and</code>时只会赋第一个值</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$v0</span><span class="token operator">=</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token operator">=</span>的运算符比<span class="token keyword">and</span>高
对于v0的值只需要看v1就可以v2<span class="token punctuation">,</span>v3是干扰<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>



<hr>
<h2 id="内置类"><a href="#内置类" class="headerlink" title="内置类"></a>内置类</h2><blockquote>
<p>题目有调用类语句时可用</p>
<p>如:</p>
<p>echo $v1($v2);</p>
</blockquote>
<h3 id="Exception-函数"><a href="#Exception-函数" class="headerlink" title="Exception()函数"></a><a target="_blank" rel="noopener" href="https://www.runoob.com/php/php-exception.html">Exception()函数</a></h3><blockquote>
<p>用于报错</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">Exception</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Value must be 1 or below"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

Fatal error<span class="token punctuation">:</span> Uncaught exception <span class="token string single-quoted-string">'Exception'</span> with message <span class="token string single-quoted-string">'Value must be 1 or below'</span> in <span class="token operator">/</span>www<span class="token operator">/</span>runoob<span class="token operator">/</span>test<span class="token operator">/</span>test<span class="token operator">.</span>php<span class="token punctuation">:</span><span class="token number">7</span> Stack trace<span class="token punctuation">:</span> <span class="token comment">#0 /www/runoob/test/test.php(13): checkNum(2) #1 &#123;main&#125; thrown in /www/runoob/test/test.php on line 7</span>

因此可以在<span class="token punctuation">(</span><span class="token punctuation">)</span>中执行函数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><code>Exception</code>对象还定义了**__toString()**方法，我们可以直接使用print或echo显示异常对象信息。</li>
</ul>
<h3 id="反射类ReflectionClass"><a href="#反射类ReflectionClass" class="headerlink" title="反射类ReflectionClass"></a><a target="_blank" rel="noopener" href="https://blog.csdn.net/raoxiaoya/article/details/92797765?ops_request_misc=%257B%2522request%255Fid%2522%253A%2522167854036216800186542643%2522%252C%2522scm%2522%253A%252220140713.130102334..%2522%257D&request_id=167854036216800186542643&biz_id=0&utm_medium=distribute.pc_search_result.none-task-blog-2~all~sobaiduend~default-1-92797765-null-null.142%5Ev73%5Einsert_down1,201%5Ev4%5Eadd_ask,239%5Ev2%5Einsert_chatgpt&utm_term=php%E5%8F%8D%E5%B0%84%E7%B1%BB%E7%94%A8%E6%B3%95&spm=1018.2226.3001.4187">反射类ReflectionClass</a></h3><blockquote>
<p>通过<strong>ReflectionClass</strong>，我们可以得到相关类的所有信息，接下来把类名传递即可</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">A</span><span class="token punctuation">&#123;</span>
<span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token variable">$flag</span><span class="token operator">=</span><span class="token string double-quoted-string">"flag&#123;123123123&#125;"</span><span class="token punctuation">;</span>
<span class="token keyword">const</span>  <span class="token constant">PI</span><span class="token operator">=</span><span class="token number">3.14</span><span class="token punctuation">;</span>
<span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">hello</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hello&lt;/br>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ReflectionClass</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'A'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//实例化</span>
 
 
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token function">getConstants</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>  获取一组常量
输出
 <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token string double-quoted-string">"PI"</span><span class="token punctuation">]</span><span class="token operator">=></span>
  <span class="token keyword type-declaration">float</span><span class="token punctuation">(</span><span class="token number">3.14</span><span class="token punctuation">)</span>
<span class="token punctuation">&#125;</span>
 
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    获取类名
输出
<span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"A"</span>
 
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token function">getStaticProperties</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 获取静态属性
输出
<span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token string double-quoted-string">"flag"</span><span class="token punctuation">]</span><span class="token operator">=></span>
  <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">15</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"flag&#123;123123123&#125;"</span>
<span class="token punctuation">&#125;</span>
 
<span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token function">getMethods</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 获取类中的方法
输出
<span class="token keyword">array</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=></span>
  <span class="token keyword type-declaration">object</span><span class="token punctuation">(</span>ReflectionMethod<span class="token punctuation">)</span><span class="token comment">#2 (2) &#123;</span>
    <span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token operator">=></span>
    <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"hello"</span>
    <span class="token punctuation">[</span><span class="token string double-quoted-string">"class"</span><span class="token punctuation">]</span><span class="token operator">=></span>
    <span class="token keyword type-declaration">string</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token string double-quoted-string">"A"</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="文件系统迭代器FilesystemIterator"><a href="#文件系统迭代器FilesystemIterator" class="headerlink" title="文件系统迭代器FilesystemIterator"></a>文件系统迭代器FilesystemIterator</h3><blockquote>
<p>可以显示当前目录下的文件结构，默认只显示第一个文件，需要遍历</p>
</blockquote>
<p><code>getcwd()</code>函数可用于返回当前路径</p>
<p>然后直接访问即可</p>
<hr>
<h2 id="编码绕过"><a href="#编码绕过" class="headerlink" title="编码绕过"></a>编码绕过</h2><h3 id="十六进制"><a href="#十六进制" class="headerlink" title="十六进制"></a>十六进制</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$v4</span> <span class="token operator">=</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">)</span> <span class="token keyword">and</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$v4</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$v2</span><span class="token punctuation">,</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$v1</span><span class="token punctuation">,</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">echo</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
    <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$v3</span><span class="token punctuation">,</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li>v1传入hex2bin函数</li>
<li>v2传入base64后的16进制ascll码</li>
<li>v3传入php伪协议写入文件</li>
</ul>
<h3 id="url编码"><a href="#url编码" class="headerlink" title="url编码"></a>url编码</h3><h3 id="字符编码"><a href="#字符编码" class="headerlink" title="字符编码"></a>字符编码</h3><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">47</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">102</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">49</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">97</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token function">chr</span><span class="token punctuation">(</span><span class="token number">103</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<hr>
<h2 id="变量覆盖"><a href="#变量覆盖" class="headerlink" title="变量覆盖"></a>变量覆盖</h2><ul>
<li>post传入的参数并不能实现变量交换</li>
</ul>
<blockquote>
<p>用我们自定义的参数值替换程序原有的变量值</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">$$ 
<span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数
<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数
<span class="token function">import_request_variables</span><span class="token punctuation">(</span><span class="token punctuation">)</span>函数<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<h3 id=""><a href="#" class="headerlink" title="$$"></a>$$</h3><blockquote>
<p>将之前定义的变量的值重新定义新的变量</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$a</span><span class="token operator">=</span><span class="token class-name type-declaration">b</span>
<span class="token variable">$b</span><span class="token operator">=</span><span class="token class-name type-declaration">c</span>

<span class="token variable">$$a</span> <span class="token operator">=</span> $<span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span> <span class="token operator">=</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token class-name type-declaration">c</span>
    
<span class="token variable">$hell</span><span class="token operator">=</span><span class="token string double-quoted-string">"abc"</span><span class="token punctuation">;</span>
<span class="token variable">$$hell</span><span class="token operator">=</span><span class="token string double-quoted-string">"def"</span><span class="token punctuation">;</span>等同于<span class="token variable">$abc</span><span class="token operator">=</span><span class="token string double-quoted-string">"def"</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<ul>
<li><p>$GLOBALS</p>
<blockquote>
<p>返回全局作用域中可用的全部变量</p>
</blockquote>
<p>可在过滤相关命令执行函数情况下使用</p>
</li>
</ul>
<h3 id="extract-函数"><a href="#extract-函数" class="headerlink" title="extract()函数"></a>extract()函数</h3><blockquote>
<p>将数组中的变量导入到当前的符号表</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">extract</span><span class="token punctuation">(</span><span class="token keyword type-declaration">array</span><span class="token punctuation">,</span>extract_rules<span class="token punctuation">,</span>prefix<span class="token punctuation">)</span> 
    
<span class="token comment">//array 必需的，规定要使用的数组</span>
<span class="token comment">//extract_rules 可有可无，如果为空，则默认为EXTR_OVERWRITE</span>
<span class="token comment">//prefix可选。如果 extract_rules 参数的值是 EXTR_PREFIX_SAME、EXTR_PREFIX_ALL、 EXTR_PREFIX_INVALID 或 EXTR_PREFIX_IF_EXISTS，则 prefix 是必需的。该参数规定了前缀。前缀和数组键名之间会自动加上一个下划线。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<h3 id="parse-str-函数"><a href="#parse-str-函数" class="headerlink" title="parse_str()函数"></a>parse_str()函数</h3><blockquote>
<p>把查询字符串解析到变量中</p>
<p>PHP4+</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token keyword type-declaration">string</span><span class="token punctuation">,</span><span class="token keyword type-declaration">array</span><span class="token punctuation">)</span> 
    
没有返回值
<span class="token comment">//string 	必需。规定要解析的字符串。</span>
<span class="token comment">//array 	可选。规定存储变量的数组名称。该参数指示变量存储到数组中。</span>
<span class="token comment">//          如果未设置 array 参数，由该函数设置的变量将覆盖已存在的同名变量。</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><strong>注释：</strong>如果未设置 array 参数，由该函数设置的变量将覆盖已存在的同名变量。</p>
<p><strong>注释：</strong>php.ini 文件中的 magic_quotes_gpc 设置影响该函数的输出。如果已启用，那么在 parse_str() 解析之前，变量会被 addslashes() 转换。</p>
<blockquote>
<p>例</p>
</blockquote>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">parse_str</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"name=Peter&amp;age=43"</span><span class="token punctuation">,</span><span class="token variable">$myArray</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">print_r</span><span class="token punctuation">(</span><span class="token variable">$myArray</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span>
    
    输出
    Array ( [name] => Peter [age] => 43 ) <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>



<hr>
<h2 id="非法传参"><a href="#非法传参" class="headerlink" title="非法传参"></a>非法传参</h2><blockquote>
<p>当变量名中出现点和空格时，变量名中的点和空格被转换成下划线</p>
</blockquote>
<ul>
<li><p>版本：php &lt; 8</p>
</li>
<li><p>在变量解析中，php会把请求参数中的非法字符转为下划线</p>
</li>
<li><p>如果参数中出现中括号<code>[</code>，中括号会被转换成下划线<code>_</code>，但是会出现转换错误导致接下来如果该参数名中还有<code>非法字符</code>并不会继续转换成下划线<code>_</code>，也就是说如果中括号<code>[</code>出现在前面，那么中括号<code>[</code>还是会被转换成下划线<code>_</code>，但是因为出错导致接下来的非法字符并不会被转换成下划线<code>_</code></p>
</li>
</ul>
<hr>
<h2 id="md5等效值绕过"><a href="#md5等效值绕过" class="headerlink" title="md5等效值绕过"></a>md5等效值绕过</h2><ul>
<li><p>弱类型绕过</p>
<ul>
<li><p>以0e开头的数字后面会被忽略（科学计数法）</p>
<p>即返回<code>0</code></p>
<pre class="line-numbers language-none"><code class="language-none">QNKCDZO

240610708

s878926199a

s155964671a

s1091221200a<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>数组绕过</p>
<p>原理是<strong>md5等函数不能处理数组，导致函数返回Null</strong>。而Null是等于Null的，导致了绕过。</p>
</li>
</ul>
</li>
<li><p>强类型绕过</p>
<p>用MD值完全相同的字符来进行绕过</p>
<pre class="line-numbers language-none"><code class="language-none">psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%24%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%82%7D%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%84%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEcC%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%BC%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%99%B59%F9%FF%C2

psycho%0A%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00%00W%ADZ%AF%3C%8A%13V%B5%96%18m%A5%EA2%81_%FB%D9%A4%22%2F%8F%D4D%A27vX%B8%08%D7m%2C%E0%D4LR%D7%FBo%10t%19%02%02%7E%7B%2B%9Bt%05%FFl%AE%8DE%F4%1F%04%3C%AE%01%0F%9B%12%D4%81%A5J%F9H%0FyE%2A%DC%2B%B1%B4%0F%DEc%C3%40%DA29%8B%C3%00%7F%8B_h%C6%D3%8Bd8%AF%85%7C%14w%06%C2%3AC%3C%0C%1B%FD%BB%98%CE%16%CE%B7%B6%3A%F3%9959%F9%FF%C2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>
</li>
<li><p>自身和md5后都是0e开头</p>
<pre class="line-numbers language-none"><code class="language-none">0e215962017<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li>
</ul>
<h2 id="SHA1"><a href="#SHA1" class="headerlink" title="SHA1"></a>SHA1</h2><ul>
<li><p>弱类型</p>
<ul>
<li><p>数组绕过</p>
</li>
<li><pre class="line-numbers language-none"><code class="language-none">aaO8zKZF
aaK1STfY<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre></li>
</ul>
</li>
<li><p>强类型绕过</p>
</li>
</ul>
<pre class="line-numbers language-none"><code class="language-none">array1&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01%7FF%DC%93%A6%B6%7E%01%3B%02%9A%AA%1D%B2V%0BE%CAg%D6%88%C7%F8K%8CLy%1F%E0%2B%3D%F6%14%F8m%B1i%09%01%C5kE%C1S%0A%FE%DF%B7%608%E9rr&#x2F;%E7%ADr%8F%0EI%04%E0F%C20W%0F%E9%D4%13%98%AB%E1.%F5%BC%94%2B%E35B%A4%80-%98%B5%D7%0F%2A3.%C3%7F%AC5%14%E7M%DC%0F%2C%C1%A8t%CD%0Cx0Z%21Vda0%97%89%60k%D0%BF%3F%98%CD%A8%04F%29%A1
&amp;array2&#x3D;%25PDF-1.3%0A%25%E2%E3%CF%D3%0A%0A%0A1%200%20obj%0A%3C%3C&#x2F;Width%202%200%20R&#x2F;Height%203%200%20R&#x2F;Type%204%200%20R&#x2F;Subtype%205%200%20R&#x2F;Filter%206%200%20R&#x2F;ColorSpace%207%200%20R&#x2F;Length%208%200%20R&#x2F;BitsPerComponent%208%3E%3E%0Astream%0A%FF%D8%FF%FE%00%24SHA-1%20is%20dead%21%21%21%21%21%85&#x2F;%EC%09%239u%9C9%B1%A1%C6%3CL%97%E1%FF%FE%01sF%DC%91f%B6%7E%11%8F%02%9A%B6%21%B2V%0F%F9%CAg%CC%A8%C7%F8%5B%A8Ly%03%0C%2B%3D%E2%18%F8m%B3%A9%09%01%D5%DFE%C1O%26%FE%DF%B3%DC8%E9j%C2&#x2F;%E7%BDr%8F%0EE%BC%E0F%D2%3CW%0F%EB%14%13%98%BBU.%F5%A0%A8%2B%E31%FE%A4%807%B8%B5%D7%1F%0E3.%DF%93%AC5%00%EBM%DC%0D%EC%C1%A8dy%0Cx%2Cv%21V%60%DD0%97%91%D0k%D0%AF%3F%98%CD%A4%BCF%29%B1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>


    </div>
    
    
    
    
    
    
    
</div>

            </div>
            </transition>
            
            <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
            </transition>
            
        </div>
        <script src="/blog/js/main.js"></script>
        
        




         
        
    <div id="vcomments"></div>
    
        <script src="/blog/js/lib/valine.min.js"></script>
            <script>
                new Valine({
                    el: '#vcomments',
                    appId: 'U9mZLKunkRUTcBFthjXPjnZE-9Nh9j0Va',
                    appKey: 'SzWOnY0PWLGNuL6jW8TZYc7j',
                });
            </script>

        <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2023 雲流のLowest World
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;C1oudfL0w0
            <span id="busuanzi_container_site_uv"> 
                本站访客数<span id="busuanzi_value_site_uv"></span>人次
            </span>
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

    <script src="/blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/blog/live2dw/assets/z16.model.json"},"display":{"position":"left","width":150,"height":290},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>
</html>

